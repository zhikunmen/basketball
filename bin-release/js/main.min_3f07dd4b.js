function createBitmapByName(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e}function createBitmapFromSheet(t,e){void 0===e&&(e="gameRes");var i=RES.getRes(e),r=i.getTexture(t),n=new egret.Bitmap;return n.texture=r,n}function getTextureFromSheet(t,e){void 0===e&&(e="gameRes");var i=RES.getRes(e),r=i.getTexture(t);return r}var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);i.prototype=e.prototype,t.prototype=new i};if("undefined"==typeof global)var global=window;if("undefined"==typeof __global)var __global=global;var __define=this&&this.__define||function(t,e,i,r){Object.defineProperty(t,e,{configurable:!0,enumerable:!0,get:i,set:r})},egret;!function(t){t.$hashCount=1;var e=function(){function e(){this.$hashCode=t.$hashCount++}return Object.defineProperty(e.prototype,"hashCode",{get:function(){return this.$hashCode},enumerable:!0,configurable:!0}),e}();t.HashObject=e,__reflect(e.prototype,"egret.HashObject",["egret.IHashObject"])}(egret||(egret={}));var egret;!function(t){var e=[],i=function(i){function r(t){void 0===t&&(t=null);var e=i.call(this)||this;return e.$EventDispatcher={0:t?t:e,1:{},2:{},3:0},e}return __extends(r,i),r.prototype.$getEventMap=function(t){var e=this.$EventDispatcher,i=t?e[2]:e[1];return i},r.prototype.addEventListener=function(t,e,i,r,n){this.$addListener(t,e,i,r,n)},r.prototype.once=function(t,e,i,r,n){this.$addListener(t,e,i,r,n,!0)},r.prototype.$addListener=function(t,e,i,r,n,a){var o=this.$EventDispatcher,s=r?o[2]:o[1],l=s[t];l?0!==o[3]&&(s[t]=l=l.concat()):l=s[t]=[],this.$insertEventBin(l,t,e,i,r,n,a)},r.prototype.$insertEventBin=function(t,e,i,r,n,a,o){a=0|+a;for(var s=-1,l=t.length,h=0;l>h;h++){var c=t[h];if(c.listener==i&&c.thisObject==r&&c.target==this)return!1;-1==s&&c.priority<a&&(s=h)}var u={type:e,listener:i,thisObject:r,priority:a,target:this,useCapture:n,dispatchOnce:!!o};return-1!==s?t.splice(s,0,u):t.push(u),!0},r.prototype.removeEventListener=function(t,e,i,r){var n=this.$EventDispatcher,a=r?n[2]:n[1],o=a[t];o&&(0!==n[3]&&(a[t]=o=o.concat()),this.$removeEventBin(o,e,i),0==o.length&&(a[t]=null))},r.prototype.$removeEventBin=function(t,e,i){for(var r=t.length,n=0;r>n;n++){var a=t[n];if(a.listener==e&&a.thisObject==i&&a.target==this)return t.splice(n,1),!0}return!1},r.prototype.hasEventListener=function(t){var e=this.$EventDispatcher;return!(!e[1][t]&&!e[2][t])},r.prototype.willTrigger=function(t){return this.hasEventListener(t)},r.prototype.dispatchEvent=function(t){return t.$currentTarget=this.$EventDispatcher[0],t.$setTarget(t.$currentTarget),this.$notifyListener(t,!1)},r.prototype.$notifyListener=function(t,i){var r=this.$EventDispatcher,n=i?r[2]:r[1],a=n[t.$type];if(!a)return!0;var o=a.length;if(0==o)return!0;var s=e;r[3]++;for(var l=0;o>l;l++){var h=a[l];if(h.listener.call(h.thisObject,t),h.dispatchOnce&&s.push(h),t.$isPropagationImmediateStopped)break}for(r[3]--;s.length;){var h=s.pop();h.target.removeEventListener(h.type,h.listener,h.thisObject,h.useCapture)}return!t.$isDefaultPrevented},r.prototype.dispatchEventWith=function(e,i,r,n){if(i||this.hasEventListener(e)){var a=t.Event.create(t.Event,e,i,n);a.data=r;var o=this.dispatchEvent(a);return t.Event.release(a),o}return!0},r}(t.HashObject);t.EventDispatcher=i,__reflect(i.prototype,"egret.EventDispatcher",["egret.IEventDispatcher"])}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.type=null,i.$id=null,i.paddingTop=0,i.paddingBottom=0,i.paddingLeft=0,i.paddingRight=0,i.$uniforms={},t.nativeRender&&egret_native.NativeDisplayObject.createFilter(i),i}return __extends(i,e),i.prototype.$toJson=function(){return""},i.prototype.updatePadding=function(){},i.prototype.onPropertyChange=function(){var e=this;e.updatePadding(),t.nativeRender&&(egret_native.NativeDisplayObject.setFilterPadding(e.$id,e.paddingTop,e.paddingBottom,e.paddingLeft,e.paddingRight),egret_native.NativeDisplayObject.setDataToFilter(e))},i}(t.HashObject);t.Filter=e,__reflect(e.prototype,"egret.Filter")}(egret||(egret={}));var egret;!function(t){function e(t){return t%=360,t>180?t-=360:-180>t&&(t+=360),t}var i=function(i){function r(){var e=i.call(this)||this;return e.$children=null,e.$name="",e.$parent=null,e.$stage=null,e.$nestLevel=0,e.$useTranslate=!1,e.$matrix=new t.Matrix,e.$matrixDirty=!1,e.$x=0,e.$y=0,e.$scaleX=1,e.$scaleY=1,e.$rotation=0,e.$skewX=0,e.$skewXdeg=0,e.$skewY=0,e.$skewYdeg=0,e.$explicitWidth=0/0,e.$explicitHeight=0/0,e.$anchorOffsetX=0,e.$anchorOffsetY=0,e.$visible=!0,e.$displayList=null,e.$cacheAsBitmap=!1,e.$cacheDirty=!1,e.$alpha=1,e.$touchEnabled=r.defaultTouchEnabled,e.$scrollRect=null,e.$blendMode=0,e.$maskedObject=null,e.$mask=null,e.$maskRect=null,e.$parentDisplayList=null,e.$renderNode=null,e.$renderDirty=!1,e.$renderMode=null,e._tint=0,e.$tintRGB=0,e.$sortDirty=!1,e._zIndex=0,e.$lastSortedIndex=0,e.sortableChildren=!1,t.nativeRender&&e.createNativeDisplayObject(),e.tint=16777215,e}return __extends(r,i),r.prototype.createNativeDisplayObject=function(){this.$nativeDisplayObject=new egret_native.NativeDisplayObject(0)},Object.defineProperty(r.prototype,"name",{get:function(){return this.$name},set:function(t){this.$name=t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"parent",{get:function(){return this.$parent},enumerable:!0,configurable:!0}),r.prototype.$setParent=function(t){this.$parent=t},r.prototype.$onAddToStage=function(e,i){var r=this;r.$stage=e,r.$nestLevel=i,r.$hasAddToStage=!0,t.Sprite.$EVENT_ADD_TO_STAGE_LIST.push(r)},r.prototype.$onRemoveFromStage=function(){var e=this;e.$nestLevel=0,t.Sprite.$EVENT_REMOVE_FROM_STAGE_LIST.push(e)},r.prototype.$updateUseTransform=function(){var t=this;1==t.$scaleX&&1==t.$scaleY&&0==t.$skewX&&0==t.$skewY?t.$useTranslate=!1:t.$useTranslate=!0},Object.defineProperty(r.prototype,"stage",{get:function(){return this.$stage},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"matrix",{get:function(){return this.$getMatrix().clone()},set:function(t){this.$setMatrix(t)},enumerable:!0,configurable:!0}),r.prototype.$getMatrix=function(){var t=this;return t.$matrixDirty&&(t.$matrixDirty=!1,t.$matrix.$updateScaleAndRotation(t.$scaleX,t.$scaleY,t.$skewX,t.$skewY)),t.$matrix.tx=t.$x,t.$matrix.ty=t.$y,t.$matrix},r.prototype.$setMatrix=function(i,r){void 0===r&&(r=!0);var n=this,a=n.$matrix;a.a=i.a,a.b=i.b,a.c=i.c,a.d=i.d,n.$x=i.tx,n.$y=i.ty,n.$matrixDirty=!1,1==a.a&&0==a.b&&0==a.c&&1==a.d?n.$useTranslate=!1:n.$useTranslate=!0,r&&(n.$scaleX=a.$getScaleX(),n.$scaleY=a.$getScaleY(),n.$skewX=i.$getSkewX(),n.$skewY=i.$getSkewY(),n.$skewXdeg=e(180*n.$skewX/Math.PI),n.$skewYdeg=e(180*n.$skewY/Math.PI),n.$rotation=e(180*n.$skewY/Math.PI)),t.nativeRender&&n.$nativeDisplayObject.setMatrix(i.a,i.b,i.c,i.d,i.tx,i.ty)},r.prototype.$getConcatenatedMatrix=function(){var e=this,i=e.$concatenatedMatrix;i||(i=e.$concatenatedMatrix=new t.Matrix),e.$parent?e.$parent.$getConcatenatedMatrix().$preMultiplyInto(e.$getMatrix(),i):i.copyFrom(e.$getMatrix());var r=e.$anchorOffsetX,n=e.$anchorOffsetY,a=e.$scrollRect;return a?i.$preMultiplyInto(t.$TempMatrix.setTo(1,0,0,1,-a.x-r,-a.y-n),i):(0!=r||0!=n)&&i.$preMultiplyInto(t.$TempMatrix.setTo(1,0,0,1,-r,-n),i),e.$concatenatedMatrix},r.prototype.$getInvertedConcatenatedMatrix=function(){var e=this;return e.$invertedConcatenatedMatrix||(e.$invertedConcatenatedMatrix=new t.Matrix),e.$getConcatenatedMatrix().$invertInto(e.$invertedConcatenatedMatrix),e.$invertedConcatenatedMatrix},Object.defineProperty(r.prototype,"x",{get:function(){return this.$getX()},set:function(t){this.$setX(t)},enumerable:!0,configurable:!0}),r.prototype.$getX=function(){return this.$x},r.prototype.$setX=function(e){var i=this;if(i.$x==e)return!1;if(i.$x=e,t.nativeRender)i.$nativeDisplayObject.setX(e);else{var r=i.$parent;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp());var n=i.$maskedObject;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp())}return!0},Object.defineProperty(r.prototype,"y",{get:function(){return this.$getY()},set:function(t){this.$setY(t)},enumerable:!0,configurable:!0}),r.prototype.$getY=function(){return this.$y},r.prototype.$setY=function(e){var i=this;if(i.$y==e)return!1;if(i.$y=e,t.nativeRender)i.$nativeDisplayObject.setY(e);else{var r=i.$parent;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp());var n=i.$maskedObject;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp())}return!0},Object.defineProperty(r.prototype,"scaleX",{get:function(){return this.$getScaleX()},set:function(t){this.$setScaleX(t)},enumerable:!0,configurable:!0}),r.prototype.$getScaleX=function(){return this.$scaleX},r.prototype.$setScaleX=function(e){var i=this;if(i.$scaleX!=e)if(i.$scaleX=e,i.$matrixDirty=!0,i.$updateUseTransform(),t.nativeRender)i.$nativeDisplayObject.setScaleX(e);else{var r=i.$parent;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp());var n=i.$maskedObject;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp())}},Object.defineProperty(r.prototype,"scaleY",{get:function(){return this.$getScaleY()},set:function(t){this.$setScaleY(t)},enumerable:!0,configurable:!0}),r.prototype.$getScaleY=function(){return this.$scaleY},r.prototype.$setScaleY=function(e){var i=this;if(i.$scaleY!=e)if(i.$scaleY=e,i.$matrixDirty=!0,i.$updateUseTransform(),t.nativeRender)i.$nativeDisplayObject.setScaleY(e);else{var r=i.$parent;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp());var n=i.$maskedObject;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp())}},Object.defineProperty(r.prototype,"rotation",{get:function(){return this.$getRotation()},set:function(t){this.$setRotation(t)},enumerable:!0,configurable:!0}),r.prototype.$getRotation=function(){return this.$rotation},r.prototype.$setRotation=function(i){i=e(i);var r=this;if(i!=r.$rotation){var n=i-r.$rotation,a=n/180*Math.PI;if(r.$skewX+=a,r.$skewY+=a,r.$rotation=i,r.$matrixDirty=!0,r.$updateUseTransform(),t.nativeRender)r.$nativeDisplayObject.setRotation(i);else{var o=r.$parent;o&&!o.$cacheDirty&&(o.$cacheDirty=!0,o.$cacheDirtyUp());var s=r.$maskedObject;s&&!s.$cacheDirty&&(s.$cacheDirty=!0,s.$cacheDirtyUp())}}},Object.defineProperty(r.prototype,"skewX",{get:function(){return this.$skewXdeg},set:function(t){this.$setSkewX(t)},enumerable:!0,configurable:!0}),r.prototype.$setSkewX=function(i){var r=this;if(i!=r.$skewXdeg)if(r.$skewXdeg=i,i=e(i),i=i/180*Math.PI,r.$skewX=i,r.$matrixDirty=!0,r.$updateUseTransform(),t.nativeRender)r.$nativeDisplayObject.setSkewX(r.$skewXdeg);else{var n=r.$parent;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp());var a=r.$maskedObject;a&&!a.$cacheDirty&&(a.$cacheDirty=!0,a.$cacheDirtyUp())}},Object.defineProperty(r.prototype,"skewY",{get:function(){return this.$skewYdeg},set:function(t){this.$setSkewY(t)},enumerable:!0,configurable:!0}),r.prototype.$setSkewY=function(i){var r=this;if(i!=r.$skewYdeg)if(r.$skewYdeg=i,i=e(i),i=(i+r.$rotation)/180*Math.PI,r.$skewY=i,r.$matrixDirty=!0,r.$updateUseTransform(),t.nativeRender)r.$nativeDisplayObject.setSkewY(r.$skewYdeg);else{var n=r.$parent;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp());var a=r.$maskedObject;a&&!a.$cacheDirty&&(a.$cacheDirty=!0,a.$cacheDirtyUp())}},Object.defineProperty(r.prototype,"width",{get:function(){return this.$getWidth()},set:function(t){this.$setWidth(t)},enumerable:!0,configurable:!0}),r.prototype.$getWidth=function(){var t=this;return isNaN(t.$explicitWidth)?t.$getOriginalBounds().width:t.$explicitWidth},r.prototype.$setWidth=function(t){t=isNaN(t)?0/0:t,this.$explicitWidth!=t&&(this.$explicitWidth=t)},Object.defineProperty(r.prototype,"height",{get:function(){return this.$getHeight()},set:function(t){this.$setHeight(t)},enumerable:!0,configurable:!0}),r.prototype.$getHeight=function(){var t=this;return isNaN(t.$explicitHeight)?t.$getOriginalBounds().height:t.$explicitHeight},r.prototype.$setHeight=function(t){t=isNaN(t)?0/0:t,this.$explicitHeight!=t&&(this.$explicitHeight=t)},Object.defineProperty(r.prototype,"measuredWidth",{get:function(){return this.$getOriginalBounds().width},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"measuredHeight",{get:function(){return this.$getOriginalBounds().height},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"anchorOffsetX",{get:function(){return this.$anchorOffsetX},set:function(t){this.$setAnchorOffsetX(t)},enumerable:!0,configurable:!0}),r.prototype.$setAnchorOffsetX=function(e){var i=this;if(i.$anchorOffsetX!=e)if(i.$anchorOffsetX=e,t.nativeRender)i.$nativeDisplayObject.setAnchorOffsetX(e);else{var r=i.$parent;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp());var n=i.$maskedObject;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp())}},Object.defineProperty(r.prototype,"anchorOffsetY",{get:function(){return this.$anchorOffsetY},set:function(t){this.$setAnchorOffsetY(t)},enumerable:!0,configurable:!0}),r.prototype.$setAnchorOffsetY=function(e){var i=this;if(i.$anchorOffsetY!=e)if(i.$anchorOffsetY=e,t.nativeRender)i.$nativeDisplayObject.setAnchorOffsetY(e);else{var r=i.$parent;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp());var n=i.$maskedObject;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp())}},Object.defineProperty(r.prototype,"visible",{get:function(){return this.$visible},set:function(t){this.$setVisible(t)},enumerable:!0,configurable:!0}),r.prototype.$setVisible=function(e){var i=this;if(i.$visible!=e)if(i.$visible=e,t.nativeRender)i.$nativeDisplayObject.setVisible(e);else{i.$updateRenderMode();var r=i.$parent;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp());var n=i.$maskedObject;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp())}},Object.defineProperty(r.prototype,"cacheAsBitmap",{get:function(){return this.$cacheAsBitmap},set:function(e){var i=this;i.$cacheAsBitmap=e,t.nativeRender?i.$nativeDisplayObject.setCacheAsBitmap(e):i.$setHasDisplayList(e)},enumerable:!0,configurable:!0}),r.prototype.$setHasDisplayList=function(e){var i=this,r=!!i.$displayList;if(r!=e)if(e){var n=t.sys.DisplayList.create(i);n&&(i.$displayList=n,i.$cacheDirty=!0)}else i.$displayList=null},r.prototype.$cacheDirtyUp=function(){var t=this.$parent;t&&!t.$cacheDirty&&(t.$cacheDirty=!0,t.$cacheDirtyUp())},Object.defineProperty(r.prototype,"alpha",{get:function(){return this.$alpha},set:function(t){this.$setAlpha(t)},enumerable:!0,configurable:!0}),r.prototype.$setAlpha=function(e){var i=this;if(i.$alpha!=e)if(i.$alpha=e,t.nativeRender)i.$nativeDisplayObject.setAlpha(e);else{i.$updateRenderMode();var r=i.$parent;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp());var n=i.$maskedObject;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp())}},Object.defineProperty(r.prototype,"touchEnabled",{get:function(){return this.$getTouchEnabled()},set:function(t){this.$setTouchEnabled(t)},enumerable:!0,configurable:!0}),r.prototype.$getTouchEnabled=function(){return this.$touchEnabled},r.prototype.$setTouchEnabled=function(t){this.$touchEnabled=!!t},Object.defineProperty(r.prototype,"scrollRect",{get:function(){return this.$scrollRect},set:function(t){this.$setScrollRect(t)},enumerable:!0,configurable:!0}),r.prototype.$setScrollRect=function(e){var i=this;if(!e&&!i.$scrollRect)return void i.$updateRenderMode();if(e?(i.$scrollRect||(i.$scrollRect=new t.Rectangle),i.$scrollRect.copyFrom(e),t.nativeRender&&i.$nativeDisplayObject.setScrollRect(e.x,e.y,e.width,e.height)):(i.$scrollRect=null,t.nativeRender&&i.$nativeDisplayObject.setScrollRect(0,0,0,0)),!t.nativeRender){i.$updateRenderMode();var r=i.$parent;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp());var n=i.$maskedObject;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp())}},Object.defineProperty(r.prototype,"blendMode",{get:function(){return t.sys.numberToBlendMode(this.$blendMode)},set:function(e){var i=this,r=t.sys.blendModeToNumber(e);if(i.$blendMode!=r)if(i.$blendMode=r,t.nativeRender)i.$nativeDisplayObject.setBlendMode(r);else{i.$updateRenderMode();var n=i.$parent;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp());var a=i.$maskedObject;a&&!a.$cacheDirty&&(a.$cacheDirty=!0,a.$cacheDirtyUp())}},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"mask",{get:function(){var t=this;return t.$mask?t.$mask:t.$maskRect},set:function(e){var i=this;if(e!==i){if(e)if(e instanceof r){if(e==i.$mask)return;e.$maskedObject&&(e.$maskedObject.mask=null),e.$maskedObject=i,i.$mask=e,t.nativeRender||e.$updateRenderMode(),i.$maskRect&&(t.nativeRender&&i.$nativeDisplayObject.setMaskRect(0,0,0,0),i.$maskRect=null),t.nativeRender&&i.$nativeDisplayObject.setMask(e.$nativeDisplayObject.id)}else i.$maskRect||(i.$maskRect=new t.Rectangle),i.$maskRect.copyFrom(e),t.nativeRender&&i.$nativeDisplayObject.setMaskRect(e.x,e.y,e.width,e.height),i.$mask&&(i.$mask.$maskedObject=null,t.nativeRender||i.$mask.$updateRenderMode()),i.mask&&(t.nativeRender&&i.$nativeDisplayObject.setMask(-1),i.$mask=null);else i.$mask&&(i.$mask.$maskedObject=null,t.nativeRender||i.$mask.$updateRenderMode()),i.mask&&(t.nativeRender&&i.$nativeDisplayObject.setMask(-1),i.$mask=null),i.$maskRect&&(t.nativeRender&&i.$nativeDisplayObject.setMaskRect(0,0,0,0),i.$maskRect=null);t.nativeRender||i.$updateRenderMode()}},enumerable:!0,configurable:!0}),r.prototype.$setMaskRect=function(e){var i=this;(e||i.$maskRect)&&(e?(i.$maskRect||(i.$maskRect=new t.Rectangle),i.$maskRect.copyFrom(e)):i.$maskRect=null)},Object.defineProperty(r.prototype,"filters",{get:function(){return this.$filters},set:function(e){var i=this,r=i.$filters;if(r||e){if(e&&e.length?(e=e.concat(),i.$filters=e,t.nativeRender&&i.$nativeDisplayObject.setFilters(e)):(i.$filters=e,t.nativeRender&&i.$nativeDisplayObject.setFilters(null)),!t.nativeRender){i.$updateRenderMode();var n=i.$parent;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp());var a=i.$maskedObject;a&&!a.$cacheDirty&&(a.$cacheDirty=!0,a.$cacheDirtyUp())}}else if(i.$filters=e,t.nativeRender)i.$nativeDisplayObject.setFilters(null);else{i.$updateRenderMode();var n=i.$parent;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp());var a=i.$maskedObject;a&&!a.$cacheDirty&&(a.$cacheDirty=!0,a.$cacheDirtyUp())}},enumerable:!0,configurable:!0}),r.prototype.getTransformedBounds=function(t,e){return t=t||this,this.$getTransformedBounds(t,e)},r.prototype.getBounds=function(t,e){void 0===e&&(e=!0);var i=this;return t=i.$getTransformedBounds(i,t),e&&(0!=i.$anchorOffsetX&&(t.x-=i.$anchorOffsetX),0!=i.$anchorOffsetY&&(t.y-=i.$anchorOffsetY)),t},r.prototype.$getTransformedBounds=function(e,i){var r=this,n=r.$getOriginalBounds();if(i||(i=new t.Rectangle),i.copyFrom(n),e==r)return i;var a;if(e){a=t.$TempMatrix;var o=e.$getInvertedConcatenatedMatrix();o.$preMultiplyInto(r.$getConcatenatedMatrix(),a)}else a=r.$getConcatenatedMatrix();return a.$transformBounds(i),i},r.prototype.globalToLocal=function(e,i,r){if(void 0===e&&(e=0),void 0===i&&(i=0),t.nativeRender){egret_native.updateNativeRender();var n=egret_native.nrGlobalToLocal(this.$nativeDisplayObject.id,e,i),a=n.split(","),o=parseFloat(a[0]),s=parseFloat(a[1]);return r?r.setTo(o,s):r=new t.Point(o,s),r}var l=this.$getInvertedConcatenatedMatrix();return l.transformPoint(e,i,r)},r.prototype.localToGlobal=function(e,i,r){if(void 0===e&&(e=0),void 0===i&&(i=0),t.nativeRender){egret_native.updateNativeRender();var n=egret_native.nrLocalToGlobal(this.$nativeDisplayObject.id,e,i),a=n.split(","),o=parseFloat(a[0]),s=parseFloat(a[1]);return r?r.setTo(o,s):r=new t.Point(o,s),r}var l=this.$getConcatenatedMatrix();return l.transformPoint(e,i,r)},r.prototype.$getOriginalBounds=function(){var t=this,e=t.$getContentBounds();t.$measureChildBounds(e);var i=t.$measureFiltersOffset(!1);return i&&(e.x+=i.minX,e.y+=i.minY,e.width+=-i.minX+i.maxX,e.height+=-i.minY+i.maxY),e},r.prototype.$measureChildBounds=function(t){},r.prototype.$getContentBounds=function(){var e=t.$TempRectangle;return e.setEmpty(),this.$measureContentBounds(e),e},r.prototype.$measureContentBounds=function(t){},r.prototype.$getRenderNode=function(){var t=this,e=t.$renderNode;return e?(t.$renderDirty&&(e.cleanBeforeRender(),t.$updateRenderNode(),t.$renderDirty=!1,e=t.$renderNode),e):null},r.prototype.$updateRenderMode=function(){var t=this;!t.$visible||t.$alpha<=0||t.$maskedObject?t.$renderMode=1:t.filters&&t.filters.length>0?t.$renderMode=2:0!==t.$blendMode||t.$mask&&t.$mask.$stage?t.$renderMode=3:t.$scrollRect||t.$maskRect?t.$renderMode=4:t.$renderMode=null},r.prototype.$measureFiltersOffset=function(e){for(var i=this,r=0,n=0,a=0,o=0;i;){var s=i.$filters;if(s&&s.length)for(var l=s.length,h=0;l>h;h++){var c=s[h];if("blur"==c.type){var u=c.blurX,p=c.blurY;r-=u,n-=p,a+=u,o+=p}else if("glow"==c.type){var u=c.blurX,p=c.blurY;r-=u,n-=p,a+=u,o+=p;var d=c.distance||0,f=c.angle||0,g=0,m=0;0!=d&&(g=d*t.NumberUtils.cos(f),g=g>0?Math.ceil(g):Math.floor(g),m=d*t.NumberUtils.sin(f),m=m>0?Math.ceil(m):Math.floor(m),r+=g,a+=g,n+=m,o+=m)}else if("custom"==c.type){var y=c.padding;r-=y,n-=y,a+=y,o+=y}}i=e?i.$parent:null}return r=Math.min(r,0),n=Math.min(n,0),a=Math.max(a,0),o=Math.max(o,0),{minX:r,minY:n,maxX:a,maxY:o}},r.prototype.$getConcatenatedMatrixAt=function(e,i){var r=e.$getInvertedConcatenatedMatrix();if(0===r.a||0===r.d){var n=this,a=e.$nestLevel;for(i.identity();n.$nestLevel>a;){var o=n.$scrollRect;o&&i.concat(t.$TempMatrix.setTo(1,0,0,1,-o.x,-o.y)),i.concat(n.$getMatrix()),n=n.$parent}}else r.$preMultiplyInto(i,i)},r.prototype.$updateRenderNode=function(){},r.prototype.$hitTest=function(e,i){var r=this;if(!t.nativeRender&&!r.$renderNode||!r.$visible||0==r.$scaleX||0==r.$scaleY)return null;var n=r.$getInvertedConcatenatedMatrix();if(0==n.a&&0==n.b&&0==n.c&&0==n.d)return null;var a=r.$getContentBounds(),o=n.a*e+n.c*i+n.tx,s=n.b*e+n.d*i+n.ty;if(a.contains(o,s)){if(!r.$children){var l=r.$scrollRect?r.$scrollRect:r.$maskRect;if(l&&!l.contains(o,s))return null;if(r.$mask&&!r.$mask.$hitTest(e,i))return null}return r}return null},r.prototype.hitTestPoint=function(e,i,r){var n=this;if(r){var a=n.$getInvertedConcatenatedMatrix(),o=a.a*e+a.c*i+a.tx,s=a.b*e+a.d*i+a.ty,l=void 0;if(t.nativeRender){var h=t.sys.customHitTestBuffer;h.resize(3,3),egret_native.forHitTest=!0,egret_native.activateBuffer(h),egret_native.updateNativeRender(),egret_native.nrRenderDisplayObject2(n.$nativeDisplayObject.id,1-o,1-s,!0);try{l=new Uint8Array(4),egret_native.nrGetPixels(1,1,1,1,l)}catch(c){throw new Error(t.sys.tr(1039))}return egret_native.activateBuffer(null),egret_native.forHitTest=!1,0===l[3]?!1:!0}var u=n.$displayList;if(u){var h=u.renderBuffer;try{l=h.getPixels(o-u.offsetX,s-u.offsetY)}catch(c){throw new Error(t.sys.tr(1039))}}else{var h=t.sys.customHitTestBuffer;h.resize(3,3);var p=t.Matrix.create();p.identity(),p.translate(1-o,1-s),t.sys.systemRenderer.render(this,h,p,!0),t.Matrix.release(p);try{l=h.getPixels(1,1)}catch(c){throw new Error(t.sys.tr(1039))}}return 0===l[3]?!1:!0}if(0==n.$scaleX||0==n.$scaleY)return!1;var a=n.$getInvertedConcatenatedMatrix(),d=n.getBounds(null,!1),o=a.a*e+a.c*i+a.tx,s=a.b*e+a.d*i+a.ty;if(d.contains(o,s)){var f=n.$scrollRect?n.$scrollRect:n.$maskRect;return f&&!f.contains(o,s)?!1:!0}return!1},r.prototype.$addListener=function(e,n,a,o,s,l){i.prototype.$addListener.call(this,e,n,a,o,s,l);var h=e==t.Event.ENTER_FRAME;if(h||e==t.Event.RENDER){var c=h?r.$enterFrameCallBackList:r.$renderCallBackList;-1==c.indexOf(this)&&c.push(this)}},r.prototype.removeEventListener=function(e,n,a,o){i.prototype.removeEventListener.call(this,e,n,a,o);var s=e==t.Event.ENTER_FRAME;if((s||e==t.Event.RENDER)&&!this.hasEventListener(e)){var l=s?r.$enterFrameCallBackList:r.$renderCallBackList,h=l.indexOf(this);-1!==h&&l.splice(h,1)}},r.prototype.dispatchEvent=function(t){if(!t.$bubbles)return i.prototype.dispatchEvent.call(this,t);var e=this.$getPropagationList(this),r=.5*e.length;return t.$setTarget(this),this.$dispatchPropagationEvent(t,e,r),!t.$isDefaultPrevented},r.prototype.$getPropagationList=function(t){for(var e=[];t;)e.push(t),t=t.$parent;var i=e.concat();return i.reverse(),e=i.concat(e)},r.prototype.$dispatchPropagationEvent=function(t,e,i){for(var r=e.length,n=i-1,a=0;r>a;a++){var o=e[a];if(t.$currentTarget=o,n>a?t.$eventPhase=1:a==i||a==n?t.$eventPhase=2:t.$eventPhase=3,o.$notifyListener(t,i>a),t.$isPropagationStopped||t.$isPropagationImmediateStopped)return}},r.prototype.willTrigger=function(t){for(var e=this;e;){if(e.hasEventListener(t))return!0;e=e.$parent}return!1},Object.defineProperty(r.prototype,"tint",{get:function(){return this._tint},set:function(t){this._tint=t,this.$tintRGB=(t>>16)+(65280&t)+((255&t)<<16)},enumerable:!0,configurable:!0}),r.prototype.sortChildren=function(){this.$sortDirty=!1},Object.defineProperty(r.prototype,"zIndex",{get:function(){return this._zIndex},set:function(t){this._zIndex=t,this.parent&&(this.parent.$sortDirty=!0)},enumerable:!0,configurable:!0}),r.defaultTouchEnabled=!1,r.$enterFrameCallBackList=[],r.$renderCallBackList=[],r}(t.EventDispatcher);t.DisplayObject=i,__reflect(i.prototype,"egret.DisplayObject")}(egret||(egret={}));var egret;!function(t){t.$TextureScaleFactor=1;var e=function(e){function i(){var t=e.call(this)||this;return t.disposeBitmapData=!0,t.$bitmapX=0,t.$bitmapY=0,t.$bitmapWidth=0,t.$bitmapHeight=0,t.$offsetX=0,t.$offsetY=0,t.$textureWidth=0,t.$textureHeight=0,t.$sourceWidth=0,t.$sourceHeight=0,t.$bitmapData=null,t.$ktxData=null,t.$rotated=!1,t}return __extends(i,e),Object.defineProperty(i.prototype,"textureWidth",{get:function(){return this.$getTextureWidth()},enumerable:!0,configurable:!0}),i.prototype.$getTextureWidth=function(){return this.$textureWidth},Object.defineProperty(i.prototype,"textureHeight",{get:function(){return this.$getTextureHeight()},enumerable:!0,configurable:!0}),i.prototype.$getTextureHeight=function(){return this.$textureHeight},i.prototype.$getScaleBitmapWidth=function(){return this.$bitmapWidth*t.$TextureScaleFactor},i.prototype.$getScaleBitmapHeight=function(){return this.$bitmapHeight*t.$TextureScaleFactor},Object.defineProperty(i.prototype,"bitmapData",{get:function(){return this.$bitmapData},set:function(t){this.$ktxData=null,this._setBitmapData(t)},enumerable:!0,configurable:!0}),i.prototype._setBitmapData=function(e){this.$bitmapData=e;var i=t.$TextureScaleFactor,r=e.width*i,n=e.height*i;this.$initData(0,0,r,n,0,0,r,n,e.width,e.height)},Object.defineProperty(i.prototype,"ktxData",{get:function(){return this.$ktxData},set:function(t){this._setKtxData(t)},enumerable:!0,configurable:!0}),i.prototype._setKtxData=function(e){if(!e)return void t.error("ktx data is null");if(e!=this.$ktxData){var i=new t.KTXContainer(e,1);if(i.isInvalid)return void t.error("ktx data is invalid");this.$ktxData=e;var r=new t.BitmapData(e);r.format="ktx",i.uploadLevels(r,!1),this._setBitmapData(r)}},i.prototype.$initData=function(e,i,r,n,a,o,s,l,h,c,u){void 0===u&&(u=!1);var p=t.$TextureScaleFactor;this.$bitmapX=e/p,this.$bitmapY=i/p,this.$bitmapWidth=r/p,this.$bitmapHeight=n/p,this.$offsetX=a,this.$offsetY=o,this.$textureWidth=s,this.$textureHeight=l,this.$sourceWidth=h,this.$sourceHeight=c,this.$rotated=u,t.BitmapData.$invalidate(this.$bitmapData)},i.prototype.getPixel32=function(t,e){throw new Error},i.prototype.getPixels=function(t,e,i,r){throw void 0===i&&(i=1),void 0===r&&(r=1),new Error},i.prototype.toDataURL=function(t,e,i){throw new Error},i.prototype.saveToFile=function(t,e,i){throw new Error},i.prototype.dispose=function(){this.$bitmapData&&(this.disposeBitmapData&&this.$bitmapData.$dispose(),this.$bitmapData=null)},i}(t.HashObject);t.Texture=e,__reflect(e.prototype,"egret.Texture")}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(e,i,r,n){var a=t.call(this)||this;return a.$eventPhase=2,a.$currentTarget=null,a.$target=null,a.$isDefaultPrevented=!1,a.$isPropagationStopped=!1,a.$isPropagationImmediateStopped=!1,a.$type=e,a.$bubbles=!!i,a.$cancelable=!!r,a.data=n,a}return __extends(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this.$type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bubbles",{get:function(){return this.$bubbles},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cancelable",{get:function(){return this.$cancelable},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"eventPhase",{get:function(){return this.$eventPhase},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentTarget",{get:function(){return this.$currentTarget},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"target",{get:function(){return this.$target},enumerable:!0,configurable:!0}),e.prototype.$setTarget=function(t){return this.$target=t,!0},e.prototype.isDefaultPrevented=function(){return this.$isDefaultPrevented},e.prototype.preventDefault=function(){this.$cancelable&&(this.$isDefaultPrevented=!0)},e.prototype.stopPropagation=function(){this.$bubbles&&(this.$isPropagationStopped=!0)},e.prototype.stopImmediatePropagation=function(){this.$bubbles&&(this.$isPropagationImmediateStopped=!0)},e.prototype.clean=function(){this.data=this.$currentTarget=null,this.$setTarget(null)},e.dispatchEvent=function(t,i,r,n){void 0===r&&(r=!1);var a=e.create(e,i,r),o=e._getPropertyData(e);void 0!=n&&(o.data=n);var s=t.dispatchEvent(a);return e.release(a),s},e._getPropertyData=function(t){var e=t._props;return e||(e=t._props={}),e},e.create=function(t,e,i,r){var n,a=t.hasOwnProperty("eventPool");if(a&&(n=t.eventPool),n||(n=t.eventPool=[]),n.length){var o=n.pop();return o.$type=e,o.$bubbles=!!i,o.$cancelable=!!r,o.$isDefaultPrevented=!1,o.$isPropagationStopped=!1,o.$isPropagationImmediateStopped=!1,o.$eventPhase=2,o}return new t(e,i,r)},e.release=function(t){t.clean();var e=Object.getPrototypeOf(t).constructor;e.eventPool.push(t)},e.ADDED_TO_STAGE="addedToStage",e.REMOVED_FROM_STAGE="removedFromStage",e.ADDED="added",e.REMOVED="removed",e.ENTER_FRAME="enterFrame",e.RENDER="render",e.RESIZE="resize",e.CHANGE="change",e.CHANGING="changing",e.COMPLETE="complete",e.LOOP_COMPLETE="loopComplete",e.FOCUS_IN="focusIn",e.FOCUS_OUT="focusOut",e.ENDED="ended",e.ACTIVATE="activate",e.DEACTIVATE="deactivate",e.CLOSE="close",e.CONNECT="connect",e.LEAVE_STAGE="leaveStage",e.SOUND_COMPLETE="soundComplete",e}(t.HashObject);t.Event=e,__reflect(e.prototype,"egret.Event")}(egret||(egret={}));var egret;!function(t){function e(){return""}function i(t){throw new Error("#"+t)}function r(){}function n(){}t.getString=e,t.$error=i,t.$warn=r,t.$markCannotUse=n}(egret||(egret={}));var egret;!function(t){var e=[],i=Math.PI/180,r=function(r){function n(t,e){void 0===t&&(t=0),void 0===e&&(e=0);var i=r.call(this)||this;return i.x=t,i.y=e,i}return __extends(n,r),n.release=function(t){t&&e.push(t)},n.create=function(t,i){var r=e.pop();return r||(r=new n),r.setTo(t,i)},Object.defineProperty(n.prototype,"length",{get:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},enumerable:!0,configurable:!0}),n.prototype.setTo=function(t,e){return this.x=t,this.y=e,this},n.prototype.clone=function(){return new n(this.x,this.y)},n.prototype.equals=function(t){return this.x==t.x&&this.y==t.y},n.distance=function(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))},n.prototype.copyFrom=function(t){this.x=t.x,this.y=t.y},n.prototype.add=function(t){return new n(this.x+t.x,this.y+t.y)},n.interpolate=function(t,e,i){var r=1-i;return new n(t.x*i+e.x*r,t.y*i+e.y*r)},n.prototype.normalize=function(t){if(0!=this.x||0!=this.y){var e=t/this.length;this.x*=e,this.y*=e}},n.prototype.offset=function(t,e){this.x+=t,this.y+=e},n.polar=function(e,r){return new n(e*t.NumberUtils.cos(r/i),e*t.NumberUtils.sin(r/i))},n.prototype.subtract=function(t){return new n(this.x-t.x,this.y-t.y)},n.prototype.toString=function(){return"(x="+this.x+", y="+this.y+")"},n}(t.HashObject);t.Point=r,__reflect(r.prototype,"egret.Point"),t.$TempPoint=new r}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(){var t=e.call(this)||this;
return t.$touchChildren=!0,t.$children=[],t}return __extends(i,e),Object.defineProperty(i.prototype,"numChildren",{get:function(){return this.$children.length},enumerable:!0,configurable:!0}),i.prototype.setChildrenSortMode=function(e){t.nativeRender&&this.$nativeDisplayObject.setChildrenSortMode&&this.$nativeDisplayObject.setChildrenSortMode(e)},i.prototype.addChild=function(t){var e=this.$children.length;return t.$parent==this&&e--,this.$doAddChild(t,e)},i.prototype.addChildAt=function(t,e){return e=0|+e,(0>e||e>=this.$children.length)&&(e=this.$children.length,t.$parent==this&&e--),this.$doAddChild(t,e)},i.prototype.$doAddChild=function(e,r,n){void 0===n&&(n=!0);var a=this,o=e.$parent;if(r=this.getHashIndex(e,r),o==a)return a.doSetChildIndex(e,r),e;o&&o.removeChild(e),a.$children.splice(r,0,e),e.$setParent(a),t.nativeRender&&a.$nativeDisplayObject.addChildAt(e.$nativeDisplayObject.id,r);var s=a.$stage;if(s&&e.$onAddToStage(s,a.$nestLevel+1),n&&e.dispatchEventWith(t.Event.ADDED,!0),s)for(var l=i.$EVENT_ADD_TO_STAGE_LIST;l.length;){var h=l.shift();h.$stage&&n&&h.dispatchEventWith(t.Event.ADDED_TO_STAGE)}if(!t.nativeRender&&(e.$maskedObject&&e.$maskedObject.$updateRenderMode(),!a.$cacheDirty)){a.$cacheDirty=!0;var c=a.$parent;c&&!c.$cacheDirty&&(c.$cacheDirty=!0,c.$cacheDirtyUp());var u=a.$maskedObject;u&&!u.$cacheDirty&&(u.$cacheDirty=!0,u.$cacheDirtyUp())}return this.$childAdded(e,r),e},i.prototype.contains=function(t){for(;t;){if(t==this)return!0;t=t.$parent}return!1},i.prototype.getChildAt=function(t){return t=0|+t,t>=0&&t<this.$children.length?this.$children[t]:null},i.prototype.getChildIndex=function(t){return this.$children.indexOf(t)},i.prototype.getChildByName=function(t){for(var e,i=this.$children,r=i.length,n=0;r>n;n++)if(e=i[n],e.name==t)return e;return null},i.prototype.removeChild=function(t){var e=this.$children.indexOf(t);return e>=0?this.$doRemoveChild(e):null},i.prototype.removeChildAt=function(t){return t=0|+t,t>=0&&t<this.$children.length?this.$doRemoveChild(t):null},i.prototype.$doRemoveChild=function(e,r){void 0===r&&(r=!0),e=0|+e;var n=this,a=this.$children,o=a[e];if(this.removeHash(o),this.$childRemoved(o,e),r&&o.dispatchEventWith(t.Event.REMOVED,!0),this.$stage){o.$onRemoveFromStage();for(var s=i.$EVENT_REMOVE_FROM_STAGE_LIST;s.length>0;){var l=s.shift();r&&l.$hasAddToStage&&(l.$hasAddToStage=!1,l.dispatchEventWith(t.Event.REMOVED_FROM_STAGE)),l.$hasAddToStage=!1,l.$stage=null}}this.$displayList||this.$parentDisplayList,o.$setParent(null);var h=a.indexOf(o);if(-1!=h&&a.splice(h,1),t.nativeRender)n.$nativeDisplayObject.removeChild(o.$nativeDisplayObject.id);else if(o.$maskedObject&&o.$maskedObject.$updateRenderMode(),!n.$cacheDirty){n.$cacheDirty=!0;var c=n.$parent;c&&!c.$cacheDirty&&(c.$cacheDirty=!0,c.$cacheDirtyUp());var u=n.$maskedObject;u&&!u.$cacheDirty&&(u.$cacheDirty=!0,u.$cacheDirtyUp())}return o},i.prototype.setChildIndex=function(t,e){e=0|+e,(0>e||e>=this.$children.length)&&(e=this.$children.length-1),this.doSetChildIndex(t,e)},i.prototype.doSetChildIndex=function(e,i){var r=this,n=this.$children.indexOf(e);if(n!=i)if(this.$childRemoved(e,n),this.$children.splice(n,1),this.$children.splice(i,0,e),this.$childAdded(e,i),t.nativeRender)this.$nativeDisplayObject.removeChild(e.$nativeDisplayObject.id),this.$nativeDisplayObject.addChildAt(e.$nativeDisplayObject.id,i);else if(!r.$cacheDirty){r.$cacheDirty=!0;var a=r.$parent;a&&!a.$cacheDirty&&(a.$cacheDirty=!0,a.$cacheDirtyUp());var o=r.$maskedObject;o&&!o.$cacheDirty&&(o.$cacheDirty=!0,o.$cacheDirtyUp())}},i.prototype.swapChildrenAt=function(t,e){t=0|+t,e=0|+e,t>=0&&t<this.$children.length&&e>=0&&e<this.$children.length&&this.doSwapChildrenAt(t,e)},i.prototype.swapChildren=function(t,e){var i=this.$children.indexOf(t),r=this.$children.indexOf(e);-1==i||-1==r||this.doSwapChildrenAt(i,r)},i.prototype.doSwapChildrenAt=function(e,i){var r=this;if(e>i){var n=i;i=e,e=n}else if(e==i)return;var a=this.$children,o=a[e],s=a[i];if(this.$childRemoved(o,e),this.$childRemoved(s,i),a[e]=s,a[i]=o,this.$childAdded(s,e),this.$childAdded(o,i),t.nativeRender)this.$nativeDisplayObject.swapChild(e,i);else if(!r.$cacheDirty){r.$cacheDirty=!0;var l=r.$parent;l&&!l.$cacheDirty&&(l.$cacheDirty=!0,l.$cacheDirtyUp());var h=r.$maskedObject;h&&!h.$cacheDirty&&(h.$cacheDirty=!0,h.$cacheDirtyUp())}},i.prototype.removeChildren=function(){for(var t=this.$children,e=t.length-1;e>=0;e--)this.$doRemoveChild(e)},i.prototype.$childAdded=function(t,e){},i.prototype.$childRemoved=function(t,e){},i.prototype.$onAddToStage=function(t,i){e.prototype.$onAddToStage.call(this,t,i);var r=this.$children,n=r.length;i++;for(var a=0;n>a;a++){var o=this.$children[a];o.$onAddToStage(t,i),o.$maskedObject&&o.$maskedObject.$updateRenderMode()}},i.prototype.$onRemoveFromStage=function(){e.prototype.$onRemoveFromStage.call(this);for(var t=this.$children,i=t.length,r=0;i>r;r++){var n=t[r];n.$onRemoveFromStage()}},i.prototype.$measureChildBounds=function(e){var i=this.$children,r=i.length;if(0!=r){for(var n=0,a=0,o=0,s=0,l=!1,h=-1;r>h;h++){var c=void 0;-1==h?c=e:(i[h].getBounds(t.$TempRectangle),i[h].$getMatrix().$transformBounds(t.$TempRectangle),c=t.$TempRectangle),c.isEmpty()||(l?(n=Math.min(n,c.x),a=Math.max(a,c.x+c.width),o=Math.min(o,c.y),s=Math.max(s,c.y+c.height)):(l=!0,n=c.x,a=n+c.width,o=c.y,s=o+c.height))}e.setTo(n,o,a-n,s-o)}},Object.defineProperty(i.prototype,"touchChildren",{get:function(){return this.$getTouchChildren()},set:function(t){this.$setTouchChildren(!!t)},enumerable:!0,configurable:!0}),i.prototype.$getTouchChildren=function(){return this.$touchChildren},i.prototype.$setTouchChildren=function(t){return this.$touchChildren==t?!1:(this.$touchChildren=t,!0)},i.prototype.$hitTest=function(t,i){if(!this.$visible)return null;var r=this.$getInvertedConcatenatedMatrix(),n=r.a*t+r.c*i+r.tx,a=r.b*t+r.d*i+r.ty,o=this.$scrollRect?this.$scrollRect:this.$maskRect;if(o&&!o.contains(n,a))return null;if(this.$mask&&!this.$mask.$hitTest(t,i))return null;for(var s=this.$children,l=!1,h=null,c=s.length-1;c>=0;c--){var u=s[c];if(!u.$maskedObject&&(h=u.$hitTest(t,i))){if(l=!0,h.$touchEnabled)break;h=null}}return h?this.$touchChildren?h:this:l?this:e.prototype.$hitTest.call(this,t,i)},i.prototype._sortChildrenFunc=function(t,e){return t.zIndex===e.zIndex?t.$lastSortedIndex-e.$lastSortedIndex:t.zIndex-e.zIndex},i.prototype.sortChildren=function(){e.prototype.sortChildren.call(this),this.$sortDirty=!1;for(var t=!1,i=this.$children,r=null,n=0,a=i.length;a>n;++n)r=i[n],r.$lastSortedIndex=n,t||0===r.zIndex||(t=!0);t&&i.length>1&&i.sort(this._sortChildrenFunc)},i.prototype.getHashIndex=function(e,i){if(window.Benchmark&&window.Benchmark.optimizeDc&&e instanceof t.Bitmap&&e.$bitmapData)if(!this.hashMap&&(this.hashMap={}),this.hashMap[e.$bitmapData.hashCode]){var r=this.hashMap[e.$bitmapData.hashCode];r.len++,r.hashs.push(e.hashCode);var n=r.index+r.len-1;i!=n&&(console.warn("warning texture name:   "+e.name),i=n)}else this.hashMap[e.$bitmapData.hashCode]={hashs:[e.hashCode],index:i,len:1};return i},i.prototype.removeHash=function(e){if(window.Benchmark&&window.Benchmark.optimizeDc&&e instanceof t.Bitmap&&e.$bitmapData&&this.hashMap){var i=this.hashMap[e.$bitmapData.hashCode];if(i&&i.hashs){var r=i.hashs.indexOf(e.hashCode);i&&-1!=r&&(i.hashs.splice(r,1),i.len--,0==i.len&&(i=null,delete this.hashMap[e.$bitmapData.hashCode]))}}},i.$EVENT_ADD_TO_STAGE_LIST=[],i.$EVENT_REMOVE_FROM_STAGE_LIST=[],i}(t.DisplayObject);t.DisplayObjectContainer=e,__reflect(e.prototype,"egret.DisplayObjectContainer")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(i){var r=e.call(this)||this;return r._bitmapX=0,r._bitmapY=0,r._textureMap=t.createMap(),r.$texture=i,r._bitmapX=i.$bitmapX-i.$offsetX,r._bitmapY=i.$bitmapY-i.$offsetY,r}return __extends(i,e),i.prototype.getTexture=function(t){return this._textureMap[t]},i.prototype.createTexture=function(e,i,r,n,a,o,s,l,h){void 0===o&&(o=0),void 0===s&&(s=0),void 0===l&&(l=o+n),void 0===h&&(h=s+a);var c=new t.Texture;return c.disposeBitmapData=!1,c.$bitmapData=this.$texture.$bitmapData,c.$initData(this._bitmapX+i,this._bitmapY+r,n,a,o,s,l,h,this.$texture.$sourceWidth,this.$texture.$sourceHeight),window.Benchmark&&window.Benchmark.optimizeDc&&(c.name=e),this._textureMap[e]=c,c},i.prototype.dispose=function(){this.$texture&&this.$texture.dispose()},i}(t.HashObject);t.SpriteSheet=e,__reflect(e.prototype,"egret.SpriteSheet")}(egret||(egret={}));var egret;!function(t){t.$locale_strings=t.$locale_strings||{},t.$language="en_US"}(egret||(egret={})),function(t){var e;!function(e){function i(e){for(var i=[],r=1;r<arguments.length;r++)i[r-1]=arguments[r];var n=t.$locale_strings[t.$language][e];if(!n)return"{"+e+"}";for(var a=i.length,o=0;a>o;o++)n=n.replace("{"+o+"}",i[o]);return n}e.tr=i}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(r){var n=e.call(this)||this;return n.$texture=null,n.$bitmapData=null,n.$bitmapX=0,n.$bitmapY=0,n.$bitmapWidth=0,n.$bitmapHeight=0,n.$offsetX=0,n.$offsetY=0,n.$textureWidth=0,n.$textureHeight=0,n.$sourceWidth=0,n.$sourceHeight=0,n.$smoothing=i.defaultSmoothing,n.$explicitBitmapWidth=0/0,n.$explicitBitmapHeight=0/0,n.$scale9Grid=null,n.$fillMode="scale",n._pixelHitTest=!1,n.$renderNode=new t.sys.NormalBitmapNode,n.$setTexture(r),r&&(n.$renderNode.rotated=r.$rotated),n}return __extends(i,e),i.prototype.createNativeDisplayObject=function(){this.$nativeDisplayObject=new egret_native.NativeDisplayObject(1)},i.prototype.$onAddToStage=function(i,r){e.prototype.$onAddToStage.call(this,i,r);var n=this.$texture;n&&n.$bitmapData&&t.BitmapData.$addDisplayObject(this,n.$bitmapData)},i.prototype.$onRemoveFromStage=function(){e.prototype.$onRemoveFromStage.call(this);var i=this.$texture;i&&t.BitmapData.$removeDisplayObject(this,i.$bitmapData)},Object.defineProperty(i.prototype,"texture",{get:function(){return this.$texture},set:function(t){var e=this;e.$setTexture(t),t&&e.$renderNode&&(e.$renderNode.rotated=t.$rotated)},enumerable:!0,configurable:!0}),i.prototype.$setTexture=function(e){var i=this,r=i.$texture;if(e==r)return!1;if(e&&e.name&&(i.name=e.name),i.$texture=e,!e){r&&t.BitmapData.$removeDisplayObject(i,r.$bitmapData),i.setImageData(null,0,0,0,0,0,0,0,0,0,0),i.$renderDirty=!0;var n=i.$parent;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp());var a=i.$maskedObject;return a&&!a.$cacheDirty&&(a.$cacheDirty=!0,a.$cacheDirtyUp()),t.nativeRender&&this.setBitmapDataToWasm(null),!0}if(i.$refreshImageData(),i.$stage){if(r&&r.$bitmapData){var o=r.$bitmapData.hashCode,s=e.$bitmapData?e.$bitmapData.hashCode:-1;if(o==s){i.$renderDirty=!0;var l=i.$parent;l&&!l.$cacheDirty&&(l.$cacheDirty=!0,l.$cacheDirtyUp());var h=i.$maskedObject;return h&&!h.$cacheDirty&&(h.$cacheDirty=!0,h.$cacheDirtyUp()),!0}t.BitmapData.$removeDisplayObject(i,r.$bitmapData)}t.BitmapData.$addDisplayObject(i,e.$bitmapData)}i.$renderDirty=!0;var c=i.$parent;c&&!c.$cacheDirty&&(c.$cacheDirty=!0,c.$cacheDirtyUp());var u=i.$maskedObject;return u&&!u.$cacheDirty&&(u.$cacheDirty=!0,u.$cacheDirtyUp()),!0},i.prototype.$setBitmapData=function(t){this.$setTexture(t)},i.prototype.setBitmapDataToWasm=function(t){this.$nativeDisplayObject.setTexture(t)},i.prototype.$refreshImageData=function(){var e=this.$texture;e?(t.nativeRender&&this.setBitmapDataToWasm(e),this.setImageData(e.$bitmapData,e.$bitmapX,e.$bitmapY,e.$bitmapWidth,e.$bitmapHeight,e.$offsetX,e.$offsetY,e.$getTextureWidth(),e.$getTextureHeight(),e.$sourceWidth,e.$sourceHeight)):t.nativeRender&&this.setBitmapDataToWasm(null)},i.prototype.setImageData=function(t,e,i,r,n,a,o,s,l,h,c){this.$bitmapData=t,this.$bitmapX=e,this.$bitmapY=i,this.$bitmapWidth=r,this.$bitmapHeight=n,this.$offsetX=a,this.$offsetY=o,this.$textureWidth=s,this.$textureHeight=l,this.$sourceWidth=h,this.$sourceHeight=c},Object.defineProperty(i.prototype,"scale9Grid",{get:function(){return this.$scale9Grid},set:function(t){this.$setScale9Grid(t)},enumerable:!0,configurable:!0}),i.prototype.$setScale9Grid=function(e){var i=this;if(i.$scale9Grid=e,i.$renderDirty=!0,t.nativeRender)e?i.$nativeDisplayObject.setScale9Grid(e.x,e.y,e.width,e.height):i.$nativeDisplayObject.setScale9Grid(0,0,-1,-1);else{var r=i.$parent;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp());var n=i.$maskedObject;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp())}},Object.defineProperty(i.prototype,"fillMode",{get:function(){return this.$fillMode},set:function(t){this.$setFillMode(t)},enumerable:!0,configurable:!0}),i.prototype.$setFillMode=function(e){var i=this;if(e==i.$fillMode)return!1;if(i.$fillMode=e,t.nativeRender)i.$nativeDisplayObject.setBitmapFillMode(i.$fillMode);else{i.$renderDirty=!0;var r=i.$parent;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp());var n=i.$maskedObject;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp())}return!0},Object.defineProperty(i.prototype,"smoothing",{get:function(){return this.$smoothing},set:function(e){var i=this;if(e!=this.$smoothing&&(this.$smoothing=e,this.$renderNode.smoothing=e,!t.nativeRender)){var r=i.$parent;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp());var n=i.$maskedObject;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp())}},enumerable:!0,configurable:!0}),i.prototype.$setWidth=function(e){var i=this;if(0>e||e==i.$explicitBitmapWidth)return!1;if(i.$explicitBitmapWidth=e,i.$renderDirty=!0,t.nativeRender)i.$nativeDisplayObject.setWidth(e);else{var r=i.$parent;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp());var n=i.$maskedObject;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp())}return!0},i.prototype.$setHeight=function(e){var i=this;if(0>e||e==i.$explicitBitmapHeight)return!1;if(i.$explicitBitmapHeight=e,i.$renderDirty=!0,t.nativeRender)i.$nativeDisplayObject.setHeight(e);else{var r=i.$parent;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp());var n=i.$maskedObject;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp())}return!0},i.prototype.$getWidth=function(){return isNaN(this.$explicitBitmapWidth)?this.$getContentBounds().width:this.$explicitBitmapWidth},i.prototype.$getHeight=function(){return isNaN(this.$explicitBitmapHeight)?this.$getContentBounds().height:this.$explicitBitmapHeight},i.prototype.$measureContentBounds=function(t){if(this.$bitmapData){var e=isNaN(this.$explicitBitmapWidth)?this.$textureWidth:this.$explicitBitmapWidth,i=isNaN(this.$explicitBitmapHeight)?this.$textureHeight:this.$explicitBitmapHeight;t.setTo(0,0,e,i)}else{var e=isNaN(this.$explicitBitmapWidth)?0:this.$explicitBitmapWidth,i=isNaN(this.$explicitBitmapHeight)?0:this.$explicitBitmapHeight;t.setTo(0,0,e,i)}},i.prototype.$updateRenderNode=function(){if(this.$texture){var e=isNaN(this.$explicitBitmapWidth)?this.$textureWidth:this.$explicitBitmapWidth,i=isNaN(this.$explicitBitmapHeight)?this.$textureHeight:this.$explicitBitmapHeight,r=this.scale9Grid||this.$texture.scale9Grid;r?(this.$renderNode instanceof t.sys.NormalBitmapNode&&(this.$renderNode=new t.sys.BitmapNode),t.sys.BitmapNode.$updateTextureDataWithScale9Grid(this.$renderNode,this.$bitmapData,r,this.$bitmapX,this.$bitmapY,this.$bitmapWidth,this.$bitmapHeight,this.$offsetX,this.$offsetY,this.$textureWidth,this.$textureHeight,e,i,this.$sourceWidth,this.$sourceHeight,this.$smoothing)):(this.fillMode==t.BitmapFillMode.REPEAT&&this.$renderNode instanceof t.sys.NormalBitmapNode&&(this.$renderNode=new t.sys.BitmapNode),t.sys.BitmapNode.$updateTextureData(this.$renderNode,this.$bitmapData,this.$bitmapX,this.$bitmapY,this.$bitmapWidth,this.$bitmapHeight,this.$offsetX,this.$offsetY,this.$textureWidth,this.$textureHeight,e,i,this.$sourceWidth,this.$sourceHeight,this.$fillMode,this.$smoothing))}},Object.defineProperty(i.prototype,"pixelHitTest",{get:function(){return this._pixelHitTest},set:function(t){this._pixelHitTest=!!t},enumerable:!0,configurable:!0}),i.prototype.$hitTest=function(t,i){var r=e.prototype.$hitTest.call(this,t,i);if(r&&this._pixelHitTest){var n=this.hitTestPoint(t,i,!0);n||(r=null)}return r},i.defaultSmoothing=!0,i}(t.DisplayObject);t.Bitmap=e,__reflect(e.prototype,"egret.Bitmap")}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(){function t(){this.type=0,this.drawData=[],this.renderCount=0}return t.prototype.cleanBeforeRender=function(){this.drawData.length=0,this.renderCount=0},t.prototype.$getRenderCount=function(){return this.renderCount},t}();t.RenderNode=e,__reflect(e.prototype,"egret.sys.RenderNode")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(){function t(){this.type=0,this.$commands=[],this.$data=[],this.commandPosition=0,this.dataPosition=0,this.$lastX=0,this.$lastY=0}return t.prototype.moveTo=function(t,e){this.$commands[this.commandPosition++]=1;var i=this.dataPosition;this.$data[i++]=t,this.$data[i++]=e,this.dataPosition=i},t.prototype.lineTo=function(t,e){this.$commands[this.commandPosition++]=2;var i=this.dataPosition;this.$data[i++]=t,this.$data[i++]=e,this.dataPosition=i},t.prototype.curveTo=function(t,e,i,r){this.$commands[this.commandPosition++]=3;var n=this.dataPosition;this.$data[n++]=t,this.$data[n++]=e,this.$data[n++]=i,this.$data[n++]=r,this.dataPosition=n},t.prototype.cubicCurveTo=function(t,e,i,r,n,a){this.$commands[this.commandPosition++]=4;var o=this.dataPosition;this.$data[o++]=t,this.$data[o++]=e,this.$data[o++]=i,this.$data[o++]=r,this.$data[o++]=n,this.$data[o++]=a,this.dataPosition=o},t.prototype.drawRect=function(t,e,i,r){var n=t+i,a=e+r;this.moveTo(t,e),this.lineTo(n,e),this.lineTo(n,a),this.lineTo(t,a),this.lineTo(t,e)},t.prototype.drawRoundRect=function(t,e,i,r,n,a){var o=.5*n|0,s=a?.5*a|0:o;if(!o||!s)return void this.drawRect(t,e,i,r);var l=.5*i,h=.5*r;if(o>l&&(o=l),s>h&&(s=h),l===o&&h===s)return void(o===s?this.drawCircle(t+o,e+s,o):this.drawEllipse(t,e,2*o,2*s));var c=t+i,u=e+r,p=t+o,d=c-o,f=e+s,g=u-s;this.moveTo(c,g),this.curveTo(c,u,d,u),this.lineTo(p,u),this.curveTo(t,u,t,g),this.lineTo(t,f),this.curveTo(t,e,p,e),this.lineTo(d,e),this.curveTo(c,e,c,f),this.lineTo(c,g)},t.prototype.drawCircle=function(t,e,i){this.arcToBezier(t,e,i,i,0,2*Math.PI)},t.prototype.drawEllipse=function(t,e,i,r){var n=.5*i,a=.5*r;t+=n,e+=a,this.arcToBezier(t,e,n,a,0,2*Math.PI)},t.prototype.drawArc=function(t,e,i,r,n,a){a?n>=r&&(n-=2*Math.PI):r>=n&&(n+=2*Math.PI),this.arcToBezier(t,e,i,i,r,n,a)},t.prototype.arcToBezier=function(t,e,i,r,n,a,o){var s=.5*Math.PI,l=n,h=l;o?(h+=-s-l%s,a>h&&(h=a)):(h+=s-l%s,h>a&&(h=a));var c=t+Math.cos(l)*i,u=e+Math.sin(l)*r;(this.$lastX!=c||this.$lastY!=u)&&this.moveTo(c,u);for(var p=Math.cos(l),d=Math.sin(l),f=0;4>f;f++){var g=h-l,m=4*Math.tan(g/4)/3,y=c-d*m*i,v=u+p*m*r;p=Math.cos(h),d=Math.sin(h),c=t+p*i,u=e+d*r;var _=c+d*m*i,b=u-p*m*r;if(this.cubicCurveTo(y,v,_,b,c,u),h===a)break;l=h,o?(h=l-s,a>h&&(h=a)):(h=l+s,h>a&&(h=a))}},t}();t.Path2D=e,__reflect(e.prototype,"egret.sys.Path2D")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){t.fontMapping={}}(egret||(egret={}));var egret;!function(t){function e(){var t=Object.create(null);return t.__v8__=void 0,delete t.__v8__,t}t.createMap=e}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(e,i,r,n,a,o,s,l){void 0===e&&(e=16711680),void 0===i&&(i=1),void 0===r&&(r=6),void 0===n&&(n=6),void 0===a&&(a=2),void 0===o&&(o=1),void 0===s&&(s=!1),void 0===l&&(l=!1);var h=t.call(this)||this,c=h;return c.type="glow",c.$color=e,c.$blue=255&e,c.$green=(65280&e)>>8,c.$red=e>>16,c.$alpha=i,c.$blurX=r,c.$blurY=n,c.$strength=a,c.$quality=o,c.$inner=s,c.$knockout=l,c.$uniforms.color={x:h.$red/255,y:h.$green/255,z:h.$blue/255,w:1},c.$uniforms.alpha=i,c.$uniforms.blurX=r,c.$uniforms.blurY=n,c.$uniforms.strength=a,c.$uniforms.inner=s?1:0,c.$uniforms.knockout=l?0:1,c.$uniforms.dist=0,c.$uniforms.angle=0,c.$uniforms.hideObject=0,c.onPropertyChange(),h}return __extends(e,t),Object.defineProperty(e.prototype,"color",{get:function(){return this.$color},set:function(t){this.$color!=t&&(this.$color=t,this.$blue=255&t,this.$green=(65280&t)>>8,this.$red=t>>16,this.$uniforms.color.x=this.$red/255,this.$uniforms.color.y=this.$green/255,this.$uniforms.color.z=this.$blue/255)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this.$alpha},set:function(t){this.$alpha!=t&&(this.$alpha=t,this.$uniforms.alpha=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"blurX",{get:function(){return this.$blurX},set:function(t){var e=this;e.$blurX!=t&&(e.$blurX=t,e.$uniforms.blurX=t,e.onPropertyChange())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"blurY",{get:function(){return this.$blurY},set:function(t){var e=this;e.$blurY!=t&&(e.$blurY=t,e.$uniforms.blurY=t,e.onPropertyChange())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"strength",{get:function(){return this.$strength},set:function(t){this.$strength!=t&&(this.$strength=t,this.$uniforms.strength=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"quality",{get:function(){return this.$quality},set:function(t){this.$quality!=t&&(this.$quality=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inner",{get:function(){return this.$inner},set:function(t){this.$inner!=t&&(this.$inner=t,this.$uniforms.inner=t?1:0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"knockout",{get:function(){return this.$knockout},set:function(t){this.$knockout!=t&&(this.$knockout=t,this.$uniforms.knockout=t?0:1)},enumerable:!0,configurable:!0}),e.prototype.$toJson=function(){return'{"color": '+this.$color+', "red": '+this.$red+', "green": '+this.$green+', "blue": '+this.$blue+', "alpha": '+this.$alpha+', "blurX": '+this.$blurX+', "blurY": '+this.blurY+', "strength": '+this.$strength+', "quality": '+this.$quality+', "inner": '+this.$inner+', "knockout": '+this.$knockout+"}"},e.prototype.updatePadding=function(){var t=this;t.paddingLeft=t.blurX,t.paddingRight=t.blurX,t.paddingTop=t.blurY,t.paddingBottom=t.blurY},e}(t.Filter);t.GlowFilter=e,__reflect(e.prototype,"egret.GlowFilter")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.$stageWidth=0,i.$stageHeight=0,i.$scaleMode=t.StageScaleMode.SHOW_ALL,i.$orientation=t.OrientationMode.AUTO,i.$maxTouches=99,i.$stage=i,i.$nestLevel=1,i}return __extends(i,e),i.prototype.createNativeDisplayObject=function(){this.$nativeDisplayObject=new egret_native.NativeDisplayObject(13)},Object.defineProperty(i.prototype,"frameRate",{get:function(){return t.ticker.$frameRate},set:function(e){t.ticker.$setFrameRate(e)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"stageWidth",{get:function(){return this.$stageWidth},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"stageHeight",{get:function(){return this.$stageHeight},enumerable:!0,configurable:!0}),i.prototype.invalidate=function(){t.sys.$invalidateRenderFlag=!0},i.prototype.registerImplementation=function(e,i){t.registerImplementation(e,i)},i.prototype.getImplementation=function(e){return t.getImplementation(e)},Object.defineProperty(i.prototype,"scaleMode",{get:function(){return this.$scaleMode},set:function(t){this.$scaleMode!=t&&(this.$scaleMode=t,this.$screen.updateScreenSize())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"orientation",{get:function(){return this.$orientation},set:function(t){this.$orientation!=t&&(this.$orientation=t,this.$screen.updateScreenSize())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"textureScaleFactor",{get:function(){return t.$TextureScaleFactor},set:function(e){t.$TextureScaleFactor=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"maxTouches",{get:function(){return this.$maxTouches},set:function(t){this.$maxTouches!=t&&(this.$maxTouches=t,this.$screen.updateMaxTouches())},enumerable:!0,configurable:!0}),i.prototype.setContentSize=function(t,e){this.$screen.setContentSize(t,e)},i}(t.DisplayObjectContainer);t.Stage=e,__reflect(e.prototype,"egret.Stage")}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.NORMAL="normal",t.ADD="add",t.ERASE="erase",t}();t.BlendMode=e,__reflect(e.prototype,"egret.BlendMode")}(egret||(egret={})),function(t){var e;!function(t){function e(t){var e=n[t];return void 0===e?0:e}function i(t){var e=r[t];return void 0===e?"normal":e}for(var r=["normal","add","erase"],n={},a=r.length,o=0;a>o;o++){var s=r[o];n[s]=o}t.blendModeToNumber=e,t.numberToBlendMode=i}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){t.ChildrenSortMode={DEFAULT:"default",INCREASE_Y:"increaseY",DECREASE_Y:"decreaseY"}}(egret||(egret={}));var egret;!function(t){t.CapsStyle={NONE:"none",ROUND:"round",SQUARE:"square"}}(egret||(egret={}));var egret;!function(t){var e=function(){function e(){}return e.compileProgram=function(i,r,n){var a=e.compileFragmentShader(i,n),o=e.compileVertexShader(i,r),s=i.createProgram();return i.attachShader(s,o),i.attachShader(s,a),i.linkProgram(s),i.getProgramParameter(s,i.LINK_STATUS)||t.$warn(1020),s},e.compileFragmentShader=function(t,i){return e._compileShader(t,i,t.FRAGMENT_SHADER)},e.compileVertexShader=function(t,i){return e._compileShader(t,i,t.VERTEX_SHADER)},e._compileShader=function(t,e,i){var r=t.createShader(i);return t.shaderSource(r,e),t.compileShader(r),t.getShaderParameter(r,t.COMPILE_STATUS)?r:null},e.checkCanUseWebGL=function(){if(void 0==e.canUseWebGL)try{var t=document.createElement("canvas");e.canUseWebGL=!(!window.WebGLRenderingContext||!t.getContext("webgl")&&!t.getContext("experimental-webgl"))}catch(i){e.canUseWebGL=!1}return e.canUseWebGL},e.deleteWebGLTexture=function(e){if(e&&!e[t.engine_default_empty_texture]){var i=e[t.glContext];i&&i.deleteTexture(e)}},e.premultiplyTint=function(t,e){if(1===e)return(255*e<<24)+t;if(0===e)return 0;var i=t>>16&255,r=t>>8&255,n=255&t;return i=i*e+.5|0,r=r*e+.5|0,n=n*e+.5|0,(255*e<<24)+(i<<16)+(r<<8)+n},e}();t.WebGLUtils=e,__reflect(e.prototype,"egret.WebGLUtils")}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(e,i,r){return void 0===i&&(i=!1),void 0===r&&(r=!1),t.call(this,e,i,r)||this}return __extends(e,t),e.FOCUS_IN="focusIn",e.FOCUS_OUT="focusOut",e}(t.Event);t.FocusEvent=e,__reflect(e.prototype,"egret.FocusEvent")}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.PERMISSION_DENIED="permissionDenied",e.UNAVAILABLE="unavailable",e}(t.Event);t.GeolocationEvent=e,__reflect(e.prototype,"egret.GeolocationEvent")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(t,i,r){void 0===i&&(i=!1),void 0===r&&(r=!1);var n=e.call(this,t,i,r)||this;return n._status=0,n}return __extends(i,e),Object.defineProperty(i.prototype,"status",{get:function(){return this._status},enumerable:!0,configurable:!0}),i.dispatchHTTPStatusEvent=function(e,r){var n=t.Event.create(i,i.HTTP_STATUS);n._status=r;var a=e.dispatchEvent(n);return t.Event.release(n),a},i.HTTP_STATUS="httpStatus",i}(t.Event);t.HTTPStatusEvent=e,__reflect(e.prototype,"egret.HTTPStatusEvent")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(t,i,r){return void 0===i&&(i=!1),void 0===r&&(r=!1),e.call(this,t,i,r)||this}return __extends(i,e),i.dispatchIOErrorEvent=function(e){var r=t.Event.create(i,i.IO_ERROR),n=e.dispatchEvent(r);return t.Event.release(r),n},i.IO_ERROR="ioError",i}(t.Event);t.IOErrorEvent=e,__reflect(e.prototype,"egret.IOErrorEvent")}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.Event);t.MotionEvent=e,__reflect(e.prototype,"egret.MotionEvent")}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.Event);t.OrientationEvent=e,__reflect(e.prototype,"egret.OrientationEvent")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(t,i,r,n,a){void 0===i&&(i=!1),void 0===r&&(r=!1),void 0===n&&(n=0),void 0===a&&(a=0);var o=e.call(this,t,i,r)||this;return o.bytesLoaded=0,o.bytesTotal=0,o.bytesLoaded=n,o.bytesTotal=a,o}return __extends(i,e),i.dispatchProgressEvent=function(e,r,n,a){void 0===n&&(n=0),void 0===a&&(a=0);var o=t.Event.create(i,r);o.bytesLoaded=n,o.bytesTotal=a;var s=e.dispatchEvent(o);return t.Event.release(o),s},i.PROGRESS="progress",i.SOCKET_DATA="socketData",i}(t.Event);t.ProgressEvent=e,__reflect(e.prototype,"egret.ProgressEvent")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(t,i,r){return void 0===i&&(i=!1),void 0===r&&(r=!1),e.call(this,t,i,r)||this}return __extends(i,e),i.dispatchStageOrientationEvent=function(e,r){var n=t.Event.create(i,r),a=e.dispatchEvent(n);return t.Event.release(n),a},i.ORIENTATION_CHANGE="orientationChange",i}(t.Event);t.StageOrientationEvent=e,__reflect(e.prototype,"egret.StageOrientationEvent")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(t,i,r,n){void 0===i&&(i=!1),void 0===r&&(r=!1),void 0===n&&(n="");var a=e.call(this,t,i,r)||this;return a.text=n,a}return __extends(i,e),i.dispatchTextEvent=function(e,r,n){var a=t.Event.create(i,r);a.text=n;var o=e.dispatchEvent(a);return t.Event.release(a),o},i.LINK="link",i}(t.Event);t.TextEvent=e,__reflect(e.prototype,"egret.TextEvent")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(t,i,r){return e.call(this,t,i,r)||this}return __extends(i,e),i.prototype.updateAfterEvent=function(){t.sys.$requestRenderingFlag=!0},i.dispatchTimerEvent=function(e,r,n,a){var o=t.Event.create(i,r,n,a),s=e.dispatchEvent(o);return t.Event.release(o),s},i.TIMER="timer",i.TIMER_COMPLETE="timerComplete",i}(t.Event);t.TimerEvent=e,__reflect(e.prototype,"egret.TimerEvent")}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t}();t.CompressedTextureData=e,__reflect(e.prototype,"egret.CompressedTextureData"),t.etc_alpha_mask="etc_alpha_mask",t.engine_default_empty_texture="engine_default_empty_texture",t.is_compressed_texture="is_compressed_texture",t.glContext="glContext",t.UNPACK_PREMULTIPLY_ALPHA_WEBGL="UNPACK_PREMULTIPLY_ALPHA_WEBGL";var i=function(e){function i(i){var r=e.call(this)||this;if(r.format="image",r.$deleteSource=!0,r.compressedTextureData=[],r.debugCompressedTextureURL="",r.etcAlphaMask=null,t.nativeRender){var n=new egret_native.NativeBitmapData;n.$init(),r.$nativeBitmapData=n}return r.source=i,r.source=i,r.source&&(r.width=+i.width,r.height=+i.height),r}return __extends(i,e),Object.defineProperty(i.prototype,"source",{get:function(){return this.$source},set:function(e){this.$source=e,t.nativeRender&&egret_native.NativeDisplayObject.setSourceToNativeBitmapData(this.$nativeBitmapData,e)},enumerable:!0,configurable:!0}),i.create=function(e,r,n){var a="";a="arraybuffer"===e?t.Base64Util.encode(r):r;var o="image/png";"/"===a.charAt(0)?o="image/jpeg":"R"===a.charAt(0)?o="image/gif":"i"===a.charAt(0)&&(o="image/png");var s=new Image;s.src="data:"+o+";base64,"+a,s.crossOrigin="*";var l=new i(s);return s.onload=function(){s.onload=void 0,l.source=s,l.height=s.height,l.width=s.width,n&&n(l)},l},i.prototype.$dispose=function(){"webgl"==t.Capabilities.renderMode&&this.webGLTexture&&(t.WebGLUtils.deleteWebGLTexture(this.webGLTexture),this.webGLTexture=null),this.source&&this.source.dispose&&this.source.dispose(),this.source&&this.source.src&&(this.source.src=""),this.source=null,this.clearCompressedTextureData(),this.debugCompressedTextureURL="",this.etcAlphaMask=null,t.nativeRender&&egret_native.NativeDisplayObject.disposeNativeBitmapData(this.$nativeBitmapData),i.$dispose(this)},i.$addDisplayObject=function(t,e){if(e){var r=e.hashCode;if(r){if(!i._displayList[r])return void(i._displayList[r]=[t]);var n=i._displayList[r];n.indexOf(t)<0&&n.push(t)}}},i.$removeDisplayObject=function(t,e){if(e){var r=e.hashCode;if(r&&i._displayList[r]){var n=i._displayList[r],a=n.indexOf(t);
a>=0&&n.splice(a,1)}}},i.$invalidate=function(e){if(e){var r=e.hashCode;if(r&&i._displayList[r])for(var n=i._displayList[r],a=0;a<n.length;a++){n[a]instanceof t.Bitmap&&n[a].$refreshImageData();var o=n[a];o.$renderDirty=!0;var s=o.$parent;s&&!s.$cacheDirty&&(s.$cacheDirty=!0,s.$cacheDirtyUp());var l=o.$maskedObject;l&&!l.$cacheDirty&&(l.$cacheDirty=!0,l.$cacheDirtyUp())}}},i.$dispose=function(e){if(e){var r=e.hashCode;if(r&&i._displayList[r]){for(var n=i._displayList[r],a=0,o=n;a<o.length;a++){var s=o[a];s instanceof t.Bitmap&&(s.$bitmapData=null),s.$renderDirty=!0;var l=s.$parent;l&&!l.$cacheDirty&&(l.$cacheDirty=!0,l.$cacheDirtyUp());var h=s.$maskedObject;h&&!h.$cacheDirty&&(h.$cacheDirty=!0,h.$cacheDirtyUp())}delete i._displayList[r]}}},i.prototype._getCompressedTextureData=function(t,e){var i=this.compressedTextureData[t];return i?i[e]:null},i.prototype.getCompressed2dTextureData=function(){return this._getCompressedTextureData(0,0)},i.prototype.hasCompressed2d=function(){return!!this.getCompressed2dTextureData()},i.prototype.clearCompressedTextureData=function(){this.compressedTextureData.length=0},i._displayList=t.createMap(),i}(t.HashObject);t.BitmapData=i,__reflect(i.prototype,"egret.BitmapData")}(egret||(egret={}));var egret;!function(t){var e=new t.Point,i=function(i){function r(t,e,r,n,a,o){var s=i.call(this,t,e,r)||this;return s.targetChanged=!0,s.touchDown=!1,s.$initTo(n,a,o),s}return __extends(r,i),r.prototype.$initTo=function(t,e,i){this.touchPointID=+i||0,this.$stageX=+t||0,this.$stageY=+e||0},Object.defineProperty(r.prototype,"stageX",{get:function(){return this.$stageX},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"stageY",{get:function(){return this.$stageY},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"localX",{get:function(){return this.targetChanged&&this.getLocalXY(),this._localX},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"localY",{get:function(){return this.targetChanged&&this.getLocalXY(),this._localY},enumerable:!0,configurable:!0}),r.prototype.getLocalXY=function(){this.targetChanged=!1;var t=this.$target.$getInvertedConcatenatedMatrix();t.transformPoint(this.$stageX,this.$stageY,e),this._localX=e.x,this._localY=e.y},r.prototype.$setTarget=function(t){return this.$target=t,this.targetChanged=!!t,!0},r.prototype.updateAfterEvent=function(){t.sys.$requestRenderingFlag=!0},r.dispatchTouchEvent=function(e,i,n,a,o,s,l,h){if(void 0===h&&(h=!1),!n&&!e.hasEventListener(i))return!0;var c=t.Event.create(r,i,n,a);c.$initTo(o,s,l),c.touchDown=h;var u=e.dispatchEvent(c);return t.Event.release(c),u},r.TOUCH_MOVE="touchMove",r.TOUCH_BEGIN="touchBegin",r.TOUCH_END="touchEnd",r.TOUCH_CANCEL="touchCancel",r.TOUCH_TAP="touchTap",r.TOUCH_RELEASE_OUTSIDE="touchReleaseOutside",r}(t.Event);t.TouchEvent=i,__reflect(i.prototype,"egret.TouchEvent")}(egret||(egret={}));var egret;!function(t){}(egret||(egret={}));var egret;!function(t){var e=function(e){function n(t,n,a){void 0===t&&(t=4),void 0===n&&(n=4),void 0===a&&(a=1);var o=e.call(this)||this,s=o;return s.type="blur",s.$blurX=t,s.$blurY=n,s.$quality=a,s.blurXFilter=new i(t),s.blurYFilter=new r(n),s.onPropertyChange(),o}return __extends(n,e),Object.defineProperty(n.prototype,"blurX",{get:function(){return this.$blurX},set:function(t){var e=this;e.$blurX!=t&&(e.$blurX=t,e.blurXFilter.blurX=t,e.onPropertyChange())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"blurY",{get:function(){return this.$blurY},set:function(t){var e=this;e.$blurY!=t&&(e.$blurY=t,e.blurYFilter.blurY=t,e.onPropertyChange())},enumerable:!0,configurable:!0}),n.prototype.$toJson=function(){return'{"blurX": '+this.$blurX+', "blurY": '+this.$blurY+', "quality": 1}'},n.prototype.updatePadding=function(){var t=this;t.paddingLeft=t.blurX,t.paddingRight=t.blurX,t.paddingTop=t.blurY,t.paddingBottom=t.blurY},n.prototype.onPropertyChange=function(){var e=this;e.updatePadding(),t.nativeRender&&(egret_native.NativeDisplayObject.setFilterPadding(e.blurXFilter.$id,0,0,e.paddingLeft,e.paddingRight),egret_native.NativeDisplayObject.setFilterPadding(e.blurYFilter.$id,e.paddingTop,e.paddingBottom,0,0),egret_native.NativeDisplayObject.setDataToFilter(e))},n}(t.Filter);t.BlurFilter=e,__reflect(e.prototype,"egret.BlurFilter");var i=function(e){function i(i){void 0===i&&(i=4);var r=e.call(this)||this;return t.nativeRender?r.type="blur":r.type="blurX",r.$uniforms.blur={x:i,y:0},r.onPropertyChange(),r}return __extends(i,e),Object.defineProperty(i.prototype,"blurX",{get:function(){return this.$uniforms.blur.x},set:function(t){this.$uniforms.blur.x=t},enumerable:!0,configurable:!0}),i}(t.Filter);__reflect(i.prototype,"BlurXFilter",["egret.IBlurXFilter"]);var r=function(e){function i(i){void 0===i&&(i=4);var r=e.call(this)||this;return t.nativeRender?r.type="blur":r.type="blurY",r.$uniforms.blur={x:0,y:i},r.onPropertyChange(),r}return __extends(i,e),Object.defineProperty(i.prototype,"blurY",{get:function(){return this.$uniforms.blur.y},set:function(t){this.$uniforms.blur.y=t},enumerable:!0,configurable:!0}),i}(t.Filter);__reflect(r.prototype,"BlurYFilter",["egret.IBlurYFilter"])}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this)||this;return i.$matrix=[],i.matrix2=[],i.type="colorTransform",i.$uniforms.matrix=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],i.$uniforms.colorAdd={x:0,y:0,z:0,w:0},i.setMatrix(e),i.onPropertyChange(),i}return __extends(e,t),Object.defineProperty(e.prototype,"matrix",{get:function(){for(var t=0;20>t;t++)this.matrix2[t]=this.$matrix[t];return this.matrix2},set:function(t){this.setMatrix(t)},enumerable:!0,configurable:!0}),e.prototype.setMatrix=function(t){if(t)for(var e=0;20>e;e++)this.$matrix[e]=t[e];else for(var e=0;20>e;e++)this.$matrix[e]=0==e||6==e||12==e||18==e?1:0;for(var i=this.$matrix,r=this.$uniforms.matrix,n=this.$uniforms.colorAdd,e=0,a=0;e<i.length;e++)4===e?n.x=i[e]/255:9===e?n.y=i[e]/255:14===e?n.z=i[e]/255:19===e?n.w=i[e]/255:(r[a]=i[e],a++);this.onPropertyChange()},e.prototype.$toJson=function(){return'{"matrix": ['+this.$matrix.toString()+"]}"},e}(t.Filter);t.ColorMatrixFilter=e,__reflect(e.prototype,"egret.ColorMatrixFilter")}(egret||(egret={}));var egret;!function(t){var e,i={},r="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),n=new Array(36),a=0,o=function(){for(var t=0;36>t;t++)8===t||13===t||18===t||23===t?n[t]="-":14===t?n[t]="4":(2>=a&&(a=33554432+16777216*Math.random()|0),e=15&a,a>>=4,n[t]=r[19===t?3&e|8:e]);return n.join("")},s=function(e){function r(t,r,n){void 0===n&&(n={});var a=e.call(this)||this;a.$padding=0,a.$vertexSrc=t,a.$fragmentSrc=r;var s=t+r;return i[s]||(i[s]=o()),a.$shaderKey=i[s],a.$uniforms=n,a.type="custom",a}return __extends(r,e),Object.defineProperty(r.prototype,"padding",{get:function(){return this.$padding},set:function(t){var e=this;e.$padding!=t&&(e.$padding=t,e.onPropertyChange())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"uniforms",{get:function(){return this.$uniforms},enumerable:!0,configurable:!0}),r.prototype.onPropertyChange=function(){if(t.nativeRender){var e=this;egret_native.NativeDisplayObject.setFilterPadding(e.$id,e.$padding,e.$padding,e.$padding,e.$padding),egret_native.NativeDisplayObject.setDataToFilter(e)}},r}(t.Filter);t.CustomFilter=s,__reflect(s.prototype,"egret.CustomFilter")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(t,i,r,n,a,o,s,l,h,c,u){void 0===t&&(t=4),void 0===i&&(i=45),void 0===r&&(r=0),void 0===n&&(n=1),void 0===a&&(a=4),void 0===o&&(o=4),void 0===s&&(s=1),void 0===l&&(l=1),void 0===h&&(h=!1),void 0===c&&(c=!1),void 0===u&&(u=!1);var p=e.call(this,r,n,a,o,s,l,h,c)||this,d=p;return d.$distance=t,d.$angle=i,d.$hideObject=u,d.$uniforms.dist=t,d.$uniforms.angle=i/180*Math.PI,d.$uniforms.hideObject=u?1:0,d.onPropertyChange(),p}return __extends(i,e),Object.defineProperty(i.prototype,"distance",{get:function(){return this.$distance},set:function(t){var e=this;e.$distance!=t&&(e.$distance=t,e.$uniforms.dist=t,e.onPropertyChange())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"angle",{get:function(){return this.$angle},set:function(t){var e=this;e.$angle!=t&&(e.$angle=t,e.$uniforms.angle=t/180*Math.PI,e.onPropertyChange())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"hideObject",{get:function(){return this.$hideObject},set:function(t){this.$hideObject!=t&&(this.$hideObject=t,this.$uniforms.hideObject=t?1:0)},enumerable:!0,configurable:!0}),i.prototype.$toJson=function(){return'{"distance": '+this.$distance+', "angle": '+this.$angle+', "color": '+this.$color+', "red": '+this.$red+', "green": '+this.$green+', "blue": '+this.$blue+', "alpha": '+this.$alpha+', "blurX": '+this.$blurX+', "blurY": '+this.blurY+', "strength": '+this.$strength+', "quality": '+this.$quality+', "inner": '+this.$inner+', "knockout": '+this.$knockout+', "hideObject": '+this.$hideObject+"}"},i.prototype.updatePadding=function(){var e=this;e.paddingLeft=e.blurX,e.paddingRight=e.blurX,e.paddingTop=e.blurY,e.paddingBottom=e.blurY;var i=e.distance||0,r=e.angle||0,n=0,a=0;0!=i&&(n=i*t.NumberUtils.cos(r),n=n>0?Math.ceil(n):Math.floor(n),a=i*t.NumberUtils.sin(r),a=a>0?Math.ceil(a):Math.floor(a),e.paddingLeft+=n,e.paddingRight+=n,e.paddingTop+=a,e.paddingBottom+=a)},i}(t.GlowFilter);t.DropShadowFilter=e,__reflect(e.prototype,"egret.DropShadowFilter")}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.LINEAR="linear",t.RADIAL="radial",t}();t.GradientType=e,__reflect(e.prototype,"egret.GradientType")}(egret||(egret={}));var egret;!function(t){function e(t){return t%=2*Math.PI,0>t&&(t+=2*Math.PI),t}function i(t,e){for(var i=[],n=0;e>n;n++){var a=r(t,n/e);a&&i.push(a)}return i}function r(e,i){var r=0,o=0,s=0,l=e.length;if(l/2==3){var h=e[r++],c=e[r++],u=e[r++],p=e[r++],d=e[r++],f=e[r++];o=n(h,u,d,i),s=n(c,p,f,i)}else if(l/2==4){var h=e[r++],c=e[r++],u=e[r++],p=e[r++],d=e[r++],f=e[r++],g=e[r++],m=e[r++];o=a(h,u,d,g,i),s=a(c,p,f,m,i)}return t.Point.create(o,s)}function n(t,e,i,r){var n=Math.pow(1-r,2)*t+2*r*(1-r)*e+Math.pow(r,2)*i;return n}function a(t,e,i,r,n){var a=Math.pow(1-n,3)*t+3*n*Math.pow(1-n,2)*e+3*(1-n)*Math.pow(n,2)*i+Math.pow(n,3)*r;return a}var o=function(r){function n(){var e=r.call(this)||this;return e.lastX=0,e.lastY=0,e.fillPath=null,e.strokePath=null,e.topLeftStrokeWidth=0,e.bottomRightStrokeWidth=0,e.minX=1/0,e.minY=1/0,e.maxX=-(1/0),e.maxY=-(1/0),e.includeLastPosition=!0,e.$renderNode=new t.sys.GraphicsNode,e}return __extends(n,r),n.prototype.$setTarget=function(e){this.$targetDisplay&&(this.$targetDisplay.$renderNode=null),e.$renderNode=this.$renderNode,this.$targetDisplay=e,this.$targetIsSprite=e instanceof t.Sprite},n.prototype.setStrokeWidth=function(t){switch(t){case 1:this.topLeftStrokeWidth=0,this.bottomRightStrokeWidth=1;break;case 3:this.topLeftStrokeWidth=1,this.bottomRightStrokeWidth=2;break;default:var e=0|Math.ceil(.5*t);this.topLeftStrokeWidth=e,this.bottomRightStrokeWidth=e}},n.prototype.beginFill=function(e,i){void 0===i&&(i=1),e=+e||0,i=+i||0,t.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setBeginFill(e,i),this.fillPath=this.$renderNode.beginFill(e,i,this.strokePath),this.$renderNode.drawData.length>1&&this.fillPath.moveTo(this.lastX,this.lastY)},n.prototype.beginGradientFill=function(e,i,r,n,a){void 0===a&&(a=null),t.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setBeginGradientFill(e,i,r,n,a),this.fillPath=this.$renderNode.beginGradientFill(e,i,r,n,a,this.strokePath),this.$renderNode.drawData.length>1&&this.fillPath.moveTo(this.lastX,this.lastY)},n.prototype.endFill=function(){t.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setEndFill(),this.fillPath=null},n.prototype.lineStyle=function(e,i,r,n,a,o,s,l,h){void 0===e&&(e=0/0),void 0===i&&(i=0),void 0===r&&(r=1),void 0===n&&(n=!1),void 0===a&&(a="normal"),void 0===o&&(o=null),void 0===s&&(s=null),void 0===l&&(l=3),e=+e||0,i=+i||0,r=+r||0,l=+l||0,t.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setLineStyle(e,i,r,n,a,o,s,l),0>=e?(this.strokePath=null,this.setStrokeWidth(0)):(this.setStrokeWidth(e),this.strokePath=this.$renderNode.lineStyle(e,i,r,o,s,l,h),this.$renderNode.drawData.length>1&&this.strokePath.moveTo(this.lastX,this.lastY))},n.prototype.drawRect=function(e,i,r,n){e=+e||0,i=+i||0,r=+r||0,n=+n||0,t.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setDrawRect(e,i,r,n);var a=this.fillPath,o=this.strokePath;a&&a.drawRect(e,i,r,n),o&&o.drawRect(e,i,r,n),this.extendBoundsByPoint(e+r,i+n),this.updatePosition(e,i),this.dirty()},n.prototype.drawRoundRect=function(e,i,r,n,a,o){e=+e||0,i=+i||0,r=+r||0,n=+n||0,a=+a||0,o=+o||0,t.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setDrawRoundRect(e,i,r,n,a,o);var s=this.fillPath,l=this.strokePath;s&&s.drawRoundRect(e,i,r,n,a,o),l&&l.drawRoundRect(e,i,r,n,a,o);var h=.5*a|0,c=o?.5*o|0:h,u=e+r,p=i+n,d=p-c;this.extendBoundsByPoint(e,i),this.extendBoundsByPoint(u,p),this.updatePosition(u,d),this.dirty()},n.prototype.drawCircle=function(e,i,r){e=+e||0,i=+i||0,r=+r||0,t.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setDrawCircle(e,i,r);var n=this.fillPath,a=this.strokePath;n&&n.drawCircle(e,i,r),a&&a.drawCircle(e,i,r),this.extendBoundsByPoint(e-r-1,i-r-1),this.extendBoundsByPoint(e+r+2,i+r+2),this.updatePosition(e+r,i),this.dirty()},n.prototype.drawEllipse=function(e,i,r,n){e=+e||0,i=+i||0,r=+r||0,n=+n||0,t.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setDrawEllipse(e,i,r,n);var a=this.fillPath,o=this.strokePath;a&&a.drawEllipse(e,i,r,n),o&&o.drawEllipse(e,i,r,n),this.extendBoundsByPoint(e-1,i-1),this.extendBoundsByPoint(e+r+2,i+n+2),this.updatePosition(e+r,i+.5*n),this.dirty()},n.prototype.moveTo=function(e,i){e=+e||0,i=+i||0,t.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setMoveTo(e,i);var r=this.fillPath,n=this.strokePath;r&&r.moveTo(e,i),n&&n.moveTo(e,i),this.includeLastPosition=!1,this.lastX=e,this.lastY=i,this.dirty()},n.prototype.lineTo=function(e,i){e=+e||0,i=+i||0,t.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setLineTo(e,i);var r=this.fillPath,n=this.strokePath;r&&r.lineTo(e,i),n&&n.lineTo(e,i),this.updatePosition(e,i),this.dirty()},n.prototype.curveTo=function(e,r,n,a){e=+e||0,r=+r||0,n=+n||0,a=+a||0,t.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setCurveTo(e,r,n,a);var o=this.fillPath,s=this.strokePath;o&&o.curveTo(e,r,n,a),s&&s.curveTo(e,r,n,a);for(var l=this.lastX||0,h=this.lastY||0,c=i([l,h,e,r,n,a],50),u=0;u<c.length;u++){var p=c[u];this.extendBoundsByPoint(p.x,p.y),t.Point.release(p)}this.extendBoundsByPoint(n,a),this.updatePosition(n,a),this.dirty()},n.prototype.cubicCurveTo=function(e,r,n,a,o,s){e=+e||0,r=+r||0,n=+n||0,a=+a||0,o=+o||0,s=+s||0,t.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setCubicCurveTo(e,r,n,a,o,s);var l=this.fillPath,h=this.strokePath;l&&l.cubicCurveTo(e,r,n,a,o,s),h&&h.cubicCurveTo(e,r,n,a,o,s);for(var c=this.lastX||0,u=this.lastY||0,p=i([c,u,e,r,n,a,o,s],50),d=0;d<p.length;d++){var f=p[d];this.extendBoundsByPoint(f.x,f.y),t.Point.release(f)}this.extendBoundsByPoint(o,s),this.updatePosition(o,s),this.dirty()},n.prototype.drawArc=function(i,r,n,a,o,s){if(!(0>n||a===o)){i=+i||0,r=+r||0,n=+n||0,a=+a||0,o=+o||0,s=!!s,a=e(a),o=e(o),t.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setDrawArc(i,r,n,a,o,s);var l=this.fillPath,h=this.strokePath;l&&(l.$lastX=this.lastX,l.$lastY=this.lastY,l.drawArc(i,r,n,a,o,s)),h&&(h.$lastX=this.lastX,h.$lastY=this.lastY,h.drawArc(i,r,n,a,o,s)),s?this.arcBounds(i,r,n,o,a):this.arcBounds(i,r,n,a,o);var c=i+Math.cos(o)*n,u=r+Math.sin(o)*n;this.updatePosition(c,u),this.dirty()}},n.prototype.dirty=function(){var e=this;if(e.$renderNode.dirtyRender=!0,!t.nativeRender){var i=e.$targetDisplay;i.$cacheDirty=!0;var r=i.$parent;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp());var n=i.$maskedObject;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp())}},n.prototype.arcBounds=function(t,e,i,r,n){var a=Math.PI;if(Math.abs(r-n)<.01)return this.extendBoundsByPoint(t-i,e-i),void this.extendBoundsByPoint(t+i,e+i);r>n&&(n+=2*a);for(var o=Math.cos(r)*i,s=Math.cos(n)*i,l=Math.min(o,s),h=Math.max(o,s),c=Math.sin(r)*i,u=Math.sin(n)*i,p=Math.min(c,u),d=Math.max(c,u),f=r/(.5*a),g=n/(.5*a),m=Math.ceil(f);g>=m;m++)switch(m%4){case 0:h=i;break;case 1:d=i;break;case 2:l=-i;break;case 3:p=-i}l=Math.floor(l),p=Math.floor(p),h=Math.ceil(h),d=Math.ceil(d),this.extendBoundsByPoint(l+t,p+e),this.extendBoundsByPoint(h+t,d+e)},n.prototype.clear=function(){t.nativeRender&&this.$targetDisplay.$nativeDisplayObject.setGraphicsClear(),this.$renderNode.clear(),this.updatePosition(0,0),this.minX=1/0,this.minY=1/0,this.maxX=-(1/0),this.maxY=-(1/0),this.dirty()},n.prototype.extendBoundsByPoint=function(t,e){this.extendBoundsByX(t),this.extendBoundsByY(e)},n.prototype.extendBoundsByX=function(t){this.minX=Math.min(this.minX,t-this.topLeftStrokeWidth),this.maxX=Math.max(this.maxX,t+this.bottomRightStrokeWidth),this.updateNodeBounds()},n.prototype.extendBoundsByY=function(t){this.minY=Math.min(this.minY,t-this.topLeftStrokeWidth),this.maxY=Math.max(this.maxY,t+this.bottomRightStrokeWidth),this.updateNodeBounds()},n.prototype.updateNodeBounds=function(){var t=this.$renderNode;t.x=this.minX,t.y=this.minY,t.width=Math.ceil(this.maxX-this.minX),t.height=Math.ceil(this.maxY-this.minY)},n.prototype.updatePosition=function(t,e){this.includeLastPosition||(this.extendBoundsByPoint(this.lastX,this.lastY),this.includeLastPosition=!0),this.lastX=t,this.lastY=e,this.extendBoundsByPoint(t,e)},n.prototype.$measureContentBounds=function(t){this.minX===1/0?t.setEmpty():t.setTo(this.minX,this.minY,this.maxX-this.minX,this.maxY-this.minY)},n.prototype.$hitTest=function(e,i){var r=this.$targetDisplay,n=r.$getInvertedConcatenatedMatrix(),a=n.a*e+n.c*i+n.tx,o=n.b*e+n.d*i+n.ty,s=t.sys.canvasHitTestBuffer;s.resize(3,3);var l=this.$renderNode,h=t.Matrix.create();h.identity(),h.translate(1-a,1-o),t.sys.canvasRenderer.drawNodeToBuffer(l,s,h,!0),t.Matrix.release(h);try{var c=s.getPixels(1,1);if(0===c[3])return null}catch(u){throw new Error(t.sys.tr(1039))}return r},n.prototype.$onRemoveFromStage=function(){this.$renderNode&&this.$renderNode.clean(),t.nativeRender&&egret_native.NativeDisplayObject.disposeGraphicData(this)},n}(t.HashObject);t.Graphics=o,__reflect(o.prototype,"egret.Graphics")}(egret||(egret={}));var egret;!function(t){var e=Math.PI,i=2*e,r=e/180,n=[],a=function(a){function o(t,e,i,r,n,o){void 0===t&&(t=1),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=1),void 0===n&&(n=0),void 0===o&&(o=0);var s=a.call(this)||this;return s.a=t,s.b=e,s.c=i,s.d=r,s.tx=n,s.ty=o,s}return __extends(o,a),o.release=function(t){t&&n.push(t)},o.create=function(){var t=n.pop();return t||(t=new o),t},o.prototype.clone=function(){return new o(this.a,this.b,this.c,this.d,this.tx,this.ty)},o.prototype.concat=function(t){var e=this.a*t.a,i=0,r=0,n=this.d*t.d,a=this.tx*t.a+t.tx,o=this.ty*t.d+t.ty;(0!==this.b||0!==this.c||0!==t.b||0!==t.c)&&(e+=this.b*t.c,n+=this.c*t.b,i+=this.a*t.b+this.b*t.d,r+=this.c*t.a+this.d*t.c,a+=this.ty*t.c,o+=this.tx*t.b),this.a=e,this.b=i,this.c=r,this.d=n,this.tx=a,this.ty=o},o.prototype.copyFrom=function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},o.prototype.identity=function(){this.a=this.d=1,this.b=this.c=this.tx=this.ty=0},o.prototype.invert=function(){this.$invertInto(this)},o.prototype.$invertInto=function(t){var e=this.a,i=this.b,r=this.c,n=this.d,a=this.tx,o=this.ty;if(0==i&&0==r)return t.b=t.c=0,void(0==e||0==n?t.a=t.d=t.tx=t.ty=0:(e=t.a=1/e,n=t.d=1/n,t.tx=-e*a,t.ty=-n*o));var s=e*n-i*r;if(0==s)return void t.identity();s=1/s;var l=t.a=n*s;i=t.b=-i*s,r=t.c=-r*s,n=t.d=e*s,t.tx=-(l*a+r*o),t.ty=-(i*a+n*o)},o.prototype.rotate=function(e){if(e=+e,0!==e){e/=r;var i=t.NumberUtils.cos(e),n=t.NumberUtils.sin(e),a=this.a,o=this.b,s=this.c,l=this.d,h=this.tx,c=this.ty;this.a=a*i-o*n,this.b=a*n+o*i,this.c=s*i-l*n,this.d=s*n+l*i,this.tx=h*i-c*n,this.ty=h*n+c*i}},o.prototype.scale=function(t,e){1!==t&&(this.a*=t,this.c*=t,this.tx*=t),1!==e&&(this.b*=e,this.d*=e,this.ty*=e)},o.prototype.setTo=function(t,e,i,r,n,a){return this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=a,this},o.prototype.transformPoint=function(e,i,r){var n=this.a*e+this.c*i+this.tx,a=this.b*e+this.d*i+this.ty;return r?(r.setTo(n,a),r):new t.Point(n,a)},o.prototype.translate=function(t,e){this.tx+=t,this.ty+=e},o.prototype.equals=function(t){return this.a==t.a&&this.b==t.b&&this.c==t.c&&this.d==t.d&&this.tx==t.tx&&this.ty==t.ty},o.prototype.prepend=function(t,e,i,r,n,a){var o=this.tx;if(1!=t||0!=e||0!=i||1!=r){var s=this.a,l=this.c;this.a=s*t+this.b*i,this.b=s*e+this.b*r,this.c=l*t+this.d*i,this.d=l*e+this.d*r}return this.tx=o*t+this.ty*i+n,this.ty=o*e+this.ty*r+a,this},o.prototype.append=function(t,e,i,r,n,a){var o=this.a,s=this.b,l=this.c,h=this.d;return(1!=t||0!=e||0!=i||1!=r)&&(this.a=t*o+e*l,this.b=t*s+e*h,this.c=i*o+r*l,this.d=i*s+r*h),this.tx=n*o+a*l+this.tx,this.ty=n*s+a*h+this.ty,this},o.prototype.deltaTransformPoint=function(e){var i=this,r=i.a*e.x+i.c*e.y,n=i.b*e.x+i.d*e.y;return new t.Point(r,n)},o.prototype.toString=function(){return"(a="+this.a+", b="+this.b+", c="+this.c+", d="+this.d+", tx="+this.tx+", ty="+this.ty+")"},o.prototype.createBox=function(e,i,n,a,o){void 0===n&&(n=0),void 0===a&&(a=0),void 0===o&&(o=0);var s=this;if(0!==n){n/=r;var l=t.NumberUtils.cos(n),h=t.NumberUtils.sin(n);s.a=l*e,s.b=h*i,s.c=-h*e,s.d=l*i}else s.a=e,s.b=0,s.c=0,s.d=i;s.tx=a,s.ty=o},o.prototype.createGradientBox=function(t,e,i,r,n){void 0===i&&(i=0),void 0===r&&(r=0),void 0===n&&(n=0),this.createBox(t/1638.4,e/1638.4,i,r+t/2,n+e/2)},o.prototype.$transformBounds=function(t){var e=this.a,i=this.b,r=this.c,n=this.d,a=this.tx,o=this.ty,s=t.x,l=t.y,h=s+t.width,c=l+t.height,u=e*s+r*l+a,p=i*s+n*l+o,d=e*h+r*l+a,f=i*h+n*l+o,g=e*h+r*c+a,m=i*h+n*c+o,y=e*s+r*c+a,v=i*s+n*c+o,_=0;u>d&&(_=u,u=d,d=_),g>y&&(_=g,g=y,y=_),t.x=Math.floor(g>u?u:g),t.width=Math.ceil((d>y?d:y)-t.x),p>f&&(_=p,p=f,f=_),m>v&&(_=m,m=v,v=_),t.y=Math.floor(m>p?p:m),t.height=Math.ceil((f>v?f:v)-t.y)},o.prototype.getDeterminant=function(){return this.a*this.d-this.b*this.c},o.prototype.$getScaleX=function(){var t=this;if(0==t.b)return t.a;var e=Math.sqrt(t.a*t.a+t.b*t.b);return this.getDeterminant()<0?-e:e},o.prototype.$getScaleY=function(){var t=this;if(0==t.c)return t.d;var e=Math.sqrt(t.c*t.c+t.d*t.d);return this.getDeterminant()<0?-e:e},o.prototype.$getSkewX=function(){return this.d<0?Math.atan2(this.d,this.c)+e/2:Math.atan2(this.d,this.c)-e/2},o.prototype.$getSkewY=function(){return this.a<0?Math.atan2(this.b,this.a)-e:Math.atan2(this.b,this.a)},o.prototype.$updateScaleAndRotation=function(e,n,a,o){if(!(0!=a&&a!=i||0!=o&&o!=i))return this.a=e,this.b=this.c=0,void(this.d=n);a/=r,o/=r;var s=t.NumberUtils.cos(a),l=t.NumberUtils.sin(a);a==o?(this.a=s*e,this.b=l*e):(this.a=t.NumberUtils.cos(o)*e,this.b=t.NumberUtils.sin(o)*e),this.c=-l*n,this.d=s*n},o.prototype.$preMultiplyInto=function(t,e){var i=t.a*this.a,r=0,n=0,a=t.d*this.d,o=t.tx*this.a+this.tx,s=t.ty*this.d+this.ty;(0!==t.b||0!==t.c||0!==this.b||0!==this.c)&&(i+=t.b*this.c,a+=t.c*this.b,r+=t.a*this.b+t.b*this.d,n+=t.c*this.a+t.d*this.c,o+=t.ty*this.c,s+=t.tx*this.b),e.a=i,e.b=r,e.c=n,e.d=a,e.tx=o,e.ty=s},o}(t.HashObject);t.Matrix=a,__reflect(a.prototype,"egret.Matrix"),t.$TempMatrix=new a}(egret||(egret={}));var egret;!function(t){var e=[],i=function(i){function r(t,e,r,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===n&&(n=0);var a=i.call(this)||this;return a.x=t,a.y=e,a.width=r,a.height=n,a}return __extends(r,i),r.release=function(t){t&&e.push(t)},r.create=function(){var t=e.pop();return t||(t=new r),t},Object.defineProperty(r.prototype,"right",{get:function(){return this.x+this.width},set:function(t){this.width=t-this.x},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"bottom",{get:function(){return this.y+this.height},set:function(t){this.height=t-this.y},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"left",{get:function(){return this.x},set:function(t){this.width+=this.x-t,this.x=t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"top",{get:function(){return this.y},set:function(t){this.height+=this.y-t,this.y=t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"topLeft",{get:function(){return new t.Point(this.left,this.top)},set:function(t){this.top=t.y,this.left=t.x},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"bottomRight",{get:function(){return new t.Point(this.right,this.bottom)},set:function(t){this.bottom=t.y,this.right=t.x},enumerable:!0,configurable:!0}),r.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this},r.prototype.setTo=function(t,e,i,r){return this.x=t,this.y=e,this.width=i,this.height=r,this},r.prototype.contains=function(t,e){return this.x<=t&&this.x+this.width>=t&&this.y<=e&&this.y+this.height>=e},r.prototype.intersection=function(t){return this.clone().$intersectInPlace(t)},r.prototype.inflate=function(t,e){this.x-=t,this.width+=2*t,this.y-=e,this.height+=2*e},r.prototype.$intersectInPlace=function(t){var e=this.x,i=this.y,r=t.x,n=t.y,a=Math.max(e,r),o=Math.min(e+this.width,r+t.width);if(o>=a){var s=Math.max(i,n),l=Math.min(i+this.height,n+t.height);if(l>=s)return this.setTo(a,s,o-a,l-s),this}return this.setEmpty(),this},r.prototype.intersects=function(t){return Math.max(this.x,t.x)<=Math.min(this.right,t.right)&&Math.max(this.y,t.y)<=Math.min(this.bottom,t.bottom)},r.prototype.isEmpty=function(){return this.width<=0||this.height<=0},r.prototype.setEmpty=function(){this.x=0,this.y=0,this.width=0,this.height=0},r.prototype.clone=function(){return new r(this.x,this.y,this.width,this.height)},r.prototype.containsPoint=function(t){return this.x<=t.x&&this.x+this.width>t.x&&this.y<=t.y&&this.y+this.height>t.y?!0:!1},r.prototype.containsRect=function(t){var e=t.x+t.width,i=t.y+t.height,r=this.x+this.width,n=this.y+this.height;return t.x>=this.x&&t.x<r&&t.y>=this.y&&t.y<n&&e>this.x&&r>=e&&i>this.y&&n>=i},r.prototype.equals=function(t){return this===t?!0:this.x===t.x&&this.y===t.y&&this.width===t.width&&this.height===t.height},r.prototype.inflatePoint=function(t){this.inflate(t.x,t.y)},r.prototype.offset=function(t,e){this.x+=t,this.y+=e},r.prototype.offsetPoint=function(t){this.offset(t.x,t.y)},r.prototype.toString=function(){return"(x="+this.x+", y="+this.y+", width="+this.width+", height="+this.height+")"},r.prototype.union=function(t){var e=this.clone();if(t.isEmpty())return e;if(e.isEmpty())return e.copyFrom(t),e;var i=Math.min(e.x,t.x),r=Math.min(e.y,t.y);return e.setTo(i,r,Math.max(e.right,t.right)-i,Math.max(e.bottom,t.bottom)-r),e},r.prototype.$getBaseWidth=function(t){var e=Math.abs(Math.cos(t)),i=Math.abs(Math.sin(t));return e*this.width+i*this.height},r.prototype.$getBaseHeight=function(t){var e=Math.abs(Math.cos(t)),i=Math.abs(Math.sin(t));return i*this.width+e*this.height},r}(t.HashObject);t.Rectangle=i,__reflect(i.prototype,"egret.Rectangle"),t.$TempRectangle=new i}(egret||(egret={}));var egret;!function(t){t.$locale_strings=t.$locale_strings||{},t.$locale_strings.en_US=t.$locale_strings.en_US||{};var e=t.$locale_strings.en_US;e[1001]="Could not find Egret entry class: {0}。",e[1002]="Egret entry class '{0}' must inherit from egret.DisplayObject.",e[1003]="Parameter {0} must be non-null.",e[1004]="An object cannot be added as a child to one of it's children (or children's children, etc.).",e[1005]="An object cannot be added as a child of itself.",e[1006]="The supplied DisplayObject must be a child of the caller.",e[1007]="An index specified for a parameter was out of range.",e[1008]="Instantiate singleton error，singleton class {0} can not create multiple instances.",e[1009]='the Class {0} cannot use the property "{1}"',e[1010]='the property "{1}" of the Class "{0}" is readonly',e[1011]="Stream Error. URL: {0}",e[1012]="The type of parameter {0} must be Class.",e[1013]="Variable assignment is NaN, please see the code!",e[1014]='the constant "{1}" of the Class "{0}" is read-only',e[1015]="xml not found!",e[1016]="{0}has been obsoleted",e[1017]="The format of JSON file is incorrect: {0}\ndata: {1}",e[1018]="the scale9Grid is not correct",e[1019]="Network ab:{0}",e[1020]="Cannot initialize Shader",e[1021]="Current browser does not support webgl",e[1022]="{0} ArgumentError",e[1023]="This method is not available in the ScrollView!",e[1025]="end of the file",e[1026]="! EncodingError The code point {0} could not be encoded.",e[1027]="DecodingError",e[1028]=". called injection is not configured rule: {0}, please specify configuration during its initial years of injection rule, and then call the corresponding single case.",e[1029]="Function.prototype.bind - what is trying to be bound is not callable",e[1033]="Photos can not be used across domains toDataURL to convert base64",e[1034]='Music file decoding failed: "{0}", please use the standard conversion tool reconversion under mp3.',e[1035]="Native does not support this feature!",e[1036]="Sound has stopped, please recall Sound.play () to play the sound!",e[1037]="Non-load the correct blob!",e[1038]="XML format error!",e[1039]="Cross domains pictures can not get pixel information!",e[1040]="hitTestPoint can not detect crossOrigin images! Please check if the display object has crossOrigin elements.",e[1041]="{0} is deprecated, please use {1} replace",e[1042]="The parameters passed in the region needs is an integer in drawToTexture method. Otherwise, some browsers will draw abnormal.",e[1043]="Compile errors in {0}, the attribute name: {1}, the attribute value: {2}.",e[1044]="The current version of the Runtime does not support video playback, please use the latest version",e[1045]="The resource url is not found",e[1046]="BitmapText no corresponding characters: {0}, please check the configuration file",e[1047]="egret.localStorage.setItem save failed,key={0}&value={1}",e[1048]="Video loading failed",e[1049]="In the absence of sound is not allowed to play after loading",e[1050]="ExternalInterface calls the method without js registration: {0}",e[1051]="runtime only support webgl render mode",e[1052]="network request timeout{0}",e[3e3]="Theme configuration file failed to load: {0}",e[3001]="Cannot find the skin name which is configured in Theme: {0}",e[3002]='Index:"{0}" is out of the collection element index range',e[3003]="Cannot be available in this component. If this component is container, please continue to use",e[3004]="addChild(){0}addElement() replace",e[3005]="addChildAt(){0}addElementAt() replace",e[3006]="removeChild(){0}removeElement() replace",e[3007]="removeChildAt(){0}removeElementAt() replace",e[3008]="setChildIndex(){0}setElementIndex() replace",e[3009]="swapChildren(){0}swapElements() replace",e[3010]="swapChildrenAt(){0}swapElementsAt() replace",e[3011]='Index:"{0}" is out of the visual element index range',e[3012]="This method is not available in Scroller component!",e[3013]="UIStage is GUI root container, and only one such instant is in the display list！",e[3014]="set fullscreen error",e[3100]="Current browser does not support WebSocket",e[3101]="Please connect Socket firstly",e[3102]="Please set the type of binary type",e[3200]="getResByUrl must be called after loadConfig",e[4e3]="An Bone cannot be added as a child to itself or one of its children (or children's children, etc.)",e[4001]="Abstract class can not be instantiated!",e[4002]="Unnamed data!",e[4003]="Nonsupport version!",e[4500]="The platform does not support {0} adapter mode and has been automatically replaced with {1} mode, please modify your code adapter logic"}(egret||(egret={}));var egret;!function(t){t.JointStyle={BEVEL:"bevel",MITER:"miter",ROUND:"round"}}(egret||(egret={}));var egret;!function(t){t.$locale_strings=t.$locale_strings||{},t.$locale_strings.zh_CN=t.$locale_strings.zh_CN||{};
var e=t.$locale_strings.zh_CN;e[1001]="找不到Egret入口类: {0}。",e[1002]="Egret入口类 {0} 必须继承自egret.DisplayObject。",e[1003]="参数 {0} 不能为 null。",e[1004]="无法将对象添加为它的一个子对象（或子对象的子对象等）的子对象。",e[1005]="不能将对象添加为其自身的子对象。",e[1006]="提供的 DisplayObject 必须是调用者的子级。",e[1007]="为参数指定的索引不在范围内。",e[1008]="实例化单例出错，不允许实例化多个 {0} 对象。",e[1009]="类 {0} 不可以使用属性 {1}",e[1010]="类 {0} 属性 {1} 是只读的",e[1011]="流错误。URL: {0}",e[1012]="参数 {0} 的类型必须为 Class。",e[1013]="变量赋值为NaN，请查看代码！",e[1014]="类 {0} 常量 {1} 是只读的",e[1015]="xml not found!",e[1016]="{0}已经废弃",e[1017]="JSON文件格式不正确: {0}\ndata: {1}",e[1018]="9宫格设置错误",e[1019]="网络异常:{0}",e[1020]="无法初始化着色器",e[1021]="当前浏览器不支持webgl",e[1022]="{0} ArgumentError",e[1023]="此方法在ScrollView内不可用!",e[1025]="遇到文件尾",e[1026]="EncodingError! The code point {0} could not be encoded.",e[1027]="DecodingError",e[1028]="调用了未配置的注入规则:{0}。 请先在项目初始化里配置指定的注入规则，再调用对应单例。",e[1029]="Function.prototype.bind - what is trying to be bound is not callable",e[1033]="跨域图片不可以使用toDataURL来转换成base64",e[1034]='音乐文件解码失败："{0}"，请使用标准的转换工具重新转换下mp3。',e[1035]="Native 下暂未实现此功能！",e[1036]="声音已停止，请重新调用 Sound.play() 来播放声音！",e[1037]="非正确的blob加载！",e[1038]="XML 格式错误!",e[1039]="跨域图片不能获取像素信息!",e[1040]="hitTestPoint 不能对跨域图片进行检测! 请检查该显示对象内是否含有跨域元素",e[1041]="{0} 已废弃,请使用 {1} 代替",e[1042]="drawToTexture方法传入的区域各个参数需要为整数,否则某些浏览器绘制会出现异常",e[1043]="{0} 中存在编译错误，属性名 : {1}，属性值 : {2}",e[1044]="当前的 runtime 版本不支持视频播放,请使用最新的版本",e[1045]="没有设置要加载的资源地址",e[1046]="BitmapText 找不到对应字符:{0}，请检查配置文件",e[1047]="egret.localStorage.setItem保存失败,key={0}&value={1}",e[1048]="视频加载失败",e[1049]="声音在没有加载完之前不允许播放",e[1050]="ExternalInterface调用了js没有注册的方法: {0}",e[1051]="runtime 只支持 webgl 渲染模式",e[1052]="网络请求超时:{0}",e[3e3]="主题配置文件加载失败: {0}",e[3001]="找不到主题中所配置的皮肤类名: {0}",e[3002]='索引:"{0}"超出集合元素索引范围',e[3003]="在此组件中不可用，若此组件为容器类，请使用",e[3004]="addChild(){0}addElement()代替",e[3005]="addChildAt(){0}addElementAt()代替",e[3006]="removeChild(){0}removeElement()代替",e[3007]="removeChildAt(){0}removeElementAt()代替",e[3008]="setChildIndex(){0}setElementIndex()代替",e[3009]="swapChildren(){0}swapElements()代替",e[3010]="swapChildrenAt(){0}swapElementsAt()代替",e[3011]='索引:"{0}"超出可视元素索引范围',e[3012]="此方法在Scroller组件内不可用!",e[3013]="UIStage是GUI根容器，只能有一个此实例在显示列表中！",e[3014]="设置全屏模式失败",e[3100]="当前浏览器不支持WebSocket",e[3101]="请先连接WebSocket",e[3102]="请先设置type为二进制类型",e[3200]="getResByUrl 必须在 loadConfig 之后调用",e[4e3]="An Bone cannot be added as a child to itself or one of its children (or children's children, etc.)",e[4001]="Abstract class can not be instantiated!",e[4002]="Unnamed data!",e[4003]="Nonsupport version!",e[4500]="该平台不支持 {0} 适配模式，已经自动替换为 {1} 模式，请修改您的代码适配逻辑"}(egret||(egret={}));var egret;!function(t){var e;!function(t){}(e=t.localStorage||(t.localStorage={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){function e(t){r.indexOf(t)<0&&r.push(t)}function i(t){var e=r.indexOf(t);return e>=0?(r.splice(e,1),!0):!1}var r=[];t.$pushSoundChannel=e,t.$popSoundChannel=i}(e=t.sys||(t.sys={}))}(egret||(egret={})),function(t){}(egret||(egret={}));var egret;!function(t){}(egret||(egret={}));var egret;!function(t){var e;!function(t){t.GET="GET",t.POST="POST"}(e=t.HttpMethod||(t.HttpMethod={}))}(egret||(egret={}));var egret;!function(t){}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.TEXT="text",t.ARRAY_BUFFER="arraybuffer",t}();t.HttpResponseType=e,__reflect(e.prototype,"egret.HttpResponseType")}(egret||(egret={}));var egret;!function(t){}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=function(i){function r(r){var n=i.call(this)||this;return n.isStage=!1,n.$renderNode=new e.BitmapNode,n.renderBuffer=null,n.offsetX=0,n.offsetY=0,n.offsetMatrix=new t.Matrix,n.$canvasScaleX=1,n.$canvasScaleY=1,n.root=r,n.isStage=r instanceof t.Stage,n}return __extends(r,i),r.create=function(i){var r=new t.sys.DisplayList(i);try{var n=new e.RenderBuffer;r.renderBuffer=n}catch(a){return null}return r.root=i,r},r.prototype.$getRenderNode=function(){return this.$renderNode},r.prototype.setClipRect=function(t,e){t*=r.$canvasScaleX,e*=r.$canvasScaleY,this.renderBuffer.resize(t,e)},r.prototype.drawToSurface=function(){var i=0;this.$canvasScaleX=this.offsetMatrix.a=r.$canvasScaleX,this.$canvasScaleY=this.offsetMatrix.d=r.$canvasScaleY,this.isStage||this.changeSurfaceSize();var n=this.renderBuffer;if(n.clear(),i=e.systemRenderer.render(this.root,n,this.offsetMatrix),!this.isStage){var a=n.surface,o=this.$renderNode;o.drawData.length=0;var s=a.width,l=a.height;this.bitmapData?(this.bitmapData.source=a,this.bitmapData.width=s,this.bitmapData.height=l):this.bitmapData=new t.BitmapData(a),o.image=this.bitmapData,o.imageWidth=s,o.imageHeight=l,o.drawImage(0,0,s,l,-this.offsetX,-this.offsetY,s/this.$canvasScaleX,l/this.$canvasScaleY)}return i},r.prototype.changeSurfaceSize=function(){var t=(this.root,this.offsetX),e=this.offsetY,i=this.root.$getOriginalBounds(),r=this.$canvasScaleX,n=this.$canvasScaleY;this.offsetX=-i.x,this.offsetY=-i.y,this.offsetMatrix.setTo(this.offsetMatrix.a,0,0,this.offsetMatrix.d,this.offsetX,this.offsetY);var a=this.renderBuffer,o=Math.max(257,i.width*r),s=Math.max(257,i.height*n);(this.offsetX!=t||this.offsetY!=e||a.surface.width!=o||a.surface.height!=s)&&a.resize(o,s)},r.$setCanvasScale=function(e,i){r.$canvasScaleX=e,r.$canvasScaleY=i,t.nativeRender&&egret_native.nrSetCanvasScaleFactor(r.$canvasScaleFactor,e,i)},r.$canvasScaleFactor=1,r.$canvasScaleX=1,r.$canvasScaleY=1,r}(t.HashObject);e.DisplayList=i,__reflect(i.prototype,"egret.sys.DisplayList")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){}(egret||(egret={}));var egret;!function(t){}(egret||(egret={}));var egret;!function(t){var e;!function(e){function i(t){for(var e=[],i=0;i<t.length;i++)e.push(t[i]);return e}var r=function(r){function l(e,i,n){var a=r.call(this)||this;return a.isPlaying=!1,a.entryClassName=n,a.stage=i,a.screenDisplayList=a.createDisplayList(i,e),a.showFPS=!1,a.showLog=!1,a.stageDisplayList=null,t.nativeRender&&(egret_native.rootWebGLBuffer=e),a}return __extends(l,r),l.prototype.createDisplayList=function(t,i){var r=new e.DisplayList(t);return r.renderBuffer=i,t.$displayList=r,r},l.prototype.start=function(){!this.isPlaying&&this.stage&&(e.$TempStage=e.$TempStage||this.stage,this.isPlaying=!0,this.root||this.initialize(),t.ticker.$addPlayer(this))},l.prototype.initialize=function(){var e;if(this.entryClassName&&(e=t.getDefinitionByName(this.entryClassName)),e){var i=new e;this.root=i,i instanceof t.DisplayObject&&this.stage.addChild(i)}},l.prototype.stop=function(){this.pause(),this.stage=null},l.prototype.pause=function(){this.isPlaying&&(this.isPlaying=!1,t.ticker.$removePlayer(this))},l.prototype.$render=function(e,i){if(t.nativeRender)return egret_native.updateNativeRender(),void egret_native.nrRender();var r=this.stage,a=t.getTimer(),o=r.$displayList.drawToSurface(),s=t.getTimer();e&&this.showFPS&&n.update(o,s-a,i),(this.benchmark||window.Benchmark&&window.Benchmark.update)&&(!this.benchmark&&(this.benchmark=window.Benchmark),this.benchmark.update(o,s-a,i))},l.prototype.updateStageSize=function(e,i){var r=this.stage;r.$stageWidth=e,r.$stageHeight=i,t.nativeRender?egret_native.nrResize(e,i):(this.screenDisplayList.setClipRect(e,i),this.stageDisplayList&&this.stageDisplayList.setClipRect(e,i)),r.dispatchEventWith(t.Event.RESIZE)},l.prototype.displayFPS=function(r,l,h,c){if(l=!!l,l&&(t.log=function(){for(var t=arguments.length,r="",n=0;t>n;n++)r+=arguments[n]+" ";e.$logToFPS(r),console.log.apply(console,i(arguments))},t.warn=function(){for(var t=arguments.length,r="",n=0;t>n;n++)r+=arguments[n]+" ";e.$warnToFPS(r),console.warn.apply(console,i(arguments))},t.error=function(){for(var t=arguments.length,r="",n=0;t>n;n++)r+=arguments[n]+" ";e.$errorToFPS(r),console.error.apply(console,i(arguments))}),this.showFPS=!!r,this.showLog=l,!n){n=new FPS(this.stage,r,l,h,c);for(var u=a.length,p=0;u>p;p++)n.updateInfo(a[p]);a=null;for(var d=o.length,p=0;d>p;p++)n.updateWarn(o[p]);o=null;for(var f=s.length,p=0;f>p;p++)n.updateError(s[p]);s=null}},l}(t.HashObject);e.Player=r,__reflect(r.prototype,"egret.sys.Player");var n,a=[],o=[],s=[];e.$logToFPS=function(t){return n?void n.updateInfo(t):void a.push(t)},e.$warnToFPS=function(t){return n?void n.updateWarn(t):void o.push(t)},e.$errorToFPS=function(t){return n?void n.updateError(t):void s.push(t)};var l=function(){function e(e,i,r,n,a){this.showFPS=i,this.showLog=r,this.logFilter=n,this.styles=a,this.infoLines=[],this.totalTime=0,this.totalTick=0,this.lastTime=0,this.drawCalls=0,this.costRender=0,this.costTicker=0,this.infoLines=[],this.totalTime=0,this.totalTick=0,this.lastTime=0,this.drawCalls=0,this.costRender=0,this.costTicker=0,this._stage=e,this.showFPS=i,this.showLog=r,this.logFilter=n,this.styles=a,this.fpsDisplay=new t.FPSDisplay(e,i,r,n,a);var o;try{o=n?new RegExp(n):null}catch(s){t.log(s)}this.filter=function(t){return o?o.test(t):!n||0==t.indexOf(n)}}return e.prototype.update=function(e,i,r){var n=t.getTimer();if(this.totalTime+=n-this.lastTime,this.lastTime=n,this.totalTick++,this.drawCalls+=e,this.costRender+=i,this.costTicker+=r,this.totalTime>=1e3){var a=Math.min(Math.ceil(1e3*this.totalTick/this.totalTime),t.ticker.$frameRate),o=Math.round(this.drawCalls/this.totalTick),s=Math.round(this.costRender/this.totalTick),l=Math.round(this.costTicker/this.totalTick);this.fpsDisplay.update({fps:a,draw:o,costTicker:l,costRender:s}),this.totalTick=0,this.totalTime=this.totalTime%1e3,this.drawCalls=0,this.costRender=0,this.costTicker=0}},e.prototype.updateInfo=function(t){t&&this.showLog&&this.filter(t)&&this.fpsDisplay.updateInfo(t)},e.prototype.updateWarn=function(t){t&&this.showLog&&this.filter(t)&&(this.fpsDisplay.updateWarn?this.fpsDisplay.updateWarn(t):this.fpsDisplay.updateInfo("[Warning]"+t))},e.prototype.updateError=function(t){t&&this.showLog&&this.filter(t)&&(this.fpsDisplay.updateError?this.fpsDisplay.updateError(t):this.fpsDisplay.updateInfo("[Error]"+t))},e}();__reflect(l.prototype,"FPSImpl"),__global.FPS=l,t.warn=function(){console.warn.apply(console,i(arguments))},t.error=function(){console.error.apply(console,i(arguments))},t.assert=function(){console.assert.apply(console,i(arguments))},t.log=function(){console.log.apply(console,i(arguments))}}(e=t.sys||(t.sys={}))}(egret||(egret={})),function(t){if(t.nativeRender=__global.nativeRender,t.nativeRender){var e=egret_native.nrABIVersion,i=egret_native.nrMinEgretVersion,r=5;if(r>e){t.nativeRender=!1;var n="需要升级微端版本到 0.1.14 才可以开启原生渲染加速";t.sys.$warnToFPS(n),t.warn(n)}else if(e>r){t.nativeRender=!1;var n="需要升级引擎版本到 "+i+" 才可以开启原生渲染加速";t.sys.$warnToFPS(n),t.warn(n)}}}(egret||(egret={}));var egret;!function(t){var e=function(){function e(t,i,r,n){this.arrayBuffer=t,this.isInvalid=!1;var a=new Uint8Array(this.arrayBuffer,0,12);if(171!==a[0]||75!==a[1]||84!==a[2]||88!==a[3]||32!==a[4]||49!==a[5]||49!==a[6]||187!==a[7]||13!==a[8]||10!==a[9]||26!==a[10]||10!==a[11])return this.isInvalid=!0,void console.error("texture missing KTX identifier");var o=Uint32Array.BYTES_PER_ELEMENT,s=new DataView(this.arrayBuffer,12,13*o),l=s.getUint32(0,!0),h=67305985===l;return this.glType=s.getUint32(1*o,h),this.glTypeSize=s.getUint32(2*o,h),this.glFormat=s.getUint32(3*o,h),this.glInternalFormat=s.getUint32(4*o,h),this.glBaseInternalFormat=s.getUint32(5*o,h),this.pixelWidth=s.getUint32(6*o,h),this.pixelHeight=s.getUint32(7*o,h),this.pixelDepth=s.getUint32(8*o,h),this.numberOfArrayElements=s.getUint32(9*o,h),this.numberOfFaces=s.getUint32(10*o,h),this.numberOfMipmapLevels=s.getUint32(11*o,h),this.bytesOfKeyValueData=s.getUint32(12*o,h),0!==this.glType?void console.error("only compressed formats currently supported"):(this.numberOfMipmapLevels=Math.max(1,this.numberOfMipmapLevels),0===this.pixelHeight||0!==this.pixelDepth?void console.error("only 2D textures currently supported"):0!==this.numberOfArrayElements?void console.error("texture arrays not currently supported"):this.numberOfFaces!==i?void console.error("number of faces expected"+i+", but found "+this.numberOfFaces):void(this.loadType=e.COMPRESSED_2D))}return e.prototype.uploadLevels=function(t,i){this.loadType===e.COMPRESSED_2D&&this._upload2DCompressedLevels(t,i)},e.prototype._upload2DCompressedLevels=function(i,r){i.clearCompressedTextureData();for(var n=i.compressedTextureData,a=e.HEADER_LEN+this.bytesOfKeyValueData,o=this.pixelWidth,s=this.pixelHeight,l=r?this.numberOfMipmapLevels:1,h=0;l>h;h++){var c=new Int32Array(this.arrayBuffer,a,1)[0];a+=4;for(var u=[],p=0;p<this.numberOfFaces;p++){var d=new Uint8Array(this.arrayBuffer,a,c),f=new t.CompressedTextureData;f.glInternalFormat=this.glInternalFormat,f.width=o,f.height=s,f.byteArray=d,f.face=p,f.level=h,u.push(f),a+=c,a+=3-(c+3)%4}n.push(u),o=Math.max(1,.5*o),s=Math.max(1,.5*s)}var g=i.getCompressed2dTextureData();g&&(i.width=g.width,i.height=g.height)},e.HEADER_LEN=64,e.COMPRESSED_2D=0,e.COMPRESSED_3D=1,e.TEX_2D=2,e.TEX_3D=3,e}();t.KTXContainer=e,__reflect(e.prototype,"egret.KTXContainer")}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=function(e){function i(){return e.call(this)||this}return __extends(i,e),i.prototype.calculateStageSize=function(e,i,r,n,a){var o=i,s=r,l=n,h=a,c=i/l||0,u=r/h||0;switch(e){case t.StageScaleMode.EXACT_FIT:break;case t.StageScaleMode.FIXED_HEIGHT:l=Math.round(i/u);break;case t.StageScaleMode.FIXED_WIDTH:h=Math.round(r/c);break;case t.StageScaleMode.NO_BORDER:c>u?s=Math.round(h*c):o=Math.round(l*u);break;case t.StageScaleMode.SHOW_ALL:c>u?o=Math.round(l*u):s=Math.round(h*c);break;case t.StageScaleMode.FIXED_NARROW:c>u?l=Math.round(i/u):h=Math.round(r/c);break;case t.StageScaleMode.FIXED_WIDE:c>u?h=Math.round(r/c):l=Math.round(i/u);break;default:l=i,h=r}return t.Capabilities.runtimeType!=t.RuntimeType.WXGAME&&(l%2!=0&&(l+=1),h%2!=0&&(h+=1),o%2!=0&&(o+=1),s%2!=0&&(s+=1)),{stageWidth:l,stageHeight:h,displayWidth:o,displayHeight:s}},i}(t.HashObject);e.DefaultScreenAdapter=i,__reflect(i.prototype,"egret.sys.DefaultScreenAdapter",["egret.sys.IScreenAdapter"])}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.NO_SCALE="noScale",t.SHOW_ALL="showAll",t.NO_BORDER="noBorder",t.EXACT_FIT="exactFit",t.FIXED_WIDTH="fixedWidth",t.FIXED_HEIGHT="fixedHeight",t.FIXED_NARROW="fixedNarrow",t.FIXED_WIDE="fixedWide",t}();t.StageScaleMode=e,__reflect(e.prototype,"egret.StageScaleMode")}(egret||(egret={}));var egret;!function(t){var e;!function(t){function e(t,e){return console.error("empty sys.mainCanvas = "+t+", "+e),null}function i(t,e){return console.error("empty sys.createCanvas = "+t+", "+e),null}function r(t,e,i,r){console.error("empty sys.resizeContext = "+t+", "+e+", "+i+", "+r)}function n(t){return console.error("empty sys.getContextWebGL = "+t),null}function a(t){return console.error("empty sys.getContext2d = "+t),null}function o(t,e){return console.error("empty sys.createTexture = "+e),null}function s(t,e,i,r){return console.error("empty sys._createTexture = "+e+", "+i+", "+r),null}function l(t,e,i){return console.error("empty sys.drawTextureElements = "+t+", "+e+", "+i),0}function h(t,e){return console.error("empty sys.measureTextWith = "+t+", "+e),0}function c(t,e,i,r){return console.error("empty sys.createCanvasRenderBufferSurface = "+e+", "+i),null}function u(t,e,i,r){console.error("empty sys.resizeContext = "+t+", "+e+", "+i+", "+r)}t.mainCanvas=e,t.createCanvas=i,t.resizeContext=r,t.getContextWebGL=n,t.getContext2d=a,t.createTexture=o,t._createTexture=s,t.drawTextureElements=l,t.measureTextWith=h,t.createCanvasRenderBufferSurface=c,t.resizeCanvasRenderBuffer=u}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){e.$START_TIME=0,e.$invalidateRenderFlag=!1,e.$requestRenderingFlag=!1;var i=function(){function i(){this.playerList=[],this.callBackList=[],this.thisObjectList=[],this.$frameRate=30,this.lastTimeStamp=0,this.costEnterFrame=0,this.isPaused=!1,e.$START_TIME=Date.now(),this.frameDeltaTime=1e3/this.$frameRate,this.lastCount=this.frameInterval=Math.round(6e4/this.$frameRate)}return i.prototype.$addPlayer=function(t){-1==this.playerList.indexOf(t)&&(this.playerList=this.playerList.concat(),this.playerList.push(t))},i.prototype.$removePlayer=function(t){var e=this.playerList.indexOf(t);-1!==e&&(this.playerList=this.playerList.concat(),this.playerList.splice(e,1))},i.prototype.$startTick=function(t,e){var i=this.getTickIndex(t,e);-1==i&&(this.concatTick(),this.callBackList.push(t),this.thisObjectList.push(e))},i.prototype.$stopTick=function(t,e){var i=this.getTickIndex(t,e);-1!=i&&(this.concatTick(),this.callBackList.splice(i,1),this.thisObjectList.splice(i,1))},i.prototype.getTickIndex=function(t,e){for(var i=this.callBackList,r=this.thisObjectList,n=i.length-1;n>=0;n--)if(i[n]==t&&r[n]==e)return n;return-1},i.prototype.concatTick=function(){this.callBackList=this.callBackList.concat(),this.thisObjectList=this.thisObjectList.concat()},i.prototype.$setFrameRate=function(t){return 0>=t?!1:this.$frameRate==t?!1:(this.$frameRate=t,t>60&&(t=60),this.frameDeltaTime=1e3/t,this.lastCount=this.frameInterval=Math.round(6e4/t),!0)},i.prototype.pause=function(){this.isPaused=!0},i.prototype.resume=function(){this.isPaused=!1},i.prototype.update=function(i){for(var r=t.getTimer(),n=this.callBackList,a=this.thisObjectList,o=n.length,s=e.$requestRenderingFlag,l=t.getTimer(),h=t.lifecycle.contexts,c=0,u=h;c<u.length;c++){var p=u[c];p.onUpdate&&p.onUpdate()}if(this.isPaused)return void(this.lastTimeStamp=l);this.callLaterAsyncs();for(var d=0;o>d;d++)n[d].call(a[d],l)&&(s=!0);var f=t.getTimer(),g=l-this.lastTimeStamp;if(this.lastTimeStamp=l,g>=this.frameDeltaTime||i)this.lastCount=this.frameInterval;else{if(this.lastCount-=1e3,this.lastCount>0)return void(s&&this.render(!1,this.costEnterFrame+f-r));this.lastCount+=this.frameInterval}this.render(!0,this.costEnterFrame+f-r);var m=t.getTimer();this.broadcastEnterFrame();var y=t.getTimer();this.costEnterFrame=y-m},i.prototype.render=function(t,i){var r=this.playerList,n=r.length;if(0!=n){this.callLaters(),e.$invalidateRenderFlag&&(this.broadcastRender(),e.$invalidateRenderFlag=!1);for(var a=0;n>a;a++)r[a].$render(t,i);e.$requestRenderingFlag=!1}},i.prototype.broadcastEnterFrame=function(){var e=t.DisplayObject.$enterFrameCallBackList,i=e.length;if(0!=i){e=e.concat();for(var r=0;i>r;r++)e[r].dispatchEventWith(t.Event.ENTER_FRAME)}},i.prototype.broadcastRender=function(){var e=t.DisplayObject.$renderCallBackList,i=e.length;if(0!=i){e=e.concat();for(var r=0;i>r;r++)e[r].dispatchEventWith(t.Event.RENDER)}},i.prototype.callLaters=function(){var e,i,r;if(t.$callLaterFunctionList.length>0&&(e=t.$callLaterFunctionList,t.$callLaterFunctionList=[],i=t.$callLaterThisList,t.$callLaterThisList=[],r=t.$callLaterArgsList,t.$callLaterArgsList=[]),e)for(var n=e.length,a=0;n>a;a++){var o=e[a];null!=o&&o.apply(i[a],r[a])}},i.prototype.callLaterAsyncs=function(){if(t.$callAsyncFunctionList.length>0){var e=t.$callAsyncFunctionList,i=t.$callAsyncThisList,r=t.$callAsyncArgsList;t.$callAsyncFunctionList=[],t.$callAsyncThisList=[],t.$callAsyncArgsList=[];for(var n=0;n<e.length;n++){var a=e[n];null!=a&&a.apply(i[n],r[n])}}},i}();e.SystemTicker=i,__reflect(i.prototype,"egret.sys.SystemTicker")}(e=t.sys||(t.sys={}))}(egret||(egret={})),function(t){var e;!function(e){function i(t){var i=new n;e.contexts.push(i),t(i)}e.contexts=[];var r=!0,n=function(){function i(){}return i.prototype.pause=function(){r&&(r=!1,e.stage.dispatchEvent(new t.Event(t.Event.DEACTIVATE)),e.onPause&&e.onPause())},i.prototype.resume=function(){r||(r=!0,e.stage.dispatchEvent(new t.Event(t.Event.ACTIVATE)),e.onResume&&e.onResume())},i}();e.LifecycleContext=n,__reflect(n.prototype,"egret.lifecycle.LifecycleContext"),e.addLifecycleListener=i}(e=t.lifecycle||(t.lifecycle={})),t.ticker=new t.sys.SystemTicker}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=function(e){function i(t){var i=e.call(this)||this;return i.maxTouches=0,i.useTouchesCount=0,i.touchDownTarget={},i.lastTouchX=-1,i.lastTouchY=-1,i.stage=t,i}return __extends(i,e),i.prototype.$initMaxTouches=function(){this.maxTouches=this.stage.$maxTouches},i.prototype.onTouchBegin=function(e,i,r){if(!(this.useTouchesCount>=this.maxTouches)){this.lastTouchX=e,this.lastTouchY=i;var n=this.findTarget(e,i);null==this.touchDownTarget[r]&&(this.touchDownTarget[r]=n,this.useTouchesCount++),t.TouchEvent.dispatchTouchEvent(n,t.TouchEvent.TOUCH_BEGIN,!0,!0,e,i,r,!0)}},i.prototype.onTouchMove=function(e,i,r){if(null!=this.touchDownTarget[r]&&(this.lastTouchX!=e||this.lastTouchY!=i)){this.lastTouchX=e,this.lastTouchY=i;var n=this.findTarget(e,i);t.TouchEvent.dispatchTouchEvent(n,t.TouchEvent.TOUCH_MOVE,!0,!0,e,i,r,!0)}},i.prototype.onTouchEnd=function(e,i,r){if(null!=this.touchDownTarget[r]){var n=this.findTarget(e,i),a=this.touchDownTarget[r];delete this.touchDownTarget[r],this.useTouchesCount--,t.TouchEvent.dispatchTouchEvent(n,t.TouchEvent.TOUCH_END,!0,!0,e,i,r,!1),a==n?t.TouchEvent.dispatchTouchEvent(n,t.TouchEvent.TOUCH_TAP,!0,!0,e,i,r,!1):t.TouchEvent.dispatchTouchEvent(a,t.TouchEvent.TOUCH_RELEASE_OUTSIDE,!0,!0,e,i,r,!1)}},i.prototype.findTarget=function(t,e){var i=this.stage.$hitTest(t,e);return i||(i=this.stage),i},i}(t.HashObject);e.TouchHandler=i,__reflect(i.prototype,"egret.sys.TouchHandler")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=function(e){function i(){var t=e.call(this)||this;return t.image=null,t.smoothing=!0,t.blendMode=null,t.alpha=0/0,t.filter=null,t.rotated=!1,t.type=1,t}return __extends(i,e),i.prototype.drawImage=function(t,e,i,r,n,a,o,s){this.drawData.push(t,e,i,r,n,a,o,s),this.renderCount++},i.prototype.cleanBeforeRender=function(){e.prototype.cleanBeforeRender.call(this),this.image=null,this.matrix=null,this.blendMode=null,this.alpha=0/0,this.filter=null},i.$updateTextureData=function(e,r,n,a,o,s,l,h,c,u,p,d,f,g,m,y){if(r){var v=t.$TextureScaleFactor;if(e.smoothing=y,e.image=r,e.imageWidth=f,e.imageHeight=g,m==t.BitmapFillMode.SCALE){var _=p/c*v,b=d/u*v;e.drawImage(n,a,o,s,_*l,b*h,_*o,b*s)}else if(m==t.BitmapFillMode.CLIP){var x=Math.min(c,p),T=Math.min(u,d),E=o*v,S=s*v;i.drawClipImage(e,v,n,a,E,S,l,h,x,T)}else for(var E=o*v,S=s*v,C=0;p>C;C+=c)for(var w=0;d>w;w+=u){var x=Math.min(p-C,c),T=Math.min(d-w,u);i.drawClipImage(e,v,n,a,E,S,l,h,x,T,C,w)}}},i.$updateTextureDataWithScale9Grid=function(e,i,r,n,a,o,s,l,h,c,u,p,d,f,g,m){e.smoothing=m,e.image=i,e.imageWidth=f,e.imageHeight=g;var y=o,v=s;p-=c-o*t.$TextureScaleFactor,d-=u-s*t.$TextureScaleFactor;var _=r.x-l,b=r.y-h,x=_/t.$TextureScaleFactor,T=b/t.$TextureScaleFactor,E=r.width/t.$TextureScaleFactor,S=r.height/t.$TextureScaleFactor;0==S&&(S=1,T>=v&&T--),0==E&&(E=1,x>=y&&x--);var C=n,w=C+x,P=w+E,D=y-x-E,A=a,I=A+T,M=I+S,$=v-T-S,O=D*t.$TextureScaleFactor,R=$*t.$TextureScaleFactor;if((x+D)*t.$TextureScaleFactor>p||(T+$)*t.$TextureScaleFactor>d)return void e.drawImage(n,a,o,s,l,h,p,d);var L=l,B=L+_,k=L+(p-O),N=p-_-O,F=h,G=F+b,U=F+d-R,V=d-b-R;T>0&&(x>0&&e.drawImage(C,A,x,T,L,F,_,b),E>0&&e.drawImage(w,A,E,T,B,F,N,b),D>0&&e.drawImage(P,A,D,T,k,F,O,b)),S>0&&(x>0&&e.drawImage(C,I,x,S,L,G,_,V),E>0&&e.drawImage(w,I,E,S,B,G,N,V),D>0&&e.drawImage(P,I,D,S,k,G,O,V)),$>0&&(x>0&&e.drawImage(C,M,x,$,L,U,_,R),E>0&&e.drawImage(w,M,E,$,B,U,N,R),D>0&&e.drawImage(P,M,D,$,k,U,O,R))},i.drawClipImage=function(t,e,i,r,n,a,o,s,l,h,c,u){void 0===c&&(c=0),void 0===u&&(u=0);var p=o+n-l;p>0&&(n-=p),p=s+a-h,p>0&&(a-=p),t.drawImage(i,r,n/e,a/e,c+o,u+s,n,a)},i}(e.RenderNode);e.BitmapNode=i,__reflect(i.prototype,"egret.sys.BitmapNode")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=["none","round","square"],r=["bevel","miter","round"],n=function(n){function a(){var t=n.call(this)||this;return t.dirtyRender=!0,t.type=3,t}return __extends(a,n),a.prototype.beginFill=function(t,i,r){void 0===i&&(i=1);var n=new e.FillPath;if(n.fillColor=t,n.fillAlpha=i,r){var a=this.drawData.lastIndexOf(r);this.drawData.splice(a,0,n)}else this.drawData.push(n);return this.renderCount++,n},a.prototype.beginGradientFill=function(i,r,n,a,o,s){var l=new t.Matrix;o?(l.a=819.2*o.a,l.b=819.2*o.b,l.c=819.2*o.c,l.d=819.2*o.d,l.tx=o.tx,l.ty=o.ty):(l.a=100,l.d=100);var h=new e.GradientFillPath;if(h.gradientType=i,h.colors=r,h.alphas=n,h.ratios=a,h.matrix=l,s){var c=this.drawData.lastIndexOf(s);this.drawData.splice(c,0,h)}else this.drawData.push(h);return this.renderCount++,h},a.prototype.lineStyle=function(n,a,o,s,l,h,c){void 0===o&&(o=1),void 0===h&&(h=3),void 0===c&&(c=[]),-1==i.indexOf(s)&&(s="round"),-1==r.indexOf(l)&&(l="round");var u=new e.StrokePath;return u.lineWidth=n,u.lineColor=a,u.lineAlpha=o,u.caps=s||t.CapsStyle.ROUND,u.joints=l,u.miterLimit=h,u.lineDash=c,this.drawData.push(u),this.renderCount++,u},a.prototype.clear=function(){this.drawData.length=0,this.dirtyRender=!0,this.renderCount=0},a.prototype.cleanBeforeRender=function(){},a.prototype.clean=function(){this.$texture&&(t.WebGLUtils.deleteWebGLTexture(this.$texture),this.$texture=null,this.dirtyRender=!0)},a}(e.RenderNode);e.GraphicsNode=n,__reflect(n.prototype,"egret.sys.GraphicsNode")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.type=4,e}return __extends(e,t),e.prototype.addNode=function(t){this.drawData.push(t)},e.prototype.cleanBeforeRender=function(){for(var t=this.drawData,e=t.length-1;e>=0;e--)t[e].cleanBeforeRender()},e.prototype.$getRenderCount=function(){for(var t=0,e=this.drawData,i=e.length-1;i>=0;i--)t+=e[i].$getRenderCount();return t},e}(t.RenderNode);t.GroupNode=e,__reflect(e.prototype,"egret.sys.GroupNode")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=function(e){function i(){var i=e.call(this)||this;return i.image=null,i.smoothing=!0,i.bounds=new t.Rectangle,i.blendMode=null,i.alpha=0/0,i.filter=null,i.rotated=!1,i.type=5,i.vertices=[],i.uvs=[],i.indices=[],i}return __extends(i,e),i.prototype.drawMesh=function(t,e,i,r,n,a,o,s){this.drawData.push(t,e,i,r,n,a,o,s),this.renderCount++},i.prototype.cleanBeforeRender=function(){e.prototype.cleanBeforeRender.call(this),this.image=null,this.matrix=null},i}(e.RenderNode);e.MeshNode=i,__reflect(i.prototype,"egret.sys.MeshNode")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.image=null,e.smoothing=!0,e.rotated=!1,e.type=6,e}return __extends(e,t),e.prototype.drawImage=function(t,e,i,r,n,a,o,s){var l=this;l.sourceX=t,l.sourceY=e,l.sourceW=i,l.sourceH=r,l.drawX=n,l.drawY=a,l.drawW=o,l.drawH=s,l.renderCount=1},e.prototype.cleanBeforeRender=function(){t.prototype.cleanBeforeRender.call(this),this.image=null},e}(t.RenderNode);t.NormalBitmapNode=e,__reflect(e.prototype,"egret.sys.NormalBitmapNode")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(i){var r=e.call(this,i)||this;return r._verticesDirty=!0,r._bounds=new t.Rectangle,r.$renderNode=new t.sys.MeshNode,r}return __extends(i,e),i.prototype.createNativeDisplayObject=function(){this.$nativeDisplayObject=new egret_native.NativeDisplayObject(12)},i.prototype.setBitmapDataToWasm=function(t){this.$nativeDisplayObject.setBitmapDataToMesh(t)},i.prototype.$updateRenderNode=function(){var e=this.$bitmapData;if(e){var i=(t.$TextureScaleFactor,this.$renderNode);i.smoothing=this.$smoothing,i.image=e,i.imageWidth=this.$sourceWidth,i.imageHeight=this.$sourceHeight;var r=isNaN(this.$explicitBitmapWidth)?this.$textureWidth:this.$explicitBitmapWidth,n=isNaN(this.$explicitBitmapHeight)?this.$textureHeight:this.$explicitBitmapHeight,a=r/this.$textureWidth,o=n/this.$textureHeight,s=this.$bitmapWidth,l=this.$bitmapHeight;i.drawMesh(this.$bitmapX,this.$bitmapY,s,l,this.$offsetX*a,this.$offsetY*o,a*s,o*l)}},i.prototype.$updateVertices=function(){var e=this;if(e._verticesDirty=!0,e.$renderDirty=!0,t.nativeRender){var i=this.$renderNode;this.$nativeDisplayObject.setDataToMesh(i.vertices,i.indices,i.uvs)}else{var r=e.$parent;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp());var n=e.$maskedObject;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp())}},i.prototype.$measureContentBounds=function(t){if(this._verticesDirty){this._verticesDirty=!1;var e=this.$renderNode,i=e.vertices;if(i.length){this._bounds.setTo(Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(var r=0,n=i.length;n>r;r+=2){var a=i[r],o=i[r+1];this._bounds.x>a&&(this._bounds.x=a),this._bounds.width<a&&(this._bounds.width=a),this._bounds.y>o&&(this._bounds.y=o),this._bounds.height<o&&(this._bounds.height=o)}this._bounds.width-=this._bounds.x,this._bounds.height-=this._bounds.y}else this._bounds.setTo(0,0,0,0);e.bounds.copyFrom(this._bounds)}t.copyFrom(this._bounds)},i}(t.Bitmap);t.Mesh=e,__reflect(e.prototype,"egret.Mesh")}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=function(e){function i(){var t=e.call(this)||this;return t.textColor=16777215,t.strokeColor=0,t.size=30,t.stroke=0,t.bold=!1,t.italic=!1,t.fontFamily="Arial",t.dirtyRender=!0,t.type=2,t}return __extends(i,e),i.prototype.drawText=function(t,e,i,r){this.drawData.push(t,e,i,r),this.renderCount++,this.dirtyRender=!0},i.prototype.clean=function(){this.$texture&&(t.WebGLUtils.deleteWebGLTexture(this.$texture),this.$texture=null,this.dirtyRender=!0)},i.prototype.cleanBeforeRender=function(){e.prototype.cleanBeforeRender.call(this),this.dirtyRender=!0},i}(e.RenderNode);e.TextNode=i,__reflect(i.prototype,"egret.sys.TextNode")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.type=1,e}return __extends(e,t),e}(t.Path2D);t.FillPath=e,__reflect(e.prototype,"egret.sys.FillPath")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.type=2,e}return __extends(e,t),e}(t.Path2D);t.GradientFillPath=e,__reflect(e.prototype,"egret.sys.GradientFillPath")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){t.OrientationMode={AUTO:"auto",PORTRAIT:"portrait",LANDSCAPE:"landscape",LANDSCAPE_FLIPPED:"landscapeFlipped"}}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.type=3,e}return __extends(e,t),e}(t.Path2D);t.StrokePath=e,__reflect(e.prototype,"egret.sys.StrokePath")}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){function e(t,e){var i=null==e.italic?t.italic:e.italic,r=null==e.bold?t.bold:e.bold,n=null==e.size?t.size:e.size,a=e.fontFamily||t.fontFamily,o=i?"italic ":"normal ";return o+=r?"bold ":"normal ",o+=n+"px "+a}function i(t,e){var i=t>>16,r=t>>8&255,n=255&t;return"rgba("+i+","+r+","+n+","+e+")"}function r(e,r,n,a,o,s){var l;l=r==t.GradientType.LINEAR?e.createLinearGradient(-1,0,1,0):e.createRadialGradient(0,0,0,0,0,1);for(var h=n.length,c=0;h>c;c++)l.addColorStop(o[c]/255,i(n[c],a[c]));return l}function n(t,e,i){void 0===i&&(i=0);for(var r=0,n=e.length;n>r;r++)t[r+i]=e[r]}function a(t,e,i,r){for(var n=r[0],a=r[1],o=r[2],s=r[3],l=r[4],h=r[5],c=r[6],u=r[7],p=r[8],d=r[9],f=r[10],g=r[11],m=r[12],y=r[13],v=r[14],_=r[15],b=r[16],x=r[17],T=r[18],E=r[19],S=0,C=e*i*4;C>S;S+=4){var w=t[S+0],P=t[S+1],D=t[S+2],A=t[S+3];t[S+0]=n*w+a*P+o*D+s*A+l,t[S+1]=h*w+c*P+u*D+p*A+d,t[S+2]=f*w+g*P+m*D+y*A+v,t[S+3]=_*w+b*P+x*D+T*A+E}}function o(t,e,i,r,n){s(t,e,i,r),l(t,e,i,n)}function s(t,e,i,r){var a;a=E?new Uint8ClampedArray(4*e):new Array(4*e);for(var o=4*e,s=2*r+1,l=0;i>l;l++){for(var h=l*o,c=0,u=0,p=0,d=0,f=0,g=0,m=4*-r,y=4*r+4;y>m;m+=4){var v=h+m;h>v||v>=h+o||(f=t[v+3],c+=t[v+0]*f,u+=t[v+1]*f,p+=t[v+2]*f,d+=f)}for(var m=h,y=h+o,_=0,b=m-4*r,x=m+4*(r+1);y>m;m+=4,_+=4,x+=4,b+=4)0===d?(a[_+0]=0,a[_+1]=0,a[_+2]=0,a[_+3]=0):(a[_+0]=c/d,a[_+1]=u/d,a[_+2]=p/d,a[_+3]=d/s),f=t[x+3],g=t[b+3],f||0==f?g||0==g?(c+=t[x+0]*f-t[b+0]*g,u+=t[x+1]*f-t[b+1]*g,p+=t[x+2]*f-t[b+2]*g,d+=f-g):(c+=t[x+0]*f,u+=t[x+1]*f,p+=t[x+2]*f,d+=f):(g||0==g)&&(c+=-t[b+0]*g,u+=-t[b+1]*g,p+=-t[b+2]*g,d+=-g);
E?t.set(a,h):n(t,a,h)}}function l(t,e,i,r){var n;n=E?new Uint8ClampedArray(4*i):new Array(4*i);for(var a=4*e,o=2*r+1,s=0;e>s;s++){for(var l=4*s,h=0,c=0,u=0,p=0,d=0,f=0,g=-r*a,m=r*a+a;m>g;g+=a){var y=l+g;l>y||y>=l+i*a||(d=t[y+3],h+=t[y+0]*d,c+=t[y+1]*d,u+=t[y+2]*d,p+=d)}for(var g=l,m=l+i*a,v=0,_=l-r*a,b=l+(r+1)*a;m>g;g+=a,v+=4,b+=a,_+=a)0===p?(n[v+0]=0,n[v+1]=0,n[v+2]=0,n[v+3]=0):(n[v+0]=h/p,n[v+1]=c/p,n[v+2]=u/p,n[v+3]=p/o),d=t[b+3],f=t[_+3],d||0==d?f||0==f?(h+=t[b+0]*d-t[_+0]*f,c+=t[b+1]*d-t[_+1]*f,u+=t[b+2]*d-t[_+2]*f,p+=d-f):(h+=t[b+0]*d,c+=t[b+1]*d,u+=t[b+2]*d,p+=d):(f||0==f)&&(h+=-t[_+0]*f,c+=-t[_+1]*f,u+=-t[_+2]*f,p+=-f);for(var x=4*s,m=x+i*a,T=0;m>x;x+=a,T+=4)t[x+0]=n[T+0],t[x+1]=n[T+1],t[x+2]=n[T+2],t[x+3]=n[T+3]}}function h(t,e,i,r,a,s,l,h,f){var g=c(t,r);u(g,e,i,l,h),o(g,e,i,a,s),p(g,f),d(g,t),t.set(g),E?t.set(g):n(t,g)}function c(t,e){e||(e=[0,0,0,0]);var i;E?i=new Uint8ClampedArray(t):(i=new Array(t.length),n(i,t));for(var r=e[0],a=e[1],o=e[2],s=e[3],l=0,h=i.length;h>l;l+=4){var c=i[l+3];i[l+0]=r*c,i[l+1]=a*c,i[l+2]=o*c,i[l+3]=s*c}return i}function u(t,e,i,r,a){var o,s,l=Math.sin(r)*a|0,h=Math.cos(r)*a|0;if(E){o=new Int32Array(t.buffer),s=new Int32Array(o.length);for(var c=0;i>c;c++){var u=c+l;if(!(0>u||u>i))for(var p=0;e>p;p++){var d=p+h;0>d||d>e||(s[u*e+d]=o[c*e+p])}}o.set(s)}else{o=t,s=new Array(o.length);for(var c=0;i>c;c++){var u=c+l;if(!(0>u||u>i))for(var p=0;e>p;p++){var d=p+h;0>d||d>e||(s[4*(u*e+d)+0]=o[4*(c*e+p)+0],s[4*(u*e+d)+1]=o[4*(c*e+p)+1],s[4*(u*e+d)+2]=o[4*(c*e+p)+2],s[4*(u*e+d)+3]=o[4*(c*e+p)+3])}}n(o,s)}}function p(t,e){for(var i=0,r=t.length;r>i;i+=4)t[i+3]*=e}function d(t,e){for(var i=0,r=t.length;r>i;i+=4){var n=t[i+0],a=t[i+1],o=t[i+2],s=t[i+3]/255,l=e[i+0],h=e[i+1],c=e[i+2],u=e[i+3]/255;t[i+0]=l+n*(1-u),t[i+1]=h+a*(1-u),t[i+2]=c+o*(1-u),t[i+3]=255*(u+s*(1-u))}}function f(t,e,i){return t*(1-i)+e*i}function g(t,e,i,r,a,o,s,l,h,c,u,p){var d;d=E?new Uint8ClampedArray(t.length):new Array(t.length);for(var g,m,y=r[3],v=0,_=0,b=l*Math.cos(s),x=l*Math.sin(s),T=7,S=12,C=3.141592653589793,w=a/T,P=o/T,D=0;e>D;D++)for(var A=0;i>A;A++){for(var I=0,M=A*e*4+4*D,$=0,O=0,R=t[M+0]/255,L=t[M+1]/255,B=t[M+2]/255,k=t[M+3]/255,N=0;2*C>=N;N+=2*C/S){g=Math.cos(N+I),m=Math.sin(N+I);for(var F=0;T>F;F++){v=F*w*g,_=F*P*m;var G=Math.round(D+v-b),U=Math.round(A+_-x),V=0;if(G>=e||0>G||0>U||U>=i)V=0;else{var H=U*e*4+4*G;V=t[H+3]/255}$+=(T-F)*V,O+=T-F}}k=Math.max(k,1e-4);var j=$/O*h*y*(1-c)*Math.max(Math.min(p,u),1-k),W=(O-$)/O*h*y*c*k;k=Math.max(k*u*(1-p),1e-4);var X=W/(W+k),z=f(R,r[0],X),Y=f(L,r[1],X),q=f(B,r[2],X),Q=j/(W+k+j),K=f(z,r[0],Q),J=f(Y,r[1],Q),Z=f(q,r[2],Q),te=Math.min(k+j+W,1);d[M+0]=255*K,d[M+1]=255*J,d[M+2]=255*Z,d[M+3]=255*te}E?t.set(d):n(t,d)}var m=["source-over","lighter","destination-out"],y="source-over",v="#000000",_={none:"butt",square:"square",round:"round"},b=[],x=[],T=function(){function n(){this.nestLevel=0,this.renderingMask=!1}return n.prototype.render=function(e,i,r,n){this.nestLevel++;var a=i.context;a.transform(r.a,r.b,r.c,r.d,0,0);var o=this.drawDisplayObject(e,a,r.tx,r.ty,!0),s=t.Matrix.create();if(r.$invertInto(s),a.transform(s.a,s.b,s.c,s.d,0,0),t.Matrix.release(s),this.nestLevel--,0===this.nestLevel){b.length>6&&(b.length=6);for(var l=b.length,h=0;l>h;h++)b[h].resize(0,0)}return o},n.prototype.drawDisplayObject=function(e,i,r,n,a){var o,s=0,l=e.$displayList;if(l&&!a?((e.$cacheDirty||e.$renderDirty||l.$canvasScaleX!=t.sys.DisplayList.$canvasScaleX||l.$canvasScaleY!=t.sys.DisplayList.$canvasScaleY)&&(s+=l.drawToSurface()),o=l.$renderNode):o=e.$renderDirty?e.$getRenderNode():e.$renderNode,e.$cacheDirty=!1,o){switch(s++,i.$offsetX=r,i.$offsetY=n,o.type){case 1:this.renderBitmap(o,i);break;case 2:this.renderText(o,i);break;case 3:this.renderGraphics(o,i);break;case 4:this.renderGroup(o,i);break;case 5:this.renderMesh(o,i);break;case 6:this.renderNormalBitmap(o,i)}i.$offsetX=0,i.$offsetY=0}if(l&&!a)return s;var h=e.$children;if(h)for(var c=h.length,u=0;c>u;u++){var p=h[u],d=void 0,f=void 0;if(p.$useTranslate){var g=p.$getMatrix();d=r+p.$x,f=n+p.$y,i.save(),i.transform(g.a,g.b,g.c,g.d,d,f),d=-p.$anchorOffsetX,f=-p.$anchorOffsetY}else d=r+p.$x-p.$anchorOffsetX,f=n+p.$y-p.$anchorOffsetY;var m=void 0;switch(1!=p.$alpha&&(m=i.globalAlpha,i.globalAlpha*=p.$alpha),p.$renderMode){case 1:break;case 2:s+=this.drawWithFilter(p,i,d,f);break;case 3:s+=this.drawWithClip(p,i,d,f);break;case 4:s+=this.drawWithScrollRect(p,i,d,f);break;default:s+=this.drawDisplayObject(p,i,d,f)}p.$useTranslate?i.restore():m&&(i.globalAlpha=m)}return s},n.prototype.drawWithFilter=function(t,e,i,r){if(t.$children&&0==t.$children.length&&(!t.$renderNode||0==t.$renderNode.$getRenderCount()))return 0;var n,s=0,l=t.$filters,c=l.length,u=0!==t.$blendMode;u&&(n=m[t.$blendMode],n||(n=y));var p=t.$getOriginalBounds(),d=p.x,f=p.y,v=p.width,_=p.height;if(0>=v||0>=_)return s;var b=this.createRenderBuffer(v-d,_-f,!0),T=b.context;if(s+=t.$mask?this.drawWithClip(t,T,-d,-f):t.$scrollRect||t.$maskRect?this.drawWithScrollRect(t,T,-d,-f):this.drawDisplayObject(t,T,-d,-f),s>0){u&&(e.globalCompositeOperation=n),s++;for(var E=T.getImageData(0,0,b.surface.width,b.surface.height),S=0;c>S;S++){var C=l[S];if("colorTransform"==C.type)a(E.data,b.surface.width,b.surface.height,C.$matrix);else if("blur"==C.type)o(E.data,b.surface.width,b.surface.height,C.$blurX,C.$blurY);else if("glow"==C.type){var w=C.$red,P=C.$green,D=C.$blue,A=C.$alpha;C.$inner||C.$knockout||C.$hideObject?g(E.data,b.surface.width,b.surface.height,[w/255,P/255,D/255,A],C.$blurX,C.$blurY,C.$angle?C.$angle/180*Math.PI:0,C.$distance||0,C.$strength,C.$inner?1:0,C.$knockout?0:1,C.$hideObject?1:0):h(E.data,b.surface.width,b.surface.height,[w/255,P/255,D/255,A],C.$blurX,C.$blurY,C.$angle?C.$angle/180*Math.PI:0,C.$distance||0,C.$strength)}else"custom"==C.type}T.putImageData(E,0,0),e.drawImage(b.surface,i+d,r+f),u&&(e.globalCompositeOperation=y)}return x.push(b),s},n.prototype.drawWithClip=function(e,i,r,n){var a,o=0,s=0!==e.$blendMode;s&&(a=m[e.$blendMode],a||(a=y));var l=e.$scrollRect?e.$scrollRect:e.$maskRect,h=e.$mask;if(h){var c=h.$getMatrix();if(0==c.a&&0==c.b||0==c.c&&0==c.d)return o}if(!(h||e.$children&&0!=e.$children.length))return l&&(i.save(),i.beginPath(),i.rect(l.x+r,l.y+n,l.width,l.height),i.clip()),s&&(i.globalCompositeOperation=a),o+=this.drawDisplayObject(e,i,r,n),s&&(i.globalCompositeOperation=y),l&&i.restore(),o;if(h){var u=h.$getRenderNode();if((!h.$children||0==h.$children.length)&&u&&3==u.type&&1==u.drawData.length&&1==u.drawData[0].type&&1==u.drawData[0].fillAlpha){this.renderingMask=!0,i.save();var p=t.Matrix.create();p.copyFrom(h.$getConcatenatedMatrix()),h.$getConcatenatedMatrixAt(e,p),p.prepend(1,0,0,1,r,n),i.transform(p.a,p.b,p.c,p.d,p.tx,p.ty);var d=this.drawDisplayObject(h,i,0,0);return this.renderingMask=!1,p.$invertInto(p),i.transform(p.a,p.b,p.c,p.d,p.tx,p.ty),t.Matrix.release(p),l&&(i.beginPath(),i.rect(l.x+r,l.y+n,l.width,l.height),i.clip()),d+=this.drawDisplayObject(e,i,r,n),i.restore(),d}}var f=e.$getOriginalBounds(),g=f.x,v=f.y,_=f.width,x=f.height;if(0>=_||0>=x)return o;var T=this.createRenderBuffer(_,x),E=T.context;if(!E)return o+=this.drawDisplayObject(e,i,r,n);if(o+=this.drawDisplayObject(e,E,-g,-v),h){var u=h.$getRenderNode(),p=t.Matrix.create();if(p.copyFrom(h.$getConcatenatedMatrix()),h.$getConcatenatedMatrixAt(e,p),p.translate(-g,-v),u&&1==u.$getRenderCount()||h.$displayList)E.globalCompositeOperation="destination-in",E.save(),E.setTransform(p.a,p.b,p.c,p.d,p.tx,p.ty),o+=this.drawDisplayObject(h,E,0,0),E.restore();else{var S=this.createRenderBuffer(_,x),C=S.context;C.setTransform(p.a,p.b,p.c,p.d,p.tx,p.ty),o+=this.drawDisplayObject(h,C,0,0),E.globalCompositeOperation="destination-in",E.drawImage(S.surface,0,0),b.push(S)}t.Matrix.release(p)}return o>0&&(o++,s&&(i.globalCompositeOperation=a),l&&(i.save(),i.beginPath(),i.rect(l.x+r,l.y+n,l.width,l.height),i.clip()),i.drawImage(T.surface,r+g,n+v),l&&i.restore(),s&&(i.globalCompositeOperation=y)),b.push(T),o},n.prototype.drawWithScrollRect=function(t,e,i,r){var n=0,a=t.$scrollRect?t.$scrollRect:t.$maskRect;return a.isEmpty()?n:(t.$scrollRect&&(i-=a.x,r-=a.y),e.save(),e.beginPath(),e.rect(a.x+i,a.y+r,a.width,a.height),e.clip(),n+=this.drawDisplayObject(t,e,i,r),e.restore(),n)},n.prototype.drawNodeToBuffer=function(t,e,i,r){var n=e.context;n.setTransform(i.a,i.b,i.c,i.d,i.tx,i.ty),this.renderNode(t,n,r)},n.prototype.drawDisplayToBuffer=function(t,e,i){var r=e.context;i&&r.setTransform(i.a,i.b,i.c,i.d,i.tx,i.ty);var n;n=t.$renderDirty?t.$getRenderNode():t.$renderNode;var a=0;if(n)switch(a++,n.type){case 1:this.renderBitmap(n,r);break;case 2:this.renderText(n,r);break;case 3:this.renderGraphics(n,r);break;case 4:this.renderGroup(n,r);break;case 5:this.renderMesh(n,r);break;case 6:this.renderNormalBitmap(n,r)}var o=t.$children;if(o)for(var s=o.length,l=0;s>l;l++){var h=o[l];switch(h.$renderMode){case 1:break;case 2:a+=this.drawWithFilter(h,r,0,0);break;case 3:a+=this.drawWithClip(h,r,0,0);break;case 4:a+=this.drawWithScrollRect(h,r,0,0);break;default:a+=this.drawDisplayObject(h,r,0,0)}}return a},n.prototype.renderNode=function(t,e,i){var r=0;switch(t.type){case 1:r=this.renderBitmap(t,e);break;case 2:r=1,this.renderText(t,e);break;case 3:r=this.renderGraphics(t,e,i);break;case 4:r=this.renderGroup(t,e);break;case 5:r=this.renderMesh(t,e);break;case 6:r+=this.renderNormalBitmap(t,e)}return r},n.prototype.renderNormalBitmap=function(t,e){var i=t.image;if(!i||!i.source)return 0;if(e.$imageSmoothingEnabled!=t.smoothing&&(e.imageSmoothingEnabled=t.smoothing,e.$imageSmoothingEnabled=t.smoothing),t.rotated){var r=t.sourceX,n=t.sourceY,a=t.sourceW,o=t.sourceH,s=t.drawX,l=t.drawY,h=t.drawW,c=t.drawH;e.save(),e.transform(0,-1,1,0,0,c),e.drawImage(i.source,r,n,o,a,s+e.$offsetX,l+e.$offsetY,c,h),e.restore()}else e.drawImage(i.source,t.sourceX,t.sourceY,t.sourceW,t.sourceH,t.drawX+e.$offsetX,t.drawY+e.$offsetY,t.drawW,t.drawH);return 1},n.prototype.renderBitmap=function(t,e){var i=t.image;if(!i||!i.source)return 0;e.$imageSmoothingEnabled!=t.smoothing&&(e.imageSmoothingEnabled=t.smoothing,e.$imageSmoothingEnabled=t.smoothing);var r,n,o=t.drawData,s=o.length,l=0,h=t.matrix,c=t.blendMode,u=t.alpha,p=!1;h&&(e.save(),p=!0,(0!=e.$offsetX||0!=e.$offsetY)&&(e.translate(e.$offsetX,e.$offsetY),r=e.$offsetX,n=e.$offsetY,e.$offsetX=e.$offsetY=0),e.transform(h.a,h.b,h.c,h.d,h.tx,h.ty)),c&&(e.globalCompositeOperation=m[c]);var d;u==u&&(d=e.globalAlpha,e.globalAlpha*=u);var f=0,g=t.filter;if(g&&8==s){var v=o[0],_=o[1],x=o[2],T=o[3],E=o[4],S=o[5],C=o[6],w=o[7];t.rotated&&(x=o[3],T=o[2],C=o[7],w=o[6]);var P=this.createRenderBuffer(C,w),D=P.context;f++,t.rotated&&e.transform(0,-1,1,0,0,C),D.drawImage(i.source,v,_,x,T,0,0,C,w),f++;var A=D.getImageData(0,0,C,w);a(A.data,C,w,g.$matrix),D.putImageData(A,0,0),e.drawImage(P.surface,0,0,C,w,E+e.$offsetX,S+e.$offsetY,C,w),b.push(P)}else for(;s>l;)if(f++,t.rotated){var v=o[l++],_=o[l++],T=o[l++],x=o[l++],I=o[l++],M=o[l++],w=o[l++],C=o[l++];e.save(),e.transform(0,-1,1,0,0,C),e.drawImage(i.source,v,_,x,T,I+e.$offsetX,M+e.$offsetY,C,w),e.restore()}else e.drawImage(i.source,o[l++],o[l++],o[l++],o[l++],o[l++]+e.$offsetX,o[l++]+e.$offsetY,o[l++],o[l++]);return p?e.restore():(c&&(e.globalCompositeOperation=y),u==u&&(e.globalAlpha=d)),r&&(e.$offsetX=r),n&&(e.$offsetY=n),f},n.prototype.renderMesh=function(t,e){return 0},n.prototype.renderText=function(i,r){r.textAlign="left",r.textBaseline="middle",r.lineJoin="round";for(var n=i.drawData,a=n.length,o=0;a>o;){var s=n[o++],l=n[o++],h=n[o++],c=n[o++];r.font=e(i,c);var u=null==c.textColor?i.textColor:c.textColor,p=null==c.strokeColor?i.strokeColor:c.strokeColor,d=null==c.stroke?i.stroke:c.stroke;r.fillStyle=t.toColorString(u),r.strokeStyle=t.toColorString(p),d&&(r.lineWidth=2*d,r.strokeText(h,s+r.$offsetX,l+r.$offsetY)),r.fillText(h,s+r.$offsetX,l+r.$offsetY)}},n.prototype.renderGraphics=function(t,e,n){var a=t.drawData,o=a.length;n=!!n;for(var s=0;o>s;s++){var l=a[s];switch(l.type){case 1:var h=l;e.fillStyle=n?v:i(h.fillColor,h.fillAlpha),this.renderPath(l,e),this.renderingMask?e.clip():e.fill();break;case 2:var c=l;e.fillStyle=n?v:r(e,c.gradientType,c.colors,c.alphas,c.ratios,c.matrix),e.save();var u=c.matrix;this.renderPath(l,e),e.transform(u.a,u.b,u.c,u.d,u.tx,u.ty),e.fill(),e.restore();break;case 3:var p=l,d=p.lineWidth;e.lineWidth=d,e.strokeStyle=n?v:i(p.lineColor,p.lineAlpha),e.lineCap=_[p.caps],e.lineJoin=p.joints,e.miterLimit=p.miterLimit,e.setLineDash&&e.setLineDash(p.lineDash);var f=1===d||3===d;f&&e.translate(.5,.5),this.renderPath(l,e),e.stroke(),f&&e.translate(-.5,-.5)}}return 0==o?0:1},n.prototype.renderPath=function(t,e){e.beginPath();for(var i=t.$data,r=t.$commands,n=r.length,a=0,o=0;n>o;o++){var s=r[o];switch(s){case 4:e.bezierCurveTo(i[a++]+e.$offsetX,i[a++]+e.$offsetY,i[a++]+e.$offsetX,i[a++]+e.$offsetY,i[a++]+e.$offsetX,i[a++]+e.$offsetY);break;case 3:e.quadraticCurveTo(i[a++]+e.$offsetX,i[a++]+e.$offsetY,i[a++]+e.$offsetX,i[a++]+e.$offsetY);break;case 2:e.lineTo(i[a++]+e.$offsetX,i[a++]+e.$offsetY);break;case 1:e.moveTo(i[a++]+e.$offsetX,i[a++]+e.$offsetY)}}},n.prototype.renderGroup=function(t,e){var i,r,n=t.matrix,a=!1;n&&(e.save(),a=!0,(0!=e.$offsetX||0!=e.$offsetY)&&(e.translate(e.$offsetX,e.$offsetY),i=e.$offsetX,r=e.$offsetY,e.$offsetX=e.$offsetY=0),e.transform(n.a,n.b,n.c,n.d,n.tx,n.ty));for(var o=0,s=t.drawData,l=s.length,h=0;l>h;h++){var c=s[h];o+=this.renderNode(c,e)}return a&&e.restore(),i&&(e.$offsetX=i),r&&(e.$offsetY=r),o},n.prototype.createRenderBuffer=function(e,i,r){var n=r?x.pop():b.pop();return n?n.resize(e,i,!0):n=new t.sys.CanvasRenderBuffer(e,i),n},n}();t.CanvasRenderer=T,__reflect(T.prototype,"egret.CanvasRenderer"),t.getFontString=e,t.getRGBAString=i;var E=!1;try{E=void 0!==typeof Uint8ClampedArray}catch(S){}}(egret||(egret={}));var egret;!function(t){t.DeviceOrientation=null}(egret||(egret={}));var egret;!function(t){}(egret||(egret={}));var egret;!function(t){}(egret||(egret={})),egret.DisplayObject.prototype.pos=function(t,e){return null!=t&&void 0!=t&&this.$setX(t),null!=e&&void 0!=e&&this.$setY(e),this},egret.DisplayObject.prototype.setWH=function(t,e){return null!=t&&void 0!=t&&this.$setWidth(t),null!=e&&void 0!=e&&this.$setHeight(e),this},egret.DisplayObject.prototype.scale=function(t,e){return null!=t&&void 0!=t&&this.$setScaleX(t),null!=e&&void 0!=e&&this.$setScaleY(e),this},egret.DisplayObject.prototype.anchorPercent=function(t,e){var i=this;null!=t&&void 0!=t&&(i.$anchorPercentX=t),null!=e&&void 0!=e&&(i.$anchorPercentY=e);var r=!0,n=function(t,e){!t&&(t=0),!e&&(e=0);var n=i.width*t,a=i.height*e;r&&(i.x+=n-i.$anchorOffsetX,i.y+=a-i.$anchorOffsetY,r=!1),i.anchorOffset(n,a)};if(egret.callLater(function(){n(i.$anchorPercentX,i.$anchorPercentY)},this),!i.hasEventListener(egret.Event.RESIZE)){var a=function(){i.removeEventListener(egret.Event.RESIZE,o,i)},o=function(){n(i.$anchorPercentX,i.$anchorPercentY)};i.once(egret.Event.REMOVED_FROM_STAGE,a,i),i.addEventListener(egret.Event.RESIZE,o,i)}return this},egret.DisplayObject.prototype.anchorOffset=function(t,e){return null!=t&&void 0!=t&&this.$setAnchorOffsetX(t),null!=e&&void 0!=e&&this.$setAnchorOffsetY(e),this},egret.DisplayObject.prototype.skew=function(t,e){return null!=t&&void 0!=t&&this.$setSkewX(t),null!=e&&void 0!=e&&this.$setSkewY(e),this},egret.DisplayObject.prototype.removeSelf=function(){return this&&this.parent&&this.parent.removeChild(this),this},Object.defineProperty(egret.DisplayObject.prototype,"anchorPercentX",{get:function(){return this.$anchorPercentX?this.$anchorPercentX:0},set:function(t){this.$anchorPercentX=t,this.anchorPercent(t,this.$anchorPercentY)},enumerable:!0,configurable:!0}),Object.defineProperty(egret.DisplayObject.prototype,"anchorPercentY",{get:function(){return this.$anchorPercentY?this.$anchorPercentY:0},set:function(t){this.$anchoPercentY=t,this.anchorPercent(this.$anchorPercentX,t)},enumerable:!0,configurable:!0});var egret;!function(t){var e;!function(t){t.WEB="web",t.NATIVE="native",t.RUNTIME2="runtime2",t.MYGAME="mygame",t.WXGAME="wxgame",t.BAIDUGAME="baidugame",t.QGAME="qgame",t.OPPOGAME="oppogame",t.QQGAME="qqgame",t.VIVOGAME="vivogame"}(e=t.RuntimeType||(t.RuntimeType={}));var i=function(){function e(){}return e.language="zh-CN",e.os="Unknown",e.runtimeType=t.RuntimeType.WEB,e.engineVersion="5.2.29",e.renderMode="Unknown",e.boundingClientWidth=0,e.boundingClientHeight=0,e}();t.Capabilities=i,__reflect(i.prototype,"egret.Capabilities")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(){var i=e.call(this)||this;i.$renderBuffer=new t.sys.RenderBuffer;var r=new t.BitmapData(i.$renderBuffer.surface);return r.$deleteSource=!1,i._setBitmapData(r),i}return __extends(i,e),i.prototype.drawToTexture=function(e,i,r){if(void 0===r&&(r=1),i&&(0==i.width||0==i.height))return!1;var n=i||e.$getOriginalBounds();if(0==n.width||0==n.height)return!1;r/=t.$TextureScaleFactor;var a=(n.x+n.width)*r,o=(n.y+n.height)*r;i&&(a=n.width*r,o=n.height*r);var s=this.$renderBuffer;if(!s)return!1;if(s.resize(a,o),this.$bitmapData.width=a,this.$bitmapData.height=o,t.nativeRender){egret_native.activateBuffer(this.$renderBuffer);var l=!1,h=0,c=0,u=0,p=0;i&&(l=!0,h=i.x,c=i.y,u=i.width,p=i.height),egret_native.updateNativeRender(),egret_native.nrRenderDisplayObject(e.$nativeDisplayObject.id,r,l,h,c,u,p),egret_native.activateBuffer(null)}else{var d=t.Matrix.create();d.identity(),d.scale(r,r),i&&d.translate(-i.x,-i.y),t.sys.systemRenderer.render(e,s,d,!0),t.Matrix.release(d)}return this.$initData(0,0,a,o,0,0,a,o,a,o),!0},i.prototype.getPixel32=function(e,i){var r;if(this.$renderBuffer){var n=t.$TextureScaleFactor;e=Math.round(e/n),i=Math.round(i/n),r=this.$renderBuffer.getPixels(e,i,1,1)}return r},i.prototype.dispose=function(){e.prototype.dispose.call(this),this.$renderBuffer=null},i}(t.Texture);t.RenderTexture=e,__reflect(e.prototype,"egret.RenderTexture")}(egret||(egret={}));var egret;!function(t){function e(t,e){r[t]=e}function i(t){return r[t]}var r={};t.registerImplementation=e,t.getImplementation=i}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.$graphics=new t.Graphics,i.$graphics.$setTarget(i),i}return __extends(i,e),i.prototype.createNativeDisplayObject=function(){this.$nativeDisplayObject=new egret_native.NativeDisplayObject(8)},Object.defineProperty(i.prototype,"graphics",{get:function(){return this.$graphics},enumerable:!0,configurable:!0}),i.prototype.$measureContentBounds=function(t){this.$graphics.$measureContentBounds(t)},i.prototype.$hitTest=function(t,i){var r=e.prototype.$hitTest.call(this,t,i);return r==this&&(r=this.$graphics.$hitTest(t,i)),r},i.prototype.$onRemoveFromStage=function(){e.prototype.$onRemoveFromStage.call(this),this.$graphics&&this.$graphics.$onRemoveFromStage()},i}(t.DisplayObject);t.Shape=e,__reflect(e.prototype,"egret.Shape")}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(e,i){var r=t.call(this,e)||this;return r.firstCharHeight=0,"string"==typeof i?r.charList=r.parseConfig(i):i&&i.hasOwnProperty("frames")?r.charList=i.frames:r.charList={},r}return __extends(e,t),e.prototype.getTexture=function(t){var e=this._textureMap[t];if(!e){var i=this.charList[t];if(!i)return null;e=this.createTexture(t,i.x,i.y,i.w,i.h,i.offX,i.offY,i.sourceW,i.sourceH),this._textureMap[t]=e}return e},e.prototype.getConfig=function(t,e){return this.charList[t]?this.charList[t][e]:0},e.prototype._getFirstCharHeight=function(){if(0==this.firstCharHeight)for(var t in this.charList){var e=this.charList[t];if(e){var i=e.sourceH;if(void 0===i){var r=e.h;void 0===r&&(r=0);var n=e.offY;void 0===n&&(n=0),i=r+n}if(0>=i)continue;this.firstCharHeight=i;break}}return this.firstCharHeight},e.prototype.parseConfig=function(t){t=t.split("\r\n").join("\n");for(var e=t.split("\n"),i=this.getConfigByKey(e[3],"count"),r={},n=4;4+i>n;n++){var a=e[n],o=String.fromCharCode(this.getConfigByKey(a,"id")),s={};r[o]=s,s.x=this.getConfigByKey(a,"x"),s.y=this.getConfigByKey(a,"y"),s.w=this.getConfigByKey(a,"width"),s.h=this.getConfigByKey(a,"height"),s.offX=this.getConfigByKey(a,"xoffset"),s.offY=this.getConfigByKey(a,"yoffset"),s.xadvance=this.getConfigByKey(a,"xadvance")}return r},e.prototype.getConfigByKey=function(t,e){for(var i=t.split(" "),r=0,n=i.length;n>r;r++){var a=i[r];if(e==a.substring(0,e.length)){var o=a.substring(e.length+1);return parseInt(o)}}return 0},e}(t.SpriteSheet);t.BitmapFont=e,__reflect(e.prototype,"egret.BitmapFont")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.$smoothing=t.Bitmap.defaultSmoothing,i.$text="",i.$textFieldWidth=0/0,i.$textLinesChanged=!1,i.$textFieldHeight=0/0,i.$font=null,i.$fontStringChanged=!1,i.$lineSpacing=0,i.$letterSpacing=0,i.$textAlign=t.HorizontalAlign.LEFT,i.$verticalAlign=t.VerticalAlign.TOP,i.$textWidth=0/0,i.$textHeight=0/0,i.$textOffsetX=0,i.$textOffsetY=0,i.$textStartX=0,i.$textStartY=0,i.textLines=[],i.$lineHeights=[],t.nativeRender||(i.$renderNode=new t.sys.BitmapNode),i}return __extends(i,e),i.prototype.createNativeDisplayObject=function(){this.$nativeDisplayObject=new egret_native.NativeDisplayObject(11)},Object.defineProperty(i.prototype,"smoothing",{get:function(){return this.$smoothing},set:function(e){var i=this;if(e!=i.$smoothing&&(i.$smoothing=e,!t.nativeRender)){var r=i.$parent;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp());var n=i.$maskedObject;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp())}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"text",{get:function(){return this.$text},set:function(t){this.$setText(t)},enumerable:!0,configurable:!0}),i.prototype.$setText=function(t){t=null==t?"":String(t);var e=this;return t==e.$text?!1:(e.$text=t,e.$invalidateContentBounds(),!0)},i.prototype.$getWidth=function(){var t=this,e=t.$textFieldWidth;return isNaN(e)?t.$getContentBounds().width:e},i.prototype.$setWidth=function(t){var e=this;return 0>t||t==e.$textFieldWidth?!1:(e.$textFieldWidth=t,e.$invalidateContentBounds(),!0)},i.prototype.$invalidateContentBounds=function(){this.$renderDirty=!0,this.$textLinesChanged=!0,this.$updateRenderNode()},i.prototype.$getHeight=function(){var t=this,e=t.$textFieldHeight;return isNaN(e)?t.$getContentBounds().height:e},i.prototype.$setHeight=function(t){var e=this;return 0>t||t==e.$textFieldHeight?!1:(e.$textFieldHeight=t,e.$invalidateContentBounds(),!0)},Object.defineProperty(i.prototype,"font",{get:function(){return this.$font},set:function(t){this.$setFont(t)},enumerable:!0,configurable:!0}),i.prototype.$setFont=function(t){var e=this;return e.$font==t?!1:(e.$font=t,e.$fontStringChanged=!0,this.$invalidateContentBounds(),!0)},Object.defineProperty(i.prototype,"lineSpacing",{get:function(){return this.$lineSpacing},set:function(t){this.$setLineSpacing(t)},enumerable:!0,configurable:!0}),i.prototype.$setLineSpacing=function(t){var e=this;return e.$lineSpacing==t?!1:(e.$lineSpacing=t,e.$invalidateContentBounds(),!0)},Object.defineProperty(i.prototype,"letterSpacing",{get:function(){return this.$letterSpacing},set:function(t){this.$setLetterSpacing(t)},enumerable:!0,configurable:!0}),i.prototype.$setLetterSpacing=function(t){var e=this;return e.$letterSpacing==t?!1:(e.$letterSpacing=t,e.$invalidateContentBounds(),!0)},Object.defineProperty(i.prototype,"textAlign",{get:function(){return this.$textAlign},set:function(t){this.$setTextAlign(t)},enumerable:!0,configurable:!0}),i.prototype.$setTextAlign=function(t){var e=this;return e.$textAlign==t?!1:(e.$textAlign=t,e.$invalidateContentBounds(),!0)},Object.defineProperty(i.prototype,"verticalAlign",{get:function(){return this.$verticalAlign},set:function(t){this.$setVerticalAlign(t)},enumerable:!0,configurable:!0}),i.prototype.$setVerticalAlign=function(t){var e=this;return e.$verticalAlign==t?!1:(e.$verticalAlign=t,e.$invalidateContentBounds(),!0)},i.prototype.$updateRenderNode=function(){var e=this,r=this.$getTextLines(),n=r.length;if(0==n)return void(t.nativeRender&&e.$font&&(e.$nativeDisplayObject.setDataToBitmapNode(e.$nativeDisplayObject.id,e.$font.$texture,[]),e.$nativeDisplayObject.setWidth(0),e.$nativeDisplayObject.setHeight(0)));var a,o=[],s=this.$textLinesWidth,l=e.$font;t.nativeRender||(a=this.$renderNode,l.$texture&&(a.image=l.$texture.$bitmapData),a.smoothing=e.$smoothing);for(var h=l._getFirstCharHeight(),c=Math.ceil(h*i.EMPTY_FACTOR),u=!isNaN(e.$textFieldHeight),p=e.$textWidth,d=e.$textFieldWidth,f=e.$textFieldHeight,g=e.$textAlign,m=this.$textOffsetY+this.$textStartY,y=this.$lineHeights,v=0;n>v;v++){var _=y[v];if(u&&v>0&&m+_>f)break;var b=r[v],x=b.length,T=this.$textOffsetX;if(g!=t.HorizontalAlign.LEFT){var E=d>p?d:p;g==t.HorizontalAlign.RIGHT?T+=E-s[v]:g==t.HorizontalAlign.CENTER&&(T+=Math.floor((E-s[v])/2))}for(var S=0;x>S;S++){var C=b.charAt(S),w=l.getTexture(C);if(w){var P=w.$bitmapWidth,D=w.$bitmapHeight;t.nativeRender?o.push(w.$bitmapX,w.$bitmapY,P,D,T+w.$offsetX,m+w.$offsetY,w.$getScaleBitmapWidth(),w.$getScaleBitmapHeight(),w.$sourceWidth,w.$sourceHeight):(a.imageWidth=w.$sourceWidth,a.imageHeight=w.$sourceHeight,a.drawImage(w.$bitmapX,w.$bitmapY,P,D,T+w.$offsetX,m+w.$offsetY,w.$getScaleBitmapWidth(),w.$getScaleBitmapHeight())),T+=(l.getConfig(C,"xadvance")||w.$getTextureWidth())+e.$letterSpacing}else" "==C?T+=c:t.$warn(1046,C)}m+=_+e.$lineSpacing}if(t.nativeRender){e.$nativeDisplayObject.setDataToBitmapNode(e.$nativeDisplayObject.id,l.$texture,o);var A=e.$getContentBounds();e.$nativeDisplayObject.setWidth(A.width),e.$nativeDisplayObject.setHeight(A.height)}},i.prototype.$measureContentBounds=function(t){var e=this.$getTextLines();0==e.length?t.setEmpty():t.setTo(this.$textOffsetX+this.$textStartX,this.$textOffsetY+this.$textStartY,this.$textWidth-this.$textOffsetX,this.$textHeight-this.$textOffsetY)},Object.defineProperty(i.prototype,"textWidth",{get:function(){return this.$getTextLines(),this.$textWidth},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"textHeight",{get:function(){return this.$getTextLines(),this.$textHeight},enumerable:!0,configurable:!0}),i.prototype.$getTextLines=function(){function e(t){return _&&n.length>0&&f>_?!1:(f+=h+u,s||l||(c-=p),n.push(t),o.push(h),a.push(c),d=Math.max(c,d),!0)}var r=this;if(!r.$textLinesChanged)return r.textLines;var n=[];r.textLines=n;var a=[];r.$textLinesWidth=a,r.$textLinesChanged=!1;var o=[];if(r.$lineHeights=o,!r.$text||!r.$font)return r.$textWidth=0,r.$textHeight=0,n;for(var s,l,h,c,u=r.$lineSpacing,p=r.$letterSpacing,d=0,f=0,g=0,m=0,y=!isNaN(r.$textFieldWidth),v=r.$textFieldWidth,_=r.$textFieldHeight,b=r.$font,x=b._getFirstCharHeight(),T=Math.ceil(x*i.EMPTY_FACTOR),E=r.$text,S=E.split(/(?:\r\n|\r|\n)/),C=S.length,w=!0,P=0;C>P;P++){var D=S[P],A=D.length;h=0,c=0,s=!0,l=!1;for(var I=0;A>I;I++){s||(c+=p);var M=D.charAt(I),$=void 0,O=void 0,R=0,L=0,B=b.getTexture(M);if(B)$=B.$getTextureWidth(),O=B.$getTextureHeight(),R=B.$offsetX,L=B.$offsetY;else{if(" "!=M){t.$warn(1046,M),s&&(s=!1);continue}$=T,O=x}if(s&&(s=!1),w&&(w=!1),y&&I>0&&c+$>v){if(!e(D.substring(0,I)))break;D=D.substring(I),A=D.length,I=0,c=I==A-1?$:b.getConfig(M,"xadvance")||$,h=O}else c+=I==A-1?$:b.getConfig(M,"xadvance")||$,h=Math.max(O,h)}if(_&&P>0&&f>_)break;if(l=!0,!e(D))break}f-=u,r.$textWidth=d,r.$textHeight=f,this.$textOffsetX=g,this.$textOffsetY=m,this.$textStartX=0,this.$textStartY=0;var k;return v>d&&(k=r.$textAlign,k==t.HorizontalAlign.RIGHT?this.$textStartX=v-d:k==t.HorizontalAlign.CENTER&&(this.$textStartX=Math.floor((v-d)/2))),_>f&&(k=r.$verticalAlign,k==t.VerticalAlign.BOTTOM?this.$textStartY=_-f:k==t.VerticalAlign.MIDDLE&&(this.$textStartY=Math.floor((_-f)/2))),n},i.EMPTY_FACTOR=.33,i}(t.DisplayObject);t.BitmapText=e,__reflect(e.prototype,"egret.BitmapText")}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.LEFT="left",t.RIGHT="right",t.CENTER="center",t.JUSTIFY="justify",t.CONTENT_JUSTIFY="contentJustify",t}();t.HorizontalAlign=e,__reflect(e.prototype,"egret.HorizontalAlign")}(egret||(egret={}));var egret;!function(t){var e=function(){function e(){this.replaceArr=[],this.resutlArr=[],this.initReplaceArr()}return e.prototype.initReplaceArr=function(){this.replaceArr=[],this.replaceArr.push([/&lt;/g,"<"]),this.replaceArr.push([/&gt;/g,">"]),this.replaceArr.push([/&amp;/g,"&"]),this.replaceArr.push([/&quot;/g,'"']),this.replaceArr.push([/&apos;/g,"'"])},e.prototype.replaceSpecial=function(t){for(var e=0;e<this.replaceArr.length;e++){var i=this.replaceArr[e][0],r=this.replaceArr[e][1];t=t.replace(i,r)}return t},e.prototype.parse=function(e){this.stackArray=[],this.resutlArr=[];for(var i=0,r=e.length;r>i;){var n=e.indexOf("<",i);if(0>n)this.addToResultArr(e.substring(i)),i=r;else{this.addToResultArr(e.substring(i,n));var a=e.indexOf(">",n);-1==a?(t.$error(1038),a=n):"/"==e.charAt(n+1)?this.stackArray.pop():this.addToArray(e.substring(n+1,a)),i=a+1}}return this.resutlArr},e.prototype.parser=function(t){return this.parse(t)},e.prototype.addToResultArr=function(t){""!=t&&(t=this.replaceSpecial(t),this.stackArray.length>0?this.resutlArr.push({text:t,style:this.stackArray[this.stackArray.length-1]}):this.resutlArr.push({text:t}))},e.prototype.changeStringToObject=function(t){t=t.trim();var e={},i=[];if("i"==t.charAt(0)||"b"==t.charAt(0)||"u"==t.charAt(0))this.addProperty(e,t,"true");else if(i=t.match(/^(font|a)\s/)){t=t.substring(i[0].length).trim();for(var r=0,n=void 0;n=t.match(this.getHeadReg());){var a=n[0],o="";t=t.substring(a.length).trim(),'"'==t.charAt(0)?(r=t.indexOf('"',1),o=t.substring(1,r),r+=1):"'"==t.charAt(0)?(r=t.indexOf("'",1),o=t.substring(1,r),r+=1):(o=t.match(/(\S)+/)[0],r=o.length),this.addProperty(e,a.substring(0,a.length-1).trim(),o.trim()),t=t.substring(r).trim()}}return e},e.prototype.getHeadReg=function(){return/^(color|textcolor|strokecolor|stroke|b|bold|i|italic|u|size|fontfamily|href|target)(\s)*=/},e.prototype.addProperty=function(t,e,i){switch(e.toLowerCase()){case"color":case"textcolor":i=i.replace(/#/,"0x"),t.textColor=parseInt(i);break;case"strokecolor":i=i.replace(/#/,"0x"),t.strokeColor=parseInt(i);break;case"stroke":t.stroke=parseInt(i);break;case"b":case"bold":t.bold="true"==i;break;case"u":t.underline="true"==i;break;case"i":case"italic":t.italic="true"==i;break;case"size":t.size=parseInt(i);break;case"fontfamily":t.fontFamily=i;break;case"href":t.href=this.replaceSpecial(i);break;case"target":t.target=this.replaceSpecial(i)}},e.prototype.addToArray=function(t){var e=this.changeStringToObject(t);if(0==this.stackArray.length)this.stackArray.push(e);else{var i=this.stackArray[this.stackArray.length-1];for(var r in i)null==e[r]&&(e[r]=i[r]);this.stackArray.push(e)}},e}();t.HtmlTextParser=e,__reflect(e.prototype,"egret.HtmlTextParser")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.stageTextAdded=!1,t._text=null,t._isFocus=!1,t}return __extends(i,e),i.prototype.init=function(e){this._text=e,this.stageText=new t.StageText,this.stageText.$setTextField(this._text)},i.prototype._addStageText=function(){this.stageTextAdded||(this._text.$inputEnabled||(this._text.$touchEnabled=!0),this.tempStage=this._text.stage,this.stageText.$addToStage(),this.stageText.addEventListener("updateText",this.updateTextHandler,this),this._text.addEventListener(t.TouchEvent.TOUCH_BEGIN,this.onMouseDownHandler,this),this.stageText.addEventListener("blur",this.blurHandler,this),this.stageText.addEventListener("focus",this.focusHandler,this),this.stageTextAdded=!0)},i.prototype._removeStageText=function(){this.stageTextAdded&&(this._text.$inputEnabled||(this._text.$touchEnabled=!1),this.stageText.$removeFromStage(),this.stageText.removeEventListener("updateText",this.updateTextHandler,this),this._text.removeEventListener(t.TouchEvent.TOUCH_BEGIN,this.onMouseDownHandler,this),this.tempStage.removeEventListener(t.TouchEvent.TOUCH_BEGIN,this.onStageDownHandler,this),this.stageText.removeEventListener("blur",this.blurHandler,this),this.stageText.removeEventListener("focus",this.focusHandler,this),this.stageTextAdded=!1)
},i.prototype._getText=function(){return this.stageText.$getText()},i.prototype._setText=function(t){this.stageText.$setText(t)},i.prototype._setColor=function(t){this.stageText.$setColor(t)},i.prototype.focusHandler=function(e){this._isFocus||(this._isFocus=!0,e.showing||this._text.$setIsTyping(!0),this._text.dispatchEvent(new t.FocusEvent(t.FocusEvent.FOCUS_IN,!0)))},i.prototype.blurHandler=function(e){this._isFocus&&(this._isFocus=!1,this.tempStage.removeEventListener(t.TouchEvent.TOUCH_BEGIN,this.onStageDownHandler,this),this._text.$setIsTyping(!1),this.stageText.$onBlur(),this._text.dispatchEvent(new t.FocusEvent(t.FocusEvent.FOCUS_OUT,!0)))},i.prototype.onMouseDownHandler=function(t){this.$onFocus()},i.prototype.$onFocus=function(){var e=this;this._text.visible&&(this._isFocus||(this.tempStage.removeEventListener(t.TouchEvent.TOUCH_BEGIN,this.onStageDownHandler,this),t.callLater(function(){e.tempStage.addEventListener(t.TouchEvent.TOUCH_BEGIN,e.onStageDownHandler,e)},this),t.nativeRender&&this.stageText.$setText(this._text.$TextField[13]),this.stageText.$show()))},i.prototype.onStageDownHandler=function(t){t.$target!=this._text&&this.stageText.$hide()},i.prototype.updateTextHandler=function(e){var i,r,n=this._text.$TextField,a=this.stageText.$getText(),o=!1;null!=n[35]&&(i=new RegExp("["+n[35]+"]","g"),r=a.match(i),a=r?r.join(""):"",o=!0),null!=n[36]&&(i=new RegExp("[^"+n[36]+"]","g"),r=a.match(i),a=r?r.join(""):"",o=!0),o&&this.stageText.$getText()!=a&&this.stageText.$setText(a),this.resetText(),this._text.dispatchEvent(new t.Event(t.Event.CHANGE,!0))},i.prototype.resetText=function(){this._text.$setBaseText(this.stageText.$getText())},i.prototype._hideInput=function(){this.stageText.$removeFromStage()},i.prototype.updateInput=function(){!this._text.$visible&&this.stageText&&this._hideInput()},i.prototype._updateProperties=function(){return this._isFocus?(this.stageText.$resetStageText(),void this.updateInput()):(this.stageText.$setText(this._text.$TextField[13]),this.stageText.$resetStageText(),void this.updateInput())},i}(t.HashObject);t.InputController=e,__reflect(e.prototype,"egret.InputController")}(egret||(egret={}));var egret;!function(t){}(egret||(egret={}));var egret;!function(t){function e(e,i,n){n=n||{};var a=null==n.italic?i[16]:n.italic,o=null==n.bold?i[15]:n.bold,s=null==n.size?i[0]:n.size,l=n.fontFamily||i[8]||r.default_fontFamily;return t.sys.measureText(e,l,s,o,a)}var i=new RegExp("(?=[\\u00BF-\\u1FFF\\u2C00-\\uD7FF]|\\b|\\s)(?![。，！、》…）)}”】\\.\\,\\!\\?\\]\\:])(?![\\0102-\\u1EF1])"),r=function(r){function n(){var e=r.call(this)||this;e.$inputEnabled=!1,e.inputUtils=null,e.$graphicsNode=null,e.isFlow=!1,e.textArr=[],e.linesArr=[],e.$isTyping=!1;var i=new t.sys.TextNode;return i.fontFamily=n.default_fontFamily,e.textNode=i,e.$renderNode=i,e.$TextField={0:n.default_size,1:0,2:n.default_textColor,3:0/0,4:0/0,5:0,6:0,7:0,8:n.default_fontFamily,9:"left",10:"top",11:"#ffffff",12:"",13:"",14:[],15:!1,16:!1,17:!0,18:!1,19:!1,20:!1,21:0,22:0,23:0,24:t.TextFieldType.DYNAMIC,25:0,26:"#000000",27:0,28:-1,29:0,30:!1,31:!1,32:0,33:!1,34:16777215,35:null,36:null,37:t.TextFieldInputType.TEXT,38:!1},e}return __extends(n,r),n.prototype.createNativeDisplayObject=function(){this.$nativeDisplayObject=new egret_native.NativeDisplayObject(7)},n.prototype.isInput=function(){return this.$TextField[24]==t.TextFieldType.INPUT},n.prototype.$setTouchEnabled=function(t){r.prototype.$setTouchEnabled.call(this,t),this.isInput()&&(this.$inputEnabled=!0)},Object.defineProperty(n.prototype,"fontFamily",{get:function(){return this.$TextField[8]},set:function(t){this.$setFontFamily(t)},enumerable:!0,configurable:!0}),n.prototype.$setFontFamily=function(e){var i=this.$TextField;return i[8]==e?!1:(i[8]=e,this.invalidateFontString(),t.nativeRender&&this.$nativeDisplayObject.setFontFamily(e),!0)},Object.defineProperty(n.prototype,"size",{get:function(){return this.$TextField[0]},set:function(t){this.$setSize(t)},enumerable:!0,configurable:!0}),n.prototype.$setSize=function(e){var i=this.$TextField;return i[0]==e?!1:(i[0]=e,this.invalidateFontString(),t.nativeRender&&this.$nativeDisplayObject.setFontSize(e),!0)},Object.defineProperty(n.prototype,"bold",{get:function(){return this.$TextField[15]},set:function(t){this.$setBold(t)},enumerable:!0,configurable:!0}),n.prototype.$setBold=function(e){var i=this.$TextField;return e==i[15]?!1:(i[15]=e,this.invalidateFontString(),t.nativeRender&&this.$nativeDisplayObject.setBold(e),!0)},Object.defineProperty(n.prototype,"italic",{get:function(){return this.$TextField[16]},set:function(t){this.$setItalic(t)},enumerable:!0,configurable:!0}),n.prototype.$setItalic=function(e){var i=this.$TextField;return e==i[16]?!1:(i[16]=e,this.invalidateFontString(),t.nativeRender&&this.$nativeDisplayObject.setItalic(e),!0)},n.prototype.invalidateFontString=function(){this.$TextField[17]=!0,this.$invalidateTextField()},Object.defineProperty(n.prototype,"textAlign",{get:function(){return this.$TextField[9]},set:function(t){this.$setTextAlign(t)},enumerable:!0,configurable:!0}),n.prototype.$setTextAlign=function(e){var i=this.$TextField;return i[9]==e?!1:(i[9]=e,this.$invalidateTextField(),t.nativeRender&&this.$nativeDisplayObject.setTextAlign(e),!0)},Object.defineProperty(n.prototype,"verticalAlign",{get:function(){return this.$TextField[10]},set:function(t){this.$setVerticalAlign(t)},enumerable:!0,configurable:!0}),n.prototype.$setVerticalAlign=function(e){var i=this.$TextField;return i[10]==e?!1:(i[10]=e,this.$invalidateTextField(),t.nativeRender&&this.$nativeDisplayObject.setVerticalAlign(e),!0)},Object.defineProperty(n.prototype,"lineSpacing",{get:function(){return this.$TextField[1]},set:function(t){this.$setLineSpacing(t)},enumerable:!0,configurable:!0}),n.prototype.$setLineSpacing=function(e){var i=this.$TextField;return i[1]==e?!1:(i[1]=e,this.$invalidateTextField(),t.nativeRender&&this.$nativeDisplayObject.setLineSpacing(e),!0)},Object.defineProperty(n.prototype,"textColor",{get:function(){return this.$TextField[2]},set:function(t){this.$setTextColor(t)},enumerable:!0,configurable:!0}),n.prototype.$setTextColor=function(e){var i=this.$TextField;return i[2]==e?!1:(i[2]=e,this.inputUtils&&this.inputUtils._setColor(this.$TextField[2]),this.$invalidateTextField(),t.nativeRender&&this.$nativeDisplayObject.setTextColor(e),!0)},Object.defineProperty(n.prototype,"wordWrap",{get:function(){return this.$TextField[19]},set:function(t){this.$setWordWrap(t)},enumerable:!0,configurable:!0}),n.prototype.$setWordWrap=function(e){var i=this.$TextField;e!=i[19]&&(i[20]||(i[19]=e,this.$invalidateTextField(),t.nativeRender&&this.$nativeDisplayObject.setWordWrap(e)))},Object.defineProperty(n.prototype,"type",{get:function(){return this.$TextField[24]},set:function(t){this.$setType(t)},enumerable:!0,configurable:!0}),n.prototype.$setType=function(e){var i=this.$TextField;return i[24]!=e?(i[24]=e,t.nativeRender&&this.$nativeDisplayObject.setType(e),e==t.TextFieldType.INPUT?(isNaN(i[3])&&this.$setWidth(100),isNaN(i[4])&&this.$setHeight(30),this.$setTouchEnabled(!0),null==this.inputUtils&&(this.inputUtils=new t.InputController),this.inputUtils.init(this),this.$invalidateTextField(),this.$stage&&this.inputUtils._addStageText()):(this.inputUtils&&(this.inputUtils._removeStageText(),this.inputUtils=null),this.$setTouchEnabled(!1)),!0):!1},Object.defineProperty(n.prototype,"inputType",{get:function(){return this.$TextField[37]},set:function(e){this.$TextField[37]!=e&&(this.$TextField[37]=e,t.nativeRender&&this.$nativeDisplayObject.setInputType(e))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"text",{get:function(){return this.$getText()},set:function(t){this.$setText(t)},enumerable:!0,configurable:!0}),n.prototype.$getText=function(){return this.$TextField[24]==t.TextFieldType.INPUT?this.inputUtils._getText():this.$TextField[13]},n.prototype.$setBaseText=function(e){e=null==e?"":e.toString(),this.isFlow=!1;var i=this.$TextField;if(i[13]!=e){this.$invalidateTextField(),i[13]=e;var r="";return r=i[20]?this.changeToPassText(e):e,t.nativeRender&&this.$nativeDisplayObject.setText(r),this.setMiddleStyle([{text:r}]),!0}return!1},n.prototype.$setText=function(t){null==t&&(t="");var e=this.$setBaseText(t);return this.inputUtils&&this.inputUtils._setText(this.$TextField[13]),e},Object.defineProperty(n.prototype,"displayAsPassword",{get:function(){return this.$TextField[20]},set:function(t){this.$setDisplayAsPassword(t)},enumerable:!0,configurable:!0}),n.prototype.$setDisplayAsPassword=function(e){var i=this.$TextField;if(i[20]!=e){i[20]=e,this.$invalidateTextField();var r="";return r=e?this.changeToPassText(i[13]):i[13],t.nativeRender&&this.$nativeDisplayObject.setText(r),this.setMiddleStyle([{text:r}]),!0}return!1},Object.defineProperty(n.prototype,"strokeColor",{get:function(){return this.$TextField[25]},set:function(t){this.$setStrokeColor(t)},enumerable:!0,configurable:!0}),n.prototype.$setStrokeColor=function(e){var i=this.$TextField;return i[25]!=e?(this.$invalidateTextField(),i[25]=e,t.nativeRender&&this.$nativeDisplayObject.setStrokeColor(e),i[26]=t.toColorString(e),!0):!1},Object.defineProperty(n.prototype,"stroke",{get:function(){return this.$TextField[27]},set:function(t){this.$setStroke(t)},enumerable:!0,configurable:!0}),n.prototype.$setStroke=function(e){return this.$TextField[27]!=e?(this.$invalidateTextField(),this.$TextField[27]=e,t.nativeRender&&this.$nativeDisplayObject.setStroke(e),!0):!1},Object.defineProperty(n.prototype,"maxChars",{get:function(){return this.$TextField[21]},set:function(t){this.$setMaxChars(t)},enumerable:!0,configurable:!0}),n.prototype.$setMaxChars=function(e){return this.$TextField[21]!=e?(this.$TextField[21]=e,t.nativeRender&&this.$nativeDisplayObject.setMaxChars(e),!0):!1},Object.defineProperty(n.prototype,"scrollV",{get:function(){return Math.min(Math.max(this.$TextField[28],1),this.maxScrollV)},set:function(e){e=Math.max(e,1),e!=this.$TextField[28]&&(this.$TextField[28]=e,t.nativeRender&&this.$nativeDisplayObject.setScrollV(e),this.$invalidateTextField())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"maxScrollV",{get:function(){return this.$getLinesArr(),Math.max(this.$TextField[29]-t.TextFieldUtils.$getScrollNum(this)+1,1)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"selectionBeginIndex",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"selectionEndIndex",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"caretIndex",{get:function(){return 0},enumerable:!0,configurable:!0}),n.prototype.$setSelection=function(t,e){return!1},n.prototype.$getLineHeight=function(){return this.$TextField[1]+this.$TextField[0]},Object.defineProperty(n.prototype,"numLines",{get:function(){return this.$getLinesArr(),this.$TextField[29]},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"multiline",{get:function(){return this.$TextField[30]},set:function(t){this.$setMultiline(t)},enumerable:!0,configurable:!0}),n.prototype.$setMultiline=function(e){return this.$TextField[30]==e?!1:(this.$TextField[30]=e,this.$invalidateTextField(),t.nativeRender&&this.$nativeDisplayObject.setMultiline(e),!0)},Object.defineProperty(n.prototype,"restrict",{get:function(){var t=this.$TextField,e=null;return null!=t[35]&&(e=t[35]),null!=t[36]&&(null==e&&(e=""),e+="^"+t[36]),e},set:function(t){var e=this.$TextField;if(null==t)e[35]=null,e[36]=null;else{for(var i=-1;i<t.length&&(i=t.indexOf("^",i),0!=i)&&i>0&&"\\"==t.charAt(i-1);)i++;0==i?(e[35]=null,e[36]=t.substring(i+1)):i>0?(e[35]=t.substring(0,i),e[36]=t.substring(i+1)):(e[35]=t,e[36]=null)}},enumerable:!0,configurable:!0}),n.prototype.$setWidth=function(e){t.nativeRender&&this.$nativeDisplayObject.setTextFieldWidth(e);var i=this.$TextField;if(isNaN(e)){if(isNaN(i[3]))return!1;i[3]=0/0}else{if(i[3]==e)return!1;i[3]=e}return e=+e,0>e?!1:(this.$invalidateTextField(),!0)},n.prototype.$setHeight=function(e){t.nativeRender&&this.$nativeDisplayObject.setTextFieldHeight(e);var i=this.$TextField;if(isNaN(e)){if(isNaN(i[4]))return!1;i[4]=0/0}else{if(i[4]==e)return!1;i[4]=e}return e=+e,0>e?!1:(this.$invalidateTextField(),!0)},n.prototype.$getWidth=function(){var t=this.$TextField;return isNaN(t[3])?this.$getContentBounds().width:t[3]},n.prototype.$getHeight=function(){var t=this.$TextField;return isNaN(t[4])?this.$getContentBounds().height:t[4]},Object.defineProperty(n.prototype,"border",{get:function(){return this.$TextField[31]},set:function(t){this.$setBorder(t)},enumerable:!0,configurable:!0}),n.prototype.$setBorder=function(e){e=!!e,this.$TextField[31]!=e&&(this.$TextField[31]=e,this.$invalidateTextField(),t.nativeRender&&this.$nativeDisplayObject.setBorder(e))},Object.defineProperty(n.prototype,"borderColor",{get:function(){return this.$TextField[32]},set:function(t){this.$setBorderColor(t)},enumerable:!0,configurable:!0}),n.prototype.$setBorderColor=function(e){e=+e||0,this.$TextField[32]!=e&&(this.$TextField[32]=e,this.$invalidateTextField(),t.nativeRender&&this.$nativeDisplayObject.setBorderColor(e))},Object.defineProperty(n.prototype,"background",{get:function(){return this.$TextField[33]},set:function(t){this.$setBackground(t)},enumerable:!0,configurable:!0}),n.prototype.$setBackground=function(e){this.$TextField[33]!=e&&(this.$TextField[33]=e,this.$invalidateTextField(),t.nativeRender&&this.$nativeDisplayObject.setBackground(e))},Object.defineProperty(n.prototype,"backgroundColor",{get:function(){return this.$TextField[34]},set:function(t){this.$setBackgroundColor(t)},enumerable:!0,configurable:!0}),n.prototype.$setBackgroundColor=function(e){this.$TextField[34]!=e&&(this.$TextField[34]=e,this.$invalidateTextField(),t.nativeRender&&this.$nativeDisplayObject.setBackgroundColor(e))},n.prototype.fillBackground=function(e){var i=this.$graphicsNode;i&&i.clear();var r=this.$TextField;if(r[33]||r[31]||e&&e.length>0){if(!i)if(i=this.$graphicsNode=new t.sys.GraphicsNode,t.nativeRender)this.$renderNode=this.textNode;else{var n=new t.sys.GroupNode;n.addNode(i),n.addNode(this.textNode),this.$renderNode=n}var a=void 0,o=void 0;if(r[33]&&(a=i.beginFill(r[34]),a.drawRect(0,0,this.$getWidth(),this.$getHeight())),r[31]&&(o=i.lineStyle(1,r[32]),o.drawRect(0,0,this.$getWidth()-1,this.$getHeight()-1)),e&&e.length>0)for(var s=r[2],l=-1,h=e.length,c=0;h>c;c+=4){var u=e[c],p=e[c+1],d=e[c+2],f=e[c+3]||s;(0>l||l!=f)&&(l=f,o=i.lineStyle(2,f,1,t.CapsStyle.NONE)),o.moveTo(u,p),o.lineTo(u+d,p)}}if(i){var g=this.$getRenderBounds();i.x=g.x,i.y=g.y,i.width=g.width,i.height=g.height,t.Rectangle.release(g)}},n.prototype.setFocus=function(){this.type==t.TextFieldType.INPUT&&this.$stage&&this.inputUtils.$onFocus()},n.prototype.$onRemoveFromStage=function(){r.prototype.$onRemoveFromStage.call(this),this.removeEvent(),this.$TextField[24]==t.TextFieldType.INPUT&&this.inputUtils._removeStageText(),this.textNode&&(this.textNode.clean(),t.nativeRender&&egret_native.NativeDisplayObject.disposeTextData(this))},n.prototype.$onAddToStage=function(e,i){r.prototype.$onAddToStage.call(this,e,i),this.addEvent(),this.$TextField[24]==t.TextFieldType.INPUT&&this.inputUtils._addStageText()},n.prototype.$invalidateTextField=function(){var e=this;if(e.$renderDirty=!0,e.$TextField[18]=!0,e.$TextField[38]=!0,t.nativeRender);else{var i=e.$parent;i&&!i.$cacheDirty&&(i.$cacheDirty=!0,i.$cacheDirtyUp());var r=e.$maskedObject;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp())}},n.prototype.$getRenderBounds=function(){var e=this.$getContentBounds(),i=t.Rectangle.create();i.copyFrom(e),this.$TextField[31]&&(i.width+=2,i.height+=2);var r=2*this.$TextField[27];return r>0&&(i.width+=2*r,i.height+=2*r),i.x-=r+2,i.y-=r+2,i.width=Math.ceil(i.width)+4,i.height=Math.ceil(i.height)+4,i},n.prototype.$measureContentBounds=function(e){this.$getLinesArr();var i=0,r=0;t.nativeRender?(i=egret_native.nrGetTextFieldWidth(this.$nativeDisplayObject.id),r=egret_native.nrGetTextFieldHeight(this.$nativeDisplayObject.id)):(i=isNaN(this.$TextField[3])?this.$TextField[5]:this.$TextField[3],r=isNaN(this.$TextField[4])?t.TextFieldUtils.$getTextHeight(this):this.$TextField[4]),e.setTo(0,0,i,r)},n.prototype.$updateRenderNode=function(){if(this.$TextField[24]==t.TextFieldType.INPUT){if(this.inputUtils._updateProperties(),this.$isTyping)return void this.fillBackground()}else if(0==this.$TextField[3]){var e=this.$graphicsNode;return void(e&&e.clear())}var i=this.drawText();this.fillBackground(i);var r=this.$getRenderBounds(),n=this.textNode;n.x=r.x,n.y=r.y,n.width=Math.ceil(r.width),n.height=Math.ceil(r.height),t.Rectangle.release(r)},Object.defineProperty(n.prototype,"textFlow",{get:function(){return this.textArr},set:function(e){this.isFlow=!0;var i="";null==e&&(e=[]);for(var r=0;r<e.length;r++){var n=e[r];i+=n.text}this.$TextField[20]?this.$setBaseText(i):(this.$TextField[13]=i,this.setMiddleStyle(e),t.nativeRender&&this.$nativeDisplayObject.setTextFlow(e))},enumerable:!0,configurable:!0}),n.prototype.changeToPassText=function(t){if(this.$TextField[20]){for(var e="",i=0,r=t.length;r>i;i++)switch(t.charAt(i)){case"\n":e+="\n";break;case"\r":break;default:e+="*"}return e}return t},n.prototype.setMiddleStyle=function(t){this.$TextField[18]=!0,this.$TextField[38]=!0,this.textArr=t,this.$invalidateTextField()},Object.defineProperty(n.prototype,"textWidth",{get:function(){return this.$getLinesArr(),t.nativeRender?egret_native.nrGetTextWidth(this.$nativeDisplayObject.id):this.$TextField[5]},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"textHeight",{get:function(){return this.$getLinesArr(),t.nativeRender?egret_native.nrGetTextHeight(this.$nativeDisplayObject.id):t.TextFieldUtils.$getTextHeight(this)},enumerable:!0,configurable:!0}),n.prototype.appendText=function(t){this.appendElement({text:t})},n.prototype.appendElement=function(e){var i=this.$TextField[13]+e.text;return t.nativeRender?(this.textArr.push(e),this.$TextField[13]=i,this.$TextField[18]=!0,this.$TextField[38]=!0,void this.$nativeDisplayObject.setTextFlow(this.textArr)):void(this.$TextField[20]?this.$setBaseText(i):(this.$TextField[13]=i,this.textArr.push(e),this.setMiddleStyle(this.textArr)))},n.prototype.$getLinesArr=function(){var e=this.$TextField;return t.nativeRender&&e[38]?(egret_native.updateNativeRender(),void(e[38]=!1)):this.$getLinesArr2()},n.prototype.$getLinesArr2=function(){var r=this.$TextField;if(!r[18])return this.linesArr;r[18]=!1;var n=this.textArr;this.linesArr.length=0,r[6]=0,r[5]=0;var a=r[3];if(!isNaN(a)&&0==a)return r[29]=0,[{width:0,height:0,charNum:0,elements:[],hasNextLine:!1}];for(var o,s=this.linesArr,l=0,h=0,c=0,u=0,p=0,d=n.length;d>p;p++){var f=n[p];if(f.text){f.style=f.style||{};for(var g=f.text.toString(),m=g.split(/(?:\r\n|\r|\n)/),y=0,v=m.length;v>y;y++){null==s[u]&&(o={width:0,height:0,elements:[],charNum:0,hasNextLine:!1},s[u]=o,l=0,c=0,h=0),c=r[24]==t.TextFieldType.INPUT?r[0]:Math.max(c,f.style.size||r[0]);var _=!0;if(""==m[y])y==v-1&&(_=!1);else{var b=e(m[y],r,f.style);if(isNaN(a))l+=b,h+=m[y].length,o.elements.push({width:b,text:m[y],style:f.style}),y==v-1&&(_=!1);else if(a>=l+b)o.elements.push({width:b,text:m[y],style:f.style}),l+=b,h+=m[y].length,y==v-1&&(_=!1);else{var x=0,T=0,E=m[y],S=void 0;S=r[19]?E.split(i):E.match(/./g);for(var C=S.length,w=0;C>x;x++){var P=S[x].length,D=!1;if(1==P&&C-1>x){var A=S[x].charCodeAt(0),I=S[x+1].charCodeAt(0);if(A>=55296&&56319>=A&&56320==(64512&I)){var M=S[x]+S[x+1];P=2,D=!0,b=e(M,r,f.style)}else b=e(S[x],r,f.style)}else b=e(S[x],r,f.style);if(0!=l&&l+b>a&&l+x!=0)break;if(T+b>a)for(var $=S[x].match(/./g),O=0,R=$.length;R>O;O++){var P=$[O].length,L=!1;if(1==P&&R-1>O){var A=$[O].charCodeAt(0),I=$[O+1].charCodeAt(0);if(A>=55296&&56319>=A&&56320==(64512&I)){var M=$[O]+$[O+1];P=2,L=!0,b=e(M,r,f.style)}else b=e($[O],r,f.style)}else b=e($[O],r,f.style);if(O>0&&l+b>a)break;w+=P,T+=b,l+=b,h+=w,L&&O++}else w+=P,T+=b,l+=b,h+=w;D&&x++}if(x>0){o.elements.push({width:T,text:E.substring(0,w),style:f.style});var B=E.substring(w),k=void 0,N=B.length;for(k=0;N>k&&" "==B.charAt(k);k++);m[y]=B.substring(k)}""!=m[y]&&(y--,_=!1)}}_&&(h++,o.hasNextLine=!0),y<m.length-1&&(o.width=l,o.height=c,o.charNum=h,r[5]=Math.max(r[5],l),r[6]+=c,u++)}p==n.length-1&&o&&(o.width=l,o.height=c,o.charNum=h,r[5]=Math.max(r[5],l),r[6]+=c)}else o&&(o.width=l,o.height=c,o.charNum=h,r[5]=Math.max(r[5],l),r[6]+=c)}return r[29]=s.length,s},n.prototype.$setIsTyping=function(e){this.$isTyping=e,this.$invalidateTextField(),t.nativeRender&&this.$nativeDisplayObject.setIsTyping(e)},n.prototype.drawText=function(){var e=this.textNode,i=this.$TextField;e.bold=i[15],e.fontFamily=i[8]||n.default_fontFamily,e.italic=i[16],e.size=i[0],e.stroke=i[27],e.strokeColor=i[25],e.textColor=i[2];var r=this.$getLinesArr();if(0==i[5])return[];var a=isNaN(i[3])?i[5]:i[3],o=t.TextFieldUtils.$getTextHeight(this),s=0,l=t.TextFieldUtils.$getStartLine(this),h=i[4];if(!isNaN(h)&&h>o){var c=t.TextFieldUtils.$getValign(this);s+=c*(h-o)}s=Math.round(s);for(var u=t.TextFieldUtils.$getHalign(this),p=0,d=[],f=l,g=i[29];g>f;f++){var m=r[f],y=m.height;if(s+=y/2,f!=l){if(i[24]==t.TextFieldType.INPUT&&!i[30])break;if(!isNaN(h)&&s>h)break}p=Math.round((a-m.width)*u);for(var v=0,_=m.elements.length;_>v;v++){var b=m.elements[v],x=b.style.size||i[0];e.drawText(p,s+(y-x)/2,b.text,b.style),b.style.underline&&d.push(p,s+y/2,b.width,b.style.textColor),p+=b.width}s+=y/2+i[1]}return d},n.prototype.addEvent=function(){this.addEventListener(t.TouchEvent.TOUCH_TAP,this.onTapHandler,this)},n.prototype.removeEvent=function(){this.removeEventListener(t.TouchEvent.TOUCH_TAP,this.onTapHandler,this)},n.prototype.onTapHandler=function(e){if(this.$TextField[24]!=t.TextFieldType.INPUT){var i=t.TextFieldUtils.$getTextElement(this,e.localX,e.localY);if(null!=i){var r=i.style;if(r&&r.href)if(r.href.match(/^event:/)){var n=r.href.match(/^event:/)[0];t.TextEvent.dispatchTextEvent(this,t.TextEvent.LINK,r.href.substring(n.length))}else open(r.href,r.target||"_blank")}}},n.default_fontFamily="Arial",n.default_size=30,n.default_textColor=16777215,n}(t.DisplayObject);t.TextField=r,__reflect(r.prototype,"egret.TextField")}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.TEXT="text",t.TEL="tel",t.PASSWORD="password",t}();t.TextFieldInputType=e,__reflect(e.prototype,"egret.TextFieldInputType")}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.DYNAMIC="dynamic",t.INPUT="input",t}();t.TextFieldType=e,__reflect(e.prototype,"egret.TextFieldType")}(egret||(egret={}));var egret;!function(t){var e=function(){function e(){}return e.$getStartLine=function(t){var i=t.$TextField,r=e.$getTextHeight(t),n=0,a=i[4];return isNaN(a)||(a>r||r>a&&(n=Math.max(i[28]-1,0),n=Math.min(i[29]-1,n)),i[30]||(n=Math.max(i[28]-1,0),i[29]>0&&(n=Math.min(i[29]-1,n)))),n},e.$getHalign=function(e){var i=e.$getLinesArr2(),r=0;return e.$TextField[9]==t.HorizontalAlign.CENTER?r=.5:e.$TextField[9]==t.HorizontalAlign.RIGHT&&(r=1),e.$TextField[24]==t.TextFieldType.INPUT&&!e.$TextField[30]&&i.length>1&&(r=0),r},e.$getTextHeight=function(e){var i=t.TextFieldType.INPUT!=e.$TextField[24]||e.$TextField[30]?e.$TextField[6]+(e.$TextField[29]-1)*e.$TextField[1]:e.$TextField[0];return i},e.$getValign=function(i){var r=e.$getTextHeight(i),n=i.$TextField[4];if(!isNaN(n)&&n>r){var a=0;return i.$TextField[10]==t.VerticalAlign.MIDDLE?a=.5:i.$TextField[10]==t.VerticalAlign.BOTTOM&&(a=1),a}return 0},e.$getTextElement=function(t,i,r){var n=e.$getHit(t,i,r),a=t.$getLinesArr2();return n&&a[n.lineIndex]&&a[n.lineIndex].elements[n.textElementIndex]?a[n.lineIndex].elements[n.textElementIndex]:null},e.$getHit=function(t,i,r){var n=t.$getLinesArr2();if(0==t.$TextField[3])return null;var a=0,o=e.$getTextHeight(t),s=0,l=t.$TextField[4];if(!isNaN(l)&&l>o){var h=e.$getValign(t);s=h*(l-o),0!=s&&(r-=s)}for(var c=e.$getStartLine(t),u=0,p=c;p<n.length;p++){var d=n[p];if(u+d.height>=r){r>u&&(a=p+1);break}if(u+=d.height,u+t.$TextField[1]>r)return null;u+=t.$TextField[1]}if(0==a)return null;var f=n[a-1],g=t.$TextField[3];isNaN(g)&&(g=t.textWidth);var m=e.$getHalign(t);i-=m*(g-f.width);for(var y=0,p=0;p<f.elements.length;p++){var v=f.elements[p];if(y+v.width<=i)y+=v.width;else if(i>y)return{lineIndex:a-1,textElementIndex:p}}return null},e.$getScrollNum=function(t){var e=1;if(t.$TextField[30]){var i=t.height,r=t.size,n=t.lineSpacing;e=Math.floor(i/(r+n));var a=i-(r+n)*e;a>r/2&&e++}return e},e}();t.TextFieldUtils=e,__reflect(e.prototype,"egret.TextFieldUtils")}(egret||(egret={}));var egret;!function(t){var e;!function(t){}(e=t.sys||(t.sys={}))}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.TOP="top",t.BOTTOM="bottom",t.MIDDLE="middle",t.JUSTIFY="justify",t.CONTENT_JUSTIFY="contentJustify",t}();t.VerticalAlign=e,__reflect(e.prototype,"egret.VerticalAlign")}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.encode=function(t){for(var e=new Uint8Array(t),i=e.length,r="",n=0;i>n;n+=3)r+=chars[e[n]>>2],r+=chars[(3&e[n])<<4|e[n+1]>>4],r+=chars[(15&e[n+1])<<2|e[n+2]>>6],r+=chars[63&e[n+2]];return i%3===2?r=r.substring(0,r.length-1)+"=":i%3===1&&(r=r.substring(0,r.length-2)+"=="),r},t.decode=function(t){var e=.75*t.length,i=t.length,r=0,n=0,a=0,o=0,s=0;"="===t[t.length-1]&&(e--,"="===t[t.length-2]&&e--);for(var l=new ArrayBuffer(e),h=new Uint8Array(l),c=0;i>c;c+=4)n=lookup[t.charCodeAt(c)],a=lookup[t.charCodeAt(c+1)],o=lookup[t.charCodeAt(c+2)],s=lookup[t.charCodeAt(c+3)],h[r++]=n<<2|a>>4,h[r++]=(15&a)<<4|o>>2,h[r++]=(3&o)<<6|63&s;return l},t}();t.Base64Util=e,__reflect(e.prototype,"egret.Base64Util")}(egret||(egret={}));for(var chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",lookup=new Uint8Array(256),i=0;i<chars.length;i++)lookup[chars.charCodeAt(i)]=i;var egret;!function(t){var e=function(){function t(){}return t.LITTLE_ENDIAN="littleEndian",t.BIG_ENDIAN="bigEndian",t}();t.Endian=e,__reflect(e.prototype,"egret.Endian");var i=function(){function i(t,i){void 0===i&&(i=0),this.bufferExtSize=0,this.EOF_byte=-1,this.EOF_code_point=-1,0>i&&(i=0),this.bufferExtSize=i;var r,n=0;if(t){var a=void 0;if(t instanceof Uint8Array?(a=t,n=t.length):(n=t.byteLength,a=new Uint8Array(t)),0==i)r=new Uint8Array(n);else{var o=(n/i|0)+1;r=new Uint8Array(o*i)}r.set(a)}else r=new Uint8Array(i);this.write_position=n,this._position=0,this._bytes=r,this.data=new DataView(r.buffer),this.endian=e.BIG_ENDIAN}return Object.defineProperty(i.prototype,"endian",{get:function(){return 0==this.$endian?e.LITTLE_ENDIAN:e.BIG_ENDIAN},set:function(t){this.$endian=t==e.LITTLE_ENDIAN?0:1},enumerable:!0,configurable:!0}),i.prototype.setArrayBuffer=function(t){},Object.defineProperty(i.prototype,"readAvailable",{get:function(){return this.write_position-this._position},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"buffer",{get:function(){return this.data.buffer.slice(0,this.write_position)},set:function(t){var e,i=t.byteLength,r=new Uint8Array(t),n=this.bufferExtSize;if(0==n)e=new Uint8Array(i);else{var a=(i/n|0)+1;e=new Uint8Array(a*n)}e.set(r),this.write_position=i,this._bytes=e,this.data=new DataView(e.buffer)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"rawBuffer",{get:function(){return this.data.buffer},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"bytes",{get:function(){return this._bytes},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"dataView",{get:function(){return this.data},set:function(t){this.buffer=t.buffer},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"bufferOffset",{get:function(){return this.data.byteOffset},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"position",{get:function(){return this._position},set:function(t){this._position=t,t>this.write_position&&(this.write_position=t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"length",{get:function(){return this.write_position},set:function(t){this.write_position=t,this.data.byteLength>t&&(this._position=t),this._validateBuffer(t)},enumerable:!0,configurable:!0}),i.prototype._validateBuffer=function(t){if(this.data.byteLength<t){var e=this.bufferExtSize,i=void 0;if(0==e)i=new Uint8Array(t);else{var r=((t/e>>0)+1)*e;i=new Uint8Array(r)}i.set(this._bytes),this._bytes=i,this.data=new DataView(i.buffer)}},Object.defineProperty(i.prototype,"bytesAvailable",{get:function(){return this.data.byteLength-this._position},enumerable:!0,configurable:!0}),i.prototype.clear=function(){var t=new ArrayBuffer(this.bufferExtSize);this.data=new DataView(t),this._bytes=new Uint8Array(t),this._position=0,this.write_position=0},i.prototype.readBoolean=function(){return this.validate(1)?!!this._bytes[this.position++]:void 0},i.prototype.readByte=function(){return this.validate(1)?this.data.getInt8(this.position++):void 0},i.prototype.readBytes=function(e,i,r){if(void 0===i&&(i=0),void 0===r&&(r=0),e){var n=this._position,a=this.write_position-n;if(0>a)return void t.$error(1025);if(0==r)r=a;else if(r>a)return void t.$error(1025);var o=e._position;e._position=0,e.validateBuffer(i+r),e._position=o,e._bytes.set(this._bytes.subarray(n,n+r),i),this.position+=r}},i.prototype.readDouble=function(){if(this.validate(8)){var t=this.data.getFloat64(this._position,0==this.$endian);return this.position+=8,t}},i.prototype.readFloat=function(){if(this.validate(4)){var t=this.data.getFloat32(this._position,0==this.$endian);return this.position+=4,t}},i.prototype.readInt=function(){if(this.validate(4)){var t=this.data.getInt32(this._position,0==this.$endian);return this.position+=4,t}},i.prototype.readShort=function(){if(this.validate(2)){var t=this.data.getInt16(this._position,0==this.$endian);return this.position+=2,t}},i.prototype.readUnsignedByte=function(){return this.validate(1)?this._bytes[this.position++]:void 0},i.prototype.readUnsignedInt=function(){if(this.validate(4)){var t=this.data.getUint32(this._position,0==this.$endian);return this.position+=4,t}},i.prototype.readUnsignedShort=function(){if(this.validate(2)){var t=this.data.getUint16(this._position,0==this.$endian);return this.position+=2,t}},i.prototype.readUTF=function(){var t=this.readUnsignedShort();return t>0?this.readUTFBytes(t):""},i.prototype.readUTFBytes=function(t){if(this.validate(t)){var e=this.data,i=new Uint8Array(e.buffer,e.byteOffset+this._position,t);return this.position+=t,this.decodeUTF8(i)}},i.prototype.writeBoolean=function(t){this.validateBuffer(1),this._bytes[this.position++]=+t},i.prototype.writeByte=function(t){this.validateBuffer(1),this._bytes[this.position++]=255&t},i.prototype.writeBytes=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=0);var r;0>e||0>i||(r=0==i?t.length-e:Math.min(t.length-e,i),r>0&&(this.validateBuffer(r),this._bytes.set(t._bytes.subarray(e,e+r),this._position),this.position=this._position+r))},i.prototype.writeDouble=function(t){this.validateBuffer(8),this.data.setFloat64(this._position,t,0==this.$endian),this.position+=8},i.prototype.writeFloat=function(t){this.validateBuffer(4),this.data.setFloat32(this._position,t,0==this.$endian),this.position+=4},i.prototype.writeInt=function(t){this.validateBuffer(4),this.data.setInt32(this._position,t,0==this.$endian),this.position+=4},i.prototype.writeShort=function(t){this.validateBuffer(2),this.data.setInt16(this._position,t,0==this.$endian),this.position+=2},i.prototype.writeUnsignedInt=function(t){this.validateBuffer(4),this.data.setUint32(this._position,t,0==this.$endian),this.position+=4},i.prototype.writeUnsignedShort=function(t){this.validateBuffer(2),this.data.setUint16(this._position,t,0==this.$endian),this.position+=2},i.prototype.writeUTF=function(t){var e=this.encodeUTF8(t),i=e.length;this.validateBuffer(2+i),this.data.setUint16(this._position,i,0==this.$endian),this.position+=2,this._writeUint8Array(e,!1)},i.prototype.writeUTFBytes=function(t){this._writeUint8Array(this.encodeUTF8(t))
},i.prototype.toString=function(){return"[ByteArray] length:"+this.length+", bytesAvailable:"+this.bytesAvailable},i.prototype._writeUint8Array=function(t,e){void 0===e&&(e=!0);var i=this._position,r=i+t.length;e&&this.validateBuffer(r),this.bytes.set(t,i),this.position=r},i.prototype.validate=function(e){var i=this._bytes.length;return i>0&&this._position+e<=i?!0:void t.$error(1025)},i.prototype.validateBuffer=function(t){this.write_position=t>this.write_position?t:this.write_position,t+=this._position,this._validateBuffer(t)},i.prototype.encodeUTF8=function(t){for(var e=0,i=this.stringToCodePoints(t),r=[];i.length>e;){var n=i[e++];if(this.inRange(n,55296,57343))this.encoderError(n);else if(this.inRange(n,0,127))r.push(n);else{var a=void 0,o=void 0;for(this.inRange(n,128,2047)?(a=1,o=192):this.inRange(n,2048,65535)?(a=2,o=224):this.inRange(n,65536,1114111)&&(a=3,o=240),r.push(this.div(n,Math.pow(64,a))+o);a>0;){var s=this.div(n,Math.pow(64,a-1));r.push(128+s%64),a-=1}}}return new Uint8Array(r)},i.prototype.decodeUTF8=function(t){for(var e,i=!1,r=0,n="",a=0,o=0,s=0,l=0;t.length>r;){var h=t[r++];if(h==this.EOF_byte)e=0!=o?this.decoderError(i):this.EOF_code_point;else if(0==o)this.inRange(h,0,127)?e=h:(this.inRange(h,194,223)?(o=1,l=128,a=h-192):this.inRange(h,224,239)?(o=2,l=2048,a=h-224):this.inRange(h,240,244)?(o=3,l=65536,a=h-240):this.decoderError(i),a*=Math.pow(64,o),e=null);else if(this.inRange(h,128,191))if(s+=1,a+=(h-128)*Math.pow(64,o-s),s!==o)e=null;else{var c=a,u=l;a=0,o=0,s=0,l=0,e=this.inRange(c,u,1114111)&&!this.inRange(c,55296,57343)?c:this.decoderError(i,h)}else a=0,o=0,s=0,l=0,r--,e=this.decoderError(i,h);null!==e&&e!==this.EOF_code_point&&(65535>=e?e>0&&(n+=String.fromCharCode(e)):(e-=65536,n+=String.fromCharCode(55296+(e>>10&1023)),n+=String.fromCharCode(56320+(1023&e))))}return n},i.prototype.encoderError=function(e){t.$error(1026,e)},i.prototype.decoderError=function(e,i){return e&&t.$error(1027),i||65533},i.prototype.inRange=function(t,e,i){return t>=e&&i>=t},i.prototype.div=function(t,e){return Math.floor(t/e)},i.prototype.stringToCodePoints=function(t){for(var e=[],i=0,r=t.length;i<t.length;){var n=t.charCodeAt(i);if(this.inRange(n,55296,57343))if(this.inRange(n,56320,57343))e.push(65533);else if(i==r-1)e.push(65533);else{var a=t.charCodeAt(i+1);if(this.inRange(a,56320,57343)){var o=1023&n,s=1023&a;i+=1,e.push(65536+(o<<10)+s)}else e.push(65533)}else e.push(n);i+=1}return e},i}();t.ByteArray=i,__reflect(i.prototype,"egret.ByteArray")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.$graphics=new t.Graphics,i.$graphics.$setTarget(i),i}return __extends(i,e),i.prototype.createNativeDisplayObject=function(){this.$nativeDisplayObject=new egret_native.NativeDisplayObject(9)},Object.defineProperty(i.prototype,"graphics",{get:function(){return this.$graphics},enumerable:!0,configurable:!0}),i.prototype.$hitTest=function(e,i){if(!this.$visible)return null;var r=this.$getInvertedConcatenatedMatrix(),n=r.a*e+r.c*i+r.tx,a=r.b*e+r.d*i+r.ty,o=this.$scrollRect?this.$scrollRect:this.$maskRect;if(o&&!o.contains(n,a))return null;if(this.$mask&&!this.$mask.$hitTest(e,i))return null;for(var s=this.$children,l=!1,h=null,c=s.length-1;c>=0;c--){var u=s[c];if(!u.$maskedObject&&(h=u.$hitTest(e,i))){if(l=!0,h.$touchEnabled)break;h=null}}return h?this.$touchChildren?h:this:l?this:(h=t.DisplayObject.prototype.$hitTest.call(this,e,i),h&&(h=this.$graphics.$hitTest(e,i)),h)},i.prototype.$measureContentBounds=function(t){this.$graphics.$measureContentBounds(t)},i.prototype.$onRemoveFromStage=function(){e.prototype.$onRemoveFromStage.call(this),this.$graphics&&this.$graphics.$onRemoveFromStage()},i}(t.DisplayObjectContainer);t.Sprite=e,__reflect(e.prototype,"egret.Sprite")}(egret||(egret={}));var egret;!function(t){function e(t,e,i){var r=t.prototype;Object.defineProperty(r,"__class__",{value:e,enumerable:!1,writable:!0});var n=[e];i&&(n=n.concat(i));var a=r.__types__;if(r.__types__)for(var o=a.length,s=0;o>s;s++){var l=a[s];-1==n.indexOf(l)&&n.push(l)}Object.defineProperty(r,"__types__",{value:n,enumerable:!1,writable:!0})}t.registerClass=e}(egret||(egret={}));var egret;!function(t){t.BitmapFillMode={REPEAT:"repeat",SCALE:"scale",CLIP:"clip"}}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return Object.defineProperty(t,"logLevel",{set:function(t){},enumerable:!0,configurable:!0}),t.ALL="all",t.DEBUG="debug",t.INFO="info",t.WARN="warn",t.ERROR="error",t.OFF="off",t}();t.Logger=e,__reflect(e.prototype,"egret.Logger")}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.isNumber=function(t){return"number"==typeof t&&!isNaN(t)},t.sin=function(e){var i=Math.floor(e),r=i+1,n=t.sinInt(i);if(i==e)return n;var a=t.sinInt(r);return(e-i)*a+(r-e)*n},t.sinInt=function(t){return t%=360,0>t&&(t+=360),egret_sin_map[t]},t.cos=function(e){var i=Math.floor(e),r=i+1,n=t.cosInt(i);if(i==e)return n;var a=t.cosInt(r);return(e-i)*a+(r-e)*n},t.cosInt=function(t){return t%=360,0>t&&(t+=360),egret_cos_map[t]},t.convertStringToHashCode=function(t){if(0===t.length)return 0;for(var e=0,i=0,r=t.length;r>i;++i){var n=t.charCodeAt(i);e=(e<<5)-e+n,e|=0}return e},t}();t.NumberUtils=e,__reflect(e.prototype,"egret.NumberUtils")}(egret||(egret={}));for(var egret_sin_map={},egret_cos_map={},DEG_TO_RAD=Math.PI/180,NumberUtils_i=0;360>NumberUtils_i;NumberUtils_i++)egret_sin_map[NumberUtils_i]=Math.sin(NumberUtils_i*DEG_TO_RAD),egret_cos_map[NumberUtils_i]=Math.cos(NumberUtils_i*DEG_TO_RAD);egret_sin_map[90]=1,egret_cos_map[90]=0,egret_sin_map[180]=0,egret_cos_map[180]=-1,egret_sin_map[270]=-1,egret_cos_map[270]=0,Function.prototype.bind||(Function.prototype.bind=function(t){"function"!=typeof this&&egret.$error(1029);var e=Array.prototype.slice.call(arguments,1),i=this,r=function(){},n=function(){return i.apply(this instanceof r&&t?this:t,e.concat(Array.prototype.slice.call(arguments)))};return r.prototype=this.prototype,n.prototype=new r,n});var egret;!function(t){var e=function(e){function i(t,i){void 0===i&&(i=0);var r=e.call(this)||this;return r._delay=0,r._currentCount=0,r._running=!1,r.updateInterval=1e3,r.lastCount=1e3,r.lastTimeStamp=0,r.delay=t,r.repeatCount=0|+i,r}return __extends(i,e),Object.defineProperty(i.prototype,"delay",{get:function(){return this._delay},set:function(t){1>t&&(t=1),this._delay!=t&&(this._delay=t,this.lastCount=this.updateInterval=Math.round(60*t))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"currentCount",{get:function(){return this._currentCount},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"running",{get:function(){return this._running},enumerable:!0,configurable:!0}),i.prototype.reset=function(){this.stop(),this._currentCount=0},i.prototype.start=function(){this._running||(this.lastCount=this.updateInterval,this.lastTimeStamp=t.getTimer(),t.ticker.$startTick(this.$update,this),this._running=!0)},i.prototype.stop=function(){this._running&&(t.stopTick(this.$update,this),this._running=!1)},i.prototype.$update=function(e){var i=e-this.lastTimeStamp;if(i>=this._delay)this.lastCount=this.updateInterval;else{if(this.lastCount-=1e3,this.lastCount>0)return!1;this.lastCount+=this.updateInterval}this.lastTimeStamp=e,this._currentCount++;var r=this.repeatCount>0&&this._currentCount>=this.repeatCount;return(0==this.repeatCount||this._currentCount<=this.repeatCount)&&t.TimerEvent.dispatchTimerEvent(this,t.TimerEvent.TIMER),r&&(this.stop(),t.TimerEvent.dispatchTimerEvent(this,t.TimerEvent.TIMER_COMPLETE)),!1},i}(t.EventDispatcher);t.Timer=e,__reflect(e.prototype,"egret.Timer")}(egret||(egret={}));var egret;!function(t){}(egret||(egret={}));var egret;!function(t){function e(e,i){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];t.$callLaterFunctionList.push(e),t.$callLaterThisList.push(i),t.$callLaterArgsList.push(r)}function i(e,i){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];t.$callAsyncFunctionList.push(e),t.$callAsyncThisList.push(i),t.$callAsyncArgsList.push(r)}t.$callLaterFunctionList=[],t.$callLaterThisList=[],t.$callLaterArgsList=[],t.callLater=e,t.$callAsyncFunctionList=[],t.$callAsyncThisList=[],t.$callAsyncArgsList=[],t.$callAsync=i}(egret||(egret={}));var egret;!function(t){function e(t,e,i){for(var r=[],n=3;n<arguments.length;n++)r[n-3]=arguments[n];var a,o=t.prototype;t.hasOwnProperty("__sets__")||Object.defineProperty(t,"__sets__",{value:{}}),a=t.__sets__;var s=a[i];if(s)return s.apply(e,r);var l=Object.getPrototypeOf(o);if(null!=l){for(;!l.hasOwnProperty(i);)if(l=Object.getPrototypeOf(l),null==l)return;s=Object.getOwnPropertyDescriptor(l,i).set,a[i]=s,s.apply(e,r)}}function i(t,e,i){var r,n=t.prototype;t.hasOwnProperty("__gets__")||Object.defineProperty(t,"__gets__",{value:{}}),r=t.__gets__;var a=r[i];if(a)return a.call(e);var o=Object.getPrototypeOf(n);if(null!=o){for(;!o.hasOwnProperty(i);)if(o=Object.getPrototypeOf(o),null==o)return;return a=Object.getOwnPropertyDescriptor(o,i).get,r[i]=a,a.call(e)}}t.superSetter=e,t.superGetter=i}(egret||(egret={}));var egret;!function(t){function e(t){if(!t)return null;var e=i[t];if(e)return e;var r=t.split("."),n=r.length;e=global;for(var a=0;n>a;a++){var o=r[a];if(e=e[o],!e)return null}return i[t]=e,e}var i={};t.getDefinitionByName=e}(egret||(egret={}));var egret;!function(t){}(egret||(egret={}));var egret;!function(t){function e(t){var e=typeof t;if(!t||"object"!=e&&!t.prototype)return e;var i=t.prototype?t.prototype:Object.getPrototypeOf(t);if(i.hasOwnProperty("__class__"))return i.__class__;var r=i.constructor.toString().trim(),n=r.indexOf("("),a=r.substring(9,n);return Object.defineProperty(i,"__class__",{value:a,enumerable:!1,writable:!0}),a}t.getQualifiedClassName=e}(egret||(egret={}));var egret;!function(t){function e(e){if(!e||"object"!=typeof e&&!e.prototype)return null;var i=e.prototype?e.prototype:Object.getPrototypeOf(e),r=Object.getPrototypeOf(i);if(!r)return null;var n=t.getQualifiedClassName(r.constructor);return n?n:null}t.getQualifiedSuperclassName=e}(egret||(egret={}));var egret;!function(t){function e(){return Date.now()-t.sys.$START_TIME}t.getTimer=e}(egret||(egret={}));var egret;!function(t){function e(e){var i=t.getDefinitionByName(e);return i?!0:!1}t.hasDefinition=e}(egret||(egret={}));var egret;!function(t){function e(t,e){if(!t||"object"!=typeof t)return!1;var i=Object.getPrototypeOf(t),r=i?i.__types__:null;return r?-1!==r.indexOf(e):!1}t.is=e}(egret||(egret={}));var egret;!function(t){function e(e,i){t.ticker.$startTick(e,i)}t.startTick=e}(egret||(egret={}));var egret;!function(t){function e(e,i){t.ticker.$stopTick(e,i)}t.stopTick=e}(egret||(egret={}));var egret;!function(t){function e(t){0>t&&(t=0),t>16777215&&(t=16777215);for(var e=t.toString(16).toUpperCase();e.length>6;)e=e.slice(1,e.length);for(;e.length<6;)e="0"+e;return"#"+e}t.toColorString=e}(egret||(egret={}));var egret;!function(t){var e;!function(t){}(e=t.sys||(t.sys={}))}(egret||(egret={}));var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);i.prototype=e.prototype,t.prototype=new i},egret;!function(t){var e;!function(e){var i=function(e){function i(i){var r=e.call(this)||this;return r.onUpdate=function(e){var i=new t.GeolocationEvent(t.Event.CHANGE),n=e.coords;i.altitude=n.altitude,i.heading=n.heading,i.accuracy=n.accuracy,i.latitude=n.latitude,i.longitude=n.longitude,i.speed=n.speed,i.altitudeAccuracy=n.altitudeAccuracy,r.dispatchEvent(i)},r.onError=function(e){var i=t.GeolocationEvent.UNAVAILABLE;e.code==e.PERMISSION_DENIED&&(i=t.GeolocationEvent.PERMISSION_DENIED);var n=new t.GeolocationEvent(t.IOErrorEvent.IO_ERROR);n.errorType=i,n.errorMessage=e.message,r.dispatchEvent(n)},r.geolocation=navigator.geolocation,r}return __extends(i,e),i.prototype.start=function(){var e=this.geolocation;e?this.watchId=e.watchPosition(this.onUpdate,this.onError):this.onError({code:2,message:t.sys.tr(3004),PERMISSION_DENIED:1,POSITION_UNAVAILABLE:2})},i.prototype.stop=function(){var t=this.geolocation;t.clearWatch(this.watchId)},i}(t.EventDispatcher);e.WebGeolocation=i,__reflect(i.prototype,"egret.web.WebGeolocation",["egret.Geolocation"])}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.onChange=function(e){var r=new t.MotionEvent(t.Event.CHANGE),n={x:e.acceleration.x,y:e.acceleration.y,z:e.acceleration.z},a={x:e.accelerationIncludingGravity.x,y:e.accelerationIncludingGravity.y,z:e.accelerationIncludingGravity.z},o={alpha:e.rotationRate.alpha,beta:e.rotationRate.beta,gamma:e.rotationRate.gamma};r.acceleration=n,r.accelerationIncludingGravity=a,r.rotationRate=o,i.dispatchEvent(r)},i}return __extends(i,e),i.prototype.start=function(){window.addEventListener("devicemotion",this.onChange)},i.prototype.stop=function(){window.removeEventListener("devicemotion",this.onChange)},i}(t.EventDispatcher);e.WebMotion=i,__reflect(i.prototype,"egret.web.WebMotion",["egret.Motion"])}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){function i(t){if(window.location){var e=location.search;if(""==e)return"";e=e.slice(1);for(var i=e.split("&"),r=i.length,n=0;r>n;n++){var a=i[n],o=a.split("=");if(o[0]==t)return o[1]}}return""}e.getOption=i,t.getOption=i}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=function(i){function r(e){var r=i.call(this)||this;return r.$startTime=0,r.audio=null,r.isStopped=!1,r.canPlay=function(){r.audio.removeEventListener("canplay",r.canPlay);try{r.audio.currentTime=r.$startTime}catch(t){}finally{r.audio.play()}},r.onPlayEnd=function(){return 1==r.$loops?(r.stop(),void r.dispatchEventWith(t.Event.SOUND_COMPLETE)):(r.$loops>0&&r.$loops--,void r.$play())},r._volume=1,e.addEventListener("ended",r.onPlayEnd),r.audio=e,r}return __extends(r,i),r.prototype.$play=function(){if(this.isStopped)return void t.$error(1036);try{this.audio.volume=this._volume,this.audio.currentTime=this.$startTime}catch(e){return void this.audio.addEventListener("canplay",this.canPlay)}this.audio.play()},r.prototype.stop=function(){if(this.audio){this.isStopped||t.sys.$popSoundChannel(this),this.isStopped=!0;var i=this.audio;i.removeEventListener("ended",this.onPlayEnd),i.removeEventListener("canplay",this.canPlay),i.volume=0,this._volume=0,this.audio=null;var r=this.$url;window.setTimeout(function(){i.pause(),e.HtmlSound.$recycle(r,i)},200)}},Object.defineProperty(r.prototype,"volume",{get:function(){return this._volume},set:function(e){return this.isStopped?void t.$error(1036):(this._volume=e,void(this.audio&&(this.audio.volume=e)))},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"position",{get:function(){return this.audio?this.audio.currentTime:0},enumerable:!0,configurable:!0}),r}(t.EventDispatcher);e.HtmlSoundChannel=i,__reflect(i.prototype,"egret.web.HtmlSoundChannel",["egret.SoundChannel","egret.IEventDispatcher"])}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=function(){function e(){}return e.decodeAudios=function(){if(!(e.decodeArr.length<=0||e.isDecoding)){e.isDecoding=!0;var i=e.decodeArr.shift();e.ctx.decodeAudioData(i.buffer,function(t){i.self.audioBuffer=t,i.success&&i.success(),e.isDecoding=!1,e.decodeAudios()},function(){t.log("sound decode error "+(i.url?i.url:"")),i.fail&&i.fail(),e.isDecoding=!1,e.decodeAudios()})}},e.audioResume=function(){var t=e.ctx;if(t&&"running"!==t.state&&"closed"!==t.state)try{t.resume()}catch(i){}},e.decodeArr=[],e.isDecoding=!1,e}();e.WebAudioDecode=i,__reflect(i.prototype,"egret.web.WebAudioDecode");var r=function(r){function n(){var t=r.call(this)||this;return t.loaded=!1,t}return __extends(n,r),Object.defineProperty(n.prototype,"length",{get:function(){if(this.audioBuffer)return this.audioBuffer.duration;throw new Error("sound not loaded!")},enumerable:!0,configurable:!0}),n.prototype.load=function(e){function r(){a.loaded=!0,a.dispatchEventWith(t.Event.COMPLETE)}function n(){a.dispatchEventWith(t.IOErrorEvent.IO_ERROR)}var a=this;this.url=e;var o=new XMLHttpRequest;o.open("GET",e,!0),o.responseType="arraybuffer",o.addEventListener("load",function(){var e=o.status>=400;e?a.dispatchEventWith(t.IOErrorEvent.IO_ERROR):(i.decodeArr.push({buffer:o.response,success:r,fail:n,self:a,url:a.url}),i.decodeAudios())}),o.addEventListener("error",function(){a.dispatchEventWith(t.IOErrorEvent.IO_ERROR)}),o.send()},n.prototype.play=function(i,r){i=+i||0,r=+r||0;var n=new e.WebAudioSoundChannel;return n.$url=this.url,n.$loops=r,n.$audioBuffer=this.audioBuffer,n.$startTime=i,n.$play(),t.sys.$pushSoundChannel(n),n},n.prototype.close=function(){},n.MUSIC="music",n.EFFECT="effect",n}(t.EventDispatcher);e.WebAudioSound=r,__reflect(r.prototype,"egret.web.WebAudioSound",["egret.Sound"])}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=function(i){function r(){var r=i.call(this)||this;return r.$startTime=0,r.bufferSource=null,r.context=e.WebAudioDecode.ctx,r.isStopped=!1,r._currentTime=0,r._volume=1,r.onPlayEnd=function(){return 1==r.$loops?(r.stop(),void r.dispatchEventWith(t.Event.SOUND_COMPLETE)):(r.$loops>0&&r.$loops--,void r.$play())},r._startTime=0,r.context.createGain?r.gain=r.context.createGain():r.gain=r.context.createGainNode(),r}return __extends(r,i),r.prototype.$play=function(){if(this.isStopped)return void t.$error(1036);this.bufferSource&&(this.bufferSource.onended=null,this.bufferSource=null);var e=this.context,i=this.gain,r=e.createBufferSource();this.bufferSource=r,r.buffer=this.$audioBuffer,r.connect(i),i.connect(e.destination),r.onended=this.onPlayEnd,this._startTime=Date.now(),this.gain.gain.value=this._volume,r.start(0,this.$startTime),this._currentTime=0},r.prototype.stop=function(){if(this.bufferSource){var e=this.bufferSource;e.stop?e.stop(0):e.noteOff(0),e.onended=null,e.disconnect(),this.bufferSource=null,this.$audioBuffer=null}this.isStopped||t.sys.$popSoundChannel(this),this.isStopped=!0},Object.defineProperty(r.prototype,"volume",{get:function(){return this._volume},set:function(e){return this.isStopped?void t.$error(1036):(this._volume=e,void(this.gain.gain.value=e))},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"position",{get:function(){return this.bufferSource?(Date.now()-this._startTime)/1e3+this.$startTime:0},enumerable:!0,configurable:!0}),r}(t.EventDispatcher);e.WebAudioSoundChannel=i,__reflect(i.prototype,"egret.web.WebAudioSoundChannel",["egret.SoundChannel","egret.IEventDispatcher"])}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=function(e){function i(i,r){void 0===r&&(r=!0);var n=e.call(this)||this;return n.loaded=!1,n.closed=!1,n.heightSet=0/0,n.widthSet=0/0,n.waiting=!1,n.userPause=!1,n.userPlay=!1,n.isPlayed=!1,n.screenChanged=function(e){var i=document.fullscreenEnabled||document.webkitIsFullScreen;i||(n.checkFullScreen(!1),t.Capabilities.isMobile||(n._fullscreen=i))},n._fullscreen=!0,n.onVideoLoaded=function(){n.video.removeEventListener("canplay",n.onVideoLoaded);var e=n.video;n.loaded=!0,n.posterData&&(n.posterData.width=n.getPlayWidth(),n.posterData.height=n.getPlayHeight()),e.width=e.videoWidth,e.height=e.videoHeight,window.setTimeout(function(){n.dispatchEventWith(t.Event.COMPLETE)},200)},n.$renderNode=new t.sys.BitmapNode,n.src=i,n.once(t.Event.ADDED_TO_STAGE,n.loadPoster,n),i&&n.load(),n}return __extends(i,e),i.prototype.createNativeDisplayObject=function(){this.$nativeDisplayObject=new egret_native.NativeDisplayObject(1)},i.prototype.load=function(e,i){var r=this;if(void 0===i&&(i=!0),e=e||this.src,this.src=e,!this.video||this.video.src!=e){var n;!this.video||t.Capabilities.isMobile?(n=document.createElement("video"),this.video=n,n.controls=null):n=this.video,n.src=e,n.setAttribute("autoplay","autoplay"),n.setAttribute("webkit-playsinline","true"),n.addEventListener("canplay",this.onVideoLoaded),n.addEventListener("error",function(){return r.onVideoError()}),n.addEventListener("ended",function(){return r.onVideoEnded()});var a=!1;n.addEventListener("canplay",function(){r.waiting=!1,a?r.userPause?r.pause():r.userPlay&&r.play():(a=!0,n.pause())}),n.addEventListener("waiting",function(){r.waiting=!0}),n.load(),this.videoPlay(),n.style.position="absolute",n.style.top="0px",n.style.zIndex="-88888",n.style.left="0px",n.height=1,n.width=1}},i.prototype.play=function(e,i){var r=this;if(void 0===i&&(i=!1),0==this.loaded)return this.load(this.src),void this.once(t.Event.COMPLETE,function(t){return r.play(e,i)},this);this.isPlayed=!0;var n=this.video;void 0!=e&&(n.currentTime=+e||0),n.loop=!!i,t.Capabilities.isMobile?n.style.zIndex="-88888":n.style.zIndex="9999",n.style.position="absolute",n.style.top="0px",n.style.left="0px",n.height=n.videoHeight,n.width=n.videoWidth,"Windows PC"!=t.Capabilities.os&&"Mac OS"!=t.Capabilities.os&&window.setTimeout(function(){n.width=0},1e3),this.checkFullScreen(this._fullscreen)},i.prototype.videoPlay=function(){return this.userPause=!1,this.waiting?void(this.userPlay=!0):(this.userPlay=!1,void this.video.play())},i.prototype.checkFullScreen=function(e){var i=this.video;if(e)null==i.parentElement&&(i.removeAttribute("webkit-playsinline"),document.body.appendChild(i)),t.stopTick(this.markDirty,this),this.goFullscreen();else if(null!=i.parentElement&&i.parentElement.removeChild(i),i.setAttribute("webkit-playsinline","true"),this.setFullScreenMonitor(!1),t.startTick(this.markDirty,this),t.Capabilities.isMobile)return this.video.currentTime=0,void this.onVideoEnded();this.videoPlay()},i.prototype.goFullscreen=function(){var e,i=this.video;return e=t.web.getPrefixStyleName("requestFullscreen",i),i[e]||(e=t.web.getPrefixStyleName("requestFullScreen",i),i[e])?(i.removeAttribute("webkit-playsinline"),i[e](),this.setFullScreenMonitor(!0),!0):!0},i.prototype.setFullScreenMonitor=function(t){var e=this.video;t?(e.addEventListener("mozfullscreenchange",this.screenChanged),e.addEventListener("webkitfullscreenchange",this.screenChanged),e.addEventListener("mozfullscreenerror",this.screenError),e.addEventListener("webkitfullscreenerror",this.screenError)):(e.removeEventListener("mozfullscreenchange",this.screenChanged),e.removeEventListener("webkitfullscreenchange",this.screenChanged),e.removeEventListener("mozfullscreenerror",this.screenError),e.removeEventListener("webkitfullscreenerror",this.screenError))},i.prototype.screenError=function(){t.$error(3014)},i.prototype.exitFullscreen=function(){document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.oCancelFullScreen?document.oCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()},i.prototype.onVideoEnded=function(){this.pause(),this.isPlayed=!1,this.dispatchEventWith(t.Event.ENDED)},i.prototype.onVideoError=function(){this.dispatchEventWith(t.IOErrorEvent.IO_ERROR)},i.prototype.close=function(){var t=this;this.closed=!0,this.video.removeEventListener("canplay",this.onVideoLoaded),this.video.removeEventListener("error",function(){return t.onVideoError()}),this.video.removeEventListener("ended",function(){return t.onVideoEnded()}),this.pause(),0==this.loaded&&this.video&&(this.video.src=""),this.video&&this.video.parentElement&&(this.video.parentElement.removeChild(this.video),this.video=null),this.loaded=!1},i.prototype.pause=function(){return this.userPlay=!1,this.waiting?void(this.userPause=!0):(this.userPause=!1,this.video.pause(),void t.stopTick(this.markDirty,this))},Object.defineProperty(i.prototype,"volume",{get:function(){return this.video?this.video.volume:1},set:function(t){this.video&&(this.video.volume=t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"position",{get:function(){return this.video?this.video.currentTime:0},set:function(t){this.video&&(this.video.currentTime=t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"fullscreen",{get:function(){return this._fullscreen},set:function(e){t.Capabilities.isMobile||(this._fullscreen=!!e,this.video&&0==this.video.paused&&this.checkFullScreen(this._fullscreen))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"bitmapData",{get:function(){return this.video&&this.loaded?(this._bitmapData||(this.video.width=this.video.videoWidth,this.video.height=this.video.videoHeight,this._bitmapData=new t.BitmapData(this.video),this._bitmapData.$deleteSource=!1),this._bitmapData):null},enumerable:!0,configurable:!0}),i.prototype.loadPoster=function(){var e=this,i=this.poster;if(i){var r=new t.ImageLoader;r.once(t.Event.COMPLETE,function(i){if(r.data,e.posterData=r.data,e.$renderDirty=!0,e.posterData.width=e.getPlayWidth(),e.posterData.height=e.getPlayHeight(),t.nativeRender){var n=new t.Texture;n._setBitmapData(e.posterData),e.$nativeDisplayObject.setTexture(n)}},this),r.load(i)}},i.prototype.$measureContentBounds=function(t){var e=this.bitmapData,i=this.posterData;e?t.setTo(0,0,this.getPlayWidth(),this.getPlayHeight()):i?t.setTo(0,0,this.getPlayWidth(),this.getPlayHeight()):t.setEmpty()},i.prototype.getPlayWidth=function(){return isNaN(this.widthSet)?this.bitmapData?this.bitmapData.width:this.posterData?this.posterData.width:0/0:this.widthSet},i.prototype.getPlayHeight=function(){return isNaN(this.heightSet)?this.bitmapData?this.bitmapData.height:this.posterData?this.posterData.height:0/0:this.heightSet},i.prototype.$updateRenderNode=function(){var e=this.$renderNode,i=this.bitmapData,r=this.posterData,n=this.getPlayWidth(),a=this.getPlayHeight();this.isPlayed&&!t.Capabilities.isMobile||!r?this.isPlayed&&i&&(e.image=i,e.imageWidth=i.width,e.imageHeight=i.height,t.WebGLUtils.deleteWebGLTexture(i.webGLTexture),i.webGLTexture=null,e.drawImage(0,0,i.width,i.height,0,0,n,a)):(e.image=r,e.imageWidth=n,e.imageHeight=a,e.drawImage(0,0,r.width,r.height,0,0,n,a))},i.prototype.markDirty=function(){return this.$renderDirty=!0,!0},i.prototype.$setHeight=function(t){if(this.heightSet=t,this.paused){var i=this;this.$renderDirty=!0,window.setTimeout(function(){i.$renderDirty=!1},200)}e.prototype.$setHeight.call(this,t)},i.prototype.$setWidth=function(t){if(this.widthSet=t,this.paused){var i=this;this.$renderDirty=!0,window.setTimeout(function(){i.$renderDirty=!1},200)}e.prototype.$setWidth.call(this,t)},Object.defineProperty(i.prototype,"paused",{get:function(){return this.video?this.video.paused:!0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"length",{get:function(){if(this.video)return this.video.duration;throw new Error("Video not loaded!")},enumerable:!0,configurable:!0}),i}(t.DisplayObject);e.WebVideo=i,__reflect(i.prototype,"egret.web.WebVideo",["egret.Video","egret.DisplayObject"]),t.Video=i}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=function(e){function i(){var t=e.call(this)||this;return t.timeout=0,t._url="",t._method="",t}return __extends(i,e),Object.defineProperty(i.prototype,"response",{get:function(){if(!this._xhr)return null;if(void 0!=this._xhr.response)return this._xhr.response;if("text"==this._responseType)return this._xhr.responseText;if("arraybuffer"==this._responseType&&/msie 9.0/i.test(navigator.userAgent)){var t=window;return t.convertResponseBodyToText(this._xhr.responseBody)}return"document"==this._responseType?this._xhr.responseXML:null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"responseType",{get:function(){return this._responseType},set:function(t){this._responseType=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"withCredentials",{get:function(){return this._withCredentials},set:function(t){this._withCredentials=t},enumerable:!0,configurable:!0}),i.prototype.getXHR=function(){return window.XMLHttpRequest?new window.XMLHttpRequest:new ActiveXObject("MSXML2.XMLHTTP")},i.prototype.open=function(t,e){void 0===e&&(e="GET"),this._url=t,this._method=e,this._xhr&&(this._xhr.abort(),this._xhr=null);var i=this.getXHR();window.XMLHttpRequest?(i.addEventListener("load",this.onload.bind(this)),i.addEventListener("error",this.onerror.bind(this))):i.onreadystatechange=this.onReadyStateChange.bind(this),i.onprogress=this.updateProgress.bind(this),i.ontimeout=this.onTimeout.bind(this),i.open(this._method,this._url,!0),this._xhr=i},i.prototype.send=function(t){if(null!=this._responseType&&(this._xhr.responseType=this._responseType),null!=this._withCredentials&&(this._xhr.withCredentials=this._withCredentials),this.headerObj)for(var e in this.headerObj)this._xhr.setRequestHeader(e,this.headerObj[e]);this._xhr.timeout=this.timeout,this._xhr.send(t)},i.prototype.abort=function(){this._xhr&&this._xhr.abort()},i.prototype.getAllResponseHeaders=function(){if(!this._xhr)return null;var t=this._xhr.getAllResponseHeaders();return t?t:""},i.prototype.setRequestHeader=function(t,e){this.headerObj||(this.headerObj={}),this.headerObj[t]=e},i.prototype.getResponseHeader=function(t){if(!this._xhr)return null;var e=this._xhr.getResponseHeader(t);return e?e:""},i.prototype.onTimeout=function(){this.dispatchEventWith(t.IOErrorEvent.IO_ERROR)},i.prototype.onReadyStateChange=function(){var e=this._xhr;if(4==e.readyState){var i=e.status>=400||0==e.status,r=(this._url,this);window.setTimeout(function(){i?r.dispatchEventWith(t.IOErrorEvent.IO_ERROR):r.dispatchEventWith(t.Event.COMPLETE)},0)}},i.prototype.updateProgress=function(e){e.lengthComputable&&t.ProgressEvent.dispatchProgressEvent(this,t.ProgressEvent.PROGRESS,e.loaded,e.total)},i.prototype.onload=function(e){var i=this,r=this._xhr,n=(this._url,r.status>=400);window.setTimeout(function(){n?i.dispatchEventWith(t.IOErrorEvent.IO_ERROR,!1,e):i.dispatchEventWith(t.Event.COMPLETE)},0)},i.prototype.onerror=function(e){var i=(this._url,this);window.setTimeout(function(){i.dispatchEventWith(t.IOErrorEvent.IO_ERROR,!1,e)},0)},i}(t.EventDispatcher);e.WebHttpRequest=i,__reflect(i.prototype,"egret.web.WebHttpRequest",["egret.HttpRequest"]),t.HttpRequest=i}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=window.URL||window.webkitURL,r=function(r){function n(){var t=null!==r&&r.apply(this,arguments)||this;return t.data=null,t._crossOrigin=null,t._hasCrossOriginSet=!1,t.currentImage=null,t.request=null,t}return __extends(n,r),Object.defineProperty(n.prototype,"crossOrigin",{get:function(){return this._crossOrigin},set:function(t){this._hasCrossOriginSet=!0,this._crossOrigin=t},enumerable:!0,configurable:!0}),n.prototype.load=function(i){if(e.Html5Capatibility._canUseBlob&&0!=i.indexOf("wxLocalResource:")&&0!=i.indexOf("data:")&&0!=i.indexOf("http:")&&0!=i.indexOf("https:")&&0!=i.indexOf("shopee:")){var r=this.request;r||(r=this.request=new t.web.WebHttpRequest,r.addEventListener(t.Event.COMPLETE,this.onBlobLoaded,this),r.addEventListener(t.IOErrorEvent.IO_ERROR,this.onBlobError,this),r.responseType="blob"),r.open(i),r.send()}else this.loadImage(i)},n.prototype.onBlobLoaded=function(t){var e=this.request.response;this.request=void 0,this.loadImage(i.createObjectURL(e))},n.prototype.onBlobError=function(t){this.dispatchIOError(this.currentURL),this.request=void 0},n.prototype.loadImage=function(t){var e=new Image;this.data=null,this.currentImage=e,this._hasCrossOriginSet?this._crossOrigin&&(e.crossOrigin=this._crossOrigin):n.crossOrigin&&(e.crossOrigin=n.crossOrigin),e.onload=this.onImageComplete.bind(this),e.onerror=this.onLoadError.bind(this),e.src=t},n.prototype.onImageComplete=function(e){var i=this.getImage(e);if(i){this.data=new t.BitmapData(i);var r=this;window.setTimeout(function(){r.dispatchEventWith(t.Event.COMPLETE)},0)}},n.prototype.onLoadError=function(t){var e=this.getImage(t);e&&this.dispatchIOError(e.src)
},n.prototype.dispatchIOError=function(e){var i=this;window.setTimeout(function(){i.dispatchEventWith(t.IOErrorEvent.IO_ERROR)},0)},n.prototype.getImage=function(e){var r=e.target,n=r.src;if(0==n.indexOf("blob:"))try{i.revokeObjectURL(r.src)}catch(a){t.$warn(1037)}return r.onerror=null,r.onload=null,this.currentImage!==r?null:(this.currentImage=null,r)},n.crossOrigin=null,n}(t.EventDispatcher);e.WebImageLoader=r,__reflect(r.prototype,"egret.web.WebImageLoader",["egret.ImageLoader"]),t.ImageLoader=r}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=function(e){function i(){var t=e.call(this)||this;return t._isNeedShow=!1,t.inputElement=null,t.inputDiv=null,t._gscaleX=0,t._gscaleY=0,t.textValue="",t.colorValue=16777215,t._styleInfoes={},t}return __extends(i,e),i.prototype.$setTextField=function(t){return this.$textfield=t,!0},i.prototype.$addToStage=function(){this.htmlInput=t.web.$getTextAdapter(this.$textfield)},i.prototype._initElement=function(){var e=this.$textfield.localToGlobal(0,0),i=e.x,r=e.y,n=this.htmlInput.$scaleX,a=this.htmlInput.$scaleY;this.inputDiv.style.left=i*n+"px",this.inputDiv.style.top=r*a+"px",this.$textfield.multiline&&this.$textfield.height>this.$textfield.size?(this.inputDiv.style.top=r*a+"px",this.inputElement.style.top=-this.$textfield.lineSpacing/2*a+"px"):(this.inputDiv.style.top=r*a+"px",this.inputElement.style.top="0px");for(var o=this.$textfield,s=1,l=1,h=0;o.parent;)s*=o.scaleX,l*=o.scaleY,h+=o.rotation,o=o.parent;var c=t.web.getPrefixStyleName("transform");this.inputDiv.style[c]="rotate("+h+"deg)",this._gscaleX=n*s,this._gscaleY=a*l},i.prototype.$show=function(){this.htmlInput.isCurrentStageText(this)?this.inputElement.onblur=null:(this.inputElement=this.htmlInput.getInputElement(this),this.$textfield.multiline?this.inputElement.type="text":this.inputElement.type=this.$textfield.inputType,this.inputDiv=this.htmlInput._inputDIV),this.htmlInput._needShow=!0,this._isNeedShow=!0,this._initElement()},i.prototype.onBlurHandler=function(){this.htmlInput.clearInputElement(),window.scrollTo(0,0)},i.prototype.onFocusHandler=function(){var t=this;window.setTimeout(function(){t.inputElement&&t.inputElement.scrollIntoView()},200)},i.prototype.executeShow=function(){this.inputElement.value=this.$getText(),null==this.inputElement.onblur&&(this.inputElement.onblur=this.onBlurHandler.bind(this)),null==this.inputElement.onfocus&&(this.inputElement.onfocus=this.onFocusHandler.bind(this)),this.$resetStageText(),this.$textfield.maxChars>0?this.inputElement.setAttribute("maxlength",this.$textfield.maxChars):this.inputElement.removeAttribute("maxlength"),this.inputElement.selectionStart=this.inputElement.value.length,this.inputElement.selectionEnd=this.inputElement.value.length,this.inputElement.focus()},i.prototype.$hide=function(){this.htmlInput&&this.htmlInput.disconnectStageText(this)},i.prototype.$getText=function(){return this.textValue||(this.textValue=""),this.textValue},i.prototype.$setText=function(t){return this.textValue=t,this.resetText(),!0},i.prototype.resetText=function(){this.inputElement&&(this.inputElement.value=this.textValue)},i.prototype.$setColor=function(t){return this.colorValue=t,this.resetColor(),!0},i.prototype.resetColor=function(){this.inputElement&&this.setElementStyle("color",t.toColorString(this.colorValue))},i.prototype.$onBlur=function(){},i.prototype._onInput=function(){var e=this;window.setTimeout(function(){e.inputElement&&e.inputElement.selectionStart==e.inputElement.selectionEnd&&(e.textValue=e.inputElement.value,t.Event.dispatchEvent(e,"updateText",!1))},0)},i.prototype.setAreaHeight=function(){var e=this.$textfield;if(e.multiline){var i=t.TextFieldUtils.$getTextHeight(e);if(e.height<=e.size)this.setElementStyle("height",e.size*this._gscaleY+"px"),this.setElementStyle("padding","0px"),this.setElementStyle("lineHeight",e.size*this._gscaleY+"px");else if(e.height<i)this.setElementStyle("height",e.height*this._gscaleY+"px"),this.setElementStyle("padding","0px"),this.setElementStyle("lineHeight",(e.size+e.lineSpacing)*this._gscaleY+"px");else{this.setElementStyle("height",(i+e.lineSpacing)*this._gscaleY+"px");var r=(e.height-i)*this._gscaleY,n=t.TextFieldUtils.$getValign(e),a=r*n,o=r-a;this.setElementStyle("padding",a+"px 0px "+o+"px 0px"),this.setElementStyle("lineHeight",(e.size+e.lineSpacing)*this._gscaleY+"px")}}},i.prototype._onClickHandler=function(e){this._isNeedShow&&(e.stopImmediatePropagation(),this._isNeedShow=!1,this.executeShow(),this.dispatchEvent(new t.Event("focus")))},i.prototype._onDisconnect=function(){this.inputElement=null,this.dispatchEvent(new t.Event("blur"))},i.prototype.setElementStyle=function(t,e){this.inputElement&&this._styleInfoes[t]!=e&&(this.inputElement.style[t]=e)},i.prototype.$removeFromStage=function(){this.inputElement&&this.htmlInput.disconnectStageText(this)},i.prototype.$resetStageText=function(){if(this.inputElement){var e=this.$textfield;this.setElementStyle("fontFamily",e.fontFamily),this.setElementStyle("fontStyle",e.italic?"italic":"normal"),this.setElementStyle("fontWeight",e.bold?"bold":"normal"),this.setElementStyle("textAlign",e.textAlign),this.setElementStyle("fontSize",e.size*this._gscaleY+"px"),this.setElementStyle("color",t.toColorString(e.textColor));var i=void 0;if(e.stage?(i=e.localToGlobal(0,0).x,i=Math.min(e.width,e.stage.stageWidth-i)):i=e.width,this.setElementStyle("width",i*this._gscaleX+"px"),this.setElementStyle("verticalAlign",e.verticalAlign),e.multiline)this.setAreaHeight();else if(this.setElementStyle("lineHeight",e.size*this._gscaleY+"px"),e.height<e.size){this.setElementStyle("height",e.size*this._gscaleY+"px");var r=e.size/2*this._gscaleY;this.setElementStyle("padding","0px 0px "+r+"px 0px")}else{this.setElementStyle("height",e.size*this._gscaleY+"px");var n=(e.height-e.size)*this._gscaleY,a=t.TextFieldUtils.$getValign(e),o=n*a,r=n-o;r<e.size/2*this._gscaleY&&(r=e.size/2*this._gscaleY),this.setElementStyle("padding",o+"px 0px "+r+"px 0px")}this.inputDiv.style.clip="rect(0px "+e.width*this._gscaleX+"px "+e.height*this._gscaleY+"px 0px)",this.inputDiv.style.height=e.height*this._gscaleY+"px",this.inputDiv.style.width=i*this._gscaleX+"px"}},i}(t.EventDispatcher);e.HTML5StageText=i,__reflect(i.prototype,"egret.web.HTML5StageText",["egret.StageText"]),t.StageText=i}(e=t.web||(t.web={}))}(egret||(egret={})),function(t){var e;!function(e){var i=function(){function e(){this._needShow=!1,this.$scaleX=1,this.$scaleY=1}return e.prototype.isInputOn=function(){return null!=this._stageText},e.prototype.isCurrentStageText=function(t){return this._stageText==t},e.prototype.initValue=function(t){t.style.position="absolute",t.style.left="0px",t.style.top="0px",t.style.border="none",t.style.padding="0"},e.prototype.$updateSize=function(){if(this.canvas){this.$scaleX=t.sys.DisplayList.$canvasScaleX,this.$scaleY=t.sys.DisplayList.$canvasScaleY,this.StageDelegateDiv.style.left=this.canvas.style.left,this.StageDelegateDiv.style.top=this.canvas.style.top;var e=t.web.getPrefixStyleName("transform");this.StageDelegateDiv.style[e]=this.canvas.style[e],this.StageDelegateDiv.style[t.web.getPrefixStyleName("transformOrigin")]="0% 0% 0px"}},e.prototype._initStageDelegateDiv=function(e,i){this.canvas=i;var r,n=this;r||(r=document.createElement("div"),this.StageDelegateDiv=r,r.id="StageDelegateDiv",e.appendChild(r),n.initValue(r),n._inputDIV=document.createElement("div"),n.initValue(n._inputDIV),n._inputDIV.style.width="0px",n._inputDIV.style.height="0px",n._inputDIV.style.left="0px",n._inputDIV.style.top="-100px",n._inputDIV.style[t.web.getPrefixStyleName("transformOrigin")]="0% 0% 0px",r.appendChild(n._inputDIV),this.canvas.addEventListener("click",function(t){n._needShow?(n._needShow=!1,n._stageText._onClickHandler(t),n.show()):n._inputElement&&(n.clearInputElement(),n._inputElement.blur(),n._inputElement=null)}),n.initInputElement(!0),n.initInputElement(!1))},e.prototype.initInputElement=function(t){var e,i=this;t?(e=document.createElement("textarea"),e.style.resize="none",i._multiElement=e,e.id="egretTextarea"):(e=document.createElement("input"),i._simpleElement=e,e.id="egretInput"),e.type="text",i._inputDIV.appendChild(e),e.setAttribute("tabindex","-1"),e.style.width="1px",e.style.height="12px",i.initValue(e),e.style.outline="thin",e.style.background="none",e.style.overflow="hidden",e.style.wordBreak="break-all",e.style.opacity=0,e.oninput=function(){i._stageText&&i._stageText._onInput()}},e.prototype.show=function(){var e=this,i=e._inputElement;t.$callAsync(function(){i.style.opacity=1},e)},e.prototype.disconnectStageText=function(t){(null==this._stageText||this._stageText==t)&&(this._inputElement&&this._inputElement.blur(),this.clearInputElement()),this._needShow=!1},e.prototype.clearInputElement=function(){var t=this;if(t._inputElement){t._inputElement.value="",t._inputElement.onblur=null,t._inputElement.onfocus=null,t._inputElement.style.width="1px",t._inputElement.style.height="12px",t._inputElement.style.left="0px",t._inputElement.style.top="0px",t._inputElement.style.opacity=0;var e=void 0;e=t._simpleElement==t._inputElement?t._multiElement:t._simpleElement,e.style.display="block",t._inputDIV.style.left="0px",t._inputDIV.style.top="-100px",t._inputDIV.style.height="0px",t._inputDIV.style.width="0px"}t._stageText&&(t._stageText._onDisconnect(),t._stageText=null,this.canvas.userTyping=!1)},e.prototype.getInputElement=function(t){var e=this;e.clearInputElement(),e._stageText=t,this.canvas.userTyping=!0,e._stageText.$textfield.multiline?e._inputElement=e._multiElement:e._inputElement=e._simpleElement;var i;return i=e._simpleElement==e._inputElement?e._multiElement:e._simpleElement,i.style.display="none",e._inputElement},e}();e.HTMLInput=i,__reflect(i.prototype,"egret.web.HTMLInput")}(e=t.web||(t.web={}))}(egret||(egret={})),function(t){var e;!function(t){function e(t){var e=t.stage?t.stage.$hashCode:0,i=r[e],o=n[e],s=a[e];return o&&s&&(delete n[e],delete a[e]),i}function i(t,e,i,o){t._initStageDelegateDiv(i,o),r[e.$hashCode]=t,n[e.$hashCode]=o,a[e.$hashCode]=i}var r={},n={},a={};t.$getTextAdapter=e,t.$cacheTextAdapter=i}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){function i(e,i,a,o,s){n||r();var l="";return s&&(l+="italic "),o&&(l+="bold "),l+=(a||12)+"px ",l+=i||"Arial",n.font=l,t.sys.measureTextWith(n,e)}function r(){n=t.sys.canvasHitTestBuffer.context,n.textAlign="left",n.textBaseline="middle"}var n=null;t.sys.measureText=i}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){function i(e,i){var r=t.sys.createCanvas(e,i),n=r.getContext("2d");if(void 0===n.imageSmoothingEnabled){for(var a,o=["webkitImageSmoothingEnabled","mozImageSmoothingEnabled","msImageSmoothingEnabled"],s=o.length-1;s>=0&&(a=o[s],void 0===n[a]);s--);try{Object.defineProperty(n,"imageSmoothingEnabled",{get:function(){return this[a]},set:function(t){this[a]=t}})}catch(l){n.imageSmoothingEnabled=n[a]}}return r}var r=function(){function e(e,r,n){this.surface=t.sys.createCanvasRenderBufferSurface(i,e,r,n),this.context=this.surface.getContext("2d"),this.context&&(this.context.$offsetX=0,this.context.$offsetY=0),this.resize(e,r)}return Object.defineProperty(e.prototype,"width",{get:function(){return this.surface.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.surface.height},enumerable:!0,configurable:!0}),e.prototype.resize=function(e,i,r){t.sys.resizeCanvasRenderBuffer(this,e,i,r)},e.prototype.getPixels=function(t,e,i,r){return void 0===i&&(i=1),void 0===r&&(r=1),this.context.getImageData(t,e,i,r).data},e.prototype.toDataURL=function(t,e){return this.surface.toDataURL(t,e)},e.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.surface.width,this.surface.height)},e.prototype.destroy=function(){this.surface.width=this.surface.height=0},e}();e.CanvasRenderBuffer=r,__reflect(r.prototype,"egret.web.CanvasRenderBuffer",["egret.sys.RenderBuffer"])}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=function(i){function r(r,n){var a=i.call(this)||this;return a.onTouchBegin=function(t){e.WebAudioDecode.audioResume();var i=a.getLocation(t);a.touch.onTouchBegin(i.x,i.y,t.identifier)},a.onMouseMove=function(t){0==t.buttons?a.onTouchEnd(t):a.onTouchMove(t)},a.onTouchMove=function(t){var e=a.getLocation(t);a.touch.onTouchMove(e.x,e.y,t.identifier)},a.onTouchEnd=function(t){var e=a.getLocation(t);a.touch.onTouchEnd(e.x,e.y,t.identifier)},a.scaleX=1,a.scaleY=1,a.rotation=0,a.canvas=n,a.touch=new t.sys.TouchHandler(r),a.addListeners(),a}return __extends(r,i),r.prototype.addListeners=function(){var e=this;window.navigator.msPointerEnabled?(this.canvas.addEventListener("MSPointerDown",function(t){t.identifier=t.pointerId,e.onTouchBegin(t),e.prevent(t)},!1),this.canvas.addEventListener("MSPointerMove",function(t){t.identifier=t.pointerId,e.onTouchMove(t),e.prevent(t)},!1),this.canvas.addEventListener("MSPointerUp",function(t){t.identifier=t.pointerId,e.onTouchEnd(t),e.prevent(t)},!1)):(t.Capabilities.isMobile||this.addMouseListener(),this.addTouchListener())},r.prototype.addMouseListener=function(){this.canvas.addEventListener("mousedown",this.onTouchBegin),this.canvas.addEventListener("mousemove",this.onMouseMove),this.canvas.addEventListener("mouseup",this.onTouchEnd)},r.prototype.addTouchListener=function(){var t=this;this.canvas.addEventListener("touchstart",function(e){for(var i=e.changedTouches.length,r=0;i>r;r++)t.onTouchBegin(e.changedTouches[r]);t.prevent(e)},!1),this.canvas.addEventListener("touchmove",function(e){for(var i=e.changedTouches.length,r=0;i>r;r++)t.onTouchMove(e.changedTouches[r]);t.prevent(e)},!1),this.canvas.addEventListener("touchend",function(e){for(var i=e.changedTouches.length,r=0;i>r;r++)t.onTouchEnd(e.changedTouches[r]);t.prevent(e)},!1),this.canvas.addEventListener("touchcancel",function(e){for(var i=e.changedTouches.length,r=0;i>r;r++)t.onTouchEnd(e.changedTouches[r]);t.prevent(e)},!1)},r.prototype.prevent=function(t){t.stopPropagation(),1==t.isScroll||this.canvas.userTyping||t.preventDefault()},r.prototype.getLocation=function(e){e.identifier=+e.identifier||0;var i=document.documentElement,r=this.canvas.getBoundingClientRect(),n=r.left+window.pageXOffset-i.clientLeft,a=r.top+window.pageYOffset-i.clientTop,o=e.pageX-n,s=o,l=e.pageY-a,h=l;return 90==this.rotation?(s=l,h=r.width-o):-90==this.rotation&&(s=r.height-l,h=o),s/=this.scaleX,h/=this.scaleY,t.$TempPoint.setTo(Math.round(s),Math.round(h))},r.prototype.updateScaleMode=function(t,e,i){this.scaleX=t,this.scaleY=e,this.rotation=i},r.prototype.$updateMaxTouches=function(){this.touch.$initMaxTouches()},r}(t.HashObject);e.WebTouchHandler=i,__reflect(i.prototype,"egret.web.WebTouchHandler")}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){t.WebLifeCycleHandler=function(t){var e=function(){document[i]?t.pause():t.resume()};window.addEventListener("focus",t.resume,!1),window.addEventListener("blur",t.pause,!1);var i,r;"undefined"!=typeof document.hidden?(i="hidden",r="visibilitychange"):"undefined"!=typeof document.mozHidden?(i="mozHidden",r="mozvisibilitychange"):"undefined"!=typeof document.msHidden?(i="msHidden",r="msvisibilitychange"):"undefined"!=typeof document.webkitHidden?(i="webkitHidden",r="webkitvisibilitychange"):"undefined"!=typeof document.oHidden&&(i="oHidden",r="ovisibilitychange"),"onpageshow"in window&&"onpagehide"in window&&(window.addEventListener("pageshow",t.resume,!1),window.addEventListener("pagehide",t.pause,!1)),i&&r&&document.addEventListener(r,e,!1);var n=navigator.userAgent,a=/micromessenger/gi.test(n),o=/mqq/gi.test(n),s=/mobile.*qq/gi.test(n);if((s||a)&&(o=!1),o){var l=window.browser||{};l.execWebFn=l.execWebFn||{},l.execWebFn.postX5GamePlayerMessage=function(e){var i=e.type;"app_enter_background"==i?t.pause():"app_enter_foreground"==i&&t.resume()},window.browser=l}}}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){function i(t,e){var i="";if(null!=e)i=r(t,e);else{if(null==o){var n=document.createElement("div").style;o=r("transform",n)}i=o}return""==i?t:i+t.charAt(0).toUpperCase()+t.substring(1,t.length)}function r(t,e){if(t in e)return"";t=t.charAt(0).toUpperCase()+t.substring(1,t.length);for(var i=["webkit","ms","Moz","O"],r=0;r<i.length;r++){var n=i[r]+t;if(n in e)return i[r]}return""}var n=function(){function t(){}return t.WEB_AUDIO=2,t.HTML5_AUDIO=3,t}();e.AudioType=n,__reflect(n.prototype,"egret.web.AudioType");var a=function(i){function r(){return i.call(this)||this}return __extends(r,i),r.$init=function(){var i=navigator.userAgent.toLowerCase();r.ua=i,r._canUseBlob=!1;var a=window.AudioContext||window.webkitAudioContext||window.mozAudioContext,o=i.indexOf("iphone")>=0||i.indexOf("ipad")>=0||i.indexOf("ipod")>=0;if(a)try{e.WebAudioDecode.ctx=new(window.AudioContext||window.webkitAudioContext||window.mozAudioContext)}catch(s){a=!1,r._audioType=n.HTML5_AUDIO}else r._audioType=n.HTML5_AUDIO;var l,h=r._audioType;h==n.WEB_AUDIO&&a||h==n.HTML5_AUDIO?(l=!1,r.setAudioType(h)):!o&&i.indexOf("safari")>=0&&-1===i.indexOf("chrome")?(l=!1,r.setAudioType(n.WEB_AUDIO)):(l=!0,r.setAudioType(n.HTML5_AUDIO)),i.indexOf("android")>=0?l&&a&&r.setAudioType(n.WEB_AUDIO):o&&r.getIOSVersion()>=7&&(r._canUseBlob=!0,l&&a&&r.setAudioType(n.WEB_AUDIO));var c=window.URL||window.webkitURL;c||(r._canUseBlob=!1),i.indexOf("egretnative")>=0&&(r.setAudioType(n.HTML5_AUDIO),r._canUseBlob=!0),t.Sound=r._AudioClass},r.setAudioType=function(e){switch(r._audioType=e,e){case n.WEB_AUDIO:r._AudioClass=t.web.WebAudioSound;break;case n.HTML5_AUDIO:r._AudioClass=t.web.HtmlSound}},r.getIOSVersion=function(){var t=r.ua.toLowerCase().match(/cpu [^\d]*\d.*like mac os x/);if(!t||0==t.length)return 0;var e=t[0];return parseInt(e.match(/\d+(_\d)*/)[0])||0},r._canUseBlob=!1,r._audioType=0,r.ua="",r}(t.HashObject);e.Html5Capatibility=a,__reflect(a.prototype,"egret.web.Html5Capatibility");var o=null;e.getPrefixStyleName=i,e.getPrefix=r}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){function i(t,e){return r(t,e)}function r(t,e){var i=document.createElement("canvas");return isNaN(t)||isNaN(e)||(i.width=t,i.height=e),i}function n(t,e,i,r){if(t){var n=t,a=n.surface;r?(a.width<e&&(a.width=e),a.height<i&&(a.height=i)):(a.width!==e&&(a.width=e),a.height!==i&&(a.height=i)),n.onResize()}}function a(i){for(var r={antialias:e.WebGLRenderContext.antialias,stencil:!0},n=null,a=["webgl","experimental-webgl"],o=0;o<a.length;++o){try{n=i.getContext(a[o],r)}catch(s){}if(n)break}return n||t.$error(1021),n}function o(t){return t?t.getContext("2d"):null}function s(e,i){var r=e,n=r.context,a=n.createTexture();return a?(a[t.glContext]=n,n.bindTexture(n.TEXTURE_2D,a),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1),a[t.UNPACK_PREMULTIPLY_ALPHA_WEBGL]=!0,n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,i),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),a):void(r.contextLost=!0)}function l(e,i,r,n){var a=e,o=a.context,s=o.createTexture();return s?(s[t.glContext]=o,o.bindTexture(o.TEXTURE_2D,s),o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1),s[t.UNPACK_PREMULTIPLY_ALPHA_WEBGL]=!0,o.texImage2D(o.TEXTURE_2D,0,o.RGBA,i,r,0,o.RGBA,o.UNSIGNED_BYTE,n),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),s):(a.contextLost=!0,null)}function h(t,e,i){var r=t,n=r.context;n.activeTexture(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,e.texture);var a=3*e.count;return n.drawElements(n.TRIANGLES,a,n.UNSIGNED_SHORT,2*i),a}function c(t,e){return t.measureText(e).width}function u(t,e,i,r){return t(e,i)}function p(t,e,i,r){var n=t,a=n.surface;if(r){var o=!1;a.width<e&&(a.width=e,o=!0),a.height<i&&(a.height=i,o=!0),o||(n.context.globalCompositeOperation="source-over",n.context.setTransform(1,0,0,1,0,0),n.context.globalAlpha=1)}else a.width!=e&&(a.width=e),a.height!=i&&(a.height=i);n.clear()}t.sys.mainCanvas=i,t.sys.createCanvas=r,e.resizeContext=n,t.sys.resizeContext=n,t.sys.getContextWebGL=a,e.getContext2d=o,t.sys.getContext2d=o,t.sys.createTexture=s,t.sys._createTexture=l,t.sys.drawTextureElements=h,t.sys.measureTextWith=c,t.sys.createCanvasRenderBufferSurface=u,t.sys.resizeCanvasRenderBuffer=p,t.Geolocation=t.web.WebGeolocation,t.Motion=t.web.WebMotion}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){function i(){if(s)for(var t=document.querySelectorAll(".egret-player"),e=t.length,i=0;e>i;i++){var r=t[i],n=r["egret-player"];n.updateScreenSize()}}function r(i){if(!s){s=!0,i||(i={});var r=navigator.userAgent.toLowerCase();if(r.indexOf("egretnative")>=0&&-1==r.indexOf("egretwebview")&&(t.Capabilities.runtimeType=t.RuntimeType.RUNTIME2),r.indexOf("egretnative")>=0&&t.nativeRender)egret_native.addModuleCallback(function(){if(e.Html5Capatibility.$init(),"webgl"==i.renderMode){var r=i.antialias;e.WebGLRenderContext.antialias=!!r}t.sys.CanvasRenderBuffer=e.CanvasRenderBuffer,n(i.renderMode),egret_native.nrSetRenderMode(2);var s;s=i.canvasScaleFactor?i.canvasScaleFactor:i.calculateCanvasScaleFactor?i.calculateCanvasScaleFactor(t.sys.canvasHitTestBuffer.context):window.devicePixelRatio,t.sys.DisplayList.$canvasScaleFactor=s;var h=t.ticker;a(h),i.screenAdapter?t.sys.screenAdapter=i.screenAdapter:t.sys.screenAdapter||(t.sys.screenAdapter=new t.sys.DefaultScreenAdapter);for(var c=document.querySelectorAll(".egret-player"),u=c.length,p=0;u>p;p++){var d=c[p],f=new e.WebPlayer(d,i);d["egret-player"]=f}window.addEventListener("resize",function(){isNaN(l)&&(l=window.setTimeout(o,300))})},null),egret_native.initNativeRender();else{e.Html5Capatibility._audioType=i.audioType,e.Html5Capatibility.$init();var h=i.renderMode;if("webgl"==h){var c=i.antialias;e.WebGLRenderContext.antialias=!!c}t.sys.CanvasRenderBuffer=e.CanvasRenderBuffer,r.indexOf("egretnative")>=0&&"webgl"!=h&&(t.$warn(1051),h="webgl"),n(h);var u=void 0;if(i.canvasScaleFactor)u=i.canvasScaleFactor;else if(i.calculateCanvasScaleFactor)u=i.calculateCanvasScaleFactor(t.sys.canvasHitTestBuffer.context);else{var p=t.sys.canvasHitTestBuffer.context,d=p.backingStorePixelRatio||p.webkitBackingStorePixelRatio||p.mozBackingStorePixelRatio||p.msBackingStorePixelRatio||p.oBackingStorePixelRatio||p.backingStorePixelRatio||1;u=(window.devicePixelRatio||1)/d}t.sys.DisplayList.$canvasScaleFactor=u;var f=t.ticker;a(f),i.screenAdapter?t.sys.screenAdapter=i.screenAdapter:t.sys.screenAdapter||(t.sys.screenAdapter=new t.sys.DefaultScreenAdapter);for(var g=document.querySelectorAll(".egret-player"),m=g.length,y=0;m>y;y++){var v=g[y],_=new e.WebPlayer(v,i);v["egret-player"]=_}window.addEventListener("resize",function(){isNaN(l)&&(l=window.setTimeout(o,300))})}}}function n(i){"webgl"==i&&t.WebGLUtils.checkCanUseWebGL()?(t.sys.RenderBuffer=e.WebGLRenderBuffer,t.sys.systemRenderer=new e.WebGLRenderer,t.sys.canvasRenderer=new t.CanvasRenderer,t.sys.customHitTestBuffer=new e.WebGLRenderBuffer(3,3),t.sys.canvasHitTestBuffer=new e.CanvasRenderBuffer(3,3),t.Capabilities.renderMode="webgl"):(t.sys.RenderBuffer=e.CanvasRenderBuffer,t.sys.systemRenderer=new t.CanvasRenderer,t.sys.canvasRenderer=t.sys.systemRenderer,t.sys.customHitTestBuffer=new e.CanvasRenderBuffer(3,3),t.sys.canvasHitTestBuffer=t.sys.customHitTestBuffer,t.Capabilities.renderMode="canvas")}function a(t){function e(){i(e),t.update()}var i=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame;i||(i=function(t){return window.setTimeout(t,1e3/60)}),i(e)}function o(){l=0/0,t.updateAllScreens()}var s=!1;window.isNaN=function(t){return t=+t,t!==t},t.runEgret=r,t.updateAllScreens=i;var l=0/0}(e=t.web||(t.web={}))}(egret||(egret={}));var language,egret;!function(t){var e;!function(e){var i=function(){function e(){}return e.detect=function(){var i=t.Capabilities,r=navigator.userAgent.toLowerCase();i.isMobile=-1!=r.indexOf("mobile")||-1!=r.indexOf("android"),i.isMobile?r.indexOf("windows")<0&&(-1!=r.indexOf("iphone")||-1!=r.indexOf("ipad")||-1!=r.indexOf("ipod"))?i.os="iOS":-1!=r.indexOf("android")&&-1!=r.indexOf("linux")?i.os="Android":-1!=r.indexOf("windows")&&(i.os="Windows Phone"):-1!=r.indexOf("windows nt")?i.os="Windows PC":-1!=r.indexOf("mac os")&&(i.os="Mac OS");var n=(navigator.language||navigator.browserLanguage).toLowerCase(),a=n.split("-");a.length>1&&(a[1]=a[1].toUpperCase()),i.language=a.join("-"),e.injectUIntFixOnIE9()},e.injectUIntFixOnIE9=function(){if(/msie 9.0/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)){var t="<!-- IEBinaryToArray_ByteStr -->\r\n<script type='text/vbscript' language='VBScript'>\r\nFunction IEBinaryToArray_ByteStr(Binary)\r\n   IEBinaryToArray_ByteStr = CStr(Binary)\r\nEnd Function\r\nFunction IEBinaryToArray_ByteStr_Last(Binary)\r\n   Dim lastIndex\r\n   lastIndex = LenB(Binary)\r\n   if lastIndex mod 2 Then\r\n       IEBinaryToArray_ByteStr_Last = Chr( AscB( MidB( Binary, lastIndex, 1 ) ) )\r\n   Else\r\n       IEBinaryToArray_ByteStr_Last = \"\"\r\n   End If\r\nEnd Function\r\n</script>\r\n<!-- convertResponseBodyToText -->\r\n<script>\r\nlet convertResponseBodyToText = function (binary) {\r\n   let byteMapping = {};\r\n   for ( let i = 0; i < 256; i++ ) {\r\n       for ( let j = 0; j < 256; j++ ) {\r\n           byteMapping[ String.fromCharCode( i + j * 256 ) ] =\r\n           String.fromCharCode(i) + String.fromCharCode(j);\r\n       }\r\n   }\r\n   let rawBytes = IEBinaryToArray_ByteStr(binary);\r\n   let lastChr = IEBinaryToArray_ByteStr_Last(binary);\r\n   return rawBytes.replace(/[\\s\\S]/g,                           function( match ) { return byteMapping[match]; }) + lastChr;\r\n};\r\n</script>\r\n";document.write(t)}},e}();e.WebCapability=i,__reflect(i.prototype,"egret.web.WebCapability"),i.detect()}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=function(){function e(e,i,r,n,a){if(this.showPanle=!0,this.fpsHeight=0,this.WIDTH=101,this.HEIGHT=20,this.bgCanvasColor="#18304b",this.fpsFrontColor="#18fefe",this.WIDTH_COST=50,this.cost1Color="#18fefe",this.cost3Color="#ff0000",this.arrFps=[],this.arrCost=[],this.arrLog=[],i||r){"canvas"==t.Capabilities.renderMode?this.renderMode="Canvas":this.renderMode="WebGL",this.panelX=void 0===a.x?0:parseInt(a.x),this.panelY=void 0===a.y?0:parseInt(a.y),this.fontColor=void 0===a.textColor?"#ffffff":a.textColor.replace("0x","#"),this.fontSize=void 0===a.size?12:parseInt(a.size),t.Capabilities.isMobile&&(this.fontSize-=2);var o=document.createElement("div");o.style.position="absolute",o.style.background="rgba(0,0,0,"+a.bgAlpha+")",o.style.left=this.panelX+"px",o.style.top=this.panelY+"px",o.style.pointerEvents="none",o.id="egret-fps-panel",document.body.appendChild(o);var s=document.createElement("div");s.style.color=this.fontColor,s.style.fontSize=this.fontSize+"px",s.style.lineHeight=this.fontSize+"px",s.style.margin="4px 4px 4px 4px",this.container=s,o.appendChild(s),i&&this.addFps(),r&&this.addLog()}}return e.prototype.addFps=function(){var t=document.createElement("div");t.style.display="inline-block",this.containerFps=t,this.container.appendChild(t);var e=document.createElement("div");e.style.paddingBottom="2px",this.fps=e,this.containerFps.appendChild(e),e.innerHTML="0 FPS "+this.renderMode+"<br/>min0 max0 avg0";var i=document.createElement("canvas");this.containerFps.appendChild(i),i.width=this.WIDTH,i.height=this.HEIGHT,this.canvasFps=i;var r=i.getContext("2d");this.contextFps=r,r.fillStyle=this.bgCanvasColor,r.fillRect(0,0,this.WIDTH,this.HEIGHT);var n=document.createElement("div");this.divDatas=n,this.containerFps.appendChild(n);var a=document.createElement("div");a.style["float"]="left",a.innerHTML="Draw<br/>GPU Size<br/>Cost",n.appendChild(a);var o=document.createElement("div");o.style.paddingLeft=a.offsetWidth+20+"px",n.appendChild(o);var s=document.createElement("div");this.divDraw=s,s.innerHTML="0<br/>0<br/>",o.appendChild(s);var l=document.createElement("div");this.divCost=l,l.innerHTML='<font  style="color:'+this.cost1Color+'">0<font/> <font  style="color:'+this.cost3Color+'">0<font/>',o.appendChild(l),i=document.createElement("canvas"),this.canvasCost=i,this.containerFps.appendChild(i),i.width=this.WIDTH,i.height=this.HEIGHT,r=i.getContext("2d"),this.contextCost=r,r.fillStyle=this.bgCanvasColor,r.fillRect(0,0,this.WIDTH,this.HEIGHT),r.fillStyle="#000000",r.fillRect(this.WIDTH_COST,0,1,this.HEIGHT),this.fpsHeight=this.container.offsetHeight},e.prototype.addLog=function(){var t=document.createElement("div");t.style.maxWidth=document.body.clientWidth-8-this.panelX+"px",t.style.wordWrap="break-word",this.log=t,this.container.appendChild(t)},e.prototype.update=function(t,e){void 0===e&&(e=!1);var i,r,n;e?(i=this.arrFps[this.arrFps.length-1],r=this.arrCost[this.arrCost.length-1][0],n=this.arrCost[this.arrCost.length-1][1]):(i=t.fps,r=t.costTicker,n=t.costRender,this.lastNumDraw=t.draw,this.arrFps.push(i),this.arrCost.push([r,n]));var a=0,o=this.arrFps.length;o>101&&(o=101,this.arrFps.shift(),this.arrCost.shift());for(var s=this.arrFps[0],l=this.arrFps[0],h=0;o>h;h++){var c=this.arrFps[h];a+=c,s>c?s=c:c>l&&(l=c)}var u=this.WIDTH,p=this.HEIGHT,d=this.contextFps;d.drawImage(this.canvasFps,1,0,u-1,p,0,0,u-1,p),d.fillStyle=this.bgCanvasColor,d.fillRect(u-1,0,1,p);var f=Math.floor(i/60*20);1>f&&(f=1),d.fillStyle=this.fpsFrontColor,d.fillRect(u-1,20-f,1,f);var g=this.WIDTH_COST;d=this.contextCost,d.drawImage(this.canvasCost,1,0,g-1,p,0,0,g-1,p),d.drawImage(this.canvasCost,g+2,0,g-1,p,g+1,0,g-1,p);var m=Math.floor(r/2);1>m?m=1:m>20&&(m=20);var y=Math.floor(n/2);1>y?y=1:y>20&&(y=20),d.fillStyle=this.bgCanvasColor,d.fillRect(g-1,0,1,p),d.fillRect(2*g,0,1,p),d.fillRect(3*g+1,0,1,p),d.fillStyle=this.cost1Color,d.fillRect(g-1,20-m,1,m),d.fillStyle=this.cost3Color,d.fillRect(2*g,20-y,1,y);var v=Math.floor(a/o),_=i+" FPS "+this.renderMode;this.showPanle&&(_+="<br/>min"+s+" max"+l+" avg"+v,this.divDraw.innerHTML=this.lastNumDraw+"<br/>"+window.RES.profile()+"m<br/>",this.divCost.innerHTML='<font  style="color:#18fefe">'+r+'<font/> <font  style="color:#ff0000">'+n+"<font/>"),this.fps.innerHTML=_},e.prototype.updateInfo=function(t){this.arrLog.push(t),this.updateLogLayout()},e.prototype.updateWarn=function(t){this.arrLog.push("[Warning]"+t),this.updateLogLayout()},e.prototype.updateError=function(t){this.arrLog.push("[Error]"+t),this.updateLogLayout()},e.prototype.updateLogLayout=function(){for(this.log.innerHTML=this.arrLog.join("<br/>");document.body.clientHeight<this.log.offsetHeight+this.fpsHeight+this.panelY+2*this.fontSize;)this.arrLog.shift(),this.log.innerHTML=this.arrLog.join("<br/>")},e}();e.WebFps=i,__reflect(i.prototype,"egret.web.WebFps",["egret.FPSDisplay"]),t.FPSDisplay=i}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i;!function(i){function r(t){return window.localStorage.getItem(t)}function n(e,i){try{return window.localStorage.setItem(e,i),!0}catch(r){return t.$warn(1047,e,i),!1}}function a(t){window.localStorage.removeItem(t)}function o(){window.localStorage.clear()}e.getItem=r,e.setItem=n,e.removeItem=a,e.clear=o}(i=e.web||(e.web={}))}(e=t.localStorage||(t.localStorage={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=function(i){function r(t,e){var r=i.call(this)||this;return r.init(t,e),r.initOrientation(),r}return __extends(r,i),r.prototype.init=function(i,r){console.log("Egret Engine Version:",t.Capabilities.engineVersion);var n=this.readOption(i,r),a=new t.Stage;
a.$screen=this,a.$scaleMode=n.scaleMode,a.$orientation=n.orientation,a.$maxTouches=n.maxTouches,a.frameRate=n.frameRate,a.textureScaleFactor=n.textureScaleFactor;var o=new t.sys.RenderBuffer(void 0,void 0,!0),s=o.surface;this.attachCanvas(i,s);var l=new e.WebTouchHandler(a,s),h=new t.sys.Player(o,a,n.entryClassName);t.lifecycle.stage=a,t.lifecycle.addLifecycleListener(e.WebLifeCycleHandler);var c=new e.HTMLInput;(n.showFPS||n.showLog)&&(t.nativeRender||h.displayFPS(n.showFPS,n.showLog,n.logFilter,n.fpsStyles)),this.playerOption=n,this.container=i,this.canvas=s,this.stage=a,this.player=h,this.webTouchHandler=l,this.webInput=c,t.web.$cacheTextAdapter(c,a,i,s),this.updateScreenSize(),this.updateMaxTouches(),h.start()},r.prototype.initOrientation=function(){var e=this;window.addEventListener("orientationchange",function(){window.setTimeout(function(){t.StageOrientationEvent.dispatchStageOrientationEvent(e.stage,t.StageOrientationEvent.ORIENTATION_CHANGE)},350)})},r.prototype.readOption=function(e,i){var r={};r.entryClassName=e.getAttribute("data-entry-class"),r.scaleMode=e.getAttribute("data-scale-mode")||t.StageScaleMode.NO_SCALE,r.frameRate=+e.getAttribute("data-frame-rate")||30,r.contentWidth=+e.getAttribute("data-content-width")||480,r.contentHeight=+e.getAttribute("data-content-height")||800,r.orientation=e.getAttribute("data-orientation")||t.OrientationMode.AUTO,r.maxTouches=+e.getAttribute("data-multi-fingered")||2,r.textureScaleFactor=+e.getAttribute("texture-scale-factor")||1,r.showFPS="true"==e.getAttribute("data-show-fps");for(var n=e.getAttribute("data-show-fps-style")||"",a=n.split(","),o={},s=0;s<a.length;s++){var l=a[s].split(":");o[l[0]]=l[1]}return r.fpsStyles=o,r.showLog="true"==e.getAttribute("data-show-log"),r.logFilter=e.getAttribute("data-log-filter"),r},r.prototype.attachCanvas=function(t,e){var i=e.style;i.cursor="inherit",i.position="absolute",i.top="0",i.bottom="0",i.left="0",i.right="0",t.appendChild(e),i=t.style,i.overflow="hidden",i.position="absolute"},r.prototype.updateScreenSize=function(){var e=this.canvas;if(!e.userTyping){var i=this.playerOption,r=this.container.getBoundingClientRect(),n=0,a=r.width,o=r.height;if(0!=a&&0!=o){r.top<0&&(o+=r.top,n=-r.top);var s=!1,l=this.stage.$orientation;l!=t.OrientationMode.AUTO&&(s=l!=t.OrientationMode.PORTRAIT&&o>a||l==t.OrientationMode.PORTRAIT&&a>o);var h=s?o:a,c=s?a:o;t.Capabilities.boundingClientWidth=h,t.Capabilities.boundingClientHeight=c;var u=t.sys.screenAdapter.calculateStageSize(this.stage.$scaleMode,h,c,i.contentWidth,i.contentHeight),p=u.stageWidth,d=u.stageHeight,f=u.displayWidth,g=u.displayHeight;e.style[t.web.getPrefixStyleName("transformOrigin")]="0% 0% 0px",e.width!=p&&(e.width=p),e.height!=d&&(e.height=d);var m=0;s?l==t.OrientationMode.LANDSCAPE?(m=90,e.style.top=n+(o-f)/2+"px",e.style.left=(a+g)/2+"px"):(m=-90,e.style.top=n+(o+f)/2+"px",e.style.left=(a-g)/2+"px"):(e.style.top=n+(o-g)/2+"px",e.style.left=(a-f)/2+"px");var y=f/p,v=g/d,_=y*t.sys.DisplayList.$canvasScaleFactor,b=v*t.sys.DisplayList.$canvasScaleFactor;"canvas"==t.Capabilities.renderMode&&(_=Math.ceil(_),b=Math.ceil(b));var x=t.Matrix.create();x.identity(),x.scale(y/_,v/b),x.rotate(m*Math.PI/180);var T="matrix("+x.a+","+x.b+","+x.c+","+x.d+","+x.tx+","+x.ty+")";t.Matrix.release(x),e.style[t.web.getPrefixStyleName("transform")]=T,t.sys.DisplayList.$setCanvasScale(_,b),this.webTouchHandler.updateScaleMode(y,v,m),this.webInput.$updateSize(),this.player.updateStageSize(p,d),t.nativeRender&&(e.width=p*_,e.height=d*b)}}},r.prototype.setContentSize=function(t,e){var i=this.playerOption;i.contentWidth=t,i.contentHeight=e,this.updateScreenSize()},r.prototype.updateMaxTouches=function(){this.webTouchHandler.$updateMaxTouches()},r}(t.HashObject);e.WebPlayer=i,__reflect(i.prototype,"egret.web.WebPlayer",["egret.sys.Screen"])}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){function i(e,i){s||(s=t.sys.createCanvas(),l=s.getContext("2d"));var r=e.$getTextureWidth(),n=e.$getTextureHeight();null==i&&(i=t.$TempRectangle,i.x=0,i.y=0,i.width=r,i.height=n),i.x=Math.min(i.x,r-1),i.y=Math.min(i.y,n-1),i.width=Math.min(i.width,r-i.x),i.height=Math.min(i.height,n-i.y);var a=i.width,o=i.height,h=s;if(h.style.width=a+"px",h.style.height=o+"px",s.width=a,s.height=o,"webgl"==t.Capabilities.renderMode){var c=void 0;e.$renderBuffer?c=e:(c=new t.RenderTexture,c.drawToTexture(new t.Bitmap(e)));for(var u=c.$renderBuffer.getPixels(i.x,i.y,a,o),p=new ImageData(a,o),d=0;d<u.length;d++)p.data[d]=u[d];return l.putImageData(p,0,0),e.$renderBuffer||c.dispose(),h}var f=e,g=Math.round(f.$offsetX),m=Math.round(f.$offsetY),y=f.$bitmapWidth,v=f.$bitmapHeight;return l.drawImage(f.$bitmapData.source,f.$bitmapX+i.x/t.$TextureScaleFactor,f.$bitmapY+i.y/t.$TextureScaleFactor,y*i.width/r,v*i.height/n,g,m,i.width,i.height),h}function r(e,r,n){try{var a=i(this,r),o=a.toDataURL(e,n);return o}catch(s){t.$error(1033)}return null}function n(t,e,i,n){var a=r.call(this,t,i,n);if(null!=a){var o=a.replace(/^data:image[^;]*/,"data:image/octet-stream"),s=document.createElement("a");s.download=e,s.href=o;var l=document.createEvent("MouseEvents");l.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),s.dispatchEvent(l)}}function a(e,i){return t.$warn(1041,"getPixel32","getPixels"),this.getPixels(e,i)}function o(e,r,n,a){if(void 0===n&&(n=1),void 0===a&&(a=1),"webgl"==t.Capabilities.renderMode){var o=void 0;this.$renderBuffer?o=this:(o=new t.RenderTexture,o.drawToTexture(new t.Bitmap(this)));var s=o.$renderBuffer.getPixels(e,r,n,a);return s}try{var h=(i(this),l.getImageData(e,r,n,a).data);return h}catch(c){t.$error(1039)}}var s,l;t.Texture.prototype.toDataURL=r,t.Texture.prototype.saveToFile=n,t.Texture.prototype.getPixel32=a,t.Texture.prototype.getPixels=o}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){function i(t){for(var e=s.parseFromString(t,"text/xml"),i=e.childNodes.length,n=0;i>n;n++){var a=e.childNodes[n];if(1==a.nodeType)return r(a,null)}return null}function r(t,e){if("parsererror"==t.localName)throw new Error(t.textContent);for(var i=new a(t.localName,e,t.prefix,t.namespaceURI,t.nodeName),n=t.attributes,s=i.attributes,l=n.length,h=0;l>h;h++){var c=n[h],u=c.name;0!=u.indexOf("xmlns:")&&(s[u]=c.value,i["$"+u]=c.value)}var p=t.childNodes;l=p.length;for(var d=i.children,h=0;l>h;h++){var f=p[h],g=f.nodeType,m=null;if(1==g)m=r(f,i);else if(3==g){var y=f.textContent.trim();y&&(m=new o(y,i))}m&&d.push(m)}return i}var n=function(){function t(t,e){this.nodeType=t,this.parent=e}return t}();e.XMLNode=n,__reflect(n.prototype,"egret.web.XMLNode");var a=function(t){function e(e,i,r,n,a){var o=t.call(this,1,i)||this;return o.attributes={},o.children=[],o.localName=e,o.prefix=r,o.namespace=n,o.name=a,o}return __extends(e,t),e}(n);e.XML=a,__reflect(a.prototype,"egret.web.XML");var o=function(t){function e(e,i){var r=t.call(this,3,i)||this;return r.text=e,r}return __extends(e,t),e}(n);e.XMLText=o,__reflect(o.prototype,"egret.web.XMLText");var s=new DOMParser;t.XML={parse:i}}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.onChange=function(e){var r=new t.OrientationEvent(t.Event.CHANGE);r.beta=e.beta,r.gamma=e.gamma,r.alpha=e.alpha,i.dispatchEvent(r)},i}return __extends(i,e),i.prototype.start=function(){window.addEventListener("deviceorientation",this.onChange)},i.prototype.stop=function(){window.removeEventListener("deviceorientation",this.onChange)},i}(t.EventDispatcher);e.WebDeviceOrientation=i,__reflect(i.prototype,"egret.web.WebDeviceOrientation",["egret.DeviceOrientation"])}(e=t.web||(t.web={}))}(egret||(egret={})),egret.DeviceOrientation=egret.web.WebDeviceOrientation;var egret;!function(t){var e;!function(e){var i=function(){function t(){}return t.call=function(t,e){},t.addCallback=function(t,e){},t}();e.WebExternalInterface=i,__reflect(i.prototype,"egret.web.WebExternalInterface",["egret.ExternalInterface"]);var r=navigator.userAgent.toLowerCase();r.indexOf("egretnative")<0&&(t.ExternalInterface=i)}(e=t.web||(t.web={}))}(egret||(egret={})),function(t){var e;!function(e){function i(e){var i=JSON.parse(e),n=i.functionName,a=r[n];if(a){var o=i.value;a.call(null,o)}else t.$warn(1050,n)}var r={},n=function(){function t(){}return t.call=function(t,e){var i={};i.functionName=t,i.value=e,egret_native.sendInfoToPlugin(JSON.stringify(i))},t.addCallback=function(t,e){r[t]=e},t}();e.NativeExternalInterface=n,__reflect(n.prototype,"egret.web.NativeExternalInterface",["egret.ExternalInterface"]);var a=navigator.userAgent.toLowerCase();a.indexOf("egretnative")>=0&&(t.ExternalInterface=n,egret_native.receivedPluginInfo=i)}(e=t.web||(t.web={}))}(egret||(egret={})),function(t){var e;!function(e){var i={},r=function(){function e(){}return e.call=function(t,e){__global.ExternalInterface.call(t,e)},e.addCallback=function(t,e){i[t]=e},e.invokeCallback=function(e,r){var n=i[e];n?n.call(null,r):t.$warn(1050,e)},e}();e.WebViewExternalInterface=r,__reflect(r.prototype,"egret.web.WebViewExternalInterface",["egret.ExternalInterface"]);var n=navigator.userAgent.toLowerCase();n.indexOf("egretwebview")>=0&&(t.ExternalInterface=r)}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=function(i){function r(){var t=i.call(this)||this;return t.loaded=!1,t.stalled=!1,t}return __extends(r,i),Object.defineProperty(r.prototype,"length",{get:function(){if(this.originAudio)return this.originAudio.duration;throw new Error("sound not loaded!")},enumerable:!0,configurable:!0}),r.prototype.load=function(e){function i(){o(),s.stalled=!0,s.dispatchEventWith(t.Event.COMPLETE)}function n(){r.$recycle(s.url,l),o(),h.indexOf("firefox")>=0&&(l.pause(),l.muted=!1),c&&document.body.appendChild(l),s.loaded=!0,s.dispatchEventWith(t.Event.COMPLETE)}function a(){o(),s.dispatchEventWith(t.IOErrorEvent.IO_ERROR)}function o(){l.removeEventListener("canplaythrough",n),l.removeEventListener("error",a),l.removeEventListener("stalled",i),c&&document.body.removeChild(l)}var s=this;this.url=e;var l=new Audio(e);l.addEventListener("canplaythrough",n),l.addEventListener("error",a),l.addEventListener("stalled",i);var h=navigator.userAgent.toLowerCase();h.indexOf("firefox")>=0&&(l.autoplay=!0,l.muted=!0);var c=h.indexOf("edge")>=0||h.indexOf("trident")>=0;c&&document.body.appendChild(l),l.load(),this.originAudio=l,r.clearAudios[this.url]&&delete r.clearAudios[this.url]},r.prototype.play=function(i,n){i=+i||0,n=+n||0;var a=r.$pop(this.url);null==a&&(a=this.originAudio.cloneNode()),a.autoplay=!0;var o=new e.HtmlSoundChannel(a);return o.$url=this.url,o.$loops=n,o.$startTime=i,o.$play(),t.sys.$pushSoundChannel(o),o},r.prototype.close=function(){this.loaded&&this.originAudio&&(this.originAudio.src=""),this.originAudio&&(this.originAudio=null),r.$clear(this.url),this.loaded=!1},r.$clear=function(t){r.clearAudios[t]=!0;var e=r.audios[t];e&&(e.length=0)},r.$pop=function(t){var e=r.audios[t];return e&&e.length>0?e.pop():null},r.$recycle=function(t,e){if(!r.clearAudios[t]){var i=r.audios[t];null==r.audios[t]&&(i=r.audios[t]=[]),i.push(e)}},r.MUSIC="music",r.EFFECT="effect",r.audios={},r.clearAudios={},r}(t.EventDispatcher);e.HtmlSound=i,__reflect(i.prototype,"egret.web.HtmlSound",["egret.Sound"])}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(){function t(){this.drawData=[],this.drawDataLen=0}return t.prototype.pushDrawRect=function(){if(0==this.drawDataLen||1!=this.drawData[this.drawDataLen-1].type){var t=this.drawData[this.drawDataLen]||{};t.type=1,t.count=0,this.drawData[this.drawDataLen]=t,this.drawDataLen++}this.drawData[this.drawDataLen-1].count+=2},t.prototype.pushDrawTexture=function(t,e,i,r,n){if(void 0===e&&(e=2),i){var a=this.drawData[this.drawDataLen]||{};a.type=0,a.texture=t,a.filter=i,a.count=e,a.textureWidth=r,a.textureHeight=n,this.drawData[this.drawDataLen]=a,this.drawDataLen++}else{if(0==this.drawDataLen||0!=this.drawData[this.drawDataLen-1].type||t!=this.drawData[this.drawDataLen-1].texture||this.drawData[this.drawDataLen-1].filter){var a=this.drawData[this.drawDataLen]||{};a.type=0,a.texture=t,a.count=0,this.drawData[this.drawDataLen]=a,this.drawDataLen++}this.drawData[this.drawDataLen-1].count+=e}},t.prototype.pushChangeSmoothing=function(t,e){t.smoothing=e;var i=this.drawData[this.drawDataLen]||{};i.type=10,i.texture=t,i.smoothing=e,this.drawData[this.drawDataLen]=i,this.drawDataLen++},t.prototype.pushPushMask=function(t){void 0===t&&(t=1);var e=this.drawData[this.drawDataLen]||{};e.type=2,e.count=2*t,this.drawData[this.drawDataLen]=e,this.drawDataLen++},t.prototype.pushPopMask=function(t){void 0===t&&(t=1);var e=this.drawData[this.drawDataLen]||{};e.type=3,e.count=2*t,this.drawData[this.drawDataLen]=e,this.drawDataLen++},t.prototype.pushSetBlend=function(t){for(var e=this.drawDataLen,i=!1,r=e-1;r>=0;r--){var n=this.drawData[r];if(n){if((0==n.type||1==n.type)&&(i=!0),!i&&4==n.type){this.drawData.splice(r,1),this.drawDataLen--;continue}if(4==n.type){if(n.value==t)return;break}}}var a=this.drawData[this.drawDataLen]||{};a.type=4,a.value=t,this.drawData[this.drawDataLen]=a,this.drawDataLen++},t.prototype.pushResize=function(t,e,i){var r=this.drawData[this.drawDataLen]||{};r.type=5,r.buffer=t,r.width=e,r.height=i,this.drawData[this.drawDataLen]=r,this.drawDataLen++},t.prototype.pushClearColor=function(){var t=this.drawData[this.drawDataLen]||{};t.type=6,this.drawData[this.drawDataLen]=t,this.drawDataLen++},t.prototype.pushActivateBuffer=function(t){for(var e=this.drawDataLen,i=!1,r=e-1;r>=0;r--){var n=this.drawData[r];!n||(4!=n.type&&7!=n.type&&(i=!0),i||7!=n.type)||(this.drawData.splice(r,1),this.drawDataLen--)}var a=this.drawData[this.drawDataLen]||{};a.type=7,a.buffer=t,a.width=t.rootRenderTarget.width,a.height=t.rootRenderTarget.height,this.drawData[this.drawDataLen]=a,this.drawDataLen++},t.prototype.pushEnableScissor=function(t,e,i,r){var n=this.drawData[this.drawDataLen]||{};n.type=8,n.x=t,n.y=e,n.width=i,n.height=r,this.drawData[this.drawDataLen]=n,this.drawDataLen++},t.prototype.pushDisableScissor=function(){var t=this.drawData[this.drawDataLen]||{};t.type=9,this.drawData[this.drawDataLen]=t,this.drawDataLen++},t.prototype.clear=function(){for(var t=0;t<this.drawDataLen;t++){var e=this.drawData[t];e.type=0,e.count=0,e.texture=null,e.filter=null,e.value="",e.buffer=null,e.width=0,e.height=0,e.textureWidth=0,e.textureHeight=0,e.smoothing=!1,e.x=0,e.y=0}this.drawDataLen=0},t}();t.WebGLDrawCmdManager=e,__reflect(e.prototype,"egret.web.WebGLDrawCmdManager")}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=function(){function e(){this.vertSize=5,this.vertByteSize=4*this.vertSize,this.maxQuadsCount=2048,this.maxVertexCount=4*this.maxQuadsCount,this.maxIndicesCount=6*this.maxQuadsCount,this.vertices=null,this.indices=null,this.indicesForMesh=null,this.vertexIndex=0,this.indexIndex=0,this.hasMesh=!1,this._vertices=null,this._verticesFloat32View=null,this._verticesUint32View=null;var t=this.maxVertexCount*this.vertSize;this.vertices=new Float32Array(t),this._vertices=new ArrayBuffer(this.maxVertexCount*this.vertByteSize),this._verticesFloat32View=new Float32Array(this._vertices),this._verticesUint32View=new Uint32Array(this._vertices),this.vertices=this._verticesFloat32View;var e=this.maxIndicesCount;this.indices=new Uint16Array(e),this.indicesForMesh=new Uint16Array(e);for(var i=0,r=0;e>i;i+=6,r+=4)this.indices[i+0]=r+0,this.indices[i+1]=r+1,this.indices[i+2]=r+2,this.indices[i+3]=r+0,this.indices[i+4]=r+2,this.indices[i+5]=r+3}return e.prototype.reachMaxSize=function(t,e){return void 0===t&&(t=4),void 0===e&&(e=6),this.vertexIndex>this.maxVertexCount-t||this.indexIndex>this.maxIndicesCount-e},e.prototype.getVertices=function(){var t=this.vertices.subarray(0,this.vertexIndex*this.vertSize);return t},e.prototype.getIndices=function(){return this.indices},e.prototype.getMeshIndices=function(){return this.indicesForMesh},e.prototype.changeToMeshIndices=function(){if(!this.hasMesh){for(var t=0,e=this.indexIndex;e>t;++t)this.indicesForMesh[t]=this.indices[t];this.hasMesh=!0}},e.prototype.isMesh=function(){return this.hasMesh},e.prototype.cacheArrays=function(e,i,r,n,a,o,s,l,h,c,u,p,d,f,g){var m=e.globalAlpha;m=Math.min(m,1);var y=e.globalTintColor||16777215,v=e.currentTexture;m=1>m&&v&&v[t.UNPACK_PREMULTIPLY_ALPHA_WEBGL]?t.WebGLUtils.premultiplyTint(y,m):y+(255*m<<24);var _=e.globalMatrix,b=_.a,x=_.b,T=_.c,E=_.d,S=_.tx,C=_.ty,w=e.$offsetX,P=e.$offsetY;if((0!=w||0!=P)&&(S=w*b+P*T+S,C=w*x+P*E+C),!d){(0!=o||0!=s)&&(S=o*b+s*T+S,C=o*x+s*E+C);var D=l/n;1!=D&&(b=D*b,x=D*x);var A=h/a;1!=A&&(T=A*T,E=A*E)}if(d){var I=this.vertices,M=this._verticesUint32View,$=this.vertexIndex*this.vertSize,O=0,R=0,L=0,B=0,k=0,N=0,F=0;for(O=0,L=p.length;L>O;O+=2)R=$+5*O/2,N=d[O],F=d[O+1],B=p[O],k=p[O+1],I[R+0]=b*N+T*F+S,I[R+1]=x*N+E*F+C,g?(I[R+2]=(i+(1-k)*a)/c,I[R+3]=(r+B*n)/u):(I[R+2]=(i+B*n)/c,I[R+3]=(r+k*a)/u),M[R+4]=m;if(this.hasMesh)for(var G=0,U=f.length;U>G;++G)this.indicesForMesh[this.indexIndex+G]=f[G]+this.vertexIndex;this.vertexIndex+=p.length/2,this.indexIndex+=f.length}else{var V=c,H=u,j=n,W=a;i/=V,r/=H;var I=this.vertices,M=this._verticesUint32View,$=this.vertexIndex*this.vertSize;if(g){var X=n;n=a/V,a=X/H,I[$++]=S,I[$++]=C,I[$++]=n+i,I[$++]=r,M[$++]=m,I[$++]=b*j+S,I[$++]=x*j+C,I[$++]=n+i,I[$++]=a+r,M[$++]=m,I[$++]=b*j+T*W+S,I[$++]=E*W+x*j+C,I[$++]=i,I[$++]=a+r,M[$++]=m,I[$++]=T*W+S,I[$++]=E*W+C,I[$++]=i,I[$++]=r,M[$++]=m}else n/=V,a/=H,I[$++]=S,I[$++]=C,I[$++]=i,I[$++]=r,M[$++]=m,I[$++]=b*j+S,I[$++]=x*j+C,I[$++]=n+i,I[$++]=r,M[$++]=m,I[$++]=b*j+T*W+S,I[$++]=E*W+x*j+C,I[$++]=n+i,I[$++]=a+r,M[$++]=m,I[$++]=T*W+S,I[$++]=E*W+C,I[$++]=i,I[$++]=a+r,M[$++]=m;if(this.hasMesh){var z=this.indicesForMesh;z[this.indexIndex+0]=0+this.vertexIndex,z[this.indexIndex+1]=1+this.vertexIndex,z[this.indexIndex+2]=2+this.vertexIndex,z[this.indexIndex+3]=0+this.vertexIndex,z[this.indexIndex+4]=2+this.vertexIndex,z[this.indexIndex+5]=3+this.vertexIndex}this.vertexIndex+=4,this.indexIndex+=6}},e.prototype.clear=function(){this.hasMesh=!1,this.vertexIndex=0,this.indexIndex=0},e}();e.WebGLVertexArrayObject=i,__reflect(i.prototype,"egret.web.WebGLVertexArrayObject")}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=function(i){function r(t,e,r){var n=i.call(this)||this;return n.clearColor=[0,0,0,0],n.useFrameBuffer=!0,n.gl=t,n._resize(e,r),n}return __extends(r,i),r.prototype._resize=function(t,e){t=t||1,e=e||1,1>t&&(t=1),1>e&&(e=1),this.width=t,this.height=e},r.prototype.resize=function(t,e){this._resize(t,e);var i=this.gl;this.frameBuffer&&(i.bindTexture(i.TEXTURE_2D,this.texture),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,this.width,this.height,0,i.RGBA,i.UNSIGNED_BYTE,null)),this.stencilBuffer&&(i.deleteRenderbuffer(this.stencilBuffer),this.stencilBuffer=null)},r.prototype.activate=function(){var t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,this.getFrameBuffer())},r.prototype.getFrameBuffer=function(){return this.useFrameBuffer?this.frameBuffer:null},r.prototype.initFrameBuffer=function(){if(!this.frameBuffer){var t=this.gl;this.texture=this.createTexture(),this.frameBuffer=t.createFramebuffer(),t.bindFramebuffer(t.FRAMEBUFFER,this.frameBuffer),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.texture,0)}},r.prototype.createTexture=function(){var i=e.WebGLRenderContext.getInstance(0,0);return t.sys._createTexture(i,this.width,this.height,null)},r.prototype.clear=function(t){var e=this.gl;t&&this.activate(),e.colorMask(!0,!0,!0,!0),e.clearColor(this.clearColor[0],this.clearColor[1],this.clearColor[2],this.clearColor[3]),e.clear(e.COLOR_BUFFER_BIT)},r.prototype.enabledStencil=function(){if(this.frameBuffer&&!this.stencilBuffer){var t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,this.frameBuffer),this.stencilBuffer=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,this.stencilBuffer),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,this.width,this.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,this.stencilBuffer)}},r.prototype.dispose=function(){t.WebGLUtils.deleteWebGLTexture(this.texture)},r}(t.HashObject);e.WebGLRenderTarget=i,__reflect(i.prototype,"egret.web.WebGLRenderTarget")}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i={},r=function(){function r(i,r){if(this._defaultEmptyTexture=null,this.glID=null,this.projectionX=0/0,this.projectionY=0/0,this.contextLost=!1,this._supportedCompressedTextureInfo=[],this.$scissorState=!1,this.vertSize=5,this.surface=t.sys.mainCanvas(i,r),!t.nativeRender){this.initWebGL(),this.$bufferStack=[];var n=this.context;this.vertexBuffer=n.createBuffer(),this.indexBuffer=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,this.vertexBuffer),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.indexBuffer),this.drawCmdManager=new e.WebGLDrawCmdManager,this.vao=new e.WebGLVertexArrayObject,this.setGlobalCompositeOperation("source-over")}}return r.getInstance=function(t,e){return this.instance?this.instance:(this.instance=new r(t,e),this.instance)},r.prototype.pushBuffer=function(t){this.$bufferStack.push(t),t!=this.currentBuffer&&(this.currentBuffer,this.drawCmdManager.pushActivateBuffer(t)),this.currentBuffer=t},r.prototype.popBuffer=function(){if(!(this.$bufferStack.length<=1)){var t=this.$bufferStack.pop(),e=this.$bufferStack[this.$bufferStack.length-1];t!=e&&this.drawCmdManager.pushActivateBuffer(e),this.currentBuffer=e}},r.prototype.activateBuffer=function(t,e,i){t.rootRenderTarget.activate(),this.bindIndices||this.uploadIndicesArray(this.vao.getIndices()),t.restoreStencil(),t.restoreScissor(),this.onResize(e,i)},r.prototype.uploadVerticesArray=function(t){var e=this.context;e.bufferData(e.ARRAY_BUFFER,t,e.STREAM_DRAW)},r.prototype.uploadIndicesArray=function(t){var e=this.context;e.bufferData(e.ELEMENT_ARRAY_BUFFER,t,e.STATIC_DRAW),this.bindIndices=!0},r.prototype.destroy=function(){this.surface.width=this.surface.height=0},r.prototype.onResize=function(t,e){t=t||this.surface.width,e=e||this.surface.height,this.projectionX=t/2,this.projectionY=-e/2,this.context&&this.context.viewport(0,0,t,e)},r.prototype.resize=function(e,i,r){t.sys.resizeContext(this,e,i,r)},r.prototype._buildSupportedCompressedTextureInfo=function(t){for(var e=[],i=0,r=t;i<r.length;i++){var n=r[i];if(n){var a={extensionName:n.name,supportedFormats:[]};for(var o in n)a.supportedFormats.push([o,n[o]]);var o;e.push(a)}}return e},r.prototype.initWebGL=function(){this.onResize(),this.surface.addEventListener("webglcontextlost",this.handleContextLost.bind(this),!1),this.surface.addEventListener("webglcontextrestored",this.handleContextRestored.bind(this),!1),this.getWebGLContext();var e=this.context;this.$maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),this.pvrtc=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),this.pvrtc&&(this.pvrtc.name="WEBGL_compressed_texture_pvrtc"),this.etc1=e.getExtension("WEBGL_compressed_texture_etc1")||e.getExtension("WEBKIT_WEBGL_compressed_texture_etc1"),this.etc1&&(this.etc1.name="WEBGL_compressed_texture_etc1"),t.Capabilities.supportedCompressedTexture=t.Capabilities.supportedCompressedTexture||{},t.Capabilities.supportedCompressedTexture.pvrtc=!!this.pvrtc,t.Capabilities.supportedCompressedTexture.etc1=!!this.etc1,this._supportedCompressedTextureInfo=this._buildSupportedCompressedTextureInfo([this.etc1,this.pvrtc])},r.prototype.handleContextLost=function(){this.contextLost=!0},r.prototype.handleContextRestored=function(){this.initWebGL(),this.contextLost=!1},r.prototype.getWebGLContext=function(){var e=t.sys.getContextWebGL(this.surface);this.setContext(e)},r.prototype.setContext=function(t){this.context=t,t.id=r.glContextId++,this.glID=t.id,t.disable(t.DEPTH_TEST),t.disable(t.CULL_FACE),t.enable(t.BLEND),t.colorMask(!0,!0,!0,!0),t.activeTexture(t.TEXTURE0)},r.prototype.enableStencilTest=function(){var t=this.context;t.enable(t.STENCIL_TEST)},r.prototype.disableStencilTest=function(){var t=this.context;t.disable(t.STENCIL_TEST)},r.prototype.enableScissorTest=function(t){var e=this.context;e.enable(e.SCISSOR_TEST),e.scissor(t.x,t.y,t.width,t.height)},r.prototype.disableScissorTest=function(){var t=this.context;t.disable(t.SCISSOR_TEST)},r.prototype.getPixels=function(t,e,i,r,n){var a=this.context;a.readPixels(t,e,i,r,a.RGBA,a.UNSIGNED_BYTE,n)},r.prototype.createTexture=function(e){return t.sys.createTexture(this,e)},r.prototype.checkCompressedTextureInternalFormat=function(t,e){for(var i=0,r=t.length;r>i;++i)for(var n=t[i],a=n.supportedFormats,o=0,s=a.length;s>o;++o)if(a[o][1]===e)return!0;return!1},r.prototype.$debugLogCompressedTextureNotSupported=function(e,r){if(!i[r]){i[r]=!0,t.log("internalFormat = "+r+":0x"+r.toString(16)+", the current hardware does not support the corresponding compression format.");for(var n=0,a=e.length;a>n;++n){var o=e[n];if(o.supportedFormats.length>0){t.log("support = "+o.extensionName);for(var s=0,l=o.supportedFormats.length;l>s;++s){var h=o.supportedFormats[s];t.log(h[0]+" : "+h[1]+" : 0x"+h[1].toString(16))}}}}},r.prototype.createCompressedTexture=function(e,i,r,n,a){var o=this.checkCompressedTextureInternalFormat(this._supportedCompressedTextureInfo,a);if(!o)return this.$debugLogCompressedTextureNotSupported(this._supportedCompressedTextureInfo,a),this.defaultEmptyTexture;var s=this.context,l=s.createTexture();return l?(l[t.glContext]=s,l[t.is_compressed_texture]=!0,s.bindTexture(s.TEXTURE_2D,l),s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1),l[t.UNPACK_PREMULTIPLY_ALPHA_WEBGL]=!0,s.compressedTexImage2D(s.TEXTURE_2D,n,a,i,r,0,e),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.LINEAR),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.LINEAR),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE),s.bindTexture(s.TEXTURE_2D,null),l):void(this.contextLost=!0)},r.prototype.updateTexture=function(t,e){var i=this.context;i.bindTexture(i.TEXTURE_2D,t),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,e)},Object.defineProperty(r.prototype,"defaultEmptyTexture",{get:function(){if(!this._defaultEmptyTexture){var e=16,i=t.sys.createCanvas(e,e),r=t.sys.getContext2d(i);r.fillStyle="white",r.fillRect(0,0,e,e),this._defaultEmptyTexture=this.createTexture(i),this._defaultEmptyTexture[t.engine_default_empty_texture]=!0}return this._defaultEmptyTexture},enumerable:!0,configurable:!0}),r.prototype.getWebGLTexture=function(e){if(!e.webGLTexture){if("image"!=e.format||e.hasCompressed2d()){if(e.hasCompressed2d()){var i=e.getCompressed2dTextureData();e.webGLTexture=this.createCompressedTexture(i.byteArray,i.width,i.height,i.level,i.glInternalFormat);var r=e.etcAlphaMask;if(r){var n=this.getWebGLTexture(r);n&&(e.webGLTexture[t.etc_alpha_mask]=n)}}}else e.webGLTexture=this.createTexture(e.source);e.$deleteSource&&e.webGLTexture&&(e.source&&(e.source.src="",e.source=null),e.clearCompressedTextureData()),e.webGLTexture&&(e.webGLTexture.smoothing=!0)}return e.webGLTexture},r.prototype.clearRect=function(t,e,i,r){if(0!=t||0!=e||i!=this.surface.width||r!=this.surface.height){var n=this.currentBuffer;if(n.$hasScissor)this.setGlobalCompositeOperation("destination-out"),this.drawRect(t,e,i,r),this.setGlobalCompositeOperation("source-over");else{var a=n.globalMatrix;0==a.b&&0==a.c?(t=t*a.a+a.tx,e=e*a.d+a.ty,i*=a.a,r*=a.d,this.enableScissor(t,-e-r+n.height,i,r),this.clear(),this.disableScissor()):(this.setGlobalCompositeOperation("destination-out"),this.drawRect(t,e,i,r),this.setGlobalCompositeOperation("source-over"))}}else this.clear()},r.prototype.setGlobalCompositeOperation=function(t){this.drawCmdManager.pushSetBlend(t)},r.prototype.drawImage=function(t,e,i,r,n,a,o,s,l,h,c,u,p){var d=this.currentBuffer;if(!this.contextLost&&t&&d){var f,g,m;if(t.texture||t.source&&t.source.texture)f=t.texture||t.source.texture,d.saveTransform(),g=d.$offsetX,m=d.$offsetY,d.useOffset(),d.transform(1,0,0,-1,0,l+2*o);else{if(!t.source&&!t.webGLTexture)return;f=this.getWebGLTexture(t)}f&&(this.drawTexture(f,e,i,r,n,a,o,s,l,h,c,void 0,void 0,void 0,void 0,u,p),t.source&&t.source.texture&&(d.$offsetX=g,d.$offsetY=m,d.restoreTransform()))}},r.prototype.drawMesh=function(t,e,i,r,n,a,o,s,l,h,c,u,p,d,f,g,m){var y=this.currentBuffer;if(!this.contextLost&&t&&y){var v,_,b;if(t.texture||t.source&&t.source.texture)v=t.texture||t.source.texture,y.saveTransform(),_=y.$offsetX,b=y.$offsetY,y.useOffset(),y.transform(1,0,0,-1,0,l+2*o);else{if(!t.source&&!t.webGLTexture)return;v=this.getWebGLTexture(t)}v&&(this.drawTexture(v,e,i,r,n,a,o,s,l,h,c,u,p,d,f,g,m),(t.texture||t.source&&t.source.texture)&&(y.$offsetX=_,y.$offsetY=b,y.restoreTransform()))}},r.prototype.drawTexture=function(t,e,i,r,n,a,o,s,l,h,c,u,p,d,f,g,m){var y=this.currentBuffer;if(!this.contextLost&&t&&y){p&&d?this.vao.reachMaxSize(p.length/2,d.length)&&this.$drawWebGL():this.vao.reachMaxSize()&&this.$drawWebGL(),void 0!=m&&t.smoothing!=m&&this.drawCmdManager.pushChangeSmoothing(t,m),u&&this.vao.changeToMeshIndices();var v=d?d.length/3:2;this.drawCmdManager.pushDrawTexture(t,v,this.$filter,h,c),y.currentTexture=t,this.vao.cacheArrays(y,e,i,r,n,a,o,s,l,h,c,u,p,d,g)}},r.prototype.drawRect=function(t,e,i,r){var n=this.currentBuffer;!this.contextLost&&n&&(this.vao.reachMaxSize()&&this.$drawWebGL(),this.drawCmdManager.pushDrawRect(),n.currentTexture=null,this.vao.cacheArrays(n,0,0,i,r,t,e,i,r,i,r))},r.prototype.pushMask=function(t,e,i,r){var n=this.currentBuffer;!this.contextLost&&n&&(n.$stencilList.push({x:t,y:e,width:i,height:r}),this.vao.reachMaxSize()&&this.$drawWebGL(),this.drawCmdManager.pushPushMask(),n.currentTexture=null,this.vao.cacheArrays(n,0,0,i,r,t,e,i,r,i,r))},r.prototype.popMask=function(){var t=this.currentBuffer;if(!this.contextLost&&t){var e=t.$stencilList.pop();this.vao.reachMaxSize()&&this.$drawWebGL(),this.drawCmdManager.pushPopMask(),t.currentTexture=null,this.vao.cacheArrays(t,0,0,e.width,e.height,e.x,e.y,e.width,e.height,e.width,e.height)}},r.prototype.clear=function(){this.drawCmdManager.pushClearColor()},r.prototype.enableScissor=function(t,e,i,r){var n=this.currentBuffer;this.drawCmdManager.pushEnableScissor(t,e,i,r),n.$hasScissor=!0},r.prototype.disableScissor=function(){var t=this.currentBuffer;this.drawCmdManager.pushDisableScissor(),t.$hasScissor=!1},r.prototype.$drawWebGL=function(){if(0!=this.drawCmdManager.drawDataLen&&!this.contextLost){this.uploadVerticesArray(this.vao.getVertices()),this.vao.isMesh()&&this.uploadIndicesArray(this.vao.getMeshIndices());for(var t=this.drawCmdManager.drawDataLen,e=0,i=0;t>i;i++){var r=this.drawCmdManager.drawData[i];e=this.drawData(r,e),7==r.type&&(this.activatedBuffer=r.buffer),(0==r.type||1==r.type||2==r.type||3==r.type)&&this.activatedBuffer&&this.activatedBuffer.$computeDrawCall&&this.activatedBuffer.$drawCalls++}this.vao.isMesh()&&this.uploadIndicesArray(this.vao.getIndices()),this.drawCmdManager.clear(),this.vao.clear()}},r.prototype.drawData=function(i,r){if(i){var n,a=this.context,o=i.filter;switch(i.type){case 0:o?"custom"===o.type?n=e.EgretWebGLProgram.getProgram(a,o.$vertexSrc,o.$fragmentSrc,o.$shaderKey):"colorTransform"===o.type?i.texture[t.etc_alpha_mask]?(a.activeTexture(a.TEXTURE1),a.bindTexture(a.TEXTURE_2D,i.texture[t.etc_alpha_mask]),n=e.EgretWebGLProgram.getProgram(a,e.EgretShaderLib.default_vert,e.EgretShaderLib.colorTransform_frag_etc_alphamask_frag,"colorTransform_frag_etc_alphamask_frag")):n=e.EgretWebGLProgram.getProgram(a,e.EgretShaderLib.default_vert,e.EgretShaderLib.colorTransform_frag,"colorTransform"):"blurX"===o.type?n=e.EgretWebGLProgram.getProgram(a,e.EgretShaderLib.default_vert,e.EgretShaderLib.blur_frag,"blur"):"blurY"===o.type?n=e.EgretWebGLProgram.getProgram(a,e.EgretShaderLib.default_vert,e.EgretShaderLib.blur_frag,"blur"):"glow"===o.type&&(n=e.EgretWebGLProgram.getProgram(a,e.EgretShaderLib.default_vert,e.EgretShaderLib.glow_frag,"glow")):i.texture[t.etc_alpha_mask]?(n=e.EgretWebGLProgram.getProgram(a,e.EgretShaderLib.default_vert,e.EgretShaderLib.texture_etc_alphamask_frag,t.etc_alpha_mask),a.activeTexture(a.TEXTURE1),a.bindTexture(a.TEXTURE_2D,i.texture[t.etc_alpha_mask])):n=e.EgretWebGLProgram.getProgram(a,e.EgretShaderLib.default_vert,e.EgretShaderLib.texture_frag,"texture"),this.activeProgram(a,n),this.syncUniforms(n,o,i.textureWidth,i.textureHeight),r+=this.drawTextureElements(i,r);
break;case 1:n=e.EgretWebGLProgram.getProgram(a,e.EgretShaderLib.default_vert,e.EgretShaderLib.primitive_frag,"primitive"),this.activeProgram(a,n),this.syncUniforms(n,o,i.textureWidth,i.textureHeight),r+=this.drawRectElements(i,r);break;case 2:n=e.EgretWebGLProgram.getProgram(a,e.EgretShaderLib.default_vert,e.EgretShaderLib.primitive_frag,"primitive"),this.activeProgram(a,n),this.syncUniforms(n,o,i.textureWidth,i.textureHeight),r+=this.drawPushMaskElements(i,r);break;case 3:n=e.EgretWebGLProgram.getProgram(a,e.EgretShaderLib.default_vert,e.EgretShaderLib.primitive_frag,"primitive"),this.activeProgram(a,n),this.syncUniforms(n,o,i.textureWidth,i.textureHeight),r+=this.drawPopMaskElements(i,r);break;case 4:this.setBlendMode(i.value);break;case 5:i.buffer.rootRenderTarget.resize(i.width,i.height),this.onResize(i.width,i.height);break;case 6:if(this.activatedBuffer){var s=this.activatedBuffer.rootRenderTarget;(0!=s.width||0!=s.height)&&s.clear(!0)}break;case 7:this.activateBuffer(i.buffer,i.width,i.height);break;case 8:var l=this.activatedBuffer;l&&(l.rootRenderTarget&&l.rootRenderTarget.enabledStencil(),l.enableScissor(i.x,i.y,i.width,i.height));break;case 9:l=this.activatedBuffer,l&&l.disableScissor();break;case 10:a.bindTexture(a.TEXTURE_2D,i.texture),i.smoothing?(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR)):(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST))}return r}},r.prototype.activeProgram=function(t,e){if(e!=this.currentProgram){t.useProgram(e.id);var i=e.attributes;for(var r in i)"aVertexPosition"===r?(t.vertexAttribPointer(i.aVertexPosition.location,2,t.FLOAT,!1,20,0),t.enableVertexAttribArray(i.aVertexPosition.location)):"aTextureCoord"===r?(t.vertexAttribPointer(i.aTextureCoord.location,2,t.FLOAT,!1,20,8),t.enableVertexAttribArray(i.aTextureCoord.location)):"aColor"===r&&(t.vertexAttribPointer(i.aColor.location,4,t.UNSIGNED_BYTE,!0,20,16),t.enableVertexAttribArray(i.aColor.location));this.currentProgram=e}},r.prototype.syncUniforms=function(t,e,i,r){var n=t.uniforms;e&&"custom"===e.type;for(var a in n)if("projectionVector"===a)n[a].setValue({x:this.projectionX,y:this.projectionY});else if("uTextureSize"===a)n[a].setValue({x:i,y:r});else if("uSampler"===a)n[a].setValue(0);else if("uSamplerAlphaMask"===a)n[a].setValue(1);else{var o=e.$uniforms[a];void 0!==o&&n[a].setValue(o)}},r.prototype.drawTextureElements=function(e,i){return t.sys.drawTextureElements(this,e,i)},r.prototype.drawRectElements=function(t,e){var i=this.context,r=3*t.count;return i.drawElements(i.TRIANGLES,r,i.UNSIGNED_SHORT,2*e),r},r.prototype.drawPushMaskElements=function(t,e){var i=this.context,r=3*t.count,n=this.activatedBuffer;if(n){n.rootRenderTarget&&n.rootRenderTarget.enabledStencil(),0==n.stencilHandleCount&&(n.enableStencil(),i.clear(i.STENCIL_BUFFER_BIT));var a=n.stencilHandleCount;n.stencilHandleCount++,i.colorMask(!1,!1,!1,!1),i.stencilFunc(i.EQUAL,a,255),i.stencilOp(i.KEEP,i.KEEP,i.INCR),i.drawElements(i.TRIANGLES,r,i.UNSIGNED_SHORT,2*e),i.stencilFunc(i.EQUAL,a+1,255),i.colorMask(!0,!0,!0,!0),i.stencilOp(i.KEEP,i.KEEP,i.KEEP)}return r},r.prototype.drawPopMaskElements=function(t,e){var i=this.context,r=3*t.count,n=this.activatedBuffer;if(n)if(n.stencilHandleCount--,0==n.stencilHandleCount)n.disableStencil();else{var a=n.stencilHandleCount;i.colorMask(!1,!1,!1,!1),i.stencilFunc(i.EQUAL,a+1,255),i.stencilOp(i.KEEP,i.KEEP,i.DECR),i.drawElements(i.TRIANGLES,r,i.UNSIGNED_SHORT,2*e),i.stencilFunc(i.EQUAL,a,255),i.colorMask(!0,!0,!0,!0),i.stencilOp(i.KEEP,i.KEEP,i.KEEP)}return r},r.prototype.setBlendMode=function(t){var e=this.context,i=r.blendModesForGL[t];i&&e.blendFunc(i[0],i[1])},r.prototype.drawTargetWidthFilters=function(t,i){var r,n=i,a=t.length;if(a>1)for(var o=0;a-1>o;o++){var s=t[o],l=i.rootRenderTarget.width,h=i.rootRenderTarget.height;r=e.WebGLRenderBuffer.create(l,h),r.setTransform(1,0,0,1,0,0),r.globalAlpha=1,this.drawToRenderTarget(s,i,r),i!=n&&e.WebGLRenderBuffer.release(i),i=r}var c=t[a-1];this.drawToRenderTarget(c,i,this.currentBuffer),i!=n&&e.WebGLRenderBuffer.release(i)},r.prototype.drawToRenderTarget=function(t,i,r){if(!this.contextLost){this.vao.reachMaxSize()&&this.$drawWebGL(),this.pushBuffer(r);var n,a=i,o=i.rootRenderTarget.width,s=i.rootRenderTarget.height;if("blur"==t.type){var l=t.blurXFilter,h=t.blurYFilter;0!=l.blurX&&0!=h.blurY?(n=e.WebGLRenderBuffer.create(o,s),n.setTransform(1,0,0,1,0,0),n.globalAlpha=1,this.drawToRenderTarget(t.blurXFilter,i,n),i!=a&&e.WebGLRenderBuffer.release(i),i=n,t=h):t=0===l.blurX?h:l}r.saveTransform(),r.transform(1,0,0,-1,0,s),r.currentTexture=i.rootRenderTarget.texture,this.vao.cacheArrays(r,0,0,o,s,0,0,o,s,o,s),r.restoreTransform(),this.drawCmdManager.pushDrawTexture(i.rootRenderTarget.texture,2,t,o,s),i!=a&&e.WebGLRenderBuffer.release(i),this.popBuffer()}},r.initBlendMode=function(){r.blendModesForGL={},r.blendModesForGL["source-over"]=[1,771],r.blendModesForGL.lighter=[1,1],r.blendModesForGL["lighter-in"]=[770,771],r.blendModesForGL["destination-out"]=[0,771],r.blendModesForGL["destination-in"]=[0,770]},r.glContextId=0,r.blendModesForGL=null,r}();e.WebGLRenderContext=r,__reflect(r.prototype,"egret.web.WebGLRenderContext",["egret.sys.RenderContext"]),r.initBlendMode()}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=function(i){function n(r,n,a){var o=i.call(this)||this;if(o.currentTexture=null,o.globalAlpha=1,o.globalTintColor=16777215,o.stencilState=!1,o.$stencilList=[],o.stencilHandleCount=0,o.$scissorState=!1,o.scissorRect=new t.Rectangle,o.$hasScissor=!1,o.$drawCalls=0,o.$computeDrawCall=!1,o.globalMatrix=new t.Matrix,o.savedGlobalMatrix=new t.Matrix,o.$offsetX=0,o.$offsetY=0,o.context=e.WebGLRenderContext.getInstance(r,n),t.nativeRender)return a?o.surface=o.context.surface:o.surface=new egret_native.NativeRenderSurface(o,r,n,a),o.rootRenderTarget=null,o;if(o.rootRenderTarget=new e.WebGLRenderTarget(o.context.context,3,3),r&&n&&o.resize(r,n),o.root=a,o.root)o.context.pushBuffer(o),o.surface=o.context.surface,o.$computeDrawCall=!0;else{var s=o.context.activatedBuffer;s&&s.rootRenderTarget.activate(),o.rootRenderTarget.initFrameBuffer(),o.surface=o.rootRenderTarget}return o}return __extends(n,i),n.prototype.enableStencil=function(){this.stencilState||(this.context.enableStencilTest(),this.stencilState=!0)},n.prototype.disableStencil=function(){this.stencilState&&(this.context.disableStencilTest(),this.stencilState=!1)},n.prototype.restoreStencil=function(){this.stencilState?this.context.enableStencilTest():this.context.disableStencilTest()},n.prototype.enableScissor=function(t,e,i,r){this.$scissorState||(this.$scissorState=!0,this.scissorRect.setTo(t,e,i,r),this.context.enableScissorTest(this.scissorRect))},n.prototype.disableScissor=function(){this.$scissorState&&(this.$scissorState=!1,this.scissorRect.setEmpty(),this.context.disableScissorTest())},n.prototype.restoreScissor=function(){this.$scissorState?this.context.enableScissorTest(this.scissorRect):this.context.disableScissorTest()},Object.defineProperty(n.prototype,"width",{get:function(){return t.nativeRender?this.surface.width:this.rootRenderTarget.width},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return t.nativeRender?this.surface.height:this.rootRenderTarget.height},enumerable:!0,configurable:!0}),n.prototype.resize=function(e,i,r){return e=e||1,i=i||1,t.nativeRender?void this.surface.resize(e,i):(this.context.pushBuffer(this),(e!=this.rootRenderTarget.width||i!=this.rootRenderTarget.height)&&(this.context.drawCmdManager.pushResize(this,e,i),this.rootRenderTarget.width=e,this.rootRenderTarget.height=i),this.root&&this.context.resize(e,i,r),this.context.clear(),void this.context.popBuffer())},n.prototype.getPixels=function(e,i,r,n){void 0===r&&(r=1),void 0===n&&(n=1);var a=new Uint8Array(4*r*n);if(t.nativeRender)egret_native.activateBuffer(this),egret_native.nrGetPixels(e,i,r,n,a),egret_native.activateBuffer(null);else{var o=this.rootRenderTarget.useFrameBuffer;this.rootRenderTarget.useFrameBuffer=!0,this.rootRenderTarget.activate(),this.context.getPixels(e,i,r,n,a),this.rootRenderTarget.useFrameBuffer=o,this.rootRenderTarget.activate()}for(var s=new Uint8Array(4*r*n),l=0;n>l;l++)for(var h=0;r>h;h++){var c=4*(r*(n-l-1)+h),u=4*(r*l+h),p=a[u+3];s[c]=Math.round(a[u]/p*255),s[c+1]=Math.round(a[u+1]/p*255),s[c+2]=Math.round(a[u+2]/p*255),s[c+3]=a[u+3]}return s},n.prototype.toDataURL=function(t,e){return this.context.surface.toDataURL(t,e)},n.prototype.destroy=function(){this.context.destroy()},n.prototype.onRenderFinish=function(){this.$drawCalls=0},n.prototype.drawFrameBufferToSurface=function(t,e,i,r,n,a,o,s,l){void 0===l&&(l=!1),this.rootRenderTarget.useFrameBuffer=!1,this.rootRenderTarget.activate(),this.context.disableStencilTest(),this.context.disableScissorTest(),this.setTransform(1,0,0,1,0,0),this.globalAlpha=1,this.context.setGlobalCompositeOperation("source-over"),l&&this.context.clear(),this.context.drawImage(this.rootRenderTarget,t,e,i,r,n,a,o,s,i,r,!1),this.context.$drawWebGL(),this.rootRenderTarget.useFrameBuffer=!0,this.rootRenderTarget.activate(),this.restoreStencil(),this.restoreScissor()},n.prototype.drawSurfaceToFrameBuffer=function(t,e,i,r,n,a,o,s,l){void 0===l&&(l=!1),this.rootRenderTarget.useFrameBuffer=!0,this.rootRenderTarget.activate(),this.context.disableStencilTest(),this.context.disableScissorTest(),this.setTransform(1,0,0,1,0,0),this.globalAlpha=1,this.context.setGlobalCompositeOperation("source-over"),l&&this.context.clear(),this.context.drawImage(this.context.surface,t,e,i,r,n,a,o,s,i,r,!1),this.context.$drawWebGL(),this.rootRenderTarget.useFrameBuffer=!1,this.rootRenderTarget.activate(),this.restoreStencil(),this.restoreScissor()},n.prototype.clear=function(){this.context.pushBuffer(this),this.context.clear(),this.context.popBuffer()},n.prototype.setTransform=function(t,e,i,r,n,a){var o=this.globalMatrix;o.a=t,o.b=e,o.c=i,o.d=r,o.tx=n,o.ty=a},n.prototype.transform=function(t,e,i,r,n,a){var o=this.globalMatrix,s=o.a,l=o.b,h=o.c,c=o.d;(1!=t||0!=e||0!=i||1!=r)&&(o.a=t*s+e*h,o.b=t*l+e*c,o.c=i*s+r*h,o.d=i*l+r*c),o.tx=n*s+a*h+o.tx,o.ty=n*l+a*c+o.ty},n.prototype.useOffset=function(){var t=this;(0!=t.$offsetX||0!=t.$offsetY)&&(t.globalMatrix.append(1,0,0,1,t.$offsetX,t.$offsetY),t.$offsetX=t.$offsetY=0)},n.prototype.saveTransform=function(){var t=this.globalMatrix,e=this.savedGlobalMatrix;e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e.tx=t.tx,e.ty=t.ty},n.prototype.restoreTransform=function(){var t=this.globalMatrix,e=this.savedGlobalMatrix;t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t.tx=e.tx,t.ty=e.ty},n.create=function(t,e){var i=r.pop();if(i){i.resize(t,e);var a=i.globalMatrix;a.a=1,a.b=0,a.c=0,a.d=1,a.tx=0,a.ty=0,i.globalAlpha=1,i.$offsetX=0,i.$offsetY=0}else i=new n(t,e),i.$computeDrawCall=!1;return i},n.release=function(t){r.push(t)},n.autoClear=!0,n}(t.HashObject);e.WebGLRenderBuffer=i,__reflect(i.prototype,"egret.web.WebGLRenderBuffer",["egret.sys.RenderBuffer"]);var r=[]}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=["source-over","lighter","destination-out"],r="source-over",n=[],a=function(){function a(){this.wxiOS10=!1,this.nestLevel=0}return a.prototype.render=function(e,i,r,a){this.nestLevel++;var o=i,s=o.context;s.pushBuffer(o),o.transform(r.a,r.b,r.c,r.d,0,0),this.drawDisplayObject(e,o,r.tx,r.ty,!0),s.$drawWebGL();var l=o.$drawCalls;o.onRenderFinish(),s.popBuffer();var h=t.Matrix.create();if(r.$invertInto(h),o.transform(h.a,h.b,h.c,h.d,0,0),t.Matrix.release(h),this.nestLevel--,0===this.nestLevel){n.length>6&&(n.length=6);for(var c=n.length,u=0;c>u;u++)n[u].resize(0,0)}return l},a.prototype.drawDisplayObject=function(e,i,r,n,a){var o,s=0,l=e.$displayList;if(l&&!a?((e.$cacheDirty||e.$renderDirty||l.$canvasScaleX!=t.sys.DisplayList.$canvasScaleX||l.$canvasScaleY!=t.sys.DisplayList.$canvasScaleY)&&(s+=l.drawToSurface()),o=l.$renderNode):o=e.$renderDirty?e.$getRenderNode():e.$renderNode,e.$cacheDirty=!1,o){switch(s++,i.$offsetX=r,i.$offsetY=n,o.type){case 1:this.renderBitmap(o,i);break;case 2:this.renderText(o,i);break;case 3:this.renderGraphics(o,i);break;case 4:this.renderGroup(o,i);break;case 5:this.renderMesh(o,i);break;case 6:this.renderNormalBitmap(o,i)}i.$offsetX=0,i.$offsetY=0}if(l&&!a)return s;var h=e.$children;if(h){e.sortableChildren&&e.$sortDirty&&e.sortChildren();for(var c=h.length,u=0;c>u;u++){var p=h[u],d=void 0,f=void 0,g=void 0,m=void 0;1!=p.$alpha&&(g=i.globalAlpha,i.globalAlpha*=p.$alpha),16777215!==p.tint&&(m=i.globalTintColor,i.globalTintColor=p.$tintRGB);var y=void 0;if(p.$useTranslate){var v=p.$getMatrix();d=r+p.$x,f=n+p.$y;var _=i.globalMatrix;y=t.Matrix.create(),y.a=_.a,y.b=_.b,y.c=_.c,y.d=_.d,y.tx=_.tx,y.ty=_.ty,i.transform(v.a,v.b,v.c,v.d,d,f),d=-p.$anchorOffsetX,f=-p.$anchorOffsetY}else d=r+p.$x-p.$anchorOffsetX,f=n+p.$y-p.$anchorOffsetY;switch(p.$renderMode){case 1:break;case 2:s+=this.drawWithFilter(p,i,d,f);break;case 3:s+=this.drawWithClip(p,i,d,f);break;case 4:s+=this.drawWithScrollRect(p,i,d,f);break;default:s+=this.drawDisplayObject(p,i,d,f)}if(g&&(i.globalAlpha=g),m&&(i.globalTintColor=m),y){var v=i.globalMatrix;v.a=y.a,v.b=y.b,v.c=y.c,v.d=y.d,v.tx=y.tx,v.ty=y.ty,t.Matrix.release(y)}}}return s},a.prototype.drawWithFilter=function(e,a,o,s){var l=0;if(e.$children&&0==e.$children.length&&(!e.$renderNode||0==e.$renderNode.$getRenderCount()))return l;var h,c=e.$filters,u=0!==e.$blendMode;u&&(h=i[e.$blendMode],h||(h=r));var p=e.$getOriginalBounds(),d=p.x,f=p.y,g=p.width,m=p.height;if(0>=g||0>=m)return l;if(!e.mask&&1==c.length&&("colorTransform"==c[0].type||"custom"===c[0].type&&0===c[0].padding)){var y=this.getRenderCount(e);if(!e.$children||1==y)return u&&a.context.setGlobalCompositeOperation(h),a.context.$filter=c[0],l+=e.$mask?this.drawWithClip(e,a,o,s):e.$scrollRect||e.$maskRect?this.drawWithScrollRect(e,a,o,s):this.drawDisplayObject(e,a,o,s),a.context.$filter=null,u&&a.context.setGlobalCompositeOperation(r),l}var v=this.createRenderBuffer(g,m);if(v.context.pushBuffer(v),l+=e.$mask?this.drawWithClip(e,v,-d,-f):e.$scrollRect||e.$maskRect?this.drawWithScrollRect(e,v,-d,-f):this.drawDisplayObject(e,v,-d,-f),v.context.popBuffer(),l>0){u&&a.context.setGlobalCompositeOperation(h),l++,a.$offsetX=o+d,a.$offsetY=s+f;var _=t.Matrix.create(),b=a.globalMatrix;_.a=b.a,_.b=b.b,_.c=b.c,_.d=b.d,_.tx=b.tx,_.ty=b.ty,a.useOffset(),a.context.drawTargetWidthFilters(c,v),b.a=_.a,b.b=_.b,b.c=_.c,b.d=_.d,b.tx=_.tx,b.ty=_.ty,t.Matrix.release(_),u&&a.context.setGlobalCompositeOperation(r)}return n.push(v),l},a.prototype.getRenderCount=function(t){var e=0,i=t.$getRenderNode();if(i&&(e+=i.$getRenderCount()),t.$children)for(var r=0,n=t.$children;r<n.length;r++){var a=n[r],o=a.$filters;if(o&&o.length>0)return 2;if(a.$children)e+=this.getRenderCount(a);else{var s=a.$getRenderNode();s&&(e+=s.$getRenderCount())}}return e},a.prototype.drawWithClip=function(e,a,o,s){var l,h=0,c=0!==e.$blendMode;c&&(l=i[e.$blendMode],l||(l=r));var u=e.$scrollRect?e.$scrollRect:e.$maskRect,p=e.$mask;if(p){var d=p.$getMatrix();if(0==d.a&&0==d.b||0==d.c&&0==d.d)return h}if(p||e.$children&&0!=e.$children.length){var f=e.$getOriginalBounds(),g=f.x,m=f.y,y=f.width,v=f.height;if(0>=y||0>=v)return h;var _=this.createRenderBuffer(y,v);if(_.context.pushBuffer(_),h+=this.drawDisplayObject(e,_,-g,-m),p){var b=this.createRenderBuffer(y,v);b.context.pushBuffer(b);var x=t.Matrix.create();x.copyFrom(p.$getConcatenatedMatrix()),p.$getConcatenatedMatrixAt(e,x),x.translate(-g,-m),b.setTransform(x.a,x.b,x.c,x.d,x.tx,x.ty),t.Matrix.release(x),h+=this.drawDisplayObject(p,b,0,0),b.context.popBuffer(),_.context.setGlobalCompositeOperation("destination-in"),_.setTransform(1,0,0,-1,0,b.height);var T=b.rootRenderTarget.width,E=b.rootRenderTarget.height;_.context.drawTexture(b.rootRenderTarget.texture,0,0,T,E,0,0,T,E,T,E),_.setTransform(1,0,0,1,0,0),_.context.setGlobalCompositeOperation("source-over"),b.setTransform(1,0,0,1,0,0),n.push(b)}if(_.context.setGlobalCompositeOperation(r),_.context.popBuffer(),h>0){h++,c&&a.context.setGlobalCompositeOperation(l),u&&a.context.pushMask(u.x+o,u.y+s,u.width,u.height);var S=t.Matrix.create(),C=a.globalMatrix;S.a=C.a,S.b=C.b,S.c=C.c,S.d=C.d,S.tx=C.tx,S.ty=C.ty,C.append(1,0,0,-1,o+g,s+m+_.height);var w=_.rootRenderTarget.width,P=_.rootRenderTarget.height;a.context.drawTexture(_.rootRenderTarget.texture,0,0,w,P,0,0,w,P,w,P),u&&_.context.popMask(),c&&a.context.setGlobalCompositeOperation(r);var D=a.globalMatrix;D.a=S.a,D.b=S.b,D.c=S.c,D.d=S.d,D.tx=S.tx,D.ty=S.ty,t.Matrix.release(S)}return n.push(_),h}return u&&a.context.pushMask(u.x+o,u.y+s,u.width,u.height),c&&a.context.setGlobalCompositeOperation(l),h+=this.drawDisplayObject(e,a,o,s),c&&a.context.setGlobalCompositeOperation(r),u&&a.context.popMask(),h},a.prototype.drawWithScrollRect=function(t,e,i,r){var n=0,a=t.$scrollRect?t.$scrollRect:t.$maskRect;if(a.isEmpty())return n;t.$scrollRect&&(i-=a.x,r-=a.y);var o=e.globalMatrix,s=e.context,l=!1;if(e.$hasScissor||0!=o.b||0!=o.c)e.context.pushMask(a.x+i,a.y+r,a.width,a.height);else{var h=o.a,c=o.d,u=o.tx,p=o.ty,d=a.x+i,f=a.y+r,g=d+a.width,m=f+a.height,y=void 0,v=void 0,_=void 0,b=void 0;if(1==h&&1==c)y=d+u,v=f+p,_=g+u,b=m+p;else{var x=h*d+u,T=c*f+p,E=h*g+u,S=c*f+p,C=h*g+u,w=c*m+p,P=h*d+u,D=c*m+p,A=0;x>E&&(A=x,x=E,E=A),C>P&&(A=C,C=P,P=A),y=C>x?x:C,_=E>P?E:P,T>S&&(A=T,T=S,S=A),w>D&&(A=w,w=D,D=A),v=w>T?T:w,b=S>D?S:D}s.enableScissor(y,-b+e.height,_-y,b-v),l=!0}return n+=this.drawDisplayObject(t,e,i,r),l?s.disableScissor():s.popMask(),n},a.prototype.drawNodeToBuffer=function(t,e,i,r){var n=e;n.context.pushBuffer(n),n.setTransform(i.a,i.b,i.c,i.d,i.tx,i.ty),this.renderNode(t,e,0,0,r),n.context.$drawWebGL(),n.onRenderFinish(),n.context.popBuffer()},a.prototype.drawDisplayToBuffer=function(t,e,i){e.context.pushBuffer(e),i&&e.setTransform(i.a,i.b,i.c,i.d,i.tx,i.ty);var r;r=t.$renderDirty?t.$getRenderNode():t.$renderNode;var n=0;if(r)switch(n++,r.type){case 1:this.renderBitmap(r,e);break;case 2:this.renderText(r,e);break;case 3:this.renderGraphics(r,e);break;case 4:this.renderGroup(r,e);break;case 5:this.renderMesh(r,e);break;case 6:this.renderNormalBitmap(r,e)}var a=t.$children;if(a)for(var o=a.length,s=0;o>s;s++){var l=a[s];switch(l.$renderMode){case 1:break;case 2:n+=this.drawWithFilter(l,e,0,0);break;case 3:n+=this.drawWithClip(l,e,0,0);break;case 4:n+=this.drawWithScrollRect(l,e,0,0);break;default:n+=this.drawDisplayObject(l,e,0,0)}}return e.context.$drawWebGL(),e.onRenderFinish(),e.context.popBuffer(),n},a.prototype.renderNode=function(t,e,i,r,n){switch(e.$offsetX=i,e.$offsetY=r,t.type){case 1:this.renderBitmap(t,e);break;case 2:this.renderText(t,e);break;case 3:this.renderGraphics(t,e,n);break;case 4:this.renderGroup(t,e);break;case 5:this.renderMesh(t,e);break;case 6:this.renderNormalBitmap(t,e)}},a.prototype.renderNormalBitmap=function(t,e){var i=t.image;i&&e.context.drawImage(i,t.sourceX,t.sourceY,t.sourceW,t.sourceH,t.drawX,t.drawY,t.drawW,t.drawH,t.imageWidth,t.imageHeight,t.rotated,t.smoothing)},a.prototype.renderBitmap=function(e,n){var a=e.image;if(a){var o,s,l,h=e.drawData,c=h.length,u=0,p=e.matrix,d=e.blendMode,f=e.alpha;if(p){o=t.Matrix.create();var g=n.globalMatrix;o.a=g.a,o.b=g.b,o.c=g.c,o.d=g.d,o.tx=g.tx,o.ty=g.ty,s=n.$offsetX,l=n.$offsetY,n.useOffset(),n.transform(p.a,p.b,p.c,p.d,p.tx,p.ty)}d&&n.context.setGlobalCompositeOperation(i[d]);var m;if(f==f&&(m=n.globalAlpha,n.globalAlpha*=f),e.filter){for(n.context.$filter=e.filter;c>u;)n.context.drawImage(a,h[u++],h[u++],h[u++],h[u++],h[u++],h[u++],h[u++],h[u++],e.imageWidth,e.imageHeight,e.rotated,e.smoothing);n.context.$filter=null}else for(;c>u;)n.context.drawImage(a,h[u++],h[u++],h[u++],h[u++],h[u++],h[u++],h[u++],h[u++],e.imageWidth,e.imageHeight,e.rotated,e.smoothing);if(d&&n.context.setGlobalCompositeOperation(r),f==f&&(n.globalAlpha=m),p){var y=n.globalMatrix;y.a=o.a,y.b=o.b,y.c=o.c,y.d=o.d,y.tx=o.tx,y.ty=o.ty,n.$offsetX=s,n.$offsetY=l,t.Matrix.release(o)}}},a.prototype.renderMesh=function(e,n){var a,o,s,l=e.image,h=e.drawData,c=h.length,u=0,p=e.matrix,d=e.blendMode,f=e.alpha;if(p){a=t.Matrix.create();var g=n.globalMatrix;a.a=g.a,a.b=g.b,a.c=g.c,a.d=g.d,a.tx=g.tx,a.ty=g.ty,o=n.$offsetX,s=n.$offsetY,n.useOffset(),n.transform(p.a,p.b,p.c,p.d,p.tx,p.ty)}d&&n.context.setGlobalCompositeOperation(i[d]);var m;if(f==f&&(m=n.globalAlpha,n.globalAlpha*=f),e.filter){for(n.context.$filter=e.filter;c>u;)n.context.drawMesh(l,h[u++],h[u++],h[u++],h[u++],h[u++],h[u++],h[u++],h[u++],e.imageWidth,e.imageHeight,e.uvs,e.vertices,e.indices,e.bounds,e.rotated,e.smoothing);n.context.$filter=null}else for(;c>u;)n.context.drawMesh(l,h[u++],h[u++],h[u++],h[u++],h[u++],h[u++],h[u++],h[u++],e.imageWidth,e.imageHeight,e.uvs,e.vertices,e.indices,e.bounds,e.rotated,e.smoothing);if(d&&n.context.setGlobalCompositeOperation(r),f==f&&(n.globalAlpha=m),p){var y=n.globalMatrix;y.a=a.a,y.b=a.b,y.c=a.c,y.d=a.d,y.tx=a.tx,y.ty=a.ty,n.$offsetX=o,n.$offsetY=s,t.Matrix.release(a)}},a.prototype.___renderText____=function(i,r){var n=i.width-i.x,a=i.height-i.y;if(!(0>=n||0>=a)&&n&&a&&0!==i.drawData.length){var o=t.sys.DisplayList.$canvasScaleX,s=t.sys.DisplayList.$canvasScaleY,l=r.context.$maxTextureSize;n*o>l&&(o*=l/(n*o)),a*s>l&&(s*=l/(a*s)),n*=o,a*=s;var h=i.x*o,c=i.y*s;(i.$canvasScaleX!==o||i.$canvasScaleY!==s)&&(i.$canvasScaleX=o,i.$canvasScaleY=s,i.dirtyRender=!0),(h||c)&&r.transform(1,0,0,1,h/o,c/s),i.dirtyRender&&e.TextAtlasRender.analysisTextNodeAndFlushDrawLabel(i);var u=i[e.property_drawLabel];if(u&&u.length>0){for(var p=r.$offsetX,d=r.$offsetY,f=null,g=0,m=0,y=null,v=null,_=null,b=0,x=u.length;x>b;++b){f=u[b],g=f.anchorX,m=f.anchorY,y=f.textBlocks,r.$offsetX=p+g;for(var T=0,E=y.length;E>T;++T)v=y[T],T>0&&(r.$offsetX-=v.canvasWidthOffset),r.$offsetY=d+m-(v.measureHeight+(v.stroke2?v.canvasHeightOffset:0))/2,_=v.line.page,r.context.drawTexture(_.webGLTexture,v.u,v.v,v.contentWidth,v.contentHeight,0,0,v.contentWidth,v.contentHeight,_.pageWidth,_.pageHeight),r.$offsetX+=v.contentWidth-v.canvasWidthOffset}r.$offsetX=p,r.$offsetY=d}(h||c)&&r.transform(1,0,0,1,-h/o,-c/s),i.dirtyRender=!1}},a.prototype.renderText=function(i,r){if(e.textAtlasRenderEnable)return void this.___renderText____(i,r);var n=i.width-i.x,a=i.height-i.y;if(!(0>=n||0>=a)&&n&&a&&0!=i.drawData.length){var o=t.sys.DisplayList.$canvasScaleX,s=t.sys.DisplayList.$canvasScaleY,l=r.context.$maxTextureSize;n*o>l&&(o*=l/(n*o)),a*s>l&&(s*=l/(a*s)),n*=o,a*=s;var h=i.x*o,c=i.y*s;if((i.$canvasScaleX!=o||i.$canvasScaleY!=s)&&(i.$canvasScaleX=o,i.$canvasScaleY=s,i.dirtyRender=!0),this.wxiOS10?(this.canvasRenderer||(this.canvasRenderer=new t.CanvasRenderer),i.dirtyRender&&(this.canvasRenderBuffer=new e.CanvasRenderBuffer(n,a))):this.canvasRenderBuffer&&this.canvasRenderBuffer.context?i.dirtyRender&&this.canvasRenderBuffer.resize(n,a):(this.canvasRenderer=new t.CanvasRenderer,this.canvasRenderBuffer=new e.CanvasRenderBuffer(n,a)),this.canvasRenderBuffer.context){if((1!=o||1!=s)&&this.canvasRenderBuffer.context.setTransform(o,0,0,s,0,0),h||c?(i.dirtyRender&&this.canvasRenderBuffer.context.setTransform(o,0,0,s,-h,-c),r.transform(1,0,0,1,h/o,c/s)):(1!=o||1!=s)&&this.canvasRenderBuffer.context.setTransform(o,0,0,s,0,0),i.dirtyRender){var u=this.canvasRenderBuffer.surface;if(this.canvasRenderer.renderText(i,this.canvasRenderBuffer.context),this.wxiOS10)u.isCanvas=!0,i.$texture=u;else{var p=i.$texture;p?r.context.updateTexture(p,u):(p=r.context.createTexture(u),i.$texture=p)}i.$textureWidth=u.width,i.$textureHeight=u.height}var d=i.$textureWidth,f=i.$textureHeight;r.context.drawTexture(i.$texture,0,0,d,f,0,0,d/o,f/s,d,f),(h||c)&&(i.dirtyRender&&this.canvasRenderBuffer.context.setTransform(o,0,0,s,0,0),r.transform(1,0,0,1,-h/o,-c/s)),i.dirtyRender=!1}}},a.prototype.renderGraphics=function(i,r,n){var a=i.width,o=i.height;if(!(0>=a||0>=o)&&a&&o&&0!=i.drawData.length){var s=t.sys.DisplayList.$canvasScaleX,l=t.sys.DisplayList.$canvasScaleY;(1>a*s||1>o*l)&&(s=l=1),(i.$canvasScaleX!=s||i.$canvasScaleY!=l)&&(i.$canvasScaleX=s,i.$canvasScaleY=l,i.dirtyRender=!0),a*=s,o*=l;var h=Math.ceil(a),c=Math.ceil(o);if(s*=h/a,l*=c/o,a=h,o=c,this.wxiOS10?(this.canvasRenderer||(this.canvasRenderer=new t.CanvasRenderer),i.dirtyRender&&(this.canvasRenderBuffer=new e.CanvasRenderBuffer(a,o))):this.canvasRenderBuffer&&this.canvasRenderBuffer.context?i.dirtyRender&&this.canvasRenderBuffer.resize(a,o):(this.canvasRenderer=new t.CanvasRenderer,this.canvasRenderBuffer=new e.CanvasRenderBuffer(a,o)),this.canvasRenderBuffer.context){(1!=s||1!=l)&&this.canvasRenderBuffer.context.setTransform(s,0,0,l,0,0),(i.x||i.y)&&((i.dirtyRender||n)&&this.canvasRenderBuffer.context.translate(-i.x,-i.y),r.transform(1,0,0,1,i.x,i.y));var u=this.canvasRenderBuffer.surface;if(n){this.canvasRenderer.renderGraphics(i,this.canvasRenderBuffer.context,!0);var p=void 0;this.wxiOS10?(u.isCanvas=!0,p=u):(t.WebGLUtils.deleteWebGLTexture(u),p=r.context.getWebGLTexture(u)),r.context.drawTexture(p,0,0,a,o,0,0,a,o,u.width,u.height)}else{if(i.dirtyRender){if(this.canvasRenderer.renderGraphics(i,this.canvasRenderBuffer.context),this.wxiOS10)u.isCanvas=!0,i.$texture=u;else{var p=i.$texture;p?r.context.updateTexture(p,u):(p=r.context.createTexture(u),i.$texture=p)}i.$textureWidth=u.width,i.$textureHeight=u.height}var d=i.$textureWidth,f=i.$textureHeight;r.context.drawTexture(i.$texture,0,0,d,f,0,0,d/s,f/l,d,f)}(i.x||i.y)&&((i.dirtyRender||n)&&this.canvasRenderBuffer.context.translate(i.x,i.y),r.transform(1,0,0,1,-i.x,-i.y)),n||(i.dirtyRender=!1)}}},a.prototype.renderGroup=function(e,i){var r,n,a,o=e.matrix;if(o){r=t.Matrix.create();var s=i.globalMatrix;r.a=s.a,r.b=s.b,r.c=s.c,r.d=s.d,r.tx=s.tx,r.ty=s.ty,n=i.$offsetX,a=i.$offsetY,i.useOffset(),i.transform(o.a,o.b,o.c,o.d,o.tx,o.ty)}for(var l=e.drawData,h=l.length,c=0;h>c;c++){var u=l[c];this.renderNode(u,i,i.$offsetX,i.$offsetY)}if(o){var p=i.globalMatrix;p.a=r.a,p.b=r.b,p.c=r.c,p.d=r.d,p.tx=r.tx,p.ty=r.ty,i.$offsetX=n,i.$offsetY=a,t.Matrix.release(r)}},a.prototype.createRenderBuffer=function(t,i){var r=n.pop();return r?r.resize(t,i):(r=new e.WebGLRenderBuffer(t,i),r.$computeDrawCall=!1),r},a}();e.WebGLRenderer=a,__reflect(a.prototype,"egret.web.WebGLRenderer",["egret.sys.SystemRenderer"])}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=function(t){function e(e,i,r,n,a,o,s,l){var h=t.call(this)||this;return h._width=0,h._height=0,h._border=0,h.line=null,h.x=0,h.y=0,h.u=0,h.v=0,h.tag="",h.measureWidth=0,h.measureHeight=0,h.canvasWidthOffset=0,h.canvasHeightOffset=0,h.stroke2=0,h._width=e,h._height=i,h._border=l,h.measureWidth=r,h.measureHeight=n,h.canvasWidthOffset=a,h.canvasHeightOffset=o,h.stroke2=s,h}return __extends(e,t),Object.defineProperty(e.prototype,"border",{get:function(){return this._border},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._width+2*this.border},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height+2*this.border},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"contentWidth",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"contentHeight",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"page",{get:function(){return this.line?this.line.page:null},enumerable:!0,configurable:!0}),e.prototype.updateUV=function(){var t=this.line;return t?(this.u=t.x+this.x+1*this.border,this.v=t.y+this.y+1*this.border,!0):!1},Object.defineProperty(e.prototype,"subImageOffsetX",{get:function(){var t=this.line;return t?t.x+this.x+this.border:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"subImageOffsetY",{get:function(){var t=this.line;return t?t.y+this.y+this.border:0},enumerable:!0,configurable:!0}),e}(t.HashObject);e.TextBlock=i,__reflect(i.prototype,"egret.web.TextBlock");var r=function(t){function e(e){var i=t.call(this)||this;return i.page=null,i.textBlocks=[],i.dynamicMaxHeight=0,i.maxWidth=0,i.x=0,i.y=0,i.maxWidth=e,i}return __extends(e,t),e.prototype.isCapacityOf=function(t){if(!t)return!1;var e=0,i=0,r=this.lastTextBlock();return r&&(e=r.x+r.width,i=r.y),e+t.width>this.maxWidth?!1:this.dynamicMaxHeight>0&&(t.height>this.dynamicMaxHeight||t.height/this.dynamicMaxHeight<.5)?!1:!0},e.prototype.lastTextBlock=function(){var t=this.textBlocks;return t.length>0?t[t.length-1]:null},e.prototype.addTextBlock=function(t,e){if(!t)return!1;if(e&&!this.isCapacityOf(t))return!1;var i=0,r=0,n=this.lastTextBlock();return n&&(i=n.x+n.width,r=n.y),t.x=i,t.y=r,t.line=this,this.textBlocks.push(t),this.dynamicMaxHeight=Math.max(this.dynamicMaxHeight,t.height),!0},e}(t.HashObject);e.Line=r,__reflect(r.prototype,"egret.web.Line");var n=function(t){function e(e,i){var r=t.call(this)||this;return r.lines=[],r.pageWidth=0,r.pageHeight=0,r.webGLTexture=null,r.pageWidth=e,r.pageHeight=i,r}return __extends(e,t),e.prototype.addLine=function(t){if(!t)return!1;var e=0,i=0,r=this.lines;if(r.length>0){var n=r[r.length-1];e=n.x,i=n.y+n.dynamicMaxHeight}return t.maxWidth>this.pageWidth?(console.error("line.maxWidth = "+t.maxWidth+", this.pageWidth = "+this.pageWidth),!1):i+t.dynamicMaxHeight>this.pageHeight?!1:(t.x=e,t.y=i,t.page=this,this.lines.push(t),!0)},e}(t.HashObject);e.Page=n,__reflect(n.prototype,"egret.web.Page");var a=function(t){function e(e,i){var r=t.call(this)||this;return r._pages=[],r._sortLines=[],r._maxSize=1024,r._border=1,r._maxSize=e,r._border=i,r}return __extends(e,t),e.prototype.addTextBlock=function(t){var e=this._addTextBlock(t);if(!e)return!1;t.updateUV();for(var i=!1,r=e,n=this._sortLines,a=0,o=n;a<o.length;a++){var s=o[a];if(s===r[1]){i=!0;break}}return i||n.push(r[1]),this.sort(),!0},e.prototype._addTextBlock=function(t){if(!t)return null;if(t.width>this._maxSize||t.height>this._maxSize)return null;for(var e=this._sortLines,i=0,n=e.length;n>i;++i){var a=e[i];if(a.isCapacityOf(t)&&a.addTextBlock(t,!1))return[a.page,a]}var o=new r(this._maxSize);if(!o.addTextBlock(t,!0))return console.error("_addTextBlock !newLine.addTextBlock(textBlock, true)"),null;for(var s=this._pages,i=0,l=s.length;l>i;++i){var h=s[i];if(h.addLine(o))return[h,o]}var c=this.createPage(this._maxSize,this._maxSize);return c.addLine(o)?[c,o]:(console.error("_addText newPage.addLine failed"),null)},e.prototype.createPage=function(t,e){var i=new n(t,e);return this._pages.push(i),i},e.prototype.sort=function(){if(!(this._sortLines.length<=1)){var t=function(t,e){return t.dynamicMaxHeight<e.dynamicMaxHeight?-1:1};this._sortLines=this._sortLines.sort(t)}},e.prototype.createTextBlock=function(t,e,r,n,a,o,s,l){var h=new i(e,r,n,a,o,s,l,this._border);return this.addTextBlock(h)?(h.tag=t,h):null},e}(t.HashObject);e.Book=a,__reflect(a.prototype,"egret.web.Book")}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){e.textAtlasRenderEnable=!1,e.__textAtlasRender__=null,e.property_drawLabel="DrawLabel";var i=!1,r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.anchorX=0,e.anchorY=0,e.textBlocks=[],e}return __extends(e,t),e.prototype.clear=function(){this.anchorX=0,this.anchorY=0,this.textBlocks.length=0},e.create=function(){var t=e.pool;return 0===t.length&&t.push(new e),t.pop()},e.back=function(t,i){if(t){var r=e.pool;if(i&&r.indexOf(t)>=0)return void console.error("DrawLabel.back repeat");t.clear(),r.push(t)}},e.pool=[],e}(t.HashObject);e.DrawLabel=r,__reflect(r.prototype,"egret.web.DrawLabel");var n=function(e){function r(r,n){var a=e.call(this)||this;a.format=null;var o=0;i&&(o=r.textColor,r.textColor=16711680),a.textColor=r.textColor,a.strokeColor=r.strokeColor,a.size=r.size,a.stroke=r.stroke,a.bold=r.bold,a.italic=r.italic,a.fontFamily=r.fontFamily,a.format=n,a.font=t.getFontString(r,a.format);var s=n.textColor?n.textColor:r.textColor,l=n.strokeColor?n.strokeColor:r.strokeColor,h=n.stroke?n.stroke:r.stroke,c=n.size?n.size:r.size;
return a.description=""+a.font+"-"+c,a.description+="-"+t.toColorString(s),a.description+="-"+t.toColorString(l),h&&(a.description+="-"+2*h),i&&(r.textColor=o),a}return __extends(r,e),r}(t.HashObject);__reflect(n.prototype,"StyleInfo");var a=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t["char"]="",t.styleInfo=null,t.hashCodeString="",t.charWithStyleHashCode=0,t.measureWidth=0,t.measureHeight=0,t.canvasWidthOffset=0,t.canvasHeightOffset=0,t.stroke2=0,t}return __extends(i,e),i.prototype.reset=function(e,i){return this["char"]=e,this.styleInfo=i,this.hashCodeString=e+":"+i.description,this.charWithStyleHashCode=t.NumberUtils.convertStringToHashCode(this.hashCodeString),this.canvasWidthOffset=0,this.canvasHeightOffset=0,this.stroke2=0,this},i.prototype.measureAndDraw=function(e){var i=e;if(i){var r=this["char"],n=this.styleInfo.format,a=n.textColor?n.textColor:this.styleInfo.textColor,o=n.strokeColor?n.strokeColor:this.styleInfo.strokeColor,s=n.stroke?n.stroke:this.styleInfo.stroke,l=n.size?n.size:this.styleInfo.size;this.measureWidth=this.measure(r,this.styleInfo,l),this.measureHeight=l;var h=this.measureWidth,c=this.measureHeight,u=2*s;u>0&&(h+=2*u,c+=2*u),this.stroke2=u,i.width=h=Math.ceil(h)+4,i.height=c=Math.ceil(c)+4,this.canvasWidthOffset=(i.width-this.measureWidth)/2,this.canvasHeightOffset=(i.height-this.measureHeight)/2;var p=3,d=Math.pow(10,p);this.canvasWidthOffset=Math.floor(this.canvasWidthOffset*d)/d,this.canvasHeightOffset=Math.floor(this.canvasHeightOffset*d)/d;var f=t.sys.getContext2d(i);f.save(),f.textAlign="center",f.textBaseline="middle",f.lineJoin="round",f.font=this.styleInfo.font,f.fillStyle=t.toColorString(a),f.strokeStyle=t.toColorString(o),f.clearRect(0,0,i.width,i.height),s&&(f.lineWidth=2*s,f.strokeText(r,i.width/2,i.height/2)),f.fillText(r,i.width/2,i.height/2),f.restore()}},i.prototype.measure=function(e,r,n){var a=i.chineseCharactersRegExp.test(e);if(a&&i.chineseCharacterMeasureFastMap[r.font])return i.chineseCharacterMeasureFastMap[r.font];var o=t.sys.measureText(e,r.fontFamily,n||r.size,r.bold,r.italic);return a&&(i.chineseCharacterMeasureFastMap[r.font]=o),o},i.chineseCharactersRegExp=new RegExp("^[一-龥]$"),i.chineseCharacterMeasureFastMap={},i}(t.HashObject);__reflect(a.prototype,"CharImageRender");var o=function(o){function s(t,i,r){var n=o.call(this)||this;return n.book=null,n.charImageRender=new a,n.textBlockMap={},n._canvas=null,n.textAtlasTextureCache=[],n.webglRenderContext=null,n.webglRenderContext=t,n.book=new e.Book(i,r),n}return __extends(s,o),s.analysisTextNodeAndFlushDrawLabel=function(a){if(a){if(!e.__textAtlasRender__){var o=t.web.WebGLRenderContext.getInstance(0,0);e.__textAtlasRender__=new s(o,512,i?12:1)}a[e.property_drawLabel]=a[e.property_drawLabel]||[];for(var l=a[e.property_drawLabel],h=0,c=l;h<c.length;h++){var u=c[h];r.back(u,!1)}l.length=0;for(var p=4,d=a.drawData,f=0,g=0,m="",y={},v=[],_=0,b=d.length;b>_;_+=p){f=d[_+0],g=d[_+1],m=d[_+2],y=d[_+3]||{},v.length=0,e.__textAtlasRender__.convertLabelStringToTextAtlas(m,new n(a,y),v);var u=r.create();u.anchorX=f,u.anchorY=g,u.textBlocks=[].concat(v),l.push(u)}}},s.prototype.convertLabelStringToTextAtlas=function(e,r,n){for(var a=this.canvas,o=this.charImageRender,s=this.textBlockMap,l=0,h=e;l<h.length;l++){var c=h[l];if(o.reset(c,r),s[o.charWithStyleHashCode])n.push(s[o.charWithStyleHashCode]);else{o.measureAndDraw(a);var u=this.book.createTextBlock(c,a.width,a.height,o.measureWidth,o.measureHeight,o.canvasWidthOffset,o.canvasHeightOffset,o.stroke2);if(u){n.push(u),s[o.charWithStyleHashCode]=u;var p=u.page;p.webGLTexture||(p.webGLTexture=this.createTextTextureAtlas(p.pageWidth,p.pageHeight,i));var d=this.webglRenderContext.context;p.webGLTexture[t.glContext]=d,d.bindTexture(d.TEXTURE_2D,p.webGLTexture),d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),p.webGLTexture[t.UNPACK_PREMULTIPLY_ALPHA_WEBGL]=!0,d.texSubImage2D(d.TEXTURE_2D,0,u.subImageOffsetX,u.subImageOffsetY,d.RGBA,d.UNSIGNED_BYTE,a),d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1)}}}},s.prototype.createTextTextureAtlas=function(e,i,r){var n=null;if(r){var a=t.sys.createCanvas(e,e),o=t.sys.getContext2d(a);o.fillStyle="black",o.fillRect(0,0,e,e),n=t.sys.createTexture(this.webglRenderContext,a)}else n=t.sys._createTexture(this.webglRenderContext,e,i,null);return n&&this.textAtlasTextureCache.push(n),n},Object.defineProperty(s.prototype,"canvas",{get:function(){return this._canvas||(this._canvas=t.sys.createCanvas(24,24)),this._canvas},enumerable:!0,configurable:!0}),s}(t.HashObject);e.TextAtlasRender=o,__reflect(o.prototype,"egret.web.TextAtlasRender")}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(){function t(t,e,i){this.gl=t,this.name=i.name,this.type=i.type,this.size=i.size,this.location=t.getAttribLocation(e,this.name),this.count=0,this.initCount(t),this.format=t.FLOAT,this.initFormat(t)}return t.prototype.initCount=function(t){var e=this.type;switch(e){case 5126:case 5120:case 5121:case 5123:this.count=1;break;case 35664:this.count=2;break;case 35665:this.count=3;break;case 35666:this.count=4}},t.prototype.initFormat=function(t){var e=this.type;switch(e){case 5126:case 35664:case 35665:case 35666:this.format=t.FLOAT;break;case 5121:this.format=t.UNSIGNED_BYTE;break;case 5123:this.format=t.UNSIGNED_SHORT;break;case 5120:this.format=t.BYTE}},t}();t.EgretWebGLAttribute=e,__reflect(e.prototype,"egret.web.EgretWebGLAttribute")}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){function e(t,e,i){var r=t.createShader(e);t.shaderSource(r,i),t.compileShader(r);var n=t.getShaderParameter(r,t.COMPILE_STATUS);return n||(console.log("shader not compiled!"),console.log(t.getShaderInfoLog(r))),r}function i(t,e,i){var r=t.createProgram();return t.attachShader(r,e),t.attachShader(r,i),t.linkProgram(r),r}function r(e,i){for(var r={},n=e.getProgramParameter(i,e.ACTIVE_ATTRIBUTES),a=0;n>a;a++){var o=e.getActiveAttrib(i,a),s=o.name,l=new t.EgretWebGLAttribute(e,i,o);r[s]=l}return r}function n(e,i){for(var r={},n=e.getProgramParameter(i,e.ACTIVE_UNIFORMS),a=0;n>a;a++){var o=e.getActiveUniform(i,a),s=o.name,l=new t.EgretWebGLUniform(e,i,o);r[s]=l}return r}var a=function(){function t(t,a,o){this.vshaderSource=a,this.fshaderSource=o,this.vertexShader=e(t,t.VERTEX_SHADER,this.vshaderSource),this.fragmentShader=e(t,t.FRAGMENT_SHADER,this.fshaderSource),this.id=i(t,this.vertexShader,this.fragmentShader),this.uniforms=n(t,this.id),this.attributes=r(t,this.id)}return t.getProgram=function(e,i,r,n){return this.programCache[n]||(this.programCache[n]=new t(e,i,r)),this.programCache[n]},t.deleteProgram=function(t,e,i,r){},t.programCache={},t}();t.EgretWebGLProgram=a,__reflect(a.prototype,"egret.web.EgretWebGLProgram")}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(){function t(t,e,i){this.gl=t,this.name=i.name,this.type=i.type,this.size=i.size,this.location=t.getUniformLocation(e,this.name),this.setDefaultValue(),this.generateSetValue(),this.generateUpload()}return t.prototype.setDefaultValue=function(){var t=this.type;switch(t){case 5126:case 35678:case 35680:case 35670:case 5124:this.value=0;break;case 35664:case 35671:case 35667:this.value=[0,0];break;case 35665:case 35672:case 35668:this.value=[0,0,0];break;case 35666:case 35673:case 35669:this.value=[0,0,0,0];break;case 35674:this.value=new Float32Array([1,0,0,1]);break;case 35675:this.value=new Float32Array([1,0,0,0,1,0,0,0,1]);break;case 35676:this.value=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}},t.prototype.generateSetValue=function(){var t=this.type;switch(t){case 5126:case 35678:case 35680:case 35670:case 5124:this.setValue=function(t){var e=this.value!==t;this.value=t,e&&this.upload()};break;case 35664:case 35671:case 35667:this.setValue=function(t){var e=this.value[0]!==t.x||this.value[1]!==t.y;this.value[0]=t.x,this.value[1]=t.y,e&&this.upload()};break;case 35665:case 35672:case 35668:this.setValue=function(t){this.value[0]=t.x,this.value[1]=t.y,this.value[2]=t.z,this.upload()};break;case 35666:case 35673:case 35669:this.setValue=function(t){this.value[0]=t.x,this.value[1]=t.y,this.value[2]=t.z,this.value[3]=t.w,this.upload()};break;case 35674:case 35675:case 35676:this.setValue=function(t){this.value.set(t),this.upload()}}},t.prototype.generateUpload=function(){var t=this.gl,e=this.type,i=this.location;switch(e){case 5126:this.upload=function(){var e=this.value;t.uniform1f(i,e)};break;case 35664:this.upload=function(){var e=this.value;t.uniform2f(i,e[0],e[1])};break;case 35665:this.upload=function(){var e=this.value;t.uniform3f(i,e[0],e[1],e[2])};break;case 35666:this.upload=function(){var e=this.value;t.uniform4f(i,e[0],e[1],e[2],e[3])};break;case 35678:case 35680:case 35670:case 5124:this.upload=function(){var e=this.value;t.uniform1i(i,e)};break;case 35671:case 35667:this.upload=function(){var e=this.value;t.uniform2i(i,e[0],e[1])};break;case 35672:case 35668:this.upload=function(){var e=this.value;t.uniform3i(i,e[0],e[1],e[2])};break;case 35673:case 35669:this.upload=function(){var e=this.value;t.uniform4i(i,e[0],e[1],e[2],e[3])};break;case 35674:this.upload=function(){var e=this.value;t.uniformMatrix2fv(i,!1,e)};break;case 35675:this.upload=function(){var e=this.value;t.uniformMatrix3fv(i,!1,e)};break;case 35676:this.upload=function(){var e=this.value;t.uniformMatrix4fv(i,!1,e)}}},t}();t.EgretWebGLUniform=e,__reflect(e.prototype,"egret.web.EgretWebGLUniform")}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(){function t(){}return t.blur_frag="precision mediump float;\r\nuniform vec2 blur;\r\nuniform sampler2D uSampler;\r\nvarying vec2 vTextureCoord;\r\nuniform vec2 uTextureSize;\r\nvoid main()\r\n{\r\n    const int sampleRadius = 5;\r\n    const int samples = sampleRadius * 2 + 1;\r\n    vec2 blurUv = blur / uTextureSize;\r\n    vec4 color = vec4(0, 0, 0, 0);\r\n    vec2 uv = vec2(0.0, 0.0);\r\n    blurUv /= float(sampleRadius);\r\n\r\n    for (int i = -sampleRadius; i <= sampleRadius; i++) {\r\n        uv.x = vTextureCoord.x + float(i) * blurUv.x;\r\n        uv.y = vTextureCoord.y + float(i) * blurUv.y;\r\n        color += texture2D(uSampler, uv);\r\n    }\r\n\r\n    color /= float(samples);\r\n    gl_FragColor = color;\r\n}",t.colorTransform_frag="precision mediump float;\r\nvarying vec2 vTextureCoord;\r\nvarying vec4 vColor;\r\nuniform mat4 matrix;\r\nuniform vec4 colorAdd;\r\nuniform sampler2D uSampler;\r\n\r\nvoid main(void) {\r\n    vec4 texColor = texture2D(uSampler, vTextureCoord);\r\n    if(texColor.a > 0.) {\r\n        // 抵消预乘的alpha通道\r\n        texColor = vec4(texColor.rgb / texColor.a, texColor.a);\r\n    }\r\n    vec4 locColor = clamp(texColor * matrix + colorAdd, 0., 1.);\r\n    gl_FragColor = vColor * vec4(locColor.rgb * locColor.a, locColor.a);\r\n}",t.default_vert="attribute vec2 aVertexPosition;\r\nattribute vec2 aTextureCoord;\r\nattribute vec4 aColor;\r\n\r\nuniform vec2 projectionVector;\r\n// uniform vec2 offsetVector;\r\n\r\nvarying vec2 vTextureCoord;\r\nvarying vec4 vColor;\r\n\r\nconst vec2 center = vec2(-1.0, 1.0);\r\n\r\nvoid main(void) {\r\n   gl_Position = vec4( (aVertexPosition / projectionVector) + center , 0.0, 1.0);\r\n   vTextureCoord = aTextureCoord;\r\n   vColor = aColor;\r\n}",t.glow_frag="precision highp float;\r\nvarying vec2 vTextureCoord;\r\n\r\nuniform sampler2D uSampler;\r\n\r\nuniform float dist;\r\nuniform float angle;\r\nuniform vec4 color;\r\nuniform float alpha;\r\nuniform float blurX;\r\nuniform float blurY;\r\n// uniform vec4 quality;\r\nuniform float strength;\r\nuniform float inner;\r\nuniform float knockout;\r\nuniform float hideObject;\r\n\r\nuniform vec2 uTextureSize;\r\n\r\nfloat random(vec2 scale)\r\n{\r\n    return fract(sin(dot(gl_FragCoord.xy, scale)) * 43758.5453);\r\n}\r\n\r\nvoid main(void) {\r\n    vec2 px = vec2(1.0 / uTextureSize.x, 1.0 / uTextureSize.y);\r\n    // TODO 自动调节采样次数？\r\n    const float linearSamplingTimes = 7.0;\r\n    const float circleSamplingTimes = 12.0;\r\n    vec4 ownColor = texture2D(uSampler, vTextureCoord);\r\n    vec4 curColor;\r\n    float totalAlpha = 0.0;\r\n    float maxTotalAlpha = 0.0;\r\n    float curDistanceX = 0.0;\r\n    float curDistanceY = 0.0;\r\n    float offsetX = dist * cos(angle) * px.x;\r\n    float offsetY = dist * sin(angle) * px.y;\r\n\r\n    const float PI = 3.14159265358979323846264;\r\n    float cosAngle;\r\n    float sinAngle;\r\n    float offset = PI * 2.0 / circleSamplingTimes * random(vec2(12.9898, 78.233));\r\n    float stepX = blurX * px.x / linearSamplingTimes;\r\n    float stepY = blurY * px.y / linearSamplingTimes;\r\n    for (float a = 0.0; a <= PI * 2.0; a += PI * 2.0 / circleSamplingTimes) {\r\n        cosAngle = cos(a + offset);\r\n        sinAngle = sin(a + offset);\r\n        for (float i = 1.0; i <= linearSamplingTimes; i++) {\r\n            curDistanceX = i * stepX * cosAngle;\r\n            curDistanceY = i * stepY * sinAngle;\r\n            if (vTextureCoord.x + curDistanceX - offsetX >= 0.0 && vTextureCoord.y + curDistanceY + offsetY <= 1.0){\r\n                curColor = texture2D(uSampler, vec2(vTextureCoord.x + curDistanceX - offsetX, vTextureCoord.y + curDistanceY + offsetY));\r\n                totalAlpha += (linearSamplingTimes - i) * curColor.a;\r\n            }\r\n            maxTotalAlpha += (linearSamplingTimes - i);\r\n        }\r\n    }\r\n\r\n    ownColor.a = max(ownColor.a, 0.0001);\r\n    ownColor.rgb = ownColor.rgb / ownColor.a;\r\n\r\n    float outerGlowAlpha = (totalAlpha / maxTotalAlpha) * strength * alpha * (1. - inner) * max(min(hideObject, knockout), 1. - ownColor.a);\r\n    float innerGlowAlpha = ((maxTotalAlpha - totalAlpha) / maxTotalAlpha) * strength * alpha * inner * ownColor.a;\r\n\r\n    ownColor.a = max(ownColor.a * knockout * (1. - hideObject), 0.0001);\r\n    vec3 mix1 = mix(ownColor.rgb, color.rgb, innerGlowAlpha / (innerGlowAlpha + ownColor.a));\r\n    vec3 mix2 = mix(mix1, color.rgb, outerGlowAlpha / (innerGlowAlpha + ownColor.a + outerGlowAlpha));\r\n    float resultAlpha = min(ownColor.a + outerGlowAlpha + innerGlowAlpha, 1.);\r\n    gl_FragColor = vec4(mix2 * resultAlpha, resultAlpha);\r\n}",t.primitive_frag="precision lowp float;\r\nvarying vec2 vTextureCoord;\r\nvarying vec4 vColor;\r\n\r\nvoid main(void) {\r\n    gl_FragColor = vColor;\r\n}",t.texture_frag="precision lowp float;\r\nvarying vec2 vTextureCoord;\r\nvarying vec4 vColor;\r\nuniform sampler2D uSampler;\r\n\r\nvoid main(void) {\r\n    gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor;\r\n}",t.texture_etc_alphamask_frag="precision lowp float;\r\nvarying vec2 vTextureCoord;\r\nvarying vec4 vColor;\r\nuniform sampler2D uSampler;\r\nuniform sampler2D uSamplerAlphaMask;\r\nvoid main(void) {\r\nfloat alpha = texture2D(uSamplerAlphaMask, vTextureCoord).r;\r\nif (alpha < 0.0039) { discard; }\r\nvec4 v4Color = texture2D(uSampler, vTextureCoord);\r\nv4Color.rgb = v4Color.rgb * alpha;\r\nv4Color.a = alpha;\r\ngl_FragColor = v4Color * vColor;\r\n}",t.colorTransform_frag_etc_alphamask_frag="precision mediump float;\r\nvarying vec2 vTextureCoord;\r\nvarying vec4 vColor;\r\nuniform mat4 matrix;\r\nuniform vec4 colorAdd;\r\nuniform sampler2D uSampler;\r\nuniform sampler2D uSamplerAlphaMask;\r\n\r\nvoid main(void){\r\nfloat alpha = texture2D(uSamplerAlphaMask, vTextureCoord).r;\r\nif (alpha < 0.0039) { discard; }\r\nvec4 texColor = texture2D(uSampler, vTextureCoord);\r\nif(texColor.a > 0.0) {\r\n // 抵消预乘的alpha通道\r\ntexColor = vec4(texColor.rgb / texColor.a, texColor.a);\r\n}\r\nvec4 v4Color = clamp(texColor * matrix + colorAdd, 0.0, 1.0);\r\nv4Color.rgb = v4Color.rgb * alpha;\r\nv4Color.a = alpha;\r\ngl_FragColor = v4Color * vColor;\r\n}",t}();t.EgretShaderLib=e,__reflect(e.prototype,"egret.web.EgretShaderLib")}(e=t.web||(t.web={}))}(egret||(egret={}));var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);i.prototype=e.prototype,t.prototype=new i},__decorate=this&&this.__decorate||function(t,e,i,r){var n,a=arguments.length,o=3>a?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,r);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(o=(3>a?n(o):a>3?n(e,i,o):n(e,i))||o);return a>3&&o&&Object.defineProperty(e,i,o),o},RES;!function(t){}(RES||(RES={}));var RES;!function(t){function e(e){var i=t.config.config.fileSystem.getFile(e);return i||(e=t.resourceNameSelector(e),i=t.config.config.fileSystem.getFile(e)),i}function i(t,e){var i;i=t.indexOf(".json")>=0?"legacyResourceConfig":"resourceConfig",r={type:i,root:e,url:t,name:t}}t.resourceNameSelector=function(t){return t},t.getResourceInfo=e;var r;t.setConfigURL=i;var n=function(){function i(){}return i.prototype.init=function(){return this.config||(this.config={alias:{},groups:{},resourceRoot:r.root,mergeSelector:null,fileSystem:null,loadGroup:[]}),t.queue.pushResItem(r)["catch"](function(e){return t.isCompatible||e.__resource_manager_error__||(e.error?console.error(e.error.stack):console.error(e.stack),e=new t.ResourceManagerError(1002)),t.host.remove(r),Promise.reject(e)})},i.prototype.getGroupByName=function(e){var i=this.config.groups[e],r=[];if(!i)return r;for(var n=0,a=i;n<a.length;n++){var o=a[n],s=void 0;if(s=t.config.getResourceWithSubkey(o),null!=s){var l=s.r,h=s.key;if(null==l)throw new t.ResourceManagerError(2005,h);-1==r.indexOf(l)&&r.push(l)}}return r},i.prototype.__temp__get__type__via__url=function(e){var i=this.config.alias[e];if(i||(i=e),t.typeSelector){var r=t.typeSelector(i);if(!r)throw new t.ResourceManagerError(2004,i);return r}return console.warn("RES.mapConfig 并未设置 typeSelector"),"unknown"},i.prototype.getResourceWithSubkey=function(t){t=this.getKeyByAlias(t);var e=t.indexOf("#"),i="";e>=0&&(i=t.substr(e+1),t=t.substr(0,e));var r=this.getResource(t);return r?{r:r,key:t,subkey:i}:null},i.prototype.getKeyByAlias=function(t){return this.config.alias[t]?this.config.alias[t]:t},i.prototype.getResource=function(t){var i=this.config.alias[t];i||(i=t);var r=e(i);return r?r:null},i.prototype.createGroup=function(t,e,i){if(void 0===i&&(i=!1),!i&&this.config.groups[t]||!e||0==e.length)return!1;for(var r=[],n=0,a=e;n<a.length;n++){var o=a[n];if(this.config.groups[o]){var s=this.config.groups[o];r=r.concat(s)}else r.push(o)}return this.config.groups[t]=r,!0},i.prototype.addSubkey=function(t,e){this.addAlias(t,e+"#"+t)},i.prototype.addAlias=function(t,e){this.config.alias[e]&&(e=this.config.alias[e]),this.config.alias[t]=e},i.prototype.addResourceData=function(e){t.hasRes(e.name)||(e.type||(e.type=this.__temp__get__type__via__url(e.url)),t.config.config.fileSystem.addFile(e))},i.prototype.removeResourceData=function(e){t.hasRes(e.name)&&(t.config.config.fileSystem.removeFile(e.url),this.config.alias[e.name]&&delete this.config.alias[e.name])},i}();t.ResourceConfig=n,__reflect(n.prototype,"RES.ResourceConfig")}(RES||(RES={}));var RES;!function(t){var e=function(){function e(){this.groupTotalDic={},this.numLoadedDic={},this.groupErrorDic={},this.retryTimesDic={},this.maxRetryTimes=3,this.reporterDic={},this.dispatcherDic={},this.failedList=new Array,this.loadItemErrorDic={},this.errorDic={},this.itemListPriorityDic={},this.itemLoadDic={},this.promiseHash={},this.lazyLoadList=new Array,this.loadingCount=0,this.thread=4}return e.prototype.pushResItem=function(t){if(this.promiseHash[t.root+t.name])return this.promiseHash[t.root+t.name];this.lazyLoadList.push(t),this.itemListPriorityDic[Number.NEGATIVE_INFINITY]=this.lazyLoadList,this.updatelistPriority(this.lazyLoadList,Number.NEGATIVE_INFINITY);var e=new egret.EventDispatcher;this.dispatcherDic[t.root+t.name]=e;var i=new Promise(function(t,i){e.addEventListener("complete",function(e){t(e.data)},null),e.addEventListener("error",function(t){i(t.data)},null)});return this.promiseHash[t.root+t.name]=i,this.loadNextResource(),i},e.prototype.pushResGroup=function(t,e,i,r){if(this.promiseHash[e])return this.promiseHash[e];for(var n=t.length,a=0;n>a;a++){var o=t[a];o.groupNames||(o.groupNames=[]),o.groupNames.push(e)}this.groupTotalDic[e]=t.length,this.numLoadedDic[e]=0,this.updatelistPriority(t,i),this.reporterDic[e]=r;var s=new egret.EventDispatcher;this.dispatcherDic[e]=s;var l=new Promise(function(t,e){s.addEventListener("complete",t,null),s.addEventListener("error",function(t){e(t.data)},null)});return this.promiseHash[e]=l,this.loadNextResource(),l},e.prototype.updatelistPriority=function(t,e){void 0==this.itemListPriorityDic[e]&&(this.itemListPriorityDic[e]=[]);for(var i=0,r=t;i<r.length;i++){var n=r[i];if(1!=this.itemLoadDic[n.root+n.name]){var a=this.findPriorityInDic(n);if(void 0==a)this.itemListPriorityDic[e].push(n);else if(e>a){this.itemListPriorityDic[e].push(n);var o=this.itemListPriorityDic[a].indexOf(n);this.itemListPriorityDic[a].splice(o,1)}}}},e.prototype.findPriorityInDic=function(t){for(var e in this.itemListPriorityDic)if(this.itemListPriorityDic[e].indexOf(t)>-1)return parseInt(e)},e.prototype.loadNextResource=function(){for(;this.loadingCount<this.thread;){var t=this.loadSingleResource();if(!t)break}},e.prototype.loadSingleResource=function(){var e=this,i=this.getOneResourceInfoInGroup();return i?(this.itemLoadDic[i.root+i.name]=1,this.loadingCount++,this.loadResource(i).then(function(r){if(e.loadingCount--,delete e.itemLoadDic[i.root+i.name],t.host.save(i,r),e.promiseHash[i.root+i.name]){var n=e.deleteDispatcher(i.root+i.name);n.dispatchEventWith("complete",!1,r)}var a=i.groupNames;if(a){delete i.groupNames;for(var o=0,s=a;o<s.length;o++){var l=s[o];e.setGroupProgress(l,i)&&e.loadGroupEnd(l)}}e.loadNextResource()})["catch"](function(r){if(!r)throw i.name+" load fail";if(!r.__resource_manager_error__)throw r;delete e.itemLoadDic[i.root+i.name],e.loadingCount--,delete t.host.state[i.root+i.name];var n=e.retryTimesDic[i.name]||1;if(!(n>e.maxRetryTimes))return e.retryTimesDic[i.name]=n+1,e.failedList.push(i),void e.loadNextResource();if(delete e.retryTimesDic[i.name],e.promiseHash[i.root+i.name]){var a=e.deleteDispatcher(i.root+i.name);a.dispatchEventWith("error",!1,{r:i,error:r})}var o=i.groupNames;if(o){delete i.groupNames;for(var s=0,l=o;s<l.length;s++){var h=l[s];e.loadItemErrorDic[h]||(e.loadItemErrorDic[h]=[]),-1==e.loadItemErrorDic[h].indexOf(i)&&e.loadItemErrorDic[h].push(i),e.groupErrorDic[h]=!0,e.setGroupProgress(h,i)?e.loadGroupEnd(h,r):e.errorDic[h]=r}}e.loadNextResource()}),!0):!1},e.prototype.getOneResourceInfoInGroup=function(){if(this.failedList.length>0)return this.failedList.shift();var t=Number.NEGATIVE_INFINITY;for(var e in this.itemListPriorityDic)t=Math.max(t,e);var i=this.itemListPriorityDic[t];return i?0==i.length?(delete this.itemListPriorityDic[t],this.getOneResourceInfoInGroup()):i.shift():void 0},e.prototype.setGroupProgress=function(t,e){var i=this.reporterDic[t];this.numLoadedDic[t]++;var r=this.numLoadedDic[t],n=this.groupTotalDic[t];return i&&i.onProgress&&i.onProgress(r,n,e),r==n},e.prototype.loadGroupEnd=function(t,e){delete this.groupTotalDic[t],delete this.numLoadedDic[t],delete this.reporterDic[t];var i=this.deleteDispatcher(t);if(e){delete this.groupErrorDic[t];var r=this.loadItemErrorDic[t];delete this.loadItemErrorDic[t],i.dispatchEventWith("error",!1,{itemList:r,lastError:e})}else{var n=this.groupErrorDic[t];if(delete this.groupErrorDic[t],n){var r=this.loadItemErrorDic[t];delete this.loadItemErrorDic[t];var a=this.errorDic[t];delete this.errorDic[t],i.dispatchEventWith("error",!1,{itemList:r,error:a})}else i.dispatchEventWith("complete")}},e.prototype.deleteDispatcher=function(t){delete this.promiseHash[t];var e=this.dispatcherDic[t];return delete this.dispatcherDic[t],e},e.prototype.loadResource=function(e,i){if(!i){if(1==t.FEATURE_FLAG.FIX_DUPLICATE_LOAD){var r=t.host.state[e.root+e.name];if(2==r)return Promise.resolve(t.host.get(e));if(1==r)return e.promise}i=t.processor.isSupport(e)}if(!i)throw new t.ResourceManagerError(2001,e.name,e.type);t.host.state[e.root+e.name]=1;var n=i.onLoadStart(t.host,e);return e.promise=n,n},e.prototype.unloadResource=function(e){var i=t.host.get(e);if(!i)return console.warn("尝试释放不存在的资源:",e.name),!1;var r=t.processor.isSupport(e);return r?(r.onRemoveStart(t.host,e),t.host.remove(e),1==e.extra&&t.config.removeResourceData(e),!0):!0},e}();t.ResourceLoader=e,__reflect(e.prototype,"RES.ResourceLoader")}(RES||(RES={}));var RES;!function(t){t.checkNull=function(t,e,i){var r=i.value;i.value=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return t[0]?r.apply(this,t):(console.warn("方法"+e+"的参数不能为null"),null)}},t.FEATURE_FLAG={FIX_DUPLICATE_LOAD:1};var e;!function(t){function e(t){i=t}var i="warning";t.setUpgradeGuideLevel=e}(e=t.upgrade||(t.upgrade={}))}(RES||(RES={}));var RES;!function(t){function e(e){return t.path.basename(e).split(".").join("_")}function i(e){var i,r=e.substr(e.lastIndexOf(".")+1);switch(r){case t.ResourceItem.TYPE_XML:case t.ResourceItem.TYPE_JSON:case t.ResourceItem.TYPE_SHEET:i=r;break;case"png":case"jpg":case"gif":case"jpeg":case"bmp":i=t.ResourceItem.TYPE_IMAGE;break;case"fnt":i=t.ResourceItem.TYPE_FONT;break;case"txt":i=t.ResourceItem.TYPE_TEXT;break;case"mp3":case"ogg":case"mpeg":case"wav":case"m4a":case"mp4":case"aiff":case"wma":case"mid":i=t.ResourceItem.TYPE_SOUND;break;case"mergeJson":case"zip":case"pvr":i=r;break;default:i=t.ResourceItem.TYPE_BIN}return i}function r(e,i){throw new t.ResourceManagerError(2002)}function n(e){t.isCompatible=e}function a(e,i){if(i.indexOf("://")>=0){var r=i.split("://");i=r[0]+"://"+t.path.normalize(r[1]+"/"),e=e.replace(i,"")}else i=t.path.normalize(i+"/"),e=e.replace(i,"");return t.setConfigURL(e,i),C||(C=new S),o(C.loadConfig())}function o(e){return t.isCompatible?void e["catch"](function(t){}).then():e}function s(t,e,i){return void 0===e&&(e=0),o(C.loadGroup(t,e,i))}function l(t){return C.isGroupLoaded(t)}function h(e){return C.getGroupByName(e).map(function(e){return t.ResourceItem.convertToResItem(e)})}function c(t,e,i){return void 0===i&&(i=!1),C.createGroup(t,e,i)}function u(t){return C.hasRes(t)}function p(t){return C.getRes(t)}function d(t,e,i){return o(C.getResAsync.apply(C,arguments))}function f(t,e,i,r){if(void 0===r&&(r=""),!C){var n=egret.sys.tr(3200);return egret.warn(n),Promise.reject(n)}return o(C.getResByUrl(t,e,i,r))}function g(t,e){return C.destroyRes(t,e)}function m(t){C||(C=new S),C.setMaxLoadingThread(t)}function y(t){C.setMaxRetryTimes(t)}function v(t,e,i,r,n){void 0===r&&(r=!1),void 0===n&&(n=0),C||(C=new S),C.addEventListener(t,e,i,r,n)}function _(t,e,i,r){void 0===r&&(r=!1),C.removeEventListener(t,e,i,r)}function b(t){C.addResourceData(t)}function x(){return C||(C=new S),C.vcs}function T(t){C||(C=new S),C.registerVersionController(t)}function E(t){return C.vcs?C.vcs.getVirtualUrl(t):t}t.nameSelector=e,t.typeSelector=i,t.registerAnalyzer=r,t.setIsCompatible=n,t.isCompatible=!1,t.loadConfig=a,t.loadGroup=s,t.isGroupLoaded=l,t.getGroupByName=h,t.createGroup=c,t.hasRes=u,t.getRes=p,t.getResAsync=d,t.getResByUrl=f,t.destroyRes=g,t.setMaxLoadingThread=m,t.setMaxRetryTimes=y,t.addEventListener=v,t.removeEventListener=_,t.$addResourceData=b,t.getVersionController=x,t.registerVersionController=T,t.getVirtualUrl=E;var S=function(e){function i(){var i=e.call(this)||this;return i.isVcsInit=!1,i.normalLoadConfig=function(){return t.config.init().then(function(e){t.ResourceEvent.dispatchResourceEvent(i,t.ResourceEvent.CONFIG_COMPLETE)},function(e){return t.ResourceEvent.dispatchResourceEvent(i,t.ResourceEvent.CONFIG_LOAD_ERROR),Promise.reject(e)})},t.VersionController&&(i.vcs=new t.VersionController),i}return __extends(i,e),i.prototype.registerVersionController=function(t){this.vcs=t,this.isVcsInit=!1},i.prototype.loadConfig=function(){var t=this;return!this.isVcsInit&&this.vcs?(this.isVcsInit=!0,this.vcs.init().then(function(){return t.normalLoadConfig()})):this.normalLoadConfig()},i.prototype.isGroupLoaded=function(e){var i=t.config.getGroupByName(e);return i.every(function(e){return null!=t.host.get(e)})},i.prototype.getGroupByName=function(e){return t.config.getGroupByName(e)},i.prototype.loadGroup=function(e,i,r){var n=this;void 0===i&&(i=0);var a={onProgress:function(i,a,o){r&&r.onProgress&&r.onProgress(i,a,o),t.ResourceEvent.dispatchResourceEvent(n,t.ResourceEvent.GROUP_PROGRESS,e,o,i,a)}};return this._loadGroup(e,i,a).then(function(i){-1==t.config.config.loadGroup.indexOf(e)&&t.config.config.loadGroup.push(e),t.ResourceEvent.dispatchResourceEvent(n,t.ResourceEvent.GROUP_COMPLETE,e)},function(i){if(-1==t.config.config.loadGroup.indexOf(e)&&t.config.config.loadGroup.push(e),i.itemList)for(var r=i.itemList,a=r.length,o=0;a>o;o++){var s=r[o];delete s.promise,t.ResourceEvent.dispatchResourceEvent(n,t.ResourceEvent.ITEM_LOAD_ERROR,e,s)}return t.isCompatible&&console.warn(i.error.message),t.ResourceEvent.dispatchResourceEvent(n,t.ResourceEvent.GROUP_LOAD_ERROR,e),Promise.reject(i.error)})},i.prototype._loadGroup=function(e,i,r){void 0===i&&(i=0);var n=t.config.getGroupByName(e);return 0==n.length?new Promise(function(i,r){r({error:new t.ResourceManagerError(2005,e)})}):t.queue.pushResGroup(n,e,i,r)},i.prototype.createGroup=function(e,i,r){return void 0===r&&(r=!1),t.config.createGroup(e,i,r)},i.prototype.hasRes=function(e){return null!=t.config.getResourceWithSubkey(e)},i.prototype.getRes=function(e){var i=t.config.getResourceWithSubkey(e);if(i){var r=i.r,n=i.key,a=i.subkey,o=t.processor.isSupport(r);return o&&o.getData&&a?o.getData(t.host,r,n,a):t.host.get(r)}return null},i.prototype.getResAsync=function(e,i,r){var n=this,a=e,o=t.config.getResourceWithSubkey(e);if(null==o)return i&&i.call(r,null,a),Promise.reject(new t.ResourceManagerError(2006,e));var s=this.getRes(e);if(s)return i&&egret.callLater(function(){i.call(r,s,a)},this),Promise.resolve(s);var l=o.r,h=o.subkey;return t.queue.pushResItem(l).then(function(n){t.host.save(l,n);var o=t.processor.isSupport(l);return o&&o.getData&&h&&(n=o.getData(t.host,l,e,h)),i&&i.call(r,n,a),n},function(e){return t.host.remove(l),t.ResourceEvent.dispatchResourceEvent(n,t.ResourceEvent.ITEM_LOAD_ERROR,"",l),i?(i.call(r,null,a),Promise.reject("load fail: "+a)):Promise.reject(e)})},i.prototype.getResByUrl=function(e,i,r,n){var a=this;void 0===n&&(n="");var o=t.config.getResource(e);if(!o&&(n||(n=t.config.__temp__get__type__via__url(e)),o={name:e,url:e,type:n,root:"",extra:1},t.config.addResourceData(o),o=t.config.getResource(e),!o))throw"never";return t.queue.pushResItem(o).then(function(e){return t.host.save(o,e),i&&o&&i.call(r,e,o.url),e},function(n){return t.host.remove(o),t.ResourceEvent.dispatchResourceEvent(a,t.ResourceEvent.ITEM_LOAD_ERROR,"",o),i?(i.call(r,null,e),Promise.reject("load fail: "+e)):Promise.reject(n)})},i.prototype.destroyRes=function(e,i){void 0===i&&(i=!0);var r=t.config.getGroupByName(e);if(r&&r.length>0){var n=t.config.config.loadGroup.indexOf(e);if(-1==n)return!1;if(i||1==t.config.config.loadGroup.length&&t.config.config.loadGroup[0]==e){for(var a=0,o=r;a<o.length;a++){var s=o[a];t.queue.unloadResource(s)}t.config.config.loadGroup.splice(n,1)}else{for(var l={},h=0,c=t.config.config.loadGroup;h<c.length;h++){var u=c[h];for(var p in t.config.config.groups[u]){var d=t.config.config.groups[u][p];l[d]?l[d]++:l[d]=1}}for(var f=0,g=r;f<g.length;f++){var s=g[f];l[s.name]&&1==l[s.name]&&t.queue.unloadResource(s)}t.config.config.loadGroup.splice(n,1)}return!0}var s=t.config.getResource(e);return s?t.queue.unloadResource(s):(console.warn("在内存"+e+"资源不存在"),!1)},i.prototype.setMaxLoadingThread=function(e){1>e&&(e=1),t.queue.thread=e},i.prototype.setMaxRetryTimes=function(e){e=Math.max(e,0),t.queue.maxRetryTimes=e},i.prototype.addResourceData=function(e){e.root="",t.config.addResourceData(e)},__decorate([t.checkNull],i.prototype,"hasRes",null),__decorate([t.checkNull],i.prototype,"getRes",null),__decorate([t.checkNull],i.prototype,"getResAsync",null),__decorate([t.checkNull],i.prototype,"getResByUrl",null),i
}(egret.EventDispatcher);t.Resource=S,__reflect(S.prototype,"RES.Resource");var C}(RES||(RES={}));var RES;!function(t){var e;!function(t){function e(t){var e=t.split("/");return e.filter(function(t,i){return!!t||i==e.length-1}).join("/")}function i(t){return t.substr(t.lastIndexOf("/")+1)}function r(t){return t.substr(0,t.lastIndexOf("/"))}t.normalize=e,t.basename=i,t.dirname=r}(e=t.path||(t.path={}))}(RES||(RES={}));var RES;!function(t){var e=function(){function t(){}return t.prototype.init=function(){return this.versionInfo=this.getLocalData("all.manifest"),Promise.resolve()},t.prototype.getVirtualUrl=function(t){return t},t.prototype.getLocalData=function(t){if(egret_native.readUpdateFileSync&&egret_native.readResourceFileSync){var e=egret_native.readUpdateFileSync(t);if(null!=e)return JSON.parse(e);if(e=egret_native.readResourceFileSync(t),null!=e)return JSON.parse(e)}return null},t}();t.NativeVersionController=e,__reflect(e.prototype,"RES.NativeVersionController",["RES.IVersionController"]),egret.Capabilities.runtimeType==egret.RuntimeType.NATIVE&&(t.VersionController=e)}(RES||(RES={}));var RES;!function(t){var e;!function(e){function i(t){return e._map[t.type]}function r(t,i){e._map[t]=i}function n(e,i){var r=this;return new Promise(function(n,a){var o=function(){var t=e.data?e.data:e.response;n(t)},s=function(){var e=new t.ResourceManagerError(1001,i.url);a(e)};e.addEventListener(egret.Event.COMPLETE,o,r),e.addEventListener(egret.IOErrorEvent.IO_ERROR,s,r)})}function a(t,e){if(-1!=e.indexOf("://"))return e;t=t.split("\\").join("/");var i=t.match(/#.*|\?.*/),r="";i&&(r=i[0]);var n=t.lastIndexOf("/");return t=-1!=n?t.substring(0,n+1)+e:e,t+r}function o(t){return{name:t.name+"_alpha",url:t.etc1_alpha_url,type:"ktx",root:t.root}}e.isSupport=i,e.map=r,e.getRelativePath=a,e.ImageProcessor={onLoadStart:function(e,i){var r=new egret.ImageLoader;return r.load(t.getVirtualUrl(i.root+i.url)),n(r,i).then(function(t){var r=new egret.Texture;r._setBitmapData(t);var n=e.resourceConfig.getResource(i.name);if(n&&n.scale9grid){var a=n.scale9grid.split(",");r.scale9Grid=new egret.Rectangle(parseInt(a[0]),parseInt(a[1]),parseInt(a[2]),parseInt(a[3]))}return r})},onRemoveStart:function(t,e){var i=t.get(e);i.dispose()}},e.KTXTextureProcessor={onLoadStart:function(t,e){return t.load(e,"bin").then(function(i){if(!i)return console.error("ktx:"+e.root+e.url+" is null"),null;var r=new egret.KTXContainer(i,1);if(r.isInvalid)return console.error("ktx:"+e.root+e.url+" is invalid"),null;var n=new egret.BitmapData(i);n.debugCompressedTextureURL=e.root+e.url,n.format="ktx",r.uploadLevels(n,!1);var a=new egret.Texture;a._setBitmapData(n);var o=t.resourceConfig.getResource(e.name);if(o&&o.scale9grid){var s=o.scale9grid.split(",");a.scale9Grid=new egret.Rectangle(parseInt(s[0]),parseInt(s[1]),parseInt(s[2]),parseInt(s[3]))}return t.save(e,a),a},function(i){throw t.remove(e),i})},onRemoveStart:function(t,e){var i=t.get(e);i&&i.dispose()}},e.makeEtc1SeperatedAlphaResourceInfo=o,e.ETC1KTXProcessor={onLoadStart:function(t,e){return t.load(e,"ktx").then(function(i){if(!i)return null;if(e.etc1_alpha_url){var r=o(e);return t.load(r,"ktx").then(function(e){return i&&i.$bitmapData&&e.$bitmapData?(i.$bitmapData.etcAlphaMask=e.$bitmapData,t.save(r,e)):t.remove(r),i},function(e){throw t.remove(r),e})}return i},function(i){throw t.remove(e),i})},onRemoveStart:function(t,e){var i=t.get(e);if(i&&i.dispose(),e.etc1_alpha_url){var r=o(e),n=t.get(r);n&&n.dispose(),t.unload(r)}}},e.BinaryProcessor={onLoadStart:function(e,i){var r=new egret.HttpRequest;return r.responseType=egret.HttpResponseType.ARRAY_BUFFER,r.open(t.getVirtualUrl(i.root+i.url),"get"),r.send(),n(r,i)},onRemoveStart:function(t,e){}},e.TextProcessor={onLoadStart:function(e,i){var r=new egret.HttpRequest;return r.responseType=egret.HttpResponseType.TEXT,r.open(t.getVirtualUrl(i.root+i.url),"get"),r.send(),n(r,i)},onRemoveStart:function(t,e){return!0}},e.JsonProcessor={onLoadStart:function(t,e){return t.load(e,"text").then(function(t){var e=JSON.parse(t);return e})},onRemoveStart:function(t,e){}},e.XMLProcessor={onLoadStart:function(t,e){return t.load(e,"text").then(function(t){var e=egret.XML.parse(t);return e})},onRemoveStart:function(t,e){return!0}},e.CommonJSProcessor={onLoadStart:function(e,i){return e.load(i,"text").then(function(e){var r=new Function("require","exports",e),n=function(){},a={};try{r(n,a)}catch(o){throw new t.ResourceManagerError(2003,i.name,o.message)}return a})},onRemoveStart:function(t,e){}},e.SheetProcessor={onLoadStart:function(e,i){return e.load(i,"json").then(function(r){var n=e.resourceConfig.getResource(t.nameSelector(r.file));if(!n){var o=a(i.url,r.file);n={name:o,url:o,type:"image",root:i.root}}return e.load(n).then(function(t){if(!t)return null;var i=r.frames,a=new egret.SpriteSheet(t);a.$resourceInfo=n;for(var o in i){var s=i[o],l=a.createTexture(o,s.x,s.y,s.w,s.h,s.offX,s.offY,s.sourceW,s.sourceH);if(s.scale9grid){var h=s.scale9grid,c=h.split(",");l.scale9Grid=new egret.Rectangle(parseInt(c[0]),parseInt(c[1]),parseInt(c[2]),parseInt(c[3]))}}return e.save(n,t),a},function(t){throw e.remove(n),t})})},getData:function(t,e,i,r){var n=t.get(e);return n?n.getTexture(r):null},onRemoveStart:function(t,e){var i=t.get(e),r=i.$resourceInfo;i.dispose(),t.unload(r)}};var s=function(t,e){var i="",r=e.split("\n"),n=r[2],a=n.indexOf('file="');-1!=a&&(n=n.substring(a+6),a=n.indexOf('"'),i=n.substring(0,a)),t=t.split("\\").join("/");var a=t.lastIndexOf("/");return t=-1!=a?t.substring(0,a+1)+i:i};e.FontProcessor={onLoadStart:function(e,i){return e.load(i,"text").then(function(r){var n;try{n=JSON.parse(r)}catch(o){n=r}var l;l="string"==typeof n?s(i.url,n):a(i.url,n.file);var h=e.resourceConfig.getResource(t.nameSelector(l));return h||(h={name:l,url:l,type:"image",root:i.root}),e.load(h).then(function(t){var i=new egret.BitmapFont(t,n);return i.$resourceInfo=h,e.save(h,t),i},function(t){throw e.remove(h),t})})},onRemoveStart:function(t,e){var i=t.get(e),r=i.$resourceInfo;t.unload(r)}},e.SoundProcessor={onLoadStart:function(e,i){var r=new egret.Sound;return r.load(t.getVirtualUrl(i.root+i.url)),n(r,i).then(function(){return r})},onRemoveStart:function(t,e){var i=t.get(e);i.close()}},e.MovieClipProcessor={onLoadStart:function(e,i){var r,n;return e.load(i,"json").then(function(a){r=a;var o=i.name,s=o.substring(0,o.lastIndexOf("."))+".png";if(n=e.resourceConfig.getResource(s),!n)throw new t.ResourceManagerError(1001,s);return e.load(n)}).then(function(t){e.save(n,t);var i=t,a=new egret.MovieClipDataFactory(r,i);return a})},onRemoveStart:function(t,e){var i=t.get(e);i.clearCache(),i.$spriteSheet.dispose();var r=e.name,n=r.substring(0,r.lastIndexOf("."))+".png",a=t.resourceConfig.getResource(n);a&&t.unload(a)}},e.MergeJSONProcessor={onLoadStart:function(e,i){return e.load(i,"json").then(function(e){for(var r in e)t.config.addSubkey(r,i.name);return e})},getData:function(t,e,i,r){var n=t.get(e);return n?n[r]:(console.error("missing resource :"+e.name),null)},onRemoveStart:function(t,e){}},e.LegacyResourceConfigProcessor={onLoadStart:function(e,i){return e.load(i,"json").then(function(r){var n=t.config.config,a=i.root,o=n.fileSystem;o||(o={fsData:{},getFile:function(t){return p[t]},addFile:function(t){t.type||(t.type=""),void 0==a&&(t.root=""),p[t.name]=t},profile:function(){console.log(p)},removeFile:function(t){delete p[t]}},n.fileSystem=o);for(var s=n.groups,l=0,h=r.groups;l<h.length;l++){var c=h[l];""==c.keys?s[c.name]=[]:s[c.name]=c.keys.split(",")}for(var u=n.alias,p=o.fsData,d=function(t){p[t.name]=t,p[t.name].root=a,t.subkeys&&t.subkeys.split(",").forEach(function(e){u[e]=t.name+"#"+e,u[t.name+"."+e]=t.name+"#"+e})},f=0,g=r.resources;f<g.length;f++){var m=g[f];d(m)}return e.save(i,r),r})},onRemoveStart:function(){}},e._map={image:e.ImageProcessor,json:e.JsonProcessor,text:e.TextProcessor,xml:e.XMLProcessor,sheet:e.SheetProcessor,font:e.FontProcessor,bin:e.BinaryProcessor,commonjs:e.CommonJSProcessor,sound:e.SoundProcessor,movieclip:e.MovieClipProcessor,mergeJson:e.MergeJSONProcessor,legacyResourceConfig:e.LegacyResourceConfigProcessor,ktx:e.KTXTextureProcessor,"etc1.ktx":e.ETC1KTXProcessor,"pvrtc.ktx":e.KTXTextureProcessor}}(e=t.processor||(t.processor={}))}(RES||(RES={}));var RES;!function(t){var e=function(e){function i(t,i,r){void 0===i&&(i=!1),void 0===r&&(r=!1);var n=e.call(this,t,i,r)||this;return n.itemsLoaded=0,n.itemsTotal=0,n.groupName="",n}return __extends(i,e),i.dispatchResourceEvent=function(e,r,n,a,o,s){void 0===n&&(n=""),void 0===a&&(a=void 0),void 0===o&&(o=0),void 0===s&&(s=0);var l=egret.Event.create(i,r);l.groupName=n,a&&(l.resItem=t.ResourceItem.convertToResItem(a)),l.itemsLoaded=o,l.itemsTotal=s;var h=e.dispatchEvent(l);return egret.Event.release(l),h},i.ITEM_LOAD_ERROR="itemLoadError",i.CONFIG_COMPLETE="configComplete",i.CONFIG_LOAD_ERROR="configLoadError",i.GROUP_PROGRESS="groupProgress",i.GROUP_COMPLETE="groupComplete",i.GROUP_LOAD_ERROR="groupLoadError",i}(egret.Event);t.ResourceEvent=e,__reflect(e.prototype,"RES.ResourceEvent")}(RES||(RES={}));var RES;!function(t){var e;!function(e){function i(e){var i=e.name;if(t.config.config)for(var r in t.config.config.alias)t.config.config.alias[r]==e.url&&(i=r);else i=e.url;var n={name:i,url:e.url,type:e.type,data:e,root:e.root};return n}e.TYPE_XML="xml",e.TYPE_IMAGE="image",e.TYPE_BIN="bin",e.TYPE_TEXT="text",e.TYPE_JSON="json",e.TYPE_SHEET="sheet",e.TYPE_FONT="font",e.TYPE_SOUND="sound",e.convertToResItem=i}(e=t.ResourceItem||(t.ResourceItem={}))}(RES||(RES={}));var RES;!function(t){var e=function(){function e(t){this.data=t}return e.prototype.profile=function(){console.log(this.data)},e.prototype.addFile=function(e,i){i||(i=""),e=t.path.normalize(e);var r=t.path.basename(e),n=t.path.dirname(e);this.exists(n)||this.mkdir(n);var a=this.resolve(n);a[r]={url:e,type:i}},e.prototype.getFile=function(t){var e=this.resolve(t);return e&&(e.name=t),e},e.prototype.resolve=function(e){if(""==e)return this.data;e=t.path.normalize(e);for(var i=e.split("/"),r=this.data,n=0,a=i;n<a.length;n++){var o=a[n];if(!r)return r;r=r[o]}return r},e.prototype.mkdir=function(e){e=t.path.normalize(e);for(var i=e.split("/"),r=this.data,n=0,a=i;n<a.length;n++){var o=a[n];r[o]||(r[o]={}),r=r[o]}},e.prototype.exists=function(e){if(""==e)return!0;e=t.path.normalize(e);for(var i=e.split("/"),r=this.data,n=0,a=i;n<a.length;n++){var o=a[n];if(!r[o])return!1;r=r[o]}return!0},e}();t.NewFileSystem=e,__reflect(e.prototype,"RES.NewFileSystem")}(RES||(RES={}));var RES;!function(t){function e(){if(!n)return i;var t=0;for(var e in r){var a=r[e];a instanceof egret.Texture&&(t+=a.$bitmapWidth*a.$bitmapHeight*4)}return i=Number((t/1024/1024).toFixed(1)),n=!1,i}var i,r={},n=!1;t.profile=e,t.host={state:{},get resourceConfig(){return t.config},load:function(e,i){var r="string"==typeof i?t.processor._map[i]:i;return t.queue.loadResource(e,r)},unload:function(e){return t.queue.unloadResource(e)},save:function(e,i){t.host.state[e.root+e.name]=2,delete e.promise,r[e.root+e.name]=i,n=!0},get:function(t){return r[t.root+t.name]},remove:function(e){delete t.host.state[e.root+e.name],delete r[e.root+e.name],n=!0}},t.config=new t.ResourceConfig,t.queue=new t.ResourceLoader;var a=function(t){function e(i,r,n){var a=t.call(this)||this;return a.__resource_manager_error__=!0,a.name=i.toString(),a.message=e.errorMessage[i].replace("{0}",r).replace("{1}",n),a}return __extends(e,t),e.errorMessage={1001:"文件加载失败:{0}",1002:"ResourceManager 初始化失败：配置文件加载失败",2001:"{0}解析失败,不支持指定解析类型:'{1}'，请编写自定义 Processor ，更多内容请参见 https://github.com/egret-labs/resourcemanager/blob/master/docs/README.md#processor",2002:"Analyzer 相关API 在 ResourceManager 中不再支持，请编写自定义 Processor ，更多内容请参见 https://github.com/egret-labs/resourcemanager/blob/master/docs/README.md#processor",2003:"{0}解析失败,错误原因:{1}",2004:"无法找到文件类型:{0}",2005:'RES加载了不存在或空的资源组:"{0}"',2006:"资源配置文件中无法找到特定的资源:{0}"},e}(Error);t.ResourceManagerError=a,__reflect(a.prototype,"RES.ResourceManagerError")}(RES||(RES={}));var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);i.prototype=e.prototype,t.prototype=new i},eui;!function(t){var e;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.targetLevel=Number.POSITIVE_INFINITY,e.invalidatePropertiesFlag=!1,e.invalidateClientPropertiesFlag=!1,e.invalidatePropertiesQueue=new i,e.invalidateSizeFlag=!1,e.invalidateClientSizeFlag=!1,e.invalidateSizeQueue=new i,e.invalidateDisplayListFlag=!1,e.invalidateDisplayListQueue=new i,e.eventDisplay=new egret.Bitmap,e.listenersAttached=!1,e}return __extends(e,t),e.prototype.invalidateProperties=function(t){this.invalidatePropertiesFlag||(this.invalidatePropertiesFlag=!0,this.listenersAttached||this.attachListeners()),this.targetLevel<=t.$nestLevel&&(this.invalidateClientPropertiesFlag=!0),this.invalidatePropertiesQueue.insert(t)},e.prototype.validateProperties=function(){for(var t=this.invalidatePropertiesQueue,e=t.shift();e;)e.$stage&&e.validateProperties(),e=t.shift();t.isEmpty()&&(this.invalidatePropertiesFlag=!1)},e.prototype.invalidateSize=function(t){this.invalidateSizeFlag||(this.invalidateSizeFlag=!0,this.listenersAttached||this.attachListeners()),this.targetLevel<=t.$nestLevel&&(this.invalidateClientSizeFlag=!0),this.invalidateSizeQueue.insert(t)},e.prototype.validateSize=function(){for(var t=this.invalidateSizeQueue,e=t.pop();e;)e.$stage&&e.validateSize(),e=t.pop();t.isEmpty()&&(this.invalidateSizeFlag=!1)},e.prototype.invalidateDisplayList=function(t){this.invalidateDisplayListFlag||(this.invalidateDisplayListFlag=!0,this.listenersAttached||this.attachListeners()),this.invalidateDisplayListQueue.insert(t)},e.prototype.validateDisplayList=function(){for(var t=this.invalidateDisplayListQueue,e=t.shift();e;)e.$stage&&e.validateDisplayList(),e=t.shift();t.isEmpty()&&(this.invalidateDisplayListFlag=!1)},e.prototype.attachListeners=function(){this.eventDisplay.addEventListener(egret.Event.ENTER_FRAME,this.doPhasedInstantiationCallBack,this),this.eventDisplay.addEventListener(egret.Event.RENDER,this.doPhasedInstantiationCallBack,this),egret.sys.$invalidateRenderFlag=!0,this.listenersAttached=!0},e.prototype.doPhasedInstantiationCallBack=function(t){this.eventDisplay.removeEventListener(egret.Event.ENTER_FRAME,this.doPhasedInstantiationCallBack,this),this.eventDisplay.removeEventListener(egret.Event.RENDER,this.doPhasedInstantiationCallBack,this),this.doPhasedInstantiation()},e.prototype.doPhasedInstantiation=function(){this.invalidatePropertiesFlag&&this.validateProperties(),this.invalidateSizeFlag&&this.validateSize(),this.invalidateDisplayListFlag&&this.validateDisplayList(),this.invalidatePropertiesFlag||this.invalidateSizeFlag||this.invalidateDisplayListFlag?this.attachListeners():this.listenersAttached=!1},e.prototype.validateClient=function(t){var e,i=!1,r=this.targetLevel;this.targetLevel===Number.POSITIVE_INFINITY&&(this.targetLevel=t.$nestLevel);for(var n=this.invalidatePropertiesQueue,a=this.invalidateSizeQueue,o=this.invalidateDisplayListQueue;!i;){for(i=!0,e=n.removeSmallestChild(t);e;)e.$stage&&e.validateProperties(),e=n.removeSmallestChild(t);for(n.isEmpty()&&(this.invalidatePropertiesFlag=!1),this.invalidateClientPropertiesFlag=!1,e=a.removeLargestChild(t);e;){if(e.$stage&&e.validateSize(),this.invalidateClientPropertiesFlag&&(e=n.removeSmallestChild(t))){n.insert(e),i=!1;break}e=a.removeLargestChild(t)}for(a.isEmpty()&&(this.invalidateSizeFlag=!1),this.invalidateClientPropertiesFlag=!1,this.invalidateClientSizeFlag=!1,e=o.removeSmallestChild(t);e;){if(e.$stage&&e.validateDisplayList(),this.invalidateClientPropertiesFlag&&(e=n.removeSmallestChild(t))){n.insert(e),i=!1;break}if(this.invalidateClientSizeFlag&&(e=a.removeLargestChild(t))){a.insert(e),i=!1;break}e=o.removeSmallestChild(t)}o.isEmpty()&&(this.invalidateDisplayListFlag=!1)}r===Number.POSITIVE_INFINITY&&(this.targetLevel=Number.POSITIVE_INFINITY)},e}(egret.EventDispatcher);t.Validator=e,__reflect(e.prototype,"eui.sys.Validator");var i=function(){function t(){this.depthBins={},this.minDepth=0,this.maxDepth=-1}return t.prototype.insert=function(t){var e=t.$nestLevel;this.maxDepth<this.minDepth?this.minDepth=this.maxDepth=e:(e<this.minDepth&&(this.minDepth=e),e>this.maxDepth&&(this.maxDepth=e));var i=this.depthBins[e];i||(i=this.depthBins[e]=new r),i.insert(t)},t.prototype.pop=function(){var t,e=this.minDepth;if(e<=this.maxDepth){for(var i=this.depthBins[this.maxDepth];!i||0===i.length;){if(this.maxDepth--,this.maxDepth<e)return null;i=this.depthBins[this.maxDepth]}for(t=i.pop();!(i&&0!=i.length||(this.maxDepth--,this.maxDepth<e));)i=this.depthBins[this.maxDepth]}return t},t.prototype.shift=function(){var t,e=this.maxDepth;if(this.minDepth<=e){for(var i=this.depthBins[this.minDepth];!i||0===i.length;){if(this.minDepth++,this.minDepth>e)return null;i=this.depthBins[this.minDepth]}for(t=i.pop();!(i&&0!=i.length||(this.minDepth++,this.minDepth>e));)i=this.depthBins[this.minDepth]}return t},t.prototype.removeLargestChild=function(t){for(var e=t.$hashCode,i=t.$nestLevel,r=this.maxDepth,n=i;r>=n;){var a=this.depthBins[r];if(a&&a.length>0){if(r===i){if(a.map[e])return a.remove(t),t}else{if(!egret.is(t,"egret.DisplayObjectContainer"))break;for(var o=a.items,s=a.length,l=0;s>l;l++){var h=o[l];if(t.contains(h))return a.remove(h),h}}r--}else if(r==this.maxDepth&&this.maxDepth--,r--,n>r)break}return null},t.prototype.removeSmallestChild=function(t){for(var e=t.$nestLevel,i=e,r=this.maxDepth,n=t.$hashCode;r>=i;){var a=this.depthBins[i];if(a&&a.length>0){if(i===e){if(a.map[n])return a.remove(t),t}else{if(!egret.is(t,"egret.DisplayObjectContainer"))break;for(var o=a.items,s=a.length,l=0;s>l;l++){var h=o[l];if(t.contains(h))return a.remove(h),h}}i++}else if(i==this.minDepth&&this.minDepth++,i++,i>r)break}return null},t.prototype.isEmpty=function(){return this.minDepth>this.maxDepth},t}();__reflect(i.prototype,"DepthQueue");var r=function(){function t(){this.map={},this.items=[],this.length=0}return t.prototype.insert=function(t){var e=t.$hashCode;this.map[e]||(this.map[e]=!0,this.length++,this.items.push(t))},t.prototype.pop=function(){var t=this.items.pop();return t&&(this.length--,0===this.length?this.map={}:this.map[t.$hashCode]=!1),t},t.prototype.remove=function(t){var e=this.items.indexOf(t);e>=0&&(this.items.splice(e,1),this.length--,0===this.length?this.map={}:this.map[t.$hashCode]=!1)},t}();__reflect(r.prototype,"DepthBin")}(e=t.sys||(t.sys={}))}(eui||(eui={}));var eui;!function(t){function e(t,e,i,r){var n=t.prototype;n.__meta__=n.__meta__||{},n.__meta__[e]=i,r&&(n.__defaultProperty__=e)}t.registerProperty=e}(eui||(eui={}));var eui;!function(t){var e=function(e){function i(t,i){void 0===i&&(i=[]);var r=e.call(this)||this;return r.name=t,r.overrides=i,r}return __extends(i,e),i.prototype.initialize=function(e,i){for(var r=this.overrides,n=r.length,a=0;n>a;a++){var o=r[a];if(o instanceof t.AddItems){var s=e[o.target];s&&s instanceof t.Image&&!s.$parent&&(i.addChild(s),i.removeChild(s))}}},i}(egret.HashObject);t.State=e,__reflect(e.prototype,"eui.State")}(eui||(eui={})),function(t){var e;!function(t){var e=function(){function t(){}return Object.defineProperty(t.prototype,"states",{get:function(){return this.$stateValues.states},set:function(t){t||(t=[]);var e=this.$stateValues;e.states=t;for(var i={},r=t.length,n=0;r>n;n++){var a=t[n];i[a.name]=a}e.statesMap=i,e.parent&&this.commitCurrentState()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentState",{get:function(){return this.$stateValues.currentState},set:function(t){var e=this.$stateValues;e.explicitState=t,e.currentState=t,this.commitCurrentState()},enumerable:!0,configurable:!0}),t.prototype.commitCurrentState=function(){var t=this.$stateValues;if(t.parent){var e=t.statesMap[t.currentState];if(!e){if(!(t.states.length>0))return;t.currentState=t.states[0].name}if(t.oldState!=t.currentState){var i=t.parent,r=t.statesMap[t.oldState];if(r)for(var n=r.overrides,a=n.length,o=0;a>o;o++)n[o].remove(this,i);if(t.oldState=t.currentState,r=t.statesMap[t.currentState])for(var n=r.overrides,s=n.length,o=0;s>o;o++)n[o].apply(this,i)}}},t.prototype.hasState=function(t){return!!this.$stateValues.statesMap[t]},t.prototype.initializeStates=function(t){this.$stateValues.intialized=!0;for(var e=this.states,i=e.length,r=0;i>r;r++)e[r].initialize(this,t)},t}();t.StateClient=e,__reflect(e.prototype,"eui.sys.StateClient");var i=function(){function t(){this.intialized=!1,this.statesMap={},this.states=[],this.oldState=null,this.explicitState=null,this.currentState=null,this.parent=null,this.stateIsDirty=!1}return t}();t.StateValues=i,__reflect(i.prototype,"eui.sys.StateValues")}(e=t.sys||(t.sys={}))}(eui||(eui={}));var eui;!function(t){function e(e,i,r){var n=egret.getImplementation("eui.IAssetAdapter");n||(n=new t.DefaultAssetAdapter),n.getAsset(e,function(t){i.call(r,t)},this)}function i(e,i){var r=egret.getImplementation("eui.IThemeAdapter");r||(r=new t.DefaultThemeAdapter),r.getTheme(e,function(t){i(t)},function(t){console.log(t)},this)}t.getAssets=e,t.getTheme=i}(eui||(eui={})),function(t){var e;!function(e){function i(t){return 1===t.a&&0===t.b&&0===t.c&&1===t.d}function r(t,e){if("function"!=typeof t[e])return!1;var i=t[e].toString(),r=i.indexOf("{"),n=i.lastIndexOf("}");return i=i.substring(r+1,n),""==i.trim()}function n(t,e){for(var i in e)"prototype"!=i&&e.hasOwnProperty(i)&&(t[i]=e[i]);for(var n=t.prototype,a=e.prototype,o=Object.keys(a),s=o.length,l=0;s>l;l++){var h=o[l];if("__meta__"!=h&&(!n.hasOwnProperty(h)||r(n,h))){var c=Object.getOwnPropertyDescriptor(a,h);Object.defineProperty(n,h,c)}}}function a(e,i,r){n(e,l);var a=e.prototype;a.$super=i.prototype,t.registerProperty(e,"left","Percentage"),t.registerProperty(e,"right","Percentage"),t.registerProperty(e,"top","Percentage"),t.registerProperty(e,"bottom","Percentage"),t.registerProperty(e,"horizontalCenter","Percentage"),t.registerProperty(e,"verticalCenter","Percentage"),r&&(a.$childAdded=function(t,e){this.invalidateSize(),this.invalidateDisplayList()},a.$childRemoved=function(t,e){this.invalidateSize(),this.invalidateDisplayList()})}var o="eui.UIComponent",s=new e.Validator,l=function(r){function n(){var t=r.call(this)||this;return t.initializeUIValues(),t}return __extends(n,r),n.prototype.initializeUIValues=function(){this.$UIComponent={0:0/0,1:0/0,2:0/0,3:0/0,4:0/0,5:0/0,6:0/0,7:0/0,8:0/0,9:0/0,10:0,11:0,12:0,13:1e5,14:0,15:1e5,16:0,17:0,18:0/0,19:0/0,20:0,21:0,22:0,23:0,24:!0,25:!0,26:!0,27:!1,28:!1,29:!1,30:0/0,31:0/0},this.$includeInLayout=!0,this.$touchEnabled=!0},n.prototype.createChildren=function(){},n.prototype.childrenCreated=function(){},n.prototype.commitProperties=function(){var e=this.$UIComponent;(e[22]!=e[10]||e[23]!=e[11])&&(this.dispatchEventWith(egret.Event.RESIZE),e[22]=e[10],e[23]=e[11]),(e[20]!=this.$getX()||e[21]!=this.$getY())&&(t.UIEvent.dispatchUIEvent(this,t.UIEvent.MOVE),e[20]=this.$getX(),e[21]=this.$getY())},n.prototype.measure=function(){},n.prototype.updateDisplayList=function(t,e){},Object.defineProperty(n.prototype,"includeInLayout",{get:function(){return this.$includeInLayout},set:function(t){t=!!t,this.$includeInLayout!==t&&(this.$includeInLayout=!0,this.invalidateParentLayout(),this.$includeInLayout=t)},enumerable:!0,configurable:!0}),n.prototype.$onAddToStage=function(e,i){this.$super.$onAddToStage.call(this,e,i),this.checkInvalidateFlag();var r=this.$UIComponent;r[29]||(r[29]=!0,this.createChildren(),this.childrenCreated(),t.UIEvent.dispatchUIEvent(this,t.UIEvent.CREATION_COMPLETE))},n.prototype.checkInvalidateFlag=function(t){var e=this.$UIComponent;e[24]&&s.invalidateProperties(this),e[25]&&s.invalidateSize(this),e[26]&&s.invalidateDisplayList(this)},Object.defineProperty(n.prototype,"left",{get:function(){return this.$UIComponent[0]},set:function(t){t=t&&"number"!=typeof t?t.toString().trim():+t;var e=this.$UIComponent;e[0]!==t&&(e[0]=t,this.invalidateParentLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"right",{get:function(){return this.$UIComponent[1]},set:function(t){t=t&&"number"!=typeof t?t.toString().trim():+t;var e=this.$UIComponent;e[1]!==t&&(e[1]=t,this.invalidateParentLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"top",{get:function(){return this.$UIComponent[2]},set:function(t){t=t&&"number"!=typeof t?t.toString().trim():+t;var e=this.$UIComponent;e[2]!==t&&(e[2]=t,this.invalidateParentLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bottom",{get:function(){return this.$UIComponent[3]},set:function(t){t=t&&"number"!=typeof t?t.toString().trim():+t;var e=this.$UIComponent;e[3]!=t&&(e[3]=t,this.invalidateParentLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"horizontalCenter",{get:function(){return this.$UIComponent[4]},set:function(t){t=t&&"number"!=typeof t?t.toString().trim():+t;var e=this.$UIComponent;e[4]!==t&&(e[4]=t,this.invalidateParentLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"verticalCenter",{get:function(){return this.$UIComponent[5]},set:function(t){t=t&&"number"!=typeof t?t.toString().trim():+t;var e=this.$UIComponent;e[5]!==t&&(e[5]=t,this.invalidateParentLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"percentWidth",{get:function(){return this.$UIComponent[6]},set:function(t){t=+t;var e=this.$UIComponent;e[6]!==t&&(e[6]=t,this.invalidateParentLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"percentHeight",{get:function(){return this.$UIComponent[7]},set:function(t){t=+t;var e=this.$UIComponent;e[7]!==t&&(e[7]=t,this.invalidateParentLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"explicitWidth",{get:function(){return this.$UIComponent[8]},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"explicitHeight",{get:function(){return this.$UIComponent[9]},enumerable:!0,configurable:!0}),n.prototype.$getWidth=function(){return this.validateSizeNow(),this.$UIComponent[10]},n.prototype.$setWidth=function(t){t=+t;var e=this.$UIComponent;return 0>t||e[10]===t&&e[8]===t?!1:(e[8]=t,isNaN(t)&&this.invalidateSize(),this.invalidateProperties(),this.invalidateDisplayList(),this.invalidateParentLayout(),!0)},n.prototype.validateSizeNow=function(){this.validateSize(!0),this.updateFinalSize()},n.prototype.$getHeight=function(){return this.validateSizeNow(),this.$UIComponent[11]},n.prototype.$setHeight=function(t){t=+t;var e=this.$UIComponent;return 0>t||e[11]===t&&e[9]===t?!1:(e[9]=t,isNaN(t)&&this.invalidateSize(),this.invalidateProperties(),this.invalidateDisplayList(),this.invalidateParentLayout(),!0)},Object.defineProperty(n.prototype,"minWidth",{get:function(){return this.$UIComponent[12]},set:function(t){t=+t||0;var e=this.$UIComponent;0>t||e[12]===t||(e[12]=t,this.invalidateSize(),this.invalidateParentLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"maxWidth",{get:function(){return this.$UIComponent[13]},set:function(t){t=+t||0;var e=this.$UIComponent;0>t||e[13]===t||(e[13]=t,this.invalidateSize(),this.invalidateParentLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"minHeight",{get:function(){return this.$UIComponent[14]},set:function(t){t=+t||0;var e=this.$UIComponent;0>t||e[14]===t||(e[14]=t,this.invalidateSize(),this.invalidateParentLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"maxHeight",{get:function(){return this.$UIComponent[15]},set:function(t){t=+t||0;var e=this.$UIComponent;0>t||e[15]===t||(e[15]=t,this.invalidateSize(),this.invalidateParentLayout())},enumerable:!0,configurable:!0}),n.prototype.setMeasuredSize=function(t,e){var i=this.$UIComponent;i[16]=Math.ceil(+t||0),i[17]=Math.ceil(+e||0)},n.prototype.setActualSize=function(t,e){var i=!1,r=this.$UIComponent;r[10]!==t&&(r[10]=t,i=!0),r[11]!==e&&(r[11]=e,i=!0),i&&(this.invalidateDisplayList(),this.dispatchEventWith(egret.Event.RESIZE))},n.prototype.$updateUseTransform=function(){this.$super.$updateUseTransform.call(this),this.invalidateParentLayout()},n.prototype.$setMatrix=function(t,e){return void 0===e&&(e=!0),this.$super.$setMatrix.call(this,t,e),this.invalidateParentLayout(),!0},n.prototype.$setAnchorOffsetX=function(t){return this.$super.$setAnchorOffsetX.call(this,t),this.invalidateParentLayout(),!0},n.prototype.$setAnchorOffsetY=function(t){return this.$super.$setAnchorOffsetY.call(this,t),this.invalidateParentLayout(),!0},n.prototype.$setX=function(t){var e=this.$super.$setX.call(this,t);return e&&(this.invalidateParentLayout(),this.invalidateProperties()),e},n.prototype.$setY=function(t){var e=this.$super.$setY.call(this,t);return e&&(this.invalidateParentLayout(),this.invalidateProperties()),e},n.prototype.invalidateProperties=function(){var t=this.$UIComponent;t[24]||(t[24]=!0,this.$stage&&s.invalidateProperties(this))},n.prototype.validateProperties=function(){var t=this.$UIComponent;t[24]&&(this.commitProperties(),t[24]=!1)},n.prototype.invalidateSize=function(){var t=this.$UIComponent;t[25]||(t[25]=!0,this.$stage&&s.invalidateSize(this))},n.prototype.validateSize=function(t){if(t){var e=this.$children;if(e)for(var i=e.length,r=0;i>r;r++){var n=e[r];egret.is(n,o)&&n.validateSize(!0)}}var a=this.$UIComponent;if(a[25]){var s=this.measureSizes();s&&(this.invalidateDisplayList(),this.invalidateParentLayout()),a[25]=!1}},n.prototype.measureSizes=function(){var t=!1,e=this.$UIComponent;if(!e[25])return t;(isNaN(e[8])||isNaN(e[9]))&&(this.measure(),e[16]<e[12]&&(e[16]=e[12]),e[16]>e[13]&&(e[16]=e[13]),e[17]<e[14]&&(e[17]=e[14]),e[17]>e[15]&&(e[17]=e[15]));var i=this.getPreferredUWidth(),r=this.getPreferredUHeight();return(i!==e[18]||r!==e[19])&&(e[18]=i,e[19]=r,t=!0),t},n.prototype.invalidateDisplayList=function(){var t=this.$UIComponent;t[26]||(t[26]=!0,this.$stage&&s.invalidateDisplayList(this))},n.prototype.validateDisplayList=function(){var t=this.$UIComponent;t[26]&&(this.updateFinalSize(),this.updateDisplayList(t[10],t[11]),t[26]=!1)},n.prototype.updateFinalSize=function(){var t=0,e=0,i=this.$UIComponent;t=i[27]?i[10]:isNaN(i[8])?i[16]:i[8],e=i[28]?i[11]:isNaN(i[9])?i[17]:i[9],this.setActualSize(t,e)},n.prototype.validateNow=function(){this.$stage&&s.validateClient(this)},n.prototype.invalidateParentLayout=function(){var t=this.$parent;t&&this.$includeInLayout&&egret.is(t,o)&&(t.invalidateSize(),t.invalidateDisplayList())},n.prototype.setLayoutBoundsSize=function(t,r){if(r=+r,t=+t,!(0>r||0>t)){var n,a,o=this.$UIComponent,s=o[13],l=o[15],h=Math.min(o[12],s),c=Math.min(o[14],l);isNaN(t)?(o[27]=!1,n=this.getPreferredUWidth()):(o[27]=!0,n=Math.max(h,Math.min(s,t))),isNaN(r)?(o[28]=!1,a=this.getPreferredUHeight()):(o[28]=!0,a=Math.max(c,Math.min(l,r)));var u=this.getAnchorMatrix();if(i(u))return void this.setActualSize(n,a);var p=e.MatrixUtil.fitBounds(t,r,u,o[8],o[9],this.getPreferredUWidth(),this.getPreferredUHeight(),h,c,s,l);p||(p=egret.Point.create(h,c)),this.setActualSize(p.x,p.y),egret.Point.release(p)}},n.prototype.setLayoutBoundsPosition=function(e,r){var n=this.$getMatrix();if(!i(n)||0!=this.anchorOffsetX||0!=this.anchorOffsetY){var a=egret.$TempRectangle;this.getLayoutBounds(a),e+=this.$getX()-a.x,r+=this.$getY()-a.y}var o=this.$super.$setX.call(this,e);(this.$super.$setY.call(this,r)||o)&&t.UIEvent.dispatchUIEvent(this,t.UIEvent.MOVE)},n.prototype.getLayoutBounds=function(t){var e,i=this.$UIComponent;e=i[27]?i[10]:isNaN(i[8])?i[16]:i[8];var r;r=i[28]?i[11]:isNaN(i[9])?i[17]:i[9],this.applyMatrix(t,e,r)},n.prototype.getPreferredUWidth=function(){var t=this.$UIComponent;return isNaN(t[8])?t[16]:t[8]},n.prototype.getPreferredUHeight=function(){var t=this.$UIComponent;return isNaN(t[9])?t[17]:t[9]},n.prototype.getPreferredBounds=function(t){var e=this.getPreferredUWidth(),i=this.getPreferredUHeight();
this.applyMatrix(t,e,i)},n.prototype.applyMatrix=function(t,e,r){t.setTo(0,0,e,r);var n=this.getAnchorMatrix();i(n)?(t.x+=n.tx,t.y+=n.ty):n.$transformBounds(t)},n.prototype.getAnchorMatrix=function(){var t=this.$getMatrix(),e=this.anchorOffsetX,i=this.anchorOffsetY;if(0!=e||0!=i){var r=egret.$TempMatrix;return t.$preMultiplyInto(r.setTo(1,0,0,1,-e,-i),r),r}return t},n}(egret.DisplayObject);e.UIComponentImpl=l,__reflect(l.prototype,"eui.sys.UIComponentImpl",["eui.UIComponent","egret.DisplayObject"]),e.mixin=n,e.implementUIComponent=a}(e=t.sys||(t.sys={}))}(eui||(eui={}));var eui;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.$layout=null,i.$stateValues=new t.sys.StateValues,i.initializeUIValues(),i.$Group={0:0,1:0,2:0,3:0,4:!1,5:!1},i.$stateValues.parent=i,i}return __extends(i,e),Object.defineProperty(i.prototype,"elementsContent",{set:function(t){if(t)for(var e=t.length,i=0;e>i;i++)this.addChild(t[i])},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"layout",{get:function(){return this.$layout},set:function(t){this.$setLayout(t)},enumerable:!0,configurable:!0}),i.prototype.$setLayout=function(t){return this.$layout==t?!1:(this.$layout&&(this.$layout.target=null),this.$layout=t,t&&(t.target=this),this.invalidateSize(),this.invalidateDisplayList(),!0)},Object.defineProperty(i.prototype,"contentWidth",{get:function(){return this.$Group[0]},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"contentHeight",{get:function(){return this.$Group[1]},enumerable:!0,configurable:!0}),i.prototype.setContentSize=function(e,i){e=Math.ceil(+e||0),i=Math.ceil(+i||0);var r=this.$Group,n=r[0]!==e,a=r[1]!==i;(n||a)&&(r[0]=e,r[1]=i,n&&t.PropertyEvent.dispatchPropertyEvent(this,t.PropertyEvent.PROPERTY_CHANGE,"contentWidth"),a&&t.PropertyEvent.dispatchPropertyEvent(this,t.PropertyEvent.PROPERTY_CHANGE,"contentHeight"))},Object.defineProperty(i.prototype,"scrollEnabled",{get:function(){return this.$Group[4]},set:function(t){t=!!t;var e=this.$Group;t!==e[4]&&(e[4]=t,this.updateScrollRect())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"scrollH",{get:function(){return this.$Group[2]},set:function(e){e=+e||0;var i=this.$Group;e!==i[2]&&(i[2]=e,this.updateScrollRect()&&this.$layout&&this.$layout.scrollPositionChanged(),t.PropertyEvent.dispatchPropertyEvent(this,t.PropertyEvent.PROPERTY_CHANGE,"scrollH"))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"scrollV",{get:function(){return this.$Group[3]},set:function(e){e=+e||0;var i=this.$Group;e!=i[3]&&(i[3]=e,this.updateScrollRect()&&this.$layout&&this.$layout.scrollPositionChanged(),t.PropertyEvent.dispatchPropertyEvent(this,t.PropertyEvent.PROPERTY_CHANGE,"scrollV"))},enumerable:!0,configurable:!0}),i.prototype.updateScrollRect=function(){var t=this.$Group,e=t[4];if(e){var i=this.$UIComponent;this.scrollRect=egret.$TempRectangle.setTo(t[2],t[3],i[10],i[11])}else this.$scrollRect&&(this.scrollRect=null);return e},Object.defineProperty(i.prototype,"numElements",{get:function(){return this.$children.length},enumerable:!0,configurable:!0}),i.prototype.getElementAt=function(t){return this.$children[t]},i.prototype.getVirtualElementAt=function(t){return this.getElementAt(t)},i.prototype.setVirtualElementIndicesInView=function(t,e){},Object.defineProperty(i.prototype,"touchThrough",{get:function(){return this.$Group[5]},set:function(t){this.$Group[5]=!!t},enumerable:!0,configurable:!0}),i.prototype.$hitTest=function(t,i){var r=e.prototype.$hitTest.call(this,t,i);if(r||this.$Group[5])return r;if(!this.$visible||!this.touchEnabled||0===this.scaleX||0===this.scaleY||0===this.width||0===this.height)return null;var n=this.globalToLocal(t,i,egret.$TempPoint),a=this.$UIComponent,o=egret.$TempRectangle.setTo(0,0,a[10],a[11]),s=this.$scrollRect;return s&&(o.x=s.x,o.y=s.y),o.contains(n.x,n.y)?this:null},i.prototype.invalidateState=function(){var t=this.$stateValues;t.stateIsDirty||(t.stateIsDirty=!0,this.invalidateProperties())},i.prototype.getCurrentState=function(){return""},i.prototype.createChildren=function(){this.$layout||this.$setLayout(new t.BasicLayout),this.initializeStates(this.$stage)},i.prototype.childrenCreated=function(){},i.prototype.commitProperties=function(){t.sys.UIComponentImpl.prototype.commitProperties.call(this);var e=this.$stateValues;e.stateIsDirty&&(e.stateIsDirty=!1,e.explicitState||(e.currentState=this.getCurrentState(),this.commitCurrentState()))},i.prototype.measure=function(){return this.$layout?void this.$layout.measure():void this.setMeasuredSize(0,0)},i.prototype.updateDisplayList=function(t,e){this.$layout&&this.$layout.updateDisplayList(t,e),this.updateScrollRect()},i.prototype.invalidateParentLayout=function(){},i.prototype.setMeasuredSize=function(t,e){},i.prototype.invalidateProperties=function(){},i.prototype.validateProperties=function(){},i.prototype.invalidateSize=function(){},i.prototype.validateSize=function(t){},i.prototype.invalidateDisplayList=function(){},i.prototype.validateDisplayList=function(){},i.prototype.validateNow=function(){},i.prototype.setLayoutBoundsSize=function(t,e){},i.prototype.setLayoutBoundsPosition=function(t,e){},i.prototype.getLayoutBounds=function(t){},i.prototype.getPreferredBounds=function(t){},i}(egret.DisplayObjectContainer);t.Group=e,__reflect(e.prototype,"eui.Group",["eui.IViewport","eui.UIComponent","egret.DisplayObject"]),t.sys.implementUIComponent(e,egret.DisplayObjectContainer,!0),t.sys.mixin(e,t.sys.StateClient),t.registerProperty(e,"elementsContent","Array",!0),t.registerProperty(e,"states","State[]")}(eui||(eui={}));var eui;!function(t){function e(t,e){if(t.hasOwnProperty(i))t[i].push(e);else{var r=[e];t[i]&&(r=t[i].concat(r)),t[i]=r}}var i="__bindables__";t.registerBindable=e}(eui||(eui={}));var eui;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.initializeUIValues(),t.$Component={0:null,1:null,2:"",3:!0,4:!1,5:!1,6:!0,7:!0,8:null},t.$touchEnabled=!0,t}return __extends(i,e),Object.defineProperty(i.prototype,"hostComponentKey",{get:function(){return this.$Component[0]},set:function(t){this.$Component[0]=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"skinName",{get:function(){return this.$Component[1]},set:function(t){var e=this.$Component;if(e[5]=!0,e[1]!=t){if(t)e[1]=t;else{var i=egret.getImplementation("eui.Theme");if(i){var r=i.getSkinName(this);r&&(e[1]=r)}}this.$parseSkinName()}},enumerable:!0,configurable:!0}),i.prototype.$parseSkinName=function(){var t,e=this.skinName;if(e)if(e.prototype)t=new e;else if("string"==typeof e){var i=void 0,r=e.trim();if("<"==r.charAt(0))i=EXML.parse(r);else if(i=egret.getDefinitionByName(e),!i&&-1!=r.toLowerCase().indexOf(".exml"))return void EXML.load(e,this.onExmlLoaded,this,!0);i&&(t=new i)}else t=e;this.setSkin(t)},i.prototype.onExmlLoaded=function(t,e){if(this.skinName==e){var i=new t;this.setSkin(i)}},Object.defineProperty(i.prototype,"skin",{get:function(){return this.$Component[8]},enumerable:!0,configurable:!0}),i.prototype.setSkin=function(e){!e||e instanceof t.Skin||(e=null);var i=this.$Component,r=i[8];if(r){for(var n=r.skinParts,a=n.length,o=0;a>o;o++){var s=n[o];this[s]&&this.setSkinPart(s,null)}var l=r.$elementsContent;if(l){a=l.length;for(var o=0;a>o;o++){var h=l[o];h.$parent==this&&this.removeChild(h)}}r.hostComponent=null}if(i[8]=e,e){for(var n=e.skinParts,c=n.length,o=0;c>o;o++){var s=n[o],u=e[s];u&&this.setSkinPart(s,u)}var l=e.$elementsContent;if(l)for(var o=l.length-1;o>=0;o--)this.addChildAt(l[o],0);e.hostComponent=this}this.invalidateSize(),this.invalidateDisplayList(),this.dispatchEventWith(egret.Event.COMPLETE)},i.prototype.setSkinPart=function(t,e){var i=this[t];i&&this.partRemoved(t,i),this[t]=e,e&&this.partAdded(t,e)},i.prototype.partAdded=function(t,e){},i.prototype.partRemoved=function(t,e){},i.prototype.$setTouchChildren=function(t){t=!!t;var i=this.$Component;return i[6]=t,i[3]?(i[6]=t,e.prototype.$setTouchChildren.call(this,t)):!0},i.prototype.$setTouchEnabled=function(t){t=!!t;var i=this.$Component;i[7]=t,i[3]&&e.prototype.$setTouchEnabled.call(this,t)},Object.defineProperty(i.prototype,"enabled",{get:function(){return this.$Component[3]},set:function(t){t=!!t,this.$setEnabled(t)},enumerable:!0,configurable:!0}),i.prototype.$setEnabled=function(t){var e=this.$Component;return t===e[3]?!1:(e[3]=t,t?(this.$touchEnabled=e[7],this.$touchChildren=e[6]):(this.$touchEnabled=!1,this.$touchChildren=!1),this.invalidateState(),!0)},Object.defineProperty(i.prototype,"currentState",{get:function(){var t=this.$Component;return t[2]?t[2]:this.getCurrentState()},set:function(t){var e=this.$Component;t!=e[2]&&(e[2]=t,this.invalidateState())},enumerable:!0,configurable:!0}),i.prototype.invalidateState=function(){var t=this.$Component;t[4]||(t[4]=!0,this.invalidateProperties())},i.prototype.getCurrentState=function(){return""},i.prototype.createChildren=function(){var t=this.$Component;if(!t[1]){var e=egret.getImplementation("eui.Theme");if(e){var i=e.getSkinName(this);i&&(t[1]=i,this.$parseSkinName())}}},i.prototype.childrenCreated=function(){},i.prototype.commitProperties=function(){t.sys.UIComponentImpl.prototype.commitProperties.call(this);var e=this.$Component;e[4]&&(e[4]=!1,e[8]&&(e[8].currentState=this.currentState))},i.prototype.measure=function(){t.sys.measure(this);var e=this.$Component[8];if(e){var i=this.$UIComponent;isNaN(e.width)?(i[16]<e.minWidth&&(i[16]=e.minWidth),i[16]>e.maxWidth&&(i[16]=e.maxWidth)):i[16]=e.width,isNaN(e.height)?(i[17]<e.minHeight&&(i[17]=e.minHeight),i[17]>e.maxHeight&&(i[17]=e.maxHeight)):i[17]=e.height}},i.prototype.updateDisplayList=function(e,i){t.sys.updateDisplayList(this,e,i)},i.prototype.invalidateParentLayout=function(){},i.prototype.setMeasuredSize=function(t,e){},i.prototype.invalidateProperties=function(){},i.prototype.validateProperties=function(){},i.prototype.invalidateSize=function(){},i.prototype.validateSize=function(t){},i.prototype.invalidateDisplayList=function(){},i.prototype.validateDisplayList=function(){},i.prototype.validateNow=function(){},i.prototype.setLayoutBoundsSize=function(t,e){},i.prototype.setLayoutBoundsPosition=function(t,e){},i.prototype.getLayoutBounds=function(t){},i.prototype.getPreferredBounds=function(t){},i}(egret.DisplayObjectContainer);t.Component=e,__reflect(e.prototype,"eui.Component",["eui.UIComponent","egret.DisplayObject"]),t.registerProperty(e,"skinName","Class"),t.sys.implementUIComponent(e,egret.DisplayObjectContainer,!0)}(eui||(eui={}));var eui;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.$dataProviderChanged=!1,t.$dataProvider=null,t.$indexToRenderer=[],t.$DataGroup={0:!0,1:!1,2:{},3:{},4:!1,5:!1,6:null,7:null,8:!1,9:null,10:!1,11:!1,12:null,13:null,14:!1},t}return __extends(i,e),Object.defineProperty(i.prototype,"useVirtualLayout",{get:function(){return this.$layout?this.$layout.$useVirtualLayout:this.$DataGroup[0]},set:function(t){t=!!t;var e=this.$DataGroup;t!==e[0]&&(e[0]=t,this.$layout&&(this.$layout.useVirtualLayout=t))},enumerable:!0,configurable:!0}),i.prototype.$setLayout=function(t){if(t==this.$layout)return!1;this.$layout&&(this.$layout.setTypicalSize(0,0),this.$layout.removeEventListener("useVirtualLayoutChanged",this.onUseVirtualLayoutChanged,this)),this.$layout&&t&&this.$layout.$useVirtualLayout!=t.$useVirtualLayout&&this.onUseVirtualLayoutChanged();var i=e.prototype.$setLayout.call(this,t);if(t){var r=this.$DataGroup[9];r&&t.setTypicalSize(r.width,r.height),t.useVirtualLayout=this.$DataGroup[0],t.addEventListener("useVirtualLayoutChanged",this.onUseVirtualLayoutChanged,this)}return i},i.prototype.onUseVirtualLayoutChanged=function(t){var e=this.$DataGroup;e[1]=!0,e[10]=!0,this.removeDataProviderListener(),this.invalidateProperties()},i.prototype.setVirtualElementIndicesInView=function(t,e){if(this.$layout&&this.$layout.$useVirtualLayout)for(var i=this.$indexToRenderer,r=Object.keys(i),n=r.length,a=0;n>a;a++){var o=+r[a];(t>o||o>e)&&this.freeRendererByIndex(o)}},i.prototype.getElementAt=function(t){return this.$indexToRenderer[t]},i.prototype.getVirtualElementAt=function(t){if(t=0|+t,0>t||t>=this.$dataProvider.length)return null;var e=this.$indexToRenderer[t];if(!e){var i=this.$dataProvider.getItemAt(t);e=this.createVirtualRenderer(i),this.$indexToRenderer[t]=e,this.updateRenderer(e,t,i);var r=this.$DataGroup;r[4]&&(e.validateNow(),r[4]=!1,this.rendererAdded(e,t,i))}return e},i.prototype.freeRendererByIndex=function(t){var e=this.$indexToRenderer[t];e&&(delete this.$indexToRenderer[t],this.doFreeRenderer(e))},i.prototype.doFreeRenderer=function(t){var e=this.$DataGroup,i=e[2][t.$hashCode],r=i.$hashCode;e[3][r]||(e[3][r]=[]),e[3][r].push(t),t.visible=!1},i.prototype.invalidateSize=function(){this.$DataGroup[4]||e.prototype.invalidateSize.call(this)},i.prototype.createVirtualRenderer=function(t){var e,i=this.itemToRendererClass(t),r=i.$hashCode,n=this.$DataGroup,a=n[3];return a[r]&&a[r].length>0?(e=a[r].pop(),e.visible=!0,this.invalidateDisplayList(),e):(n[4]=!0,this.createOneRenderer(i))},i.prototype.createOneRenderer=function(t){var e=new t,i=this.$DataGroup;return i[2][e.$hashCode]=t,egret.is(e,"eui.IItemRenderer")?(i[13]&&this.setItemRenderSkinName(e,i[13]),this.addChild(e),e):null},i.prototype.setItemRenderSkinName=function(e,i){if(e&&e instanceof t.Component){var r=e;r.$Component[5]||(r.skinName=i,r.$Component[5]=!1)}},Object.defineProperty(i.prototype,"dataProvider",{get:function(){return this.$dataProvider},set:function(t){this.$setDataProvider(t)},enumerable:!0,configurable:!0}),i.prototype.$setDataProvider=function(t){return this.$dataProvider==t||t&&!t.getItemAt?!1:(this.removeDataProviderListener(),this.$dataProvider=t,this.$dataProviderChanged=!0,this.$DataGroup[10]=!0,this.invalidateProperties(),this.invalidateSize(),this.invalidateDisplayList(),!0)},i.prototype.removeDataProviderListener=function(){this.$dataProvider&&this.$dataProvider.removeEventListener(t.CollectionEvent.COLLECTION_CHANGE,this.onCollectionChange,this)},i.prototype.onCollectionChange=function(e){switch(e.kind){case t.CollectionEventKind.ADD:this.itemAddedHandler(e.items,e.location);break;case t.CollectionEventKind.REMOVE:this.itemRemovedHandler(e.items,e.location);break;case t.CollectionEventKind.UPDATE:case t.CollectionEventKind.REPLACE:this.itemUpdatedHandler(e.items[0],e.location);break;case t.CollectionEventKind.RESET:case t.CollectionEventKind.REFRESH:if(this.$layout&&this.$layout.$useVirtualLayout)for(var i=this.$indexToRenderer,r=Object.keys(i),n=r.length,a=n-1;a>=0;a--){var o=+r[a];this.freeRendererByIndex(o)}this.$dataProviderChanged=!0,this.invalidateProperties();break;default:egret.$warn(2204,e.kind)}this.invalidateSize(),this.invalidateDisplayList()},i.prototype.itemAddedHandler=function(t,e){for(var i=t.length,r=0;i>r;r++)this.itemAdded(t[r],e+r);this.resetRenderersIndices()},i.prototype.itemRemovedHandler=function(t,e){for(var i=t.length,r=i-1;r>=0;r--)this.itemRemoved(t[r],e+r);this.resetRenderersIndices()},i.prototype.itemAdded=function(t,e){if(this.$layout&&this.$layout.elementAdded(e),this.$layout&&this.$layout.$useVirtualLayout)return void this.$indexToRenderer.splice(e,0,null);var i=this.createVirtualRenderer(t);if(this.$indexToRenderer.splice(e,0,i),i){this.updateRenderer(i,e,t);var r=this.$DataGroup;r[4]&&(r[4]=!1,this.rendererAdded(i,e,t))}},i.prototype.itemRemoved=function(t,e){this.$layout&&this.$layout.elementRemoved(e);var i=this.$indexToRenderer[e];this.$indexToRenderer.length>e&&this.$indexToRenderer.splice(e,1),i&&(this.$layout&&this.$layout.$useVirtualLayout?this.doFreeRenderer(i):(this.rendererRemoved(i,e,t),this.removeChild(i)))},i.prototype.resetRenderersIndices=function(){var t=this.$indexToRenderer;if(0!=t.length)if(this.$layout&&this.$layout.$useVirtualLayout)for(var e=Object.keys(t),i=e.length,r=0;i>r;r++){var n=+e[r];this.resetRendererItemIndex(n)}else for(var a=t.length,n=0;a>n;n++)this.resetRendererItemIndex(n)},i.prototype.itemUpdatedHandler=function(t,e){if(!this.$DataGroup[11]){var i=this.$indexToRenderer[e];i&&this.updateRenderer(i,e,t)}},i.prototype.resetRendererItemIndex=function(t){var e=this.$indexToRenderer[t];e&&(e.itemIndex=t)},Object.defineProperty(i.prototype,"itemRenderer",{get:function(){return this.$DataGroup[6]},set:function(t){var e=this.$DataGroup;e[6]!=t&&(e[6]=t,e[5]=!0,e[8]=!0,e[10]=!0,this.removeDataProviderListener(),this.invalidateProperties())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"itemRendererSkinName",{get:function(){return this.$DataGroup[13]},set:function(t){var e=this.$DataGroup;e[13]!=t&&(e[13]=t,this.$UIComponent[29]&&(e[14]=!0,this.invalidateProperties()))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"itemRendererFunction",{get:function(){return this.$DataGroup[7]},set:function(t){var e=this.$DataGroup;e[7]!=t&&(e[7]=t,e[5]=!0,e[8]=!0,this.removeDataProviderListener(),this.invalidateProperties())},enumerable:!0,configurable:!0}),i.prototype.itemToRendererClass=function(e){var i,r=this.$DataGroup;return r[7]&&(i=r[7](e)),i||(i=r[6]),i||(i=t.ItemRenderer),i.$hashCode||(i.$hashCode=egret.$hashCount++),i},i.prototype.createChildren=function(){if(!this.$layout){var i=new t.VerticalLayout;i.gap=0,i.horizontalAlign=t.JustifyAlign.CONTENT_JUSTIFY,this.$setLayout(i)}e.prototype.createChildren.call(this)},i.prototype.commitProperties=function(){var i=this.$DataGroup;if((i[5]||this.$dataProviderChanged||i[1])&&(this.removeAllRenderers(),this.$layout&&this.$layout.clearVirtualLayoutCache(),this.setTypicalLayoutRect(null),i[1]=!1,i[5]=!1,this.$dataProvider&&this.$dataProvider.addEventListener(t.CollectionEvent.COLLECTION_CHANGE,this.onCollectionChange,this),this.$layout&&this.$layout.$useVirtualLayout?(this.invalidateSize(),this.invalidateDisplayList()):this.createRenderers(),this.$dataProviderChanged&&(this.$dataProviderChanged=!1,this.scrollV=this.scrollH=0)),e.prototype.commitProperties.call(this),i[8]&&(i[8]=!1,this.$dataProvider&&this.$dataProvider.length>0&&(i[12]=this.$dataProvider.getItemAt(0),this.measureRendererSize())),i[14]){i[14]=!1;for(var r=i[13],n=this.$indexToRenderer,a=Object.keys(n),o=a.length,s=0;o>s;s++){var l=a[s];this.setItemRenderSkinName(n[l],r)}var h=i[3];a=Object.keys(h),o=a.length;for(var s=0;o>s;s++)for(var c=a[s],u=h[c],p=u.length,d=0;p>d;d++)this.setItemRenderSkinName(u[d],r)}},i.prototype.measure=function(){this.$layout&&this.$layout.$useVirtualLayout&&this.ensureTypicalLayoutElement(),e.prototype.measure.call(this)},i.prototype.updateDisplayList=function(t,i){var r=this.$layout&&this.$layout.$useVirtualLayout;r&&this.ensureTypicalLayoutElement(),e.prototype.updateDisplayList.call(this,t,i);var n=this.$DataGroup;if(r){var a=n[9];if(a){var o=this.$indexToRenderer[0];if(o){var s=egret.$TempRectangle;o.getPreferredBounds(s),(s.width!=a.width||s.height!=a.height)&&(n[9]=null)}}}},i.prototype.ensureTypicalLayoutElement=function(){this.$DataGroup[9]||this.$dataProvider&&this.$dataProvider.length>0&&(this.$DataGroup[12]=this.$dataProvider.getItemAt(0),this.measureRendererSize())},i.prototype.measureRendererSize=function(){var t=this.$DataGroup;if(void 0==t[12])return void this.setTypicalLayoutRect(null);var e=this.createVirtualRenderer(t[12]);if(!e)return void this.setTypicalLayoutRect(null);this.updateRenderer(e,0,t[12]),e.validateNow();var i=egret.$TempRectangle;e.getPreferredBounds(i);var r=new egret.Rectangle(0,0,i.width,i.height);this.$layout&&this.$layout.$useVirtualLayout?(t[4]&&this.rendererAdded(e,0,t[12]),this.doFreeRenderer(e)):this.removeChild(e),this.setTypicalLayoutRect(r),t[4]=!1},i.prototype.setTypicalLayoutRect=function(t){this.$DataGroup[9]=t,this.$layout&&(t?this.$layout.setTypicalSize(t.width,t.height):this.$layout.setTypicalSize(0,0))},i.prototype.removeAllRenderers=function(){for(var t=this.$indexToRenderer,e=Object.keys(t),i=e.length,r=0;i>r;r++){var n=e[r],a=t[n];a&&(this.rendererRemoved(a,a.itemIndex,a.data),this.removeChild(a))}this.$indexToRenderer=[];var o=this.$DataGroup;if(o[10]){for(var s=o[3],l=Object.keys(s),h=l.length,r=0;h>r;r++)for(var c=l[r],u=s[c],p=u.length,d=0;p>d;d++){var a=u[d];this.rendererRemoved(a,a.itemIndex,a.data),this.removeChild(a)}o[3]={},o[2]={},o[10]=!1}},i.prototype.createRenderers=function(){if(this.$dataProvider)for(var t=0,e=this.$dataProvider.length,i=0;e>i;i++){var r=this.$dataProvider.getItemAt(i),n=this.itemToRendererClass(r),a=this.createOneRenderer(n);a&&(this.$indexToRenderer[t]=a,this.updateRenderer(a,t,r),this.rendererAdded(a,t,r),t++)}},i.prototype.updateRenderer=function(t,e,i){var r=this.$DataGroup;return r[11]=!0,t.itemIndex=e,t.parent==this&&this.setChildIndex(t,e),t.data=i,r[11]=!1,t},Object.defineProperty(i.prototype,"numElements",{get:function(){return this.$dataProvider?this.$dataProvider.length:0},enumerable:!0,configurable:!0}),i.prototype.rendererAdded=function(t,e,i){},i.prototype.rendererRemoved=function(t,e,i){},i}(t.Group);t.DataGroup=e,__reflect(e.prototype,"eui.DataGroup"),t.registerProperty(e,"itemRenderer","Class"),t.registerProperty(e,"itemRendererSkinName","Class"),t.registerProperty(e,"dataProvider","eui.ICollection",!0)}(eui||(eui={}));var eui;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.labelDisplay=null,e._label="",e.iconDisplay=null,e._icon=null,e.touchCaptured=!1,e.touchChildren=!1,e.addEventListener(egret.TouchEvent.TOUCH_BEGIN,e.onTouchBegin,e),e}return __extends(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return this._label},set:function(t){this._label=t,this.labelDisplay&&(this.labelDisplay.text=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"icon",{get:function(){return this._icon},set:function(t){this._icon=t,this.iconDisplay&&(this.iconDisplay.source=t)},enumerable:!0,configurable:!0}),e.prototype.onTouchCancle=function(t){var e=t.$currentTarget;e.removeEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onTouchCancle,this),e.removeEventListener(egret.TouchEvent.TOUCH_END,this.onStageTouchEnd,this),this.touchCaptured=!1,this.invalidateState()},e.prototype.onTouchBegin=function(t){this.$stage.addEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onTouchCancle,this),this.$stage.addEventListener(egret.TouchEvent.TOUCH_END,this.onStageTouchEnd,this),this.touchCaptured=!0,this.invalidateState(),t.updateAfterEvent()},e.prototype.onStageTouchEnd=function(t){var e=t.$currentTarget;e.removeEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onTouchCancle,this),e.removeEventListener(egret.TouchEvent.TOUCH_END,this.onStageTouchEnd,this),this.contains(t.target)&&this.buttonReleased(),this.touchCaptured=!1,this.invalidateState()},e.prototype.getCurrentState=function(){return this.enabled?this.touchCaptured?"down":"up":"disabled"},e.prototype.partAdded=function(t,e){e===this.labelDisplay?this.labelDisplay.text=this._label:e==this.iconDisplay&&(this.iconDisplay.source=this._icon)},e.prototype.buttonReleased=function(){},e}(t.Component);t.Button=e,__reflect(e.prototype,"eui.Button")}(eui||(eui={}));var eui;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.$Range={0:100,1:!1,2:0,3:!1,4:0,5:0,6:!1,7:1,8:!1,9:!1},t}return __extends(i,e),Object.defineProperty(i.prototype,"maximum",{get:function(){return this.$Range[0]},set:function(t){t=+t||0;var e=this.$Range;t!==e[0]&&(e[0]=t,e[1]=!0,this.invalidateProperties(),this.invalidateDisplayList())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"minimum",{get:function(){return this.$Range[2]},set:function(t){t=+t||0;var e=this.$Range;t!==e[2]&&(e[2]=t,e[3]=!0,this.invalidateProperties(),this.invalidateDisplayList())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"value",{get:function(){var t=this.$Range;return t[6]?t[5]:t[4]},set:function(t){t=+t||0,this.$setValue(t)},enumerable:!0,configurable:!0}),i.prototype.$setValue=function(t){if(t===this.value)return!1;var e=this.$Range;return e[5]=t,e[6]=!0,this.invalidateProperties(),!0},Object.defineProperty(i.prototype,"snapInterval",{get:function(){return this.$Range[7]},set:function(t){var e=this.$Range;e[9]=!0,t=+t||0,t!==e[7]&&(isNaN(t)?(e[7]=1,e[9]=!1):e[7]=t,e[8]=!0,this.invalidateProperties())},enumerable:!0,configurable:!0}),i.prototype.commitProperties=function(){e.prototype.commitProperties.call(this);var t=this.$Range;if(t[2]>t[0]&&(t[1]?t[0]=t[2]:t[2]=t[0]),t[6]||t[1]||t[3]||t[8]){var i=t[6]?t[5]:t[4];t[6]=!1,t[1]=!1,t[3]=!1,t[8]=!1,this.setValue(this.nearestValidValue(i,t[7]))}},i.prototype.nearestValidSize=function(t){var e=this.snapInterval;if(0==e)return t;var i=Math.round(t/e)*e;return Math.abs(i)<e?e:i},i.prototype.nearestValidValue=function(t,e){var i=this.$Range;if(0==e)return Math.max(i[2],Math.min(i[0],t));var r=i[0]-i[2],n=1;if(t-=i[2],e!=Math.round(e)){var a=(1+e).toString().split(".");n=Math.pow(10,a[1].length),r*=n,t=Math.round(t*n),e=Math.round(e*n)}var o=Math.max(0,Math.floor(t/e)*e),s=Math.min(r,Math.floor((t+e)/e)*e),l=t-o>=(s-o)/2?s:o;return l/n+i[2]},i.prototype.setValue=function(e){var i=this.$Range;i[4]!==e&&(i[0]>i[2]?i[4]=Math.min(i[0],Math.max(i[2],e)):i[4]=e,i[6]=!1,this.invalidateDisplayList(),t.PropertyEvent.dispatchPropertyEvent(this,t.PropertyEvent.PROPERTY_CHANGE,"value"))},i.prototype.updateDisplayList=function(t,i){e.prototype.updateDisplayList.call(this,t,i),this.updateSkinDisplayList()},i.prototype.updateSkinDisplayList=function(){},i}(t.Component);t.Range=e,__reflect(e.prototype,"eui.Range"),t.registerBindable(e.prototype,"value")}(eui||(eui={}));var eui;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.$target=null,e.$useVirtualLayout=!1,e.$typicalWidth=71,e.$typicalHeight=22,e}return __extends(e,t),Object.defineProperty(e.prototype,"target",{get:function(){return this.$target},set:function(t){this.$target!==t&&(this.$target=t,this.clearVirtualLayoutCache())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"useVirtualLayout",{get:function(){return this.$useVirtualLayout},set:function(t){t=!!t,this.$useVirtualLayout!=t&&(this.$useVirtualLayout=t,this.dispatchEventWith("useVirtualLayoutChanged"),this.$useVirtualLayout&&!t&&this.clearVirtualLayoutCache(),this.target&&this.target.invalidateDisplayList())},enumerable:!0,configurable:!0}),e.prototype.setTypicalSize=function(t,e){t=+t||71,e=+e||22,(t!==this.$typicalWidth||e!==this.$typicalHeight)&&(this.$typicalWidth=t,this.$typicalHeight=e,this.$target&&this.$target.invalidateSize())},e.prototype.scrollPositionChanged=function(){},e.prototype.clearVirtualLayoutCache=function(){},e.prototype.elementAdded=function(t){},e.prototype.elementRemoved=function(t){},e.prototype.getElementIndicesInView=function(){return null},e.prototype.measure=function(){},e.prototype.updateDisplayList=function(t,e){},e}(egret.EventDispatcher);t.LayoutBase=e,__reflect(e.prototype,"eui.LayoutBase")}(eui||(eui={}));var eui;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.$ListBase={0:!1,1:!1,2:-2,3:-1,4:!1,5:void 0,6:!1,7:null,8:!1},t}return __extends(i,e),Object.defineProperty(i.prototype,"requireSelection",{get:function(){return this.$ListBase[0]},set:function(t){t=!!t;var e=this.$ListBase;t!==e[0]&&(e[0]=t,t&&(e[1]=!0,this.invalidateProperties()))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"selectedIndex",{get:function(){return this.$getSelectedIndex()},set:function(t){t=0|+t,this.setSelectedIndex(t,!1)},enumerable:!0,configurable:!0}),i.prototype.$getSelectedIndex=function(){var t=this.$ListBase;return t[2]!=i.NO_PROPOSED_SELECTION?t[2]:t[3]},i.prototype.setSelectedIndex=function(t,e){if(t!=this.selectedIndex){var i=this.$ListBase;e&&(i[4]=i[4]||e),i[2]=t,this.invalidateProperties()}},Object.defineProperty(i.prototype,"selectedItem",{get:function(){var t=this.$ListBase;if(void 0!==t[5])return t[5];var e=this.$getSelectedIndex();return e!=i.NO_SELECTION&&null!=this.$dataProvider&&this.$dataProvider.length>e?this.$dataProvider.getItemAt(e):void 0},set:function(t){this.setSelectedItem(t,!1)},enumerable:!0,configurable:!0}),i.prototype.setSelectedItem=function(t,e){if(void 0===e&&(e=!1),this.selectedItem!==t){var i=this.$ListBase;e&&(i[4]=i[4]||e),i[5]=t,this.invalidateProperties()}},i.prototype.commitProperties=function(){var r=this.$dataProviderChanged;e.prototype.commitProperties.call(this);var n=this.$ListBase,a=this.$getSelectedIndex(),o=this.$dataProvider;r&&(a>=0&&o&&a<o.length?this.itemSelected(a,!0):this.requireSelection?n[2]=0:this.setSelectedIndex(-1,!1)),n[1]&&(n[1]=!1,n[0]&&a==i.NO_SELECTION&&o&&o.length>0&&(n[2]=0)),void 0!==n[5]&&(o?n[2]=o.getItemIndex(n[5]):n[2]=i.NO_SELECTION,n[5]=void 0);var s=!1;n[2]!=i.NO_PROPOSED_SELECTION&&(s=this.commitSelection()),n[6]&&(n[6]=!1,s||t.PropertyEvent.dispatchPropertyEvent(this,t.PropertyEvent.PROPERTY_CHANGE,"selectedIndex"))},i.prototype.updateRenderer=function(t,i,r){return this.itemSelected(i,this.$isItemIndexSelected(i)),e.prototype.updateRenderer.call(this,t,i,r)},i.prototype.itemSelected=function(t,e){var i=this.$indexToRenderer[t];i&&(i.selected=e)},i.prototype.$isItemIndexSelected=function(t){return t==this.selectedIndex},i.prototype.commitSelection=function(e){void 0===e&&(e=!0);var r=this.$dataProvider,n=this.$ListBase,a=r?r.length-1:-1,o=n[3],s=n[2];if(s<i.NO_SELECTION&&(s=i.NO_SELECTION),s>a&&(s=a),n[0]&&s==i.NO_SELECTION&&r&&r.length>0)return n[2]=i.NO_PROPOSED_SELECTION,n[4]=!1,!1;if(n[4]){var l=this.dispatchEventWith(egret.Event.CHANGING,!1,!0,!0);if(!l)return this.itemSelected(n[2],!1),n[2]=i.NO_PROPOSED_SELECTION,n[4]=!1,!1}return n[3]=s,n[2]=i.NO_PROPOSED_SELECTION,o!=i.NO_SELECTION&&this.itemSelected(o,!1),n[3]!=i.NO_SELECTION&&this.itemSelected(n[3],!0),e&&(n[4]&&(this.dispatchEventWith(egret.Event.CHANGE),n[4]=!1),t.PropertyEvent.dispatchPropertyEvent(this,t.PropertyEvent.PROPERTY_CHANGE,"selectedIndex"),t.PropertyEvent.dispatchPropertyEvent(this,t.PropertyEvent.PROPERTY_CHANGE,"selectedItem")),!0},i.prototype.adjustSelection=function(t,e){void 0===e&&(e=!1);var r=this.$ListBase;r[2]!=i.NO_PROPOSED_SELECTION?r[2]=t:r[3]=t,r[6]=!0,this.invalidateProperties()},i.prototype.itemAdded=function(t,r){e.prototype.itemAdded.call(this,t,r);var n=this.$getSelectedIndex();n==i.NO_SELECTION?this.$ListBase[0]&&this.adjustSelection(r,!0):n>=r&&this.adjustSelection(n+1,!0)},i.prototype.itemRemoved=function(t,r){if(e.prototype.itemRemoved.call(this,t,r),this.selectedIndex!=i.NO_SELECTION){var n=this.$getSelectedIndex();r==n?this.requireSelection&&this.$dataProvider&&this.$dataProvider.length>0?0==r?(this.$ListBase[2]=0,this.invalidateProperties()):this.setSelectedIndex(0,!1):this.adjustSelection(-1,!1):n>r&&this.adjustSelection(n-1,!1)}},i.prototype.onCollectionChange=function(r){e.prototype.onCollectionChange.call(this,r),r.kind==t.CollectionEventKind.RESET?0==this.$dataProvider.length&&this.setSelectedIndex(i.NO_SELECTION,!1):r.kind==t.CollectionEventKind.REFRESH&&this.dataProviderRefreshed()},i.prototype.dataProviderRefreshed=function(){this.setSelectedIndex(i.NO_SELECTION,!1)},i.prototype.rendererAdded=function(t,e,i){t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onRendererTouchBegin,this),t.addEventListener(egret.TouchEvent.TOUCH_END,this.onRendererTouchEnd,this),t.addEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onRendererTouchCancle,this)},i.prototype.rendererRemoved=function(t,e,i){t.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onRendererTouchBegin,this),t.removeEventListener(egret.TouchEvent.TOUCH_END,this.onRendererTouchEnd,this),t.removeEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onRendererTouchCancle,this)},i.prototype.onRendererTouchBegin=function(t){if(this.$stage){var e=this.$ListBase;t.$isDefaultPrevented||(e[8]=!1,e[7]=t.$currentTarget,this.$stage.addEventListener(egret.TouchEvent.TOUCH_END,this.stage_touchEndHandler,this))}},i.prototype.onRendererTouchCancle=function(t){var e=this.$ListBase;e[7]=null,e[8]=!0,this.$stage&&this.$stage.removeEventListener(egret.TouchEvent.TOUCH_END,this.stage_touchEndHandler,this)
},i.prototype.onRendererTouchEnd=function(e){var i=this.$ListBase,r=e.$currentTarget,n=i[7];r==n&&(i[8]||(this.setSelectedIndex(r.itemIndex,!0),t.ItemTapEvent.dispatchItemTapEvent(this,t.ItemTapEvent.ITEM_TAP,r)),i[8]=!1)},i.prototype.stage_touchEndHandler=function(t){var e=t.$currentTarget;e.removeEventListener(egret.TouchEvent.TOUCH_END,this.stage_touchEndHandler,this),this.$ListBase[7]=null},i.NO_SELECTION=-1,i.NO_PROPOSED_SELECTION=-2,i}(t.DataGroup);t.ListBase=e,__reflect(e.prototype,"eui.ListBase"),t.registerBindable(e.prototype,"selectedIndex"),t.registerBindable(e.prototype,"selectedItem")}(eui||(eui={}));var eui;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.thumb=null,t.$viewport=null,t.autoVisibility=!0,t}return __extends(i,e),Object.defineProperty(i.prototype,"viewport",{get:function(){return this.$viewport},set:function(e){if(e!=this.$viewport){var i=this.$viewport;i&&(i.removeEventListener(t.PropertyEvent.PROPERTY_CHANGE,this.onPropertyChanged,this),i.removeEventListener(egret.Event.RESIZE,this.onViewportResize,this)),this.$viewport=e,e&&(e.addEventListener(t.PropertyEvent.PROPERTY_CHANGE,this.onPropertyChanged,this),e.addEventListener(egret.Event.RESIZE,this.onViewportResize,this)),this.invalidateDisplayList()}},enumerable:!0,configurable:!0}),i.prototype.onViewportResize=function(t){this.invalidateDisplayList()},i.prototype.onPropertyChanged=function(t){},i}(t.Component);t.ScrollBarBase=e,__reflect(e.prototype,"eui.ScrollBarBase")}(eui||(eui={}));var eui;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.trackHighlight=null,t.thumb=null,t.track=null,t.$SliderBase={0:0,1:0,2:0,3:0,4:null,5:null,6:300,7:0,8:0,9:!0},t.maximum=10,t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,t.onTouchBegin,t),t}return __extends(i,e),Object.defineProperty(i.prototype,"slideDuration",{get:function(){return this.$SliderBase[6]},set:function(t){this.$SliderBase[6]=+t||0},enumerable:!0,configurable:!0}),i.prototype.pointToValue=function(t,e){return this.minimum},Object.defineProperty(i.prototype,"liveDragging",{get:function(){return this.$SliderBase[9]},set:function(t){this.$SliderBase[9]=!!t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"pendingValue",{get:function(){return this.$SliderBase[7]},set:function(t){t=+t||0;var e=this.$SliderBase;t!==e[7]&&(e[7]=t,this.invalidateDisplayList())},enumerable:!0,configurable:!0}),i.prototype.setValue=function(t){this.$SliderBase[7]=t,e.prototype.setValue.call(this,t)},i.prototype.partAdded=function(t,i){e.prototype.partAdded.call(this,t,i),i==this.thumb?(this.thumb.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onThumbTouchBegin,this),this.thumb.addEventListener(egret.Event.RESIZE,this.onTrackOrThumbResize,this)):i==this.track?(this.track.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTrackTouchBegin,this),this.track.addEventListener(egret.Event.RESIZE,this.onTrackOrThumbResize,this)):i===this.trackHighlight&&(this.trackHighlight.touchEnabled=!1,egret.is(this.trackHighlight,"egret.DisplayObjectContainer")&&(this.trackHighlight.touchChildren=!1))},i.prototype.partRemoved=function(t,i){e.prototype.partRemoved.call(this,t,i),i==this.thumb?(this.thumb.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onThumbTouchBegin,this),this.thumb.removeEventListener(egret.Event.RESIZE,this.onTrackOrThumbResize,this)):i==this.track&&(this.track.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTrackTouchBegin,this),this.track.removeEventListener(egret.Event.RESIZE,this.onTrackOrThumbResize,this))},i.prototype.onTrackOrThumbResize=function(t){this.updateSkinDisplayList()},i.prototype.onThumbTouchBegin=function(e){var i=this.$SliderBase;i[5]&&i[5].isPlaying&&this.stopAnimation();var r=this.$stage;r.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onStageTouchMove,this),r.addEventListener(egret.TouchEvent.TOUCH_END,this.onStageTouchEnd,this);var n=this.thumb.globalToLocal(e.stageX,e.stageY,egret.$TempPoint);i[0]=n.x,i[1]=n.y,t.UIEvent.dispatchUIEvent(this,t.UIEvent.CHANGE_START)},i.prototype.onStageTouchMove=function(t){var e=this.$SliderBase;e[2]=t.$stageX,e[3]=t.$stageY;var i=this.track;if(i){var r=i.globalToLocal(e[2],e[3],egret.$TempPoint),n=this.pointToValue(r.x-e[0],r.y-e[1]);n=this.nearestValidValue(n,this.snapInterval),this.updateWhenTouchMove(n),t.updateAfterEvent()}},i.prototype.updateWhenTouchMove=function(t){t!=this.$SliderBase[7]&&(this.liveDragging?(this.setValue(t),this.dispatchEventWith(egret.Event.CHANGE)):this.pendingValue=t)},i.prototype.onStageTouchEnd=function(e){var i=e.$currentTarget;i.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onStageTouchMove,this),i.removeEventListener(egret.TouchEvent.TOUCH_END,this.onStageTouchEnd,this),t.UIEvent.dispatchUIEvent(this,t.UIEvent.CHANGE_END);var r=this.$SliderBase;this.liveDragging||this.value==r[7]||(this.setValue(r[7]),this.dispatchEventWith(egret.Event.CHANGE))},i.prototype.onTouchBegin=function(t){this.$stage.addEventListener(egret.TouchEvent.TOUCH_END,this.stageTouchEndHandler,this),this.$SliderBase[4]=t.$target},i.prototype.stageTouchEndHandler=function(t){var e=t.$target,i=this.$SliderBase;t.$currentTarget.removeEventListener(egret.TouchEvent.TOUCH_END,this.stageTouchEndHandler,this),i[4]!=e&&this.contains(e)&&egret.TouchEvent.dispatchTouchEvent(this,egret.TouchEvent.TOUCH_TAP,!0,!0,t.$stageX,t.$stageY,t.touchPointID),i[4]=null},i.prototype.$animationUpdateHandler=function(t){this.pendingValue=t.currentValue},i.prototype.animationEndHandler=function(e){this.setValue(this.$SliderBase[8]),this.dispatchEventWith(egret.Event.CHANGE),t.UIEvent.dispatchUIEvent(this,t.UIEvent.CHANGE_END)},i.prototype.stopAnimation=function(){this.$SliderBase[5].stop(),this.setValue(this.nearestValidValue(this.pendingValue,this.snapInterval)),this.dispatchEventWith(egret.Event.CHANGE),t.UIEvent.dispatchUIEvent(this,t.UIEvent.CHANGE_END)},i.prototype.onTrackTouchBegin=function(e){var i=this.thumb?this.thumb.width:0,r=this.thumb?this.thumb.height:0,n=e.$stageX-i/2,a=e.$stageY-r/2,o=this.track.globalToLocal(n,a,egret.$TempPoint),s=this.$Range,l=this.pointToValue(o.x,o.y);l=this.nearestValidValue(l,s[7]);var h=this.$SliderBase;if(l!=h[7])if(0!=h[6]){h[5]||(h[5]=new t.sys.Animation(this.$animationUpdateHandler,this),h[5].endFunction=this.animationEndHandler);var c=h[5];c.isPlaying&&this.stopAnimation(),h[8]=l,c.duration=h[6]*(Math.abs(h[7]-h[8])/(s[0]-s[2])),c.from=h[7],c.to=h[8],t.UIEvent.dispatchUIEvent(this,t.UIEvent.CHANGE_START),c.play()}else this.setValue(l),this.dispatchEventWith(egret.Event.CHANGE)},i}(t.Range);t.SliderBase=e,__reflect(e.prototype,"eui.SliderBase")}(eui||(eui={}));var eui;!function(t){var e;!function(t){function e(t){if(!t)return"";for(var e="  at <"+t.name,i=t.attributes,r=Object.keys(i),n=r.length,a=0;n>a;a++){var o=r[a],s=i[o];("id"!=o||"__"!=s.substring(0,2))&&(e+=" "+o+'="'+s+'"')}return e+=0==t.children.length?"/>":">"}function i(t){var i=e(t.parent),r=e(t).substring(5);return i+"\n      	"+r}var r=[],n=1,a="hostComponent",o="eui.Skin",s="Declarations",l="egret.Rectangle",h="Class",c="Array",u="Percentage",p="State[]",d="skinName",f=[c,"boolean","string","number"],g=["id","locked","includeIn","excludeFrom"],m=[["<","&lt;"],[">","&gt;"],["&","&amp;"],['"',"&quot;"],["'","&apos;"]],y=["null","NaN","undefined","true","false"],v=function(){function e(){this.delayAssignmentDic={}}return e.prototype.$parseCode=function(t,e){var i=e?e:"$exmlClass"+n++,r=eval,a=r(t),o=!0;if(o&&a){egret.registerClass(a,i);for(var s=i.split("."),l=s.length,h=__global,c=0;l-1>c;c++){var u=s[c];h=h[u]||(h[u]={})}h[s[l-1]]||(h[s[l-1]]=a)}return a},e.prototype.parse=function(t){var e=null;e=egret.XML.parse(t);var i=!1,r="";e.attributes["class"]?(r=e.attributes["class"],delete e.attributes["class"],i=!!r):r="$exmlClass"+n++;var a=this.parseClass(e,r),o=a.toCode(),s=null,l=eval;if(s=l(o),i&&s){egret.registerClass(s,r);for(var h=r.split("."),c=h.length,u=__global,p=0;c-1>p;p++){var d=h[p];u=u[d]||(u[d]={})}u[h[c-1]]||(u[h[c-1]]=s)}return s},e.prototype.parseClass=function(e,i){t.exmlConfig||(t.exmlConfig=new t.EXMLConfig),this.currentXML=e,this.currentClassName=i,this.delayAssignmentDic={},this.idDic={},this.stateCode=[],this.stateNames=[],this.skinParts=[],this.bindings=[],this.declarations=null,this.currentClass=new t.EXClass,this.stateIds=[];var r=i.lastIndexOf(".");-1!=r?this.currentClass.className=i.substring(r+1):this.currentClass.className=i,this.startCompile();var n=this.currentClass;return this.currentClass=null,n},e.prototype.startCompile=function(){var e=this.getClassNameOfNode(this.currentXML);this.isSkinClass=e==o,this.currentClass.superClass=e,this.getStateNames();var i=this.currentXML.children;if(i)for(var r=i.length,n=0;r>n;n++){var a=i[n];if(1===a.nodeType&&a.namespace==t.NS_W&&a.localName==s){this.declarations=a;break}}this.currentXML.namespace&&(this.addIds(this.currentXML.children),this.createConstructFunc())},e.prototype.addIds=function(e){if(e)for(var i=e.length,r=0;i>r;r++){var n=e[r];if(1==n.nodeType&&n.namespace&&!this.isInnerClass(n)&&(this.addIds(n.children),n.namespace!=t.NS_W&&n.localName))if(this.isProperty(n)){var a=n.localName,o=a.indexOf("."),s=n.children;if(-1==o||!s||0==s.length)continue;var l=s[0];this.stateIds.push(l.attributes.id)}else if(1===n.nodeType){var h=n.attributes.id;if(h){var c=new RegExp("^[a-zA-Z_$]{1}[a-z0-9A-Z_$]*");null==h.match(c)&&egret.$warn(2022,h),null!=h.match(new RegExp(/ /g))&&egret.$warn(2022,h),-1==this.skinParts.indexOf(h)&&this.skinParts.push(h),this.createVarForNode(n),this.isStateNode(n)&&this.stateIds.push(h)}else this.createIdForNode(n),this.isStateNode(n)&&this.stateIds.push(n.attributes.id)}}},e.prototype.isInnerClass=function(e){if(e.hasOwnProperty("isInnerClass"))return e.isInnerClass;var i="Skin"==e.localName&&e.namespace==t.NS_S;if(!i)if(this.isProperty(e))i=!1;else{var r=void 0,n=e.parent;if(this.isProperty(n)){r=n.localName;var a=r.indexOf(".");-1!=a&&(r.substring(a+1),r=r.substring(0,a)),n=n.parent}else r=t.exmlConfig.getDefaultPropById(n.localName,n.namespace);var o=t.exmlConfig.getClassNameById(n.localName,n.namespace);i=t.exmlConfig.getPropertyType(r,o)==h}return e.isInnerClass=i,i},e.prototype.containsState=function(t){var e=t.attributes;if(e.includeIn||e.excludeFrom)return!0;for(var i=Object.keys(e),r=i.length,n=0;r>n;n++){var a=i[n];if(-1!=a.indexOf("."))return!0}return!1},e.prototype.createIdForNode=function(t){var e=this.getNodeId(t);this.idDic[e]?this.idDic[e]++:this.idDic[e]=1,e+=this.idDic[e],t.attributes.id=e},e.prototype.getNodeId=function(t){return t.attributes.id?t.attributes.id:"_"+t.localName},e.prototype.createVarForNode=function(e){var i=this.getClassNameOfNode(e);""!=i&&(this.currentClass.getVariableByName(e.attributes.id)||this.currentClass.addVariable(new t.EXVariable(e.attributes.id)))},e.prototype.createFuncForNode=function(e){var i=e.localName,r=this.isBasicTypeData(i);if(r)return this.createBasicTypeForNode(e);var n=this.getClassNameOfNode(e),a=new t.EXFunction,o="_i",s=e.attributes.id;a.name=s+o,this.currentClass.addFunction(a);var l=new t.EXCodeBlock;a.codeBlock=l;var h="t";"Object"==i?l.addVar(h,"{}"):l.addVar(h,"new "+n+"()");var c=!!this.currentClass.getVariableByName(s);c&&l.addAssignment("this."+s,h),this.addAttributesToCodeBlock(l,h,e),this.initlizeChildNode(e,l,h);var u=this.delayAssignmentDic[s];if(u)for(var p=u.length,d=0;p>d;d++){var f=u[d];l.concat(f)}return l.addReturn(h),"this."+a.name+"()"},e.prototype.isBasicTypeData=function(t){return-1!=f.indexOf(t)},e.prototype.createBasicTypeForNode=function(t){var e=t.localName,i="",r=this.currentClass.getVariableByName(t.attributes.id),n=t.children,a="";if(n&&n.length>0){var o=n[0];3==o.nodeType&&(a=o.text.trim())}switch(e){case c:var s=[];if(n)for(var l=n.length,h=0;l>h;h++){var u=n[h];1==u.nodeType&&s.push(this.createFuncForNode(u))}i="["+s.join(",")+"]";break;case"boolean":i="false"!=a&&a?"true":"false";break;case"number":i=a,-1!=i.indexOf("%")&&(i=i.substring(0,i.length-1));break;case"string":i=this.formatString(a)}return r&&(r.defaultValue=i),i},e.prototype.addAttributesToCodeBlock=function(e,i,r){var n,a,o=r.attributes,s=Object.keys(o);s.sort();for(var l=s.length,h=0;l>h;h++)if(n=s[h],this.isNormalKey(n)&&(a=o[n],n=this.formatKey(n,a),a=this.formatValue(n,a,r))){if(this.currentClass.getVariableByName(a)){var c="this.",u=o.id,p=c+u+" = t;";this.currentClass.getVariableByName(u)||this.createVarForNode(r),e.containsCodeLine(p)||e.addCodeLineAt(p,1);var d=new t.EXCodeBlock;"this"==i?d.addAssignment(i,c+a,n):(d.startIf(c+u),d.addAssignment(c+u,c+a,n),d.endBlock()),this.delayAssignmentDic[a]||(this.delayAssignmentDic[a]=[]),this.delayAssignmentDic[a].push(d),a=c+a}e.addAssignment(i,a,n)}},e.prototype.initlizeChildNode=function(e,r,n){var a=e.children;if(a&&0!=a.length){for(var o,s=t.exmlConfig.getClassNameById(e.localName,e.namespace),l=[],h=a.length,c=[],u=0;h>u;u++){var p=a[u];if(1==p.nodeType&&p.namespace!=t.NS_W)if(this.isInnerClass(p)){if("Skin"==p.localName){var f=this.parseInnerClass(p),g=t.exmlConfig.getPropertyType(d,s);g?r.addAssignment(n,f,d):egret.$error(2005,this.currentClassName,d,i(p))}}else{var m=p.localName;if(this.isProperty(p)){if(!this.isNormalKey(m))continue;var g=t.exmlConfig.getPropertyType(p.localName,s);if(!g)continue;if(!p.children||0==p.children.length)continue;this.addChildrenToProp(p.children,g,m,r,n,o,c,e)}else l.push(p)}}if(0!=l.length){var y=t.exmlConfig.getDefaultPropById(e.localName,e.namespace),v=t.exmlConfig.getPropertyType(y,s);y&&v&&this.addChildrenToProp(l,v,y,r,n,o,c,e)}}},e.prototype.parseInnerClass=function(t){var i=r.pop();i||(i=new e);var a=this.currentClass.className+"$"+t.localName+n++,o=i.parseClass(t,a);return this.currentClass.addInnerClass(o),r.push(i),a},e.prototype.addChildrenToProp=function(t,e,i,r,n,a,o,s){var l="",u=t.length;if(u>1){if(e!=c)return;for(var p=[],d=0;u>d;d++){var f=t[d];1==f.nodeType&&(l=this.createFuncForNode(f),this.getClassNameOfNode(f),this.isStateNode(f)||p.push(l))}l="["+p.join(",")+"]"}else{var g=t[0];if(e==c)if(g.localName==c){var p=[];if(g.children)for(var m=g.children.length,y=0;m>y;y++){var f=g.children[y];1==f.nodeType&&(l=this.createFuncForNode(f),this.getClassNameOfNode(f),this.isStateNode(f)||p.push(l))}l="["+p.join(",")+"]"}else l=this.createFuncForNode(g),this.getClassNameOfNode(g),l=this.isStateNode(g)?"[]":"["+l+"]";else if(1==g.nodeType)if(e==h){if(u>1)return;l=this.parseInnerClass(t[0])}else this.getClassNameOfNode(g),l=this.createFuncForNode(g);else l=this.formatValue(i,g.text,s)}""!=l&&(-1==l.indexOf("()")&&(i=this.formatKey(i,l)),-1==o.indexOf(i)&&o.push(i),r.addAssignment(n,l,i))},e.prototype.isProperty=function(e){if(e.hasOwnProperty("isProperty"))return e.isProperty;var i,r=e.localName;if(r&&1===e.nodeType&&e.parent&&!this.isBasicTypeData(r)){var n=e.parent,a=r.indexOf(".");-1!=a&&(r=r.substr(0,a));var o=t.exmlConfig.getClassNameById(n.localName,n.namespace);i=!!t.exmlConfig.getPropertyType(r,o)}else i=!1;return e.isProperty=i,i},e.prototype.isNormalKey=function(t){return t&&-1==t.indexOf(".")&&-1==t.indexOf(":")&&-1==g.indexOf(t)?!0:!1},e.prototype.formatKey=function(t,e){return-1!=e.indexOf("%")&&("height"==t?t="percentHeight":"width"==t&&(t="percentWidth")),t},e.prototype.formatValue=function(e,i,r){i||(i="");var n=i;i=i.trim();var a=this.getClassNameOfNode(r),o=t.exmlConfig.getPropertyType(e,a),s=this.formatBinding(e,i,r);if(s){this.checkIdForState(r);var c="this";r!==this.currentXML&&(c+="."+r.attributes.id),this.bindings.push(new t.EXBinding(c,e,s.templates,s.chainIndex)),i=""}else if(o==l)i="new "+l+"("+i+")";else if(o==u)-1!=i.indexOf("%")&&(i=this.formatString(i));else switch(o){case h:e==d&&(i=this.formatString(n));break;case"number":0==i.indexOf("#")?i="0x"+i.substring(1):-1!=i.indexOf("%")&&(i=parseFloat(i.substr(0,i.length-1)).toString());break;case"boolean":i="false"!=i&&i?"true":"false";break;case"string":case"any":i=this.formatString(n)}return i},e.prototype.formatString=function(t){return t=this.unescapeHTMLEntity(t),t=t.split("\n").join("\\n"),t=t.split("\r").join("\\n"),t=t.split('"').join('\\"'),t='"'+t+'"'},e.prototype.formatBinding=function(t,e,i){if(!e)return null;if(e=e.trim(),"{"!=e.charAt(0)||"}"!=e.charAt(e.length-1))return null;e=e.substring(1,e.length-1).trim();for(var r=-1==e.indexOf("+")?[e]:this.parseTemplates(e),n=[],o=r.length,s=0;o>s;s++){var l=r[s].trim();if(l){var h=l.charAt(0);if(!("'"==h||'"'==h||h>="0"&&"9">=h||"-"==h||-1==l.indexOf(".")&&-1!=y.indexOf(l))){0==l.indexOf("this.")&&(l=l.substring(5));var c=l.split(".")[0];c!=a&&-1==this.skinParts.indexOf(c)&&(l=a+"."+l),r[s]='"'+l+'"',n.push(s)}}else r.splice(s,1),s--,o--}return{templates:r,chainIndex:n}},e.prototype.parseTemplates=function(t){if(-1==t.indexOf("'"))return t.split("+");var e=!1,i="";for(t=t.split("\\'").join("0");t.length>0;){var r=t.indexOf("'");if(-1==r){i+=t;break}i+=t.substring(0,r+1),t=t.substring(r+1),r=t.indexOf("'"),-1==r&&(r=t.length-1,e=!0);var n=t.substring(0,r+1);i+=n.split("+").join("1"),t=t.substring(r+1)}t=i.split("0").join("\\'"),e&&(t+="'");for(var a=t.split("+"),o=a.length,s=0;o>s;s++)a[s]=a[s].split("1").join("+");return a},e.prototype.unescapeHTMLEntity=function(t){if(!t)return"";for(var e=m.length,i=0;e>i;i++){var r=m[i],n=r[0],a=r[1];t=t.split(a).join(n)}return t},e.prototype.createConstructFunc=function(){var e=new t.EXCodeBlock;e.addEmptyLine();var i="this";if(this.addAttributesToCodeBlock(e,i,this.currentXML),this.declarations){var r=this.declarations.children;if(r&&r.length>0)for(var n=r.length,a=0;n>a;a++){var o=r[a];if(1==o.nodeType){var s=this.createFuncForNode(o);s&&e.addCodeLine(s+";")}}}this.initlizeChildNode(this.currentXML,e,i);var l,h,c=this.stateIds;if(c.length>0){h=c.length;for(var a=0;h>a;a++)l=c[a],e.addCodeLine("this."+l+"_i();");e.addEmptyLine()}var u=this.skinParts,p="[]";if(h=u.length,h>0){for(var a=0;h>a;a++)u[a]='"'+u[a]+'"';p="["+u.join(",")+"]"}var d=new t.EXFunction;d.name="skinParts",d.isGet=!0;var f=new t.EXCodeBlock;f.addReturn(p),d.codeBlock=f,this.currentClass.addFunction(d),this.currentXML.attributes.id="",this.createStates(this.currentXML);for(var g,m=this.currentXML,y=(this.getClassNameOfNode(m),m.attributes),v=Object.keys(y),_=v.length,b=0;_>b;b++){var x=v[b],T=y[x],E=x.indexOf(".");if(-1!=E){var S=x.substring(0,E);S=this.formatKey(S,T);var C=this.formatValue(S,T,m);if(!C)continue;var w=x.substr(E+1);g=this.getStateByName(w,m);var P=g.length;if(P>0)for(var a=0;P>a;a++){var D=g[a];D.addOverride(new t.EXSetProperty("",S,C))}}}var A=this.stateCode;if(h=A.length,h>0){var I="	";e.addCodeLine("this.states = [");for(var M=!0,a=0;h>a;a++){var D=A[a];M?M=!1:e.addCodeLine(I+",");for(var $=D.toCode().split("\n"),O=0;O<$.length;){var R=$[O];R&&e.addCodeLine(I+R),O++}}e.addCodeLine("];")}var L=this.bindings;if(h=L.length,h>0){e.addEmptyLine();for(var a=0;h>a;a++){var B=L[a];e.addCodeLine(B.toCode())}}this.currentClass.constructCode=e},e.prototype.isStateNode=function(t){var e=t.attributes;return e.hasOwnProperty("includeIn")||e.hasOwnProperty("excludeFrom")},e.prototype.getStateNames=function(){var e=this.currentXML,i=t.exmlConfig.getClassNameById(e.localName,e.namespace),r=t.exmlConfig.getPropertyType("states",i);if(r==p){var n=e.attributes.states;n&&delete e.attributes.states;var a,o,s=this.stateNames,l=e.children;if(l)for(var h=l.length,c=0;h>c;c++)if(o=l[c],1==o.nodeType&&"states"==o.localName){o.namespace=t.NS_W,a=o.children;break}if(a||n)if(n)for(var u=n.split(","),d=u.length,c=0;d>c;c++){var f=u[c].trim();f&&(-1==s.indexOf(f)&&s.push(f),this.stateCode.push(new t.EXState(f)))}else for(var g=a.length,c=0;g>c;c++){var m=a[c];if(1==m.nodeType){var y=[],v=m.attributes;if(v.stateGroups)for(var _=v.stateGroups.split(","),b=_.length,x=0;b>x;x++){var T=_[x].trim();T&&(-1==s.indexOf(T)&&s.push(T),y.push(T))}var f=v.name;-1==s.indexOf(f)&&s.push(f),this.stateCode.push(new t.EXState(f,y))}}}},e.prototype.createStates=function(e){var i=e.children;if(i)for(var r=i.length,n=0;r>n;n++){var a=i[n];if(1==a.nodeType&&!this.isInnerClass(a)&&(this.createStates(a),a.namespace!=t.NS_W&&a.localName))if(this.isProperty(a)){var o=a.localName,s=o.indexOf("."),l=a.children;if(-1==s||!l||0==l.length)continue;var h=o.substring(s+1);o=o.substring(0,s);var u=this.getClassNameOfNode(e),p=(t.exmlConfig.getPropertyType(o,u),l[0]),d=void 0;1==p.nodeType?(this.createFuncForNode(p),this.checkIdForState(p),d="this."+p.attributes.id):d=this.formatValue(o,p.text,e);var f=this.getStateByName(h,a),g=f.length;if(g>0)for(var m=0;g>m;m++){var y=f[m];y.addOverride(new t.EXSetProperty(e.attributes.id,o,d))}}else if(this.containsState(a)){var v=a.attributes,_=v.id;this.getClassNameOfNode(a),this.checkIdForState(a);var h=void 0,f=void 0,y=void 0;if(this.isStateNode(a)){var b="",x=a.parent;x.localName==c&&(x=x.parent),x&&x.parent&&this.isProperty(x)&&(x=x.parent),x&&x!=this.currentXML&&(b=x.attributes.id,this.checkIdForState(x));var T=this.findNearNodeId(a),E=[];if(v.includeIn)E=v.includeIn.split(",");else{for(var S=v.excludeFrom.split(","),C=S.length,m=0;C>m;m++){var w=S[m];this.getStateByName(w,a)}C=this.stateCode.length;for(var m=0;C>m;m++)y=this.stateCode[m],-1==S.indexOf(y.name)&&E.push(y.name)}for(var P=E.length,D=0;P>D;D++)if(h=E[D],f=this.getStateByName(h,a),f.length>0)for(var g=f.length,m=0;g>m;m++)y=f[m],y.addOverride(new t.EXAddItems(_,b,T.position,T.relativeTo))}for(var A=Object.keys(v),I=A.length,M=0;I>M;M++){var $=A[M],d=v[$],s=$.indexOf(".");if(-1!=s){var O=$.substring(0,s);O=this.formatKey(O,d);var R=this.formatBinding(O,d,a);if(!R&&(d=this.formatValue(O,d,a),!d))continue;h=$.substr(s+1),f=this.getStateByName(h,a);var g=f.length;if(g>0)for(var m=0;g>m;m++)y=f[m],R?y.addOverride(new t.EXSetStateProperty(_,O,R.templates,R.chainIndex)):y.addOverride(new t.EXSetProperty(_,O,d))}}}}},e.prototype.checkIdForState=function(t){if(t&&!this.currentClass.getVariableByName(t.attributes.id)){this.createVarForNode(t);var e=t.attributes.id,i=e+"_i",r=this.currentClass.getFuncByName(i);if(r){var n="this."+e+" = t;",a=r.codeBlock;a&&(a.containsCodeLine(n)||a.addCodeLineAt(n,1))}}},e.prototype.getStateByName=function(t,e){for(var i=[],r=this.stateCode,n=r.length,a=0;n>a;a++){var o=r[a];if(o.name==t)-1==i.indexOf(o)&&i.push(o);else if(o.stateGroups.length>0){for(var s=!1,l=o.stateGroups.length,h=0;l>h;h++){var c=o.stateGroups[h];if(c==t){s=!0;break}}s&&-1==i.indexOf(o)&&i.push(o)}}return i},e.prototype.findNearNodeId=function(t){for(var e,i,r,n=t.parent,a="",o=-1,s=!1,l=n.children,h=l.length,c=0;h>c;c++){var u=l[c];this.isProperty(u)||(u==t?(s=!0,o=c):!s||r||this.isStateNode(u)||(r=u),s||this.isStateNode(u)||(i=u))}return 0==o?(e=0,{position:e,relativeTo:a}):o==h-1?(e=1,{position:e,relativeTo:a}):r&&(e=2,a=r.attributes.id)?(this.checkIdForState(r),{position:e,relativeTo:a}):{position:1,relativeTo:a}},e.prototype.getClassNameOfNode=function(e){var i=t.exmlConfig.getClassNameById(e.localName,e.namespace);return i},e}();t.EXMLParser=v,__reflect(v.prototype,"eui.sys.EXMLParser")}(e=t.sys||(t.sys={}))}(eui||(eui={}));var eui;!function(t){var e=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.$selected=!1,t.$autoSelected=!0,t}return __extends(i,e),Object.defineProperty(i.prototype,"selected",{get:function(){return this.$selected},set:function(t){this.$setSelected(t)},enumerable:!0,configurable:!0}),i.prototype.$setSelected=function(e){return e=!!e,e===this.$selected?!1:(this.$selected=e,this.invalidateState(),t.PropertyEvent.dispatchPropertyEvent(this,t.PropertyEvent.PROPERTY_CHANGE,"selected"),!0)},i.prototype.getCurrentState=function(){var t=e.prototype.getCurrentState.call(this);if(this.$selected){var i=t+"AndSelected",r=this.skin;return r&&r.hasState(i)?i:"disabled"==t?"disabled":"down"}return t},i.prototype.buttonReleased=function(){this.$autoSelected&&(this.selected=!this.$selected,this.dispatchEventWith(egret.Event.CHANGE))},i}(t.Button);t.ToggleButton=e,__reflect(e.prototype,"eui.ToggleButton"),t.registerBindable(e.prototype,"selected")}(eui||(eui={}));var eui;!function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.$horizontalAlign="left",e.$verticalAlign="top",e.$gap=6,e.$paddingLeft=0,e.$paddingRight=0,e.$paddingTop=0,e.$paddingBottom=0,e.elementSizeTable=[],e.startIndex=-1,e.endIndex=-1,e.indexInViewCalculated=!1,e.maxElementSize=0,e}return __extends(e,t),Object.defineProperty(e.prototype,"horizontalAlign",{get:function(){return this.$horizontalAlign},set:function(t){this.$horizontalAlign!=t&&(this.$horizontalAlign=t,this.$target&&this.$target.invalidateDisplayList())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"verticalAlign",{get:function(){return this.$verticalAlign},set:function(t){this.$verticalAlign!=t&&(this.$verticalAlign=t,this.$target&&this.$target.invalidateDisplayList())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gap",{get:function(){return this.$gap},set:function(t){t=+t||0,this.$gap!==t&&(this.$gap=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paddingLeft",{get:function(){return this.$paddingLeft},set:function(t){t=+t||0,this.$paddingLeft!==t&&(this.$paddingLeft=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paddingRight",{get:function(){return this.$paddingRight},set:function(t){t=+t||0,this.$paddingRight!==t&&(this.$paddingRight=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paddingTop",{get:function(){return this.$paddingTop},set:function(t){t=+t||0,this.$paddingTop!==t&&(this.$paddingTop=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paddingBottom",{get:function(){return this.$paddingBottom},set:function(t){t=+t||0,this.$paddingBottom!==t&&(this.$paddingBottom=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),e.prototype.invalidateTargetLayout=function(){var t=this.$target;t&&(t.invalidateSize(),t.invalidateDisplayList())},e.prototype.measure=function(){this.$target&&(this.$useVirtualLayout?this.measureVirtual():this.measureReal())},e.prototype.measureReal=function(){},e.prototype.measureVirtual=function(){},e.prototype.updateDisplayList=function(t,e){var i=this.$target;return i?0==i.numElements?void i.setContentSize(Math.ceil(this.$paddingLeft+this.$paddingRight),Math.ceil(this.$paddingTop+this.$paddingBottom)):void(this.$useVirtualLayout?this.updateDisplayListVirtual(t,e):this.updateDisplayListReal(t,e)):void 0},e.prototype.getStartPosition=function(t){return 0},e.prototype.getElementSize=function(t){return 0},e.prototype.getElementTotalSize=function(){return 0},e.prototype.elementRemoved=function(e){this.$useVirtualLayout&&(t.prototype.elementRemoved.call(this,e),this.elementSizeTable.splice(e,1))},e.prototype.clearVirtualLayoutCache=function(){this.$useVirtualLayout&&(this.elementSizeTable=[],this.maxElementSize=0)},e.prototype.findIndexAt=function(t,e,i){var r=.5*(e+i)|0,n=this.getStartPosition(r),a=this.getElementSize(r);return t>=n&&t<n+a+this.$gap?r:e==i?-1:n>t?this.findIndexAt(t,e,Math.max(e,r-1)):this.findIndexAt(t,Math.min(r+1,i),i)},e.prototype.scrollPositionChanged=function(){if(t.prototype.scrollPositionChanged.call(this),this.$useVirtualLayout){var e=this.getIndexInView();e&&(this.indexInViewCalculated=!0,this.target.invalidateDisplayList())}},e.prototype.getIndexInView=function(){return!1},e.prototype.updateDisplayListVirtual=function(t,e){},e.prototype.updateDisplayListReal=function(t,e){},e.prototype.flexChildrenProportionally=function(t,e,i,r){var n,a=r.length;do{n=!0;var o=e-t*i/100;o>0?e-=o:o=0;for(var s=e/i,l=0;a>l;l++){var h=r[l],c=h.percent*s;if(c<h.min){var u=h.min;h.size=u,r[l]=r[--a],r[a]=h,i-=h.percent,o>=u?o-=u:(e-=u-o,o=0),n=!1;break}if(c>h.max){var p=h.max;h.size=p,r[l]=r[--a],r[a]=h,i-=h.percent,o>=p?o-=p:(e-=p-o,o=0),n=!1;break}h.size=c}}while(!n)},e}(t.LayoutBase);t.LinearLayoutBase=e,__reflect(e.prototype,"eui.LinearLayoutBase")}(eui||(eui={})),function(t){var e;!function(t){var e=function(){function t(){this.layoutElement=null,this.size=0,this.percent=0/0,this.min=0/0,this.max=0/0}return t}();t.ChildInfo=e,__reflect(e.prototype,"eui.sys.ChildInfo")}(e=t.sys||(t.sys={}))}(eui||(eui={}));var eui;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.pointToValue=function(t,e){if(!this.thumb||!this.track)return 0;var i=this.$Range,r=i[0]-i[2],n=this.getThumbRange();return i[2]+(0!=n?t/n*r:0)},e.prototype.getThumbRange=function(){var t=egret.$TempRectangle;this.track.getLayoutBounds(t);var e=t.width;return this.thumb.getLayoutBounds(t),e-t.width},e.prototype.updateSkinDisplayList=function(){if(this.thumb&&this.track){var t=this.$Range,e=this.getThumbRange(),i=t[0]-t[2],r=i>0?(this.pendingValue-t[2])/i*e:0,n=this.track.localToGlobal(r,0,egret.$TempPoint),a=n.x,o=n.y,s=this.thumb.$parent.globalToLocal(a,o,egret.$TempPoint).x,l=egret.$TempRectangle;if(this.thumb.getLayoutBounds(l),this.thumb.setLayoutBoundsPosition(Math.round(s),l.y),this.trackHighlight&&this.trackHighlight.$parent){var h=this.trackHighlight.$parent.globalToLocal(a,o,egret.$TempPoint).x-r;this.trackHighlight.x=Math.round(h),this.trackHighlight.width=Math.round(r)}}},e}(t.SliderBase);t.HSlider=e,__reflect(e.prototype,"eui.HSlider")}(eui||(eui={}));var eui;!function(t){var e=[],i={},r={},n=function(){function t(){}return t.prototype.getAsset=function(t,n,a){var o=i[t];if(o)return void o.push([n,a]);var s=e.pop();s||(s=new egret.ImageLoader),i[t]=[[n,a]],r[s.$hashCode]=t,s.addEventListener(egret.Event.COMPLETE,this.onLoadFinish,this),s.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onLoadFinish,this),s.load(t)},t.prototype.onLoadFinish=function(t){var n=t.currentTarget;n.removeEventListener(egret.Event.COMPLETE,this.onLoadFinish,this),n.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.onLoadFinish,this);var a;t.$type==egret.Event.COMPLETE&&(a=new egret.Texture,a._setBitmapData(n.data),n.data=null),e.push(n);var o=r[n.$hashCode];delete r[n.$hashCode];var s=i[o];delete i[o];for(var l=s.length,h=0;l>h;h++){var c=s[h];c[0].call(c[1],a,o)}},t}();t.DefaultAssetAdapter=n,__reflect(n.prototype,"eui.DefaultAssetAdapter",["eui.IAssetAdapter"])}(eui||(eui={}));var eui;!function(t){var e=function(e){function i(t){var i=e.call(this)||this;return i.sourceChanged=!1,i._source=null,i.initializeUIValues(),t&&(i.source=t),i}return __extends(i,e),Object.defineProperty(i.prototype,"scale9Grid",{get:function(){return this.$scale9Grid},set:function(t){this.$setScale9Grid(t),this.invalidateDisplayList()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"fillMode",{get:function(){return this.$fillMode},set:function(t){t!=this.$fillMode&&(e.prototype.$setFillMode.call(this,t),this.invalidateDisplayList())},enumerable:!0,configurable:!0}),i.prototype.$setFillMode=function(t){var i=e.prototype.$setFillMode.call(this,t);return this.invalidateDisplayList(),i},Object.defineProperty(i.prototype,"source",{get:function(){return this._source},set:function(t){t!=this._source&&(this._source=t,this.$stage?this.parseSource():(this.sourceChanged=!0,this.invalidateProperties()))},enumerable:!0,configurable:!0}),i.prototype.$setTexture=function(t){if(t==this.$texture)return!1;var i=e.prototype.$setTexture.call(this,t);return this.sourceChanged=!1,this.invalidateSize(),this.invalidateDisplayList(),i},i.prototype.parseSource=function(){this.sourceChanged=!1;var e=this._source;e&&"string"==typeof e?t.getAssets(this._source,function(t){e===this._source&&egret.is(t,"egret.Texture")&&(this.$setTexture(t),t&&this.dispatchEventWith(egret.Event.COMPLETE))},this):this.$setTexture(e)},i.prototype.$measureContentBounds=function(t){var e=this.$texture;if(e){var i=this.$UIComponent,r=i[10],n=i[11];if(isNaN(r)||isNaN(n))return void t.setEmpty();"clip"==this.$fillMode&&(r>e.$getTextureWidth()&&(r=e.$getTextureWidth()),n>e.$getTextureHeight()&&(n=e.$getTextureHeight())),t.setTo(0,0,r,n)
}else t.setEmpty()},i.prototype.createChildren=function(){this.sourceChanged&&this.parseSource()},i.prototype.setActualSize=function(i,r){t.sys.UIComponentImpl.prototype.setActualSize.call(this,i,r),e.prototype.$setWidth.call(this,i),e.prototype.$setHeight.call(this,r)},i.prototype.childrenCreated=function(){},i.prototype.commitProperties=function(){t.sys.UIComponentImpl.prototype.commitProperties.call(this),this.sourceChanged&&this.parseSource()},i.prototype.measure=function(){var t=this.$texture;t?this.setMeasuredSize(t.$getTextureWidth(),t.$getTextureHeight()):this.setMeasuredSize(0,0)},i.prototype.updateDisplayList=function(t,e){this.$renderDirty=!0},i.prototype.invalidateParentLayout=function(){},i.prototype.setMeasuredSize=function(t,e){},i.prototype.invalidateProperties=function(){},i.prototype.validateProperties=function(){},i.prototype.invalidateSize=function(){},i.prototype.validateSize=function(t){},i.prototype.invalidateDisplayList=function(){},i.prototype.validateDisplayList=function(){},i.prototype.validateNow=function(){},i.prototype.setLayoutBoundsSize=function(t,e){},i.prototype.setLayoutBoundsPosition=function(t,e){},i.prototype.getLayoutBounds=function(t){},i.prototype.getPreferredBounds=function(t){},i}(egret.Bitmap);t.Image=e,__reflect(e.prototype,"eui.Image",["eui.UIComponent","egret.DisplayObject"]),t.sys.implementUIComponent(e,egret.Bitmap),t.registerProperty(e,"scale9Grid","egret.Rectangle")}(eui||(eui={}));var eui;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t._data=null,t._selected=!1,t.itemIndex=-1,t.touchCaptured=!1,t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,t.onTouchBegin,t),t}return __extends(i,e),Object.defineProperty(i.prototype,"data",{get:function(){return this._data},set:function(e){this._data=e,t.PropertyEvent.dispatchPropertyEvent(this,t.PropertyEvent.PROPERTY_CHANGE,"data"),this.dataChanged()},enumerable:!0,configurable:!0}),i.prototype.dataChanged=function(){},Object.defineProperty(i.prototype,"selected",{get:function(){return this._selected},set:function(t){this._selected!=t&&(this._selected=t,this.invalidateState())},enumerable:!0,configurable:!0}),i.prototype.onTouchCancle=function(t){this.touchCaptured=!1;var e=t.$currentTarget;e.removeEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onTouchCancle,this),e.removeEventListener(egret.TouchEvent.TOUCH_END,this.onStageTouchEnd,this),this.invalidateState()},i.prototype.onTouchBegin=function(t){this.$stage&&(this.$stage.addEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onTouchCancle,this),this.$stage.addEventListener(egret.TouchEvent.TOUCH_END,this.onStageTouchEnd,this),this.touchCaptured=!0,this.invalidateState(),t.updateAfterEvent())},i.prototype.onStageTouchEnd=function(t){var e=t.$currentTarget;e.removeEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onTouchCancle,this),e.removeEventListener(egret.TouchEvent.TOUCH_END,this.onStageTouchEnd,this),this.touchCaptured=!1,this.invalidateState()},i.prototype.getCurrentState=function(){var t="up";if(this.enabled||(t="disabled"),this.touchCaptured&&(t="down"),this._selected){var e=t+"AndSelected",i=this.skin;return i&&i.hasState(e)?e:"disabled"==t?"disabled":"down"}return t},i}(t.Component);t.ItemRenderer=e,__reflect(e.prototype,"eui.ItemRenderer",["eui.IItemRenderer"]),t.registerBindable(e.prototype,"data")}(eui||(eui={}));var eui;!function(t){var e=t.sys.UIComponentImpl,i=function(i){function r(t){var e=i.call(this)||this;return e.$styleSetMap={fontFamily:!0,size:!0,bold:!0,italic:!0,textAlign:!0,verticalAlign:!0,lineSpacing:!0,textColor:!0,wordWrap:!0,displayAsPassword:!0,strokeColor:!0,stroke:!0,maxChars:!0,multiline:!0,border:!0,borderColor:!0,background:!0,backgroundColor:!0},e.$revertStyle={},e.$style=null,e.$changeFromStyle=!1,e._widthConstraint=0/0,e.initializeUIValues(),e.text=t,e}return __extends(r,i),Object.defineProperty(r.prototype,"style",{get:function(){return this.$style},set:function(t){this.$setStyle(t)},enumerable:!0,configurable:!0}),r.prototype.$setStyle=function(t){if(this.$style!=t){this.$style=t;var e=egret.getImplementation("eui.Theme");if(e){this.$changeFromStyle=!0;for(var i in this.$revertStyle)this[i]=this.$revertStyle[i];if(this.$revertStyle={},null==t)return void(this.$changeFromStyle=!1);for(var r=t.split(","),n=0;n<r.length;n++){var a=e.$getStyleConfig(r[n]);if(a)for(var i in a)if(this.$styleSetMap[i]){var o=this[i];this[i]=a[i],this.$revertStyle[i]=o}}this.$changeFromStyle=!1}}},r.prototype.$setFontFamily=function(t){return this.$changeFromStyle||(delete this.$revertStyle.fontFamily,this.$styleSetMap.fontFamily=!1),i.prototype.$setFontFamily.call(this,t)},r.prototype.$setSize=function(t){return this.$changeFromStyle||(delete this.$revertStyle.size,this.$styleSetMap.size=!1),i.prototype.$setSize.call(this,t)},r.prototype.$setBold=function(t){return this.$changeFromStyle||(delete this.$revertStyle.bold,this.$styleSetMap.bold=!1),i.prototype.$setBold.call(this,t)},r.prototype.$setItalic=function(t){return this.$changeFromStyle||(delete this.$revertStyle.italic,this.$styleSetMap.italic=!1),i.prototype.$setItalic.call(this,t)},r.prototype.$setTextAlign=function(t){return this.$changeFromStyle||(delete this.$revertStyle.textAlign,this.$styleSetMap.textAlign=!1),i.prototype.$setTextAlign.call(this,t)},r.prototype.$setVerticalAlign=function(t){return this.$changeFromStyle||(delete this.$revertStyle.verticalAlign,this.$styleSetMap.verticalAlign=!1),i.prototype.$setVerticalAlign.call(this,t)},r.prototype.$setLineSpacing=function(t){return this.$changeFromStyle||(delete this.$revertStyle.lineSpacing,this.$styleSetMap.lineSpacing=!1),i.prototype.$setLineSpacing.call(this,t)},r.prototype.$setTextColor=function(t){return this.$changeFromStyle||(delete this.$revertStyle.textColor,this.$styleSetMap.textColor=!1),i.prototype.$setTextColor.call(this,t)},r.prototype.$setWordWrap=function(t){this.$changeFromStyle||(delete this.$revertStyle.wordWrap,this.$styleSetMap.wordWrap=!1),i.prototype.$setWordWrap.call(this,t)},r.prototype.$setDisplayAsPassword=function(t){return this.$changeFromStyle||(delete this.$revertStyle.displayAsPassword,this.$styleSetMap.displayAsPassword=!1),i.prototype.$setDisplayAsPassword.call(this,t)},r.prototype.$setStrokeColor=function(t){return this.$changeFromStyle||(delete this.$revertStyle.strokeColor,this.$styleSetMap.strokeColor=!1),i.prototype.$setStrokeColor.call(this,t)},r.prototype.$setStroke=function(t){return this.$changeFromStyle||(delete this.$revertStyle.stroke,this.$styleSetMap.stroke=!1),i.prototype.$setStroke.call(this,t)},r.prototype.$setMaxChars=function(t){return this.$changeFromStyle||(delete this.$revertStyle.maxChars,this.$styleSetMap.maxChars=!1),i.prototype.$setMaxChars.call(this,t)},r.prototype.$setMultiline=function(t){return this.$changeFromStyle||(delete this.$revertStyle.multiline,this.$styleSetMap.multiline=!1),i.prototype.$setMultiline.call(this,t)},r.prototype.$setBorder=function(t){this.$changeFromStyle||(delete this.$revertStyle.border,this.$styleSetMap.border=!1),i.prototype.$setBorder.call(this,t)},r.prototype.$setBorderColor=function(t){this.$changeFromStyle||(delete this.$revertStyle.borderColor,this.$styleSetMap.borderColor=!1),i.prototype.$setBorderColor.call(this,t)},r.prototype.$setBackground=function(t){this.$changeFromStyle||(delete this.$revertStyle.background,this.$styleSetMap.background=!1),i.prototype.$setBackground.call(this,t)},r.prototype.$setBackgroundColor=function(t){this.$changeFromStyle||(delete this.$revertStyle.backgroundColor,this.$styleSetMap.backgroundColor=!1),i.prototype.$setBackgroundColor.call(this,t)},r.prototype.$invalidateTextField=function(){i.prototype.$invalidateTextField.call(this),this.invalidateSize()},r.prototype.$setWidth=function(t){var r=i.prototype.$setWidth.call(this,t),n=e.prototype.$setWidth.call(this,t);return r&&n},r.prototype.$setHeight=function(t){var r=i.prototype.$setHeight.call(this,t),n=e.prototype.$setHeight.call(this,t);return r&&n},r.prototype.$setText=function(e){var r=i.prototype.$setText.call(this,e);return t.PropertyEvent.dispatchPropertyEvent(this,t.PropertyEvent.PROPERTY_CHANGE,"text"),r},r.prototype.createChildren=function(){},r.prototype.childrenCreated=function(){},r.prototype.commitProperties=function(){},r.prototype.measure=function(){var t=this.$UIComponent,e=this.$TextField,r=e[3],n=0/0;isNaN(this._widthConstraint)?isNaN(t[8])?1e5!=t[13]&&(n=t[13]):n=t[8]:(n=this._widthConstraint,this._widthConstraint=0/0),i.prototype.$setWidth.call(this,n),this.setMeasuredSize(this.textWidth,this.textHeight),i.prototype.$setWidth.call(this,r)},r.prototype.updateDisplayList=function(t,e){i.prototype.$setWidth.call(this,t),i.prototype.$setHeight.call(this,e)},r.prototype.invalidateParentLayout=function(){},r.prototype.setMeasuredSize=function(t,e){},r.prototype.invalidateProperties=function(){},r.prototype.validateProperties=function(){},r.prototype.invalidateSize=function(){},r.prototype.validateSize=function(t){},r.prototype.invalidateDisplayList=function(){},r.prototype.validateDisplayList=function(){},r.prototype.validateNow=function(){},r.prototype.setLayoutBoundsSize=function(t,i){if(e.prototype.setLayoutBoundsSize.call(this,t,i),isNaN(t)||t===this._widthConstraint||0==t)return void(this._widthConstraint=t);this._widthConstraint=t;var r=this.$UIComponent;isNaN(r[9])&&t!=r[16]&&this.invalidateSize()},r.prototype.setLayoutBoundsPosition=function(t,e){},r.prototype.getLayoutBounds=function(t){},r.prototype.getPreferredBounds=function(t){},r}(egret.TextField);t.Label=i,__reflect(i.prototype,"eui.Label",["eui.UIComponent","egret.DisplayObject","eui.IDisplayText"]),t.sys.implementUIComponent(i,egret.TextField),t.registerBindable(i.prototype,"text")}(eui||(eui={}));var eui;!function(t){var e=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.allowMultipleSelection=!1,t._selectedIndices=[],t.isValidIndex=function(e,i,r){return t.$dataProvider&&e>=0&&e<t.$dataProvider.length&&e%1==0},t}return __extends(i,e),Object.defineProperty(i.prototype,"selectedIndices",{get:function(){return this._proposedSelectedIndices?this._proposedSelectedIndices:this._selectedIndices},set:function(t){this.setSelectedIndices(t,!1)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"selectedIndex",{get:function(){return this._proposedSelectedIndices?this._proposedSelectedIndices.length>0?this._proposedSelectedIndices[0]:-1:this.$getSelectedIndex()},set:function(t){this.setSelectedIndex(t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"selectedItems",{get:function(){var t=[],e=this.selectedIndices;if(e)for(var i=e.length,r=0;i>r;r++)t[r]=this.$dataProvider.getItemAt(e[r]);return t},set:function(t){var e=[];if(t)for(var i=t.length,r=0;i>r;r++){var n=this.$dataProvider.getItemIndex(t[r]);if(-1!=n&&e.splice(0,0,n),-1==n){e=[];break}}this.setSelectedIndices(e,!1)},enumerable:!0,configurable:!0}),i.prototype.setSelectedIndices=function(t,e){var i=this.$ListBase;e&&(i[4]=i[4]||e),t?this._proposedSelectedIndices=t:this._proposedSelectedIndices=[],this.invalidateProperties()},i.prototype.commitProperties=function(){e.prototype.commitProperties.call(this),this._proposedSelectedIndices&&this.commitSelection()},i.prototype.commitSelection=function(i){void 0===i&&(i=!0);var r=this.$ListBase,n=r[3];if(this._proposedSelectedIndices){if(this._proposedSelectedIndices=this._proposedSelectedIndices.filter(this.isValidIndex),!this.allowMultipleSelection&&this._proposedSelectedIndices.length>0){var a=[];a.push(this._proposedSelectedIndices[0]),this._proposedSelectedIndices=a}this._proposedSelectedIndices.length>0?r[2]=this._proposedSelectedIndices[0]:r[2]=-1}var o=e.prototype.commitSelection.call(this,!1);if(!o)return this._proposedSelectedIndices=null,!1;var s=this.$getSelectedIndex();return s>t.ListBase.NO_SELECTION&&(this._proposedSelectedIndices?-1==this._proposedSelectedIndices.indexOf(s)&&this._proposedSelectedIndices.push(s):this._proposedSelectedIndices=[s]),this._proposedSelectedIndices&&(-1!=this._proposedSelectedIndices.indexOf(n)&&this.itemSelected(n,!0),this.commitMultipleSelection()),i&&o&&(r[4]&&(this.dispatchEventWith(egret.Event.CHANGE),r[4]=!1),t.PropertyEvent.dispatchPropertyEvent(this,t.PropertyEvent.PROPERTY_CHANGE,"selectedIndex"),t.PropertyEvent.dispatchPropertyEvent(this,t.PropertyEvent.PROPERTY_CHANGE,"selectedItem")),o},i.prototype.commitMultipleSelection=function(){var t,e,i=[],r=[],n=this._selectedIndices,a=this._proposedSelectedIndices;if(n.length>0&&a.length>0){for(e=a.length,t=0;e>t;t++)-1==n.indexOf(a[t])&&r.push(a[t]);for(e=n.length,t=0;e>t;t++)-1==a.indexOf(n[t])&&i.push(n[t])}else n.length>0?i=n:a.length>0&&(r=a);if(this._selectedIndices=a,i.length>0)for(e=i.length,t=0;e>t;t++)this.itemSelected(i[t],!1);if(r.length>0)for(e=r.length,t=0;e>t;t++)this.itemSelected(r[t],!0);this._proposedSelectedIndices=null},i.prototype.$isItemIndexSelected=function(t){return this.allowMultipleSelection?-1!=this._selectedIndices.indexOf(t):e.prototype.$isItemIndexSelected.call(this,t)},i.prototype.dataProviderRefreshed=function(){this.allowMultipleSelection||e.prototype.dataProviderRefreshed.call(this)},i.prototype.calculateSelectedIndices=function(t){var e=[],i=this._selectedIndices,r=i.length;if(r>0){if(1==r&&i[0]==t)return this.$ListBase[0]?(e.splice(0,0,i[0]),e):e;for(var n=!1,a=0;r>a;a++)i[a]==t?n=!0:i[a]!=t&&e.splice(0,0,i[a]);return n||e.splice(0,0,t),e}return e.splice(0,0,t),e},i.prototype.onRendererTouchEnd=function(i){if(this.allowMultipleSelection){var r=i.currentTarget,n=this.$ListBase[7];if(r!=n)return;this.setSelectedIndices(this.calculateSelectedIndices(r.itemIndex),!0),t.ItemTapEvent.dispatchItemTapEvent(this,t.ItemTapEvent.ITEM_TAP,r)}else e.prototype.onRendererTouchEnd.call(this,i)},i}(t.ListBase);t.List=e,__reflect(e.prototype,"eui.List")}(eui||(eui={}));var eui;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.closeButton=null,t.moveArea=null,t.titleDisplay=null,t._title="",t.offsetPointX=0,t.offsetPointY=0,t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,t.onWindowTouchBegin,t,!1,100),t}return __extends(i,e),i.prototype.onWindowTouchBegin=function(t){this.$parent.addChild(this)},Object.defineProperty(i.prototype,"elementsContent",{set:function(t){if(t)for(var e=t.length,i=0;e>i;i++)this.addChild(t[i])},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"title",{get:function(){return this._title},set:function(t){this._title=t,this.titleDisplay&&(this.titleDisplay.text=this.title)},enumerable:!0,configurable:!0}),i.prototype.partAdded=function(t,i){e.prototype.partAdded.call(this,t,i),i==this.titleDisplay?this.titleDisplay.text=this._title:i==this.moveArea?this.moveArea.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this):i==this.closeButton&&this.closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onCloseButtonClick,this)},i.prototype.partRemoved=function(t,i){e.prototype.partRemoved.call(this,t,i),i==this.moveArea?this.moveArea.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this):i==this.closeButton&&this.closeButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onCloseButtonClick,this)},i.prototype.onCloseButtonClick=function(e){t.UIEvent.dispatchUIEvent(this,t.UIEvent.CLOSING,!0,!0)&&this.close()},i.prototype.close=function(){this.$parent&&this.$parent.removeChild(this)},i.prototype.onTouchBegin=function(t){this.$includeInLayout=!1,this.offsetPointX=this.x-t.$stageX,this.offsetPointY=this.y-t.$stageY,this.$stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),this.$stage.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this)},i.prototype.onTouchMove=function(t){this.x=t.$stageX+this.offsetPointX,this.y=t.$stageY+this.offsetPointY},i.prototype.onTouchEnd=function(t){var e=t.$currentTarget;e.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),e.removeEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this)},i}(t.Component);t.Panel=e,__reflect(e.prototype,"eui.Panel"),t.registerProperty(e,"elementsContent","Array",!0)}(eui||(eui={}));var eui;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.thumb=null,i.labelDisplay=null,i._labelFunction=null,i._slideDuration=500,i._direction=t.Direction.LTR,i.slideToValue=0,i.animationValue=0,i.thumbInitX=0,i.thumbInitY=0,i.animation=new t.sys.Animation(i.animationUpdateHandler,i),i}return __extends(i,e),Object.defineProperty(i.prototype,"labelFunction",{get:function(){return this._labelFunction},set:function(t){this._labelFunction!=t&&(this._labelFunction=t,this.invalidateDisplayList())},enumerable:!0,configurable:!0}),i.prototype.valueToLabel=function(t,e){return null!=this.labelFunction?this._labelFunction(t,e):t+" / "+e},Object.defineProperty(i.prototype,"slideDuration",{get:function(){return this._slideDuration},set:function(t){t=0|+t,this._slideDuration!==t&&(this._slideDuration=t,this.animation.isPlaying&&(this.animation.stop(),this.setValue(this.slideToValue)))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"direction",{get:function(){return this._direction},set:function(t){this._direction!=t&&(this.thumb&&(this.thumb.x=this.thumbInitX),this.thumb&&(this.thumb.y=this.thumbInitY),this._direction=t,this.invalidateDisplayList())},enumerable:!0,configurable:!0}),i.prototype.$setValue=function(t){if(this.value===t)return!1;var i=this.$Range,r=e.prototype.$setValue.call(this,t);if(this._slideDuration>0&&this.$stage){this.validateProperties();var n=this.animation;if(n.isPlaying&&(this.animationValue=this.slideToValue,this.invalidateDisplayList(),n.stop()),this.slideToValue=this.nearestValidValue(t,i[7]),this.slideToValue===this.animationValue)return r;var a=this._slideDuration*(Math.abs(this.animationValue-this.slideToValue)/(i[0]-i[2]));n.duration=a===1/0?0:a,n.from=this.animationValue,n.to=this.slideToValue,n.play()}else this.animationValue=this.value;return r},i.prototype.animationUpdateHandler=function(t){var e=this.$Range,i=this.nearestValidValue(t.currentValue,e[7]);this.animationValue=Math.min(e[0],Math.max(e[2],i)),this.invalidateDisplayList()},i.prototype.partAdded=function(t,i){e.prototype.partAdded.call(this,t,i),i===this.thumb&&(this.thumb.x&&(this.thumbInitX=this.thumb.x),this.thumb.y&&(this.thumbInitY=this.thumb.y),this.thumb.addEventListener(egret.Event.RESIZE,this.onThumbResize,this))},i.prototype.partRemoved=function(t,i){e.prototype.partRemoved.call(this,t,i),i===this.thumb&&this.thumb.removeEventListener(egret.Event.RESIZE,this.onThumbResize,this)},i.prototype.onThumbResize=function(t){this.updateSkinDisplayList()},i.prototype.updateSkinDisplayList=function(){var e=this.animation.isPlaying?this.animationValue:this.value,i=this.maximum,r=this.thumb;if(r){var n=r.width,a=r.height,o=Math.round(e/i*n);(0>o||o===1/0)&&(o=0);var s=Math.round(e/i*a);(0>s||s===1/0)&&(s=0);var l=r.$scrollRect;l||(l=egret.$TempRectangle),l.setTo(0,0,n,a);var h=r.x-l.x,c=r.y-l.y;switch(this._direction){case t.Direction.LTR:l.width=o,r.x=h;break;case t.Direction.RTL:l.width=o,l.x=n-o,r.x=l.x;break;case t.Direction.TTB:l.height=s,r.y=c;break;case t.Direction.BTT:l.height=s,l.y=a-s,r.y=l.y}r.scrollRect=l}this.labelDisplay&&(this.labelDisplay.text=this.valueToLabel(e,i))},i}(t.Range);t.ProgressBar=e,__reflect(e.prototype,"eui.ProgressBar")}(eui||(eui={}));var eui;!function(t){var e={},i=function(i){function r(){var t=i.call(this)||this;return t.$indexNumber=0,t.$radioButtonGroup=null,t._group=null,t.groupChanged=!1,t._groupName="radioGroup",t._value=null,t.groupName="radioGroup",t}return __extends(r,i),Object.defineProperty(r.prototype,"enabled",{get:function(){return this.$Component[3]?!this.$radioButtonGroup||this.$radioButtonGroup.$enabled:!1},set:function(t){this.$setEnabled(t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"group",{get:function(){if(!this._group&&this._groupName){var i=e[this._groupName];i||(i=new t.RadioButtonGroup,i.$name=this._groupName,e[this._groupName]=i),this._group=i}return this._group},set:function(t){this._group!=t&&(this.$radioButtonGroup&&this.$radioButtonGroup.$removeInstance(this,!1),this._group=t,this._groupName=t?this.group.$name:"radioGroup",this.groupChanged=!0,this.invalidateProperties(),this.invalidateDisplayList())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"groupName",{get:function(){return this._groupName},set:function(t){t&&""!=t&&(this._groupName=t,this.$radioButtonGroup&&this.$radioButtonGroup.$removeInstance(this,!1),this._group=null,this.groupChanged=!0,this.invalidateProperties(),this.invalidateDisplayList())},enumerable:!0,configurable:!0}),r.prototype.$setSelected=function(t){var e=i.prototype.$setSelected.call(this,t);return this.invalidateDisplayList(),e},Object.defineProperty(r.prototype,"value",{get:function(){return this._value},set:function(e){this._value!=e&&(this._value=e,this.$selected&&this.group&&t.PropertyEvent.dispatchPropertyEvent(this.group,t.PropertyEvent.PROPERTY_CHANGE,"selectedValue"))},enumerable:!0,configurable:!0}),r.prototype.commitProperties=function(){this.groupChanged&&(this.addToGroup(),this.groupChanged=!1),i.prototype.commitProperties.call(this)},r.prototype.updateDisplayList=function(t,e){i.prototype.updateDisplayList.call(this,t,e),this.group&&(this.$selected?this._group.$setSelection(this,!1):this.group.selection==this&&this._group.$setSelection(null,!1))},r.prototype.buttonReleased=function(){this.enabled&&!this.selected&&(this.$radioButtonGroup||this.addToGroup(),i.prototype.buttonReleased.call(this),this.group.$setSelection(this,!0))},r.prototype.addToGroup=function(){var t=this.group;return t&&t.$addInstance(this),t},r}(t.ToggleButton);t.RadioButton=i,__reflect(i.prototype,"eui.RadioButton")}(eui||(eui={}));var eui;!function(t){function e(t,i){var r=t.parent,n=i.parent;if(!r||!n)return 0;var a=t.$nestLevel,o=i.$nestLevel,s=0,l=0;return r==n&&(s=r.getChildIndex(t),l=n.getChildIndex(i)),a>o||s>l?1:o>a||l>s?-1:t==i?0:e(r,n)}var i=0,r=function(r){function n(){var t=r.call(this)||this;return t.$name=null,t.radioButtons=[],t.$enabled=!0,t._selectedValue=null,t._selection=null,t.$name="_radioButtonGroup"+i++,t}return __extends(n,r),n.prototype.getRadioButtonAt=function(t){return this.radioButtons[t]},Object.defineProperty(n.prototype,"enabled",{get:function(){return this.$enabled},set:function(t){if(t=!!t,this.$enabled!==t){this.$enabled=t;for(var e=this.radioButtons,i=e.length,r=0;i>r;r++)e[r].invalidateState()}},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"numRadioButtons",{get:function(){return this.radioButtons.length},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"selectedValue",{get:function(){return this.selection?null!=this.selection.value?this.selection.value:this.selection.label:null},set:function(e){if(this._selectedValue=e,null==e)return void this.$setSelection(null,!1);for(var i=this.numRadioButtons,r=0;i>r;r++){var n=this.radioButtons[r];if(n.value==e||n.label==e){this.changeSelection(r,!1),this._selectedValue=null,t.PropertyEvent.dispatchPropertyEvent(this,t.PropertyEvent.PROPERTY_CHANGE,"selectedValue");break}}},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"selection",{get:function(){return this._selection},set:function(t){this._selection!=t&&this.$setSelection(t,!1)},enumerable:!0,configurable:!0}),n.prototype.$addInstance=function(t){t.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.removedHandler,this);var i=this.radioButtons;i.push(t),i.sort(e);for(var r=i.length,n=0;r>n;n++)i[n].$indexNumber=n;this._selectedValue&&(this.selectedValue=this._selectedValue),1==t.selected&&(this.selection=t),t.$radioButtonGroup=this,t.invalidateState()},n.prototype.$removeInstance=function(t,e){if(t)for(var i=!1,r=this.radioButtons,n=r.length,a=0;n>a;a++){var o=r[a];i?o.$indexNumber=o.$indexNumber-1:o==t&&(e&&t.addEventListener(egret.Event.ADDED_TO_STAGE,this.addedHandler,this),t==this._selection&&(this._selection=null),t.$radioButtonGroup=null,t.invalidateState(),this.radioButtons.splice(a,1),i=!0,a--,n--)}},n.prototype.$setSelection=function(e,i){if(this._selection==e)return!1;if(e){for(var r=this.numRadioButtons,n=0;r>n;n++)if(e==this.getRadioButtonAt(n)){this.changeSelection(n,i);break}}else this._selection&&(this._selection.selected=!1,this._selection=null,i&&this.dispatchEventWith(egret.Event.CHANGE));return t.PropertyEvent.dispatchPropertyEvent(this,t.PropertyEvent.PROPERTY_CHANGE,"selectedValue"),!0},n.prototype.changeSelection=function(t,e){var i=this.getRadioButtonAt(t);i&&i!=this._selection&&(this._selection&&(this._selection.selected=!1),this._selection=i,this._selection.selected=!0,e&&this.dispatchEventWith(egret.Event.CHANGE))},n.prototype.addedHandler=function(t){var e=t.target;e==t.currentTarget&&(e.removeEventListener(egret.Event.ADDED_TO_STAGE,this.addedHandler,this),this.$addInstance(e))},n.prototype.removedHandler=function(t){var e=t.target;e==t.currentTarget&&(e.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.removedHandler,this),this.$removeInstance(e,!0))},n}(egret.EventDispatcher);t.RadioButtonGroup=r,__reflect(r.prototype,"eui.RadioButtonGroup"),t.registerBindable(r.prototype,"selectedValue")}(eui||(eui={}));var eui;!function(t){var e=function(t){function e(e,i,r){var n=t.call(this)||this;return n.$fillColor=0,n.$fillAlpha=1,n.$strokeColor=4473924,n.$strokeAlpha=1,n.$strokeWeight=0,n.$ellipseWidth=0,n.$ellipseHeight=0,n.touchChildren=!1,n.$graphics=new egret.Graphics,n.$graphics.$setTarget(n),n.width=e,n.height=i,n.fillColor=r,n}return __extends(e,t),e.prototype.createNativeDisplayObject=function(){this.$nativeDisplayObject=new egret_native.NativeDisplayObject(8)},Object.defineProperty(e.prototype,"graphics",{get:function(){return this.$graphics},enumerable:!0,configurable:!0}),e.prototype.$measureContentBounds=function(t){this.$graphics&&t.setTo(0,0,this.width,this.height)},Object.defineProperty(e.prototype,"fillColor",{get:function(){return this.$fillColor},set:function(t){void 0!=t&&this.$fillColor!=t&&(this.$fillColor=t,this.invalidateDisplayList())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fillAlpha",{get:function(){return this.$fillAlpha},set:function(t){this.$fillAlpha!=t&&(this.$fillAlpha=t,this.invalidateDisplayList())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"strokeColor",{get:function(){return this.$strokeColor},set:function(t){this.$strokeColor!=t&&(this.$strokeColor=t,this.invalidateDisplayList())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"strokeAlpha",{get:function(){return this.$strokeAlpha},set:function(t){this.$strokeAlpha!=t&&(this.$strokeAlpha=t,this.invalidateDisplayList())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"strokeWeight",{get:function(){return this.$strokeWeight},set:function(t){this.$strokeWeight!=t&&(this.$strokeWeight=t,this.invalidateDisplayList())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ellipseWidth",{get:function(){return this.$ellipseWidth},set:function(t){this.$ellipseWidth!=t&&(this.$ellipseWidth=t,this.invalidateDisplayList())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ellipseHeight",{get:function(){return this.$ellipseHeight},set:function(t){this.$ellipseHeight!=t&&(this.$ellipseHeight=t,this.invalidateDisplayList())},enumerable:!0,configurable:!0}),e.prototype.updateDisplayList=function(t,e){var i=this.graphics;i.clear(),this.$strokeWeight>0&&(i.beginFill(this.$fillColor,0),i.lineStyle(this.$strokeWeight,this.$strokeColor,this.$strokeAlpha,!0,"normal","square","miter"),0==this.$ellipseWidth&&0==this.$ellipseHeight?i.drawRect(this.$strokeWeight/2,this.$strokeWeight/2,t-this.$strokeWeight,e-this.$strokeWeight):i.drawRoundRect(this.$strokeWeight/2,this.$strokeWeight/2,t-this.$strokeWeight,e-this.$strokeWeight,this.$ellipseWidth,this.$ellipseHeight),i.endFill()),i.beginFill(this.$fillColor,this.$fillAlpha),i.lineStyle(this.$strokeWeight,this.$strokeColor,0,!0,"normal","square","miter"),0==this.$ellipseWidth&&0==this.$ellipseHeight?i.drawRect(this.$strokeWeight,this.$strokeWeight,t-2*this.$strokeWeight,e-2*this.$strokeWeight):i.drawRoundRect(this.$strokeWeight,this.$strokeWeight,t-2*this.$strokeWeight,e-2*this.$strokeWeight,this.$ellipseWidth,this.$ellipseHeight),i.endFill()},e.prototype.$onRemoveFromStage=function(){t.prototype.$onRemoveFromStage.call(this),this.$graphics&&this.$graphics.$onRemoveFromStage()},e}(t.Component);t.Rect=e,__reflect(e.prototype,"eui.Rect")}(eui||(eui={}));var eui;!function(t){var e,i=function(i){function r(){var e=i.call(this)||this;e.$bounces=!0,e.horizontalScrollBar=null,e.verticalScrollBar=null;var r=new t.sys.TouchScroll(e.horizontalUpdateHandler,e.horizontalEndHandler,e),n=new t.sys.TouchScroll(e.verticalUpdateHandler,e.verticalEndHanlder,e);return e.$Scroller={0:"auto",1:"auto",2:null,3:0,4:0,5:!1,6:!1,7:!1,8:r,9:n,10:null,11:!1,12:!1},e}return __extends(r,i),Object.defineProperty(r.prototype,"bounces",{get:function(){return this.$bounces},set:function(t){this.$bounces=!!t;var e=this.$Scroller[8];e&&(e.$bounces=this.$bounces);var i=this.$Scroller[9];i&&(i.$bounces=this.$bounces)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"throwSpeed",{get:function(){return this.$Scroller[8].$scrollFactor},set:function(t){t=+t,0>t&&(t=0),this.$Scroller[8].$scrollFactor=t,this.$Scroller[9].$scrollFactor=t},enumerable:!0,configurable:!0}),r.prototype.$getThrowInfo=function(i,r){return e?(e.currentPos=i,e.toPos=r):e=new t.ScrollerThrowEvent(t.ScrollerThrowEvent.THROW,!1,!1,i,r),e},Object.defineProperty(r.prototype,"scrollPolicyV",{get:function(){return this.$Scroller[0]},set:function(t){var e=this.$Scroller;e[0]!=t&&(e[0]=t,this.checkScrollPolicy())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"scrollPolicyH",{get:function(){return this.$Scroller[1]},set:function(t){var e=this.$Scroller;e[1]!=t&&(e[1]=t,this.checkScrollPolicy())},enumerable:!0,configurable:!0}),r.prototype.stopAnimation=function(){var e=this.$Scroller,i=e[9],r=e[8];i.animation.isPlaying?t.UIEvent.dispatchUIEvent(this,t.UIEvent.CHANGE_END):r.animation.isPlaying&&t.UIEvent.dispatchUIEvent(this,t.UIEvent.CHANGE_END),i.stop(),r.stop();var n=this.verticalScrollBar,a=this.horizontalScrollBar;n&&n.autoVisibility&&(n.visible=!1),a&&a.autoVisibility&&(a.visible=!1)},Object.defineProperty(r.prototype,"viewport",{get:function(){return this.$Scroller[10]},set:function(t){var e=this.$Scroller;t!=e[10]&&(this.uninstallViewport(),e[10]=t,e[11]=!1,this.installViewport())},enumerable:!0,configurable:!0}),r.prototype.installViewport=function(){var t=this.viewport;t&&(this.addChildAt(t,0),t.scrollEnabled=!0,t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBeginCapture,this,!0),t.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEndCapture,this,!0),t.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTapCapture,this,!0),t.addEventListener(egret.Event.REMOVED,this.onViewPortRemove,this)),this.horizontalScrollBar&&(this.horizontalScrollBar.viewport=t),this.verticalScrollBar&&(this.verticalScrollBar.viewport=t)},r.prototype.uninstallViewport=function(){this.horizontalScrollBar&&(this.horizontalScrollBar.viewport=null),this.verticalScrollBar&&(this.verticalScrollBar.viewport=null);var t=this.viewport;t&&(t.scrollEnabled=!1,t.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBeginCapture,this,!0),t.removeEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEndCapture,this,!0),t.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchTapCapture,this,!0),t.removeEventListener(egret.Event.REMOVED,this.onViewPortRemove,this),0==this.$Scroller[11]&&this.removeChild(t))},r.prototype.onViewPortRemove=function(t){t.target==this.viewport&&(this.$Scroller[11]=!0,this.viewport=null)},r.prototype.setSkin=function(t){i.prototype.setSkin.call(this,t);var e=this.viewport;e&&this.addChildAt(e,0)
},r.prototype.onTouchBeginCapture=function(t){if(this.$stage){this.$Scroller[12]=!1;var e=this.checkScrollPolicy();e&&this.onTouchBegin(t)}},r.prototype.onTouchEndCapture=function(t){this.$Scroller[12]&&(t.$bubbles=!1,this.dispatchBubbleEvent(t),t.$bubbles=!0,t.stopPropagation(),this.onTouchEnd(t))},r.prototype.onTouchTapCapture=function(t){this.$Scroller[12]&&(t.$bubbles=!1,this.dispatchBubbleEvent(t),t.$bubbles=!0,t.stopPropagation())},r.prototype.checkScrollPolicy=function(){var t=this.$Scroller,e=t[10];if(!e)return!1;var i,r=e.$UIComponent;switch(t[1]){case"auto":i=e.contentWidth>r[10]||0!==e.scrollH?!0:!1;break;case"on":i=!0;break;case"off":i=!1}t[6]=i;var n;switch(t[0]){case"auto":n=e.contentHeight>r[11]||0!==e.scrollV?!0:!1;break;case"on":n=!0;break;case"off":n=!1}return t[7]=n,i||n},r.prototype.onTouchBegin=function(t){if(!t.isDefaultPrevented()&&this.checkScrollPolicy()){this.downTarget=t.target;var e=this.$Scroller;this.stopAnimation(),e[3]=t.$stageX,e[4]=t.$stageY,e[6]&&e[8].start(t.$stageX),e[7]&&e[9].start(t.$stageY);var i=this.$stage;this.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),i.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this,!0),this.addEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onTouchCancel,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveListeners,this),this.tempStage=i}},r.prototype.onTouchMove=function(e){if(!e.isDefaultPrevented()){var i=this.$Scroller;if(!i[5]){var n=void 0;n=Math.abs(i[3]-e.$stageX)<r.scrollThreshold?!1:!0;var a=void 0;if(a=Math.abs(i[4]-e.$stageY)<r.scrollThreshold?!1:!0,!n&&!a)return;if(!a&&n&&"off"==i[1])return;if(!n&&a&&"off"==i[0])return;i[12]=!0,i[5]=!0,this.dispatchCancelEvent(e);var o=this.horizontalScrollBar,s=this.verticalScrollBar;o&&o.autoVisibility&&i[6]&&(o.visible=!0),s&&s.autoVisibility&&i[7]&&(s.visible=!0),i[2]&&i[2].reset(),t.UIEvent.dispatchUIEvent(this,t.UIEvent.CHANGE_START),this.$stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this)}e.preventDefault();var l=i[10],h=l.$UIComponent;i[6]&&i[8].update(e.$stageX,l.contentWidth-h[10],l.scrollH),i[7]&&i[9].update(e.$stageY,l.contentHeight-h[11],l.scrollV)}},r.prototype.onTouchCancel=function(t){this.$Scroller[5]||this.onRemoveListeners()},r.prototype.dispatchBubbleEvent=function(t){var e=this.$Scroller[10];if(e){var i=egret.Event.create(egret.TouchEvent,t.type,t.bubbles,t.cancelable);i.$initTo(t.$stageX,t.$stageY,t.touchPointID);var r=this.downTarget;i.$setTarget(r);for(var n=this.$getPropagationList(r),a=n.length,o=.5*n.length,s=-1,l=0;a>l;l++)if(n[l]===e){s=l;break}n.splice(0,n.length-s+1),o=0,this.$dispatchPropagationEvent(i,n,o),egret.Event.release(i)}},r.prototype.dispatchCancelEvent=function(t){var e=this.$Scroller[10];if(e){var i=egret.Event.create(egret.TouchEvent,egret.TouchEvent.TOUCH_CANCEL,t.bubbles,t.cancelable);i.$initTo(t.$stageX,t.$stageY,t.touchPointID);var r=this.downTarget;i.$setTarget(r);for(var n=this.$getPropagationList(r),a=n.length,o=.5*n.length,s=-1,l=0;a>l;l++)if(n[l]===e){s=l;break}n.splice(0,s+1-2),n.splice(n.length-1-s+2,s+1-2),o-=s+1,this.$dispatchPropagationEvent(i,n,o),egret.Event.release(i)}},r.prototype.onTouchEnd=function(t){var e=this.$Scroller;e[5]=!1,this.onRemoveListeners();var i=e[10],r=i.$UIComponent;e[8].isStarted()&&e[8].finish(i.scrollH,i.contentWidth-r[10]),e[9].isStarted()&&e[9].finish(i.scrollV,i.contentHeight-r[11])},r.prototype.onRemoveListeners=function(){var t=this.tempStage||this.$stage;this.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),t.removeEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this,!0),t.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),this.removeEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onTouchCancel,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveListeners,this)},r.prototype.horizontalUpdateHandler=function(t){var e=this.$Scroller[10];e&&(e.scrollH=t),this.dispatchEventWith(egret.Event.CHANGE)},r.prototype.verticalUpdateHandler=function(t){var e=this.$Scroller[10];e&&(e.scrollV=t),this.dispatchEventWith(egret.Event.CHANGE)},r.prototype.horizontalEndHandler=function(){this.$Scroller[9].isPlaying()||this.onChangeEnd()},r.prototype.verticalEndHanlder=function(){this.$Scroller[8].isPlaying()||this.onChangeEnd()},r.prototype.onChangeEnd=function(){var e=this.$Scroller,i=this.horizontalScrollBar,r=this.verticalScrollBar;(i&&i.visible||r&&r.visible)&&(e[2]||(e[2]=new egret.Timer(200,1),e[2].addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.onAutoHideTimer,this)),e[2].reset(),e[2].start()),t.UIEvent.dispatchUIEvent(this,t.UIEvent.CHANGE_END)},r.prototype.onAutoHideTimer=function(t){var e=this.horizontalScrollBar,i=this.verticalScrollBar;e&&e.autoVisibility&&(e.visible=!1),i&&i.autoVisibility&&(i.visible=!1)},r.prototype.updateDisplayList=function(t,e){i.prototype.updateDisplayList.call(this,t,e);var r=this.viewport;r&&(r.setLayoutBoundsSize(t,e),r.setLayoutBoundsPosition(0,0))},r.prototype.partAdded=function(t,e){i.prototype.partAdded.call(this,t,e),e==this.horizontalScrollBar?(this.horizontalScrollBar.touchChildren=!1,this.horizontalScrollBar.touchEnabled=!1,this.horizontalScrollBar.viewport=this.viewport,this.horizontalScrollBar.autoVisibility&&(this.horizontalScrollBar.visible=!1)):e==this.verticalScrollBar&&(this.verticalScrollBar.touchChildren=!1,this.verticalScrollBar.touchEnabled=!1,this.verticalScrollBar.viewport=this.viewport,this.verticalScrollBar.autoVisibility&&(this.verticalScrollBar.visible=!1))},r.scrollThreshold=5,r}(t.Component);t.Scroller=i,__reflect(i.prototype,"eui.Scroller"),t.registerProperty(i,"viewport","eui.IViewport",!0)}(eui||(eui={}));var eui;!function(t){var e=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.maxWidth=1e5,i.minWidth=0,i.maxHeight=1e5,i.minHeight=0,i.width=0/0,i.height=0/0,i.$elementsContent=[],i._hostComponent=null,i.$stateValues=new t.sys.StateValues,i}return __extends(i,e),Object.defineProperty(i.prototype,"elementsContent",{set:function(t){this.$elementsContent=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"hostComponent",{get:function(){return this._hostComponent},set:function(e){if(this._hostComponent!=e){this._hostComponent&&this._hostComponent.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onAddedToStage,this),this._hostComponent=e;var i=this.$stateValues;i.parent=e,e&&(this.commitCurrentState(),this.$stateValues.intialized||(e.$stage?this.initializeStates(e.$stage):e.once(egret.Event.ADDED_TO_STAGE,this.onAddedToStage,this))),t.PropertyEvent.dispatchPropertyEvent(this,t.PropertyEvent.PROPERTY_CHANGE,"hostComponent")}},enumerable:!0,configurable:!0}),i.prototype.onAddedToStage=function(t){this.initializeStates(this._hostComponent.$stage)},i}(egret.EventDispatcher);t.Skin=e,__reflect(e.prototype,"eui.Skin"),t.sys.mixin(e,t.sys.StateClient),t.registerProperty(e,"elementsContent","Array",!0),t.registerProperty(e,"states","State[]"),t.registerBindable(e.prototype,"hostComponent")}(eui||(eui={}));var eui;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.indexBeingUpdated=!1,t.requireSelection=!0,t.useVirtualLayout=!1,t}return __extends(i,e),i.prototype.createChildren=function(){if(!this.$layout){var i=new t.HorizontalLayout;i.gap=0,i.horizontalAlign=t.JustifyAlign.JUSTIFY,i.verticalAlign=t.JustifyAlign.CONTENT_JUSTIFY,this.$setLayout(i)}e.prototype.createChildren.call(this)},i.prototype.$setDataProvider=function(i){var r=this.$dataProvider;return r&&r instanceof t.ViewStack&&(r.removeEventListener(t.PropertyEvent.PROPERTY_CHANGE,this.onViewStackIndexChange,this),this.removeEventListener(egret.Event.CHANGE,this.onIndexChanged,this)),i&&i instanceof t.ViewStack&&(i.addEventListener(t.PropertyEvent.PROPERTY_CHANGE,this.onViewStackIndexChange,this),this.addEventListener(egret.Event.CHANGE,this.onIndexChanged,this)),e.prototype.$setDataProvider.call(this,i)},i.prototype.onIndexChanged=function(t){this.indexBeingUpdated=!0,this.$dataProvider.selectedIndex=this.selectedIndex,this.indexBeingUpdated=!1},i.prototype.onViewStackIndexChange=function(t){"selectedIndex"!=t.property||this.indexBeingUpdated||this.setSelectedIndex(this.$dataProvider.selectedIndex,!1)},i}(t.ListBase);t.TabBar=e,__reflect(e.prototype,"eui.TabBar")}(eui||(eui={}));var eui;!function(t){var e=egret.FocusEvent,i=function(i){function r(){var t=i.call(this)||this;return t.isFocus=!1,t.$TextInput={0:null,1:null,2:null,3:null,4:null,5:null,6:"",7:null,8:egret.TextFieldInputType.TEXT},t}return __extends(r,i),Object.defineProperty(r.prototype,"prompt",{get:function(){return this.promptDisplay?this.promptDisplay.text:this.$TextInput[0]},set:function(t){this.$TextInput[0]=t,this.promptDisplay&&(this.promptDisplay.text=t),this.invalidateProperties(),this.invalidateState()},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"displayAsPassword",{get:function(){if(this.textDisplay)return this.textDisplay.displayAsPassword;var t=this.$TextInput[1];return t?t:!1},set:function(t){this.$TextInput[1]=t,this.textDisplay&&(this.textDisplay.displayAsPassword=t),this.invalidateProperties()},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"inputType",{get:function(){return this.textDisplay?this.textDisplay.inputType:this.$TextInput[8]},set:function(t){this.$TextInput[8]=t,this.textDisplay&&(this.textDisplay.inputType=t),this.invalidateProperties()},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"textColor",{get:function(){return this.textDisplay?this.textDisplay.textColor:this.$TextInput[2]},set:function(t){this.$TextInput[2]=t,this.textDisplay&&(this.textDisplay.textColor=t),this.invalidateProperties()},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"maxChars",{get:function(){if(this.textDisplay)return this.textDisplay.maxChars;var t=this.$TextInput[3];return t?t:0},set:function(t){this.$TextInput[3]=t,this.textDisplay&&(this.textDisplay.maxChars=t),this.invalidateProperties()},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"maxWidth",{get:function(){if(this.textDisplay)return this.textDisplay.maxWidth;var t=this.$TextInput[4];return t?t:1e5},set:function(t){this.$TextInput[4]=t,this.textDisplay&&(this.textDisplay.maxWidth=t),this.invalidateProperties()},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"maxHeight",{get:function(){this.textDisplay;var t=this.$TextInput[5];return t?t:1e5},set:function(t){this.$TextInput[5]=t,this.textDisplay&&(this.textDisplay.maxHeight=t),this.invalidateProperties()},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"text",{get:function(){return this.textDisplay?this.textDisplay.text:this.$TextInput[6]},set:function(t){this.$TextInput[6]=t,this.textDisplay&&(this.textDisplay.text=t),this.invalidateProperties(),this.invalidateState()},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"restrict",{get:function(){return this.textDisplay?this.textDisplay.restrict:this.$TextInput[7]},set:function(t){this.$TextInput[7]=t,this.textDisplay&&(this.textDisplay.restrict=t),this.invalidateProperties()},enumerable:!0,configurable:!0}),r.prototype.focusInHandler=function(t){this.isFocus=!0,this.invalidateState()},r.prototype.focusOutHandler=function(t){this.isFocus=!1,this.invalidateState()},r.prototype.getCurrentState=function(){var t=this.skin;return!this.prompt||this.isFocus||this.text?this.enabled?"normal":"disabled":this.enabled&&t.hasState("normalWithPrompt")?"normalWithPrompt":!this.enabled&&t.hasState("disabledWithPrompt")?"disabledWithPrompt":void 0},r.prototype.partAdded=function(r,n){i.prototype.partAdded.call(this,r,n);var a=this.$TextInput;n==this.textDisplay?(this.textDisplayAdded(),this.textDisplay instanceof t.EditableText&&(this.textDisplay.addEventListener(e.FOCUS_IN,this.focusInHandler,this),this.textDisplay.addEventListener(e.FOCUS_OUT,this.focusOutHandler,this))):n==this.promptDisplay&&a[0]&&(this.promptDisplay.text=a[0])},r.prototype.partRemoved=function(r,n){i.prototype.partRemoved.call(this,r,n),n==this.textDisplay?(this.textDisplayRemoved(),this.textDisplay instanceof t.EditableText&&(this.textDisplay.removeEventListener(e.FOCUS_IN,this.focusInHandler,this),this.textDisplay.removeEventListener(e.FOCUS_OUT,this.focusOutHandler,this))):n==this.promptDisplay&&(this.$TextInput[0]=this.promptDisplay.text)},r.prototype.textDisplayAdded=function(){var t=this.$TextInput;t[1]&&(this.textDisplay.displayAsPassword=t[1]),t[2]&&(this.textDisplay.textColor=t[2]),t[3]&&(this.textDisplay.maxChars=t[3]),t[4]&&(this.textDisplay.maxWidth=t[4]),t[5]&&(this.textDisplay.maxHeight=t[5]),t[6]&&(this.textDisplay.text=t[6]),t[7]&&(this.textDisplay.restrict=t[7]),t[8]&&(this.textDisplay.inputType=t[8])},r.prototype.textDisplayRemoved=function(){var t=this.$TextInput;t[1]=this.textDisplay.displayAsPassword,t[2]=this.textDisplay.textColor,t[3]=this.textDisplay.maxChars,t[4]=this.textDisplay.maxWidth,t[5]=this.textDisplay.maxHeight,t[6]=this.textDisplay.text,t[7]=this.textDisplay.restrict,t[8]=this.textDisplay.inputType},r}(t.Component);t.TextInput=i,__reflect(i.prototype,"eui.TextInput")}(eui||(eui={}));var eui;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(t.ToggleButton);t.CheckBox=e,__reflect(e.prototype,"eui.CheckBox")}(eui||(eui={}));var eui;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(t.ToggleButton);t.ToggleSwitch=e,__reflect(e.prototype,"eui.ToggleSwitch")}(eui||(eui={}));var eui;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e.addEventListener(egret.Event.REMOVED_FROM_STAGE,e.onRemoveFromStage,e),e}return __extends(e,t),e.prototype.onAddToStage=function(t){this.$stage.addEventListener(egret.Event.RESIZE,this.onResize,this),this.onResize()},e.prototype.onRemoveFromStage=function(t){this.$stage.removeEventListener(egret.Event.RESIZE,this.onResize,this)},e.prototype.onResize=function(t){var e=this.$stage;this.$setWidth(e.$stageWidth),this.$setHeight(e.$stageHeight)},e}(t.Group);t.UILayer=e,__reflect(e.prototype,"eui.UILayer")}(eui||(eui={}));var eui;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.updateDisplayList=function(e,i){t.prototype.updateDisplayList.call(this,e,i);var r=this.thumb,n=this.$viewport;if(r&&n){var a=egret.$TempRectangle;r.getPreferredBounds(a);var o=a.height,s=a.x,l=n.scrollV,h=n.contentHeight,c=n.height;if(0>=l){var u=o*(1- -l/(.5*c));u=Math.max(5,Math.round(u)),r.setLayoutBoundsSize(0/0,u),r.setLayoutBoundsPosition(s,0)}else if(l>=h-c){var u=o*(1-(l-h+c)/(.5*c));u=Math.max(5,Math.round(u)),r.setLayoutBoundsSize(0/0,u),r.setLayoutBoundsPosition(s,i-u)}else{var p=(i-o)*l/(h-c);r.setLayoutBoundsSize(0/0,0/0),r.setLayoutBoundsPosition(s,p)}}},e.prototype.onPropertyChanged=function(t){switch(t.property){case"scrollV":case"contentHeight":this.invalidateDisplayList()}},e}(t.ScrollBarBase);t.VScrollBar=e,__reflect(e.prototype,"eui.VScrollBar")}(eui||(eui={}));var eui;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.pointToValue=function(t,e){if(!this.thumb||!this.track)return 0;var i=this.$Range,r=i[0]-i[2],n=this.getThumbRange();return i[2]+(0!=n?(n-e)/n*r:0)},e.prototype.getThumbRange=function(){var t=egret.$TempRectangle;this.track.getLayoutBounds(t);var e=t.height;return this.thumb.getLayoutBounds(t),e-t.height},e.prototype.updateSkinDisplayList=function(){if(this.thumb&&this.track){var t=this.$Range,e=this.getThumbRange(),i=t[0]-t[2],r=i>0?e-(this.pendingValue-t[2])/i*e:0,n=this.track.localToGlobal(0,r,egret.$TempPoint),a=n.x,o=n.y,s=this.thumb.$parent.globalToLocal(a,o,egret.$TempPoint).y,l=egret.$TempRectangle,h=l.height;if(this.thumb.getLayoutBounds(l),this.thumb.setLayoutBoundsPosition(l.x,Math.round(s)),this.trackHighlight){var c=this.trackHighlight.$parent.globalToLocal(a,o,egret.$TempPoint).y;this.trackHighlight.y=Math.round(c+h),this.trackHighlight.height=Math.round(e-c)}}},e}(t.SliderBase);t.VSlider=e,__reflect(e.prototype,"eui.VSlider")}(eui||(eui={}));var eui;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i._selectedChild=null,i.proposedSelectedIndex=t.ListBase.NO_PROPOSED_SELECTION,i._selectedIndex=-1,i}return __extends(i,e),Object.defineProperty(i.prototype,"layout",{get:function(){return this.$layout},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"selectedChild",{get:function(){var t=this.selectedIndex;return t>=0&&t<this.numChildren?this.getChildAt(t):null},set:function(t){var e=this.getChildIndex(t);e>=0&&e<this.numChildren&&this.setSelectedIndex(e)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"selectedIndex",{get:function(){return this.proposedSelectedIndex!=t.ListBase.NO_PROPOSED_SELECTION?this.proposedSelectedIndex:this._selectedIndex},set:function(t){t=0|+t,this.setSelectedIndex(t)},enumerable:!0,configurable:!0}),i.prototype.setSelectedIndex=function(e){e!=this.selectedIndex&&(this.proposedSelectedIndex=e,this.invalidateProperties(),t.PropertyEvent.dispatchPropertyEvent(this,t.PropertyEvent.PROPERTY_CHANGE,"selectedIndex"))},i.prototype.$childAdded=function(i,r){e.prototype.$childAdded.call(this,i,r),this.showOrHide(i,!1);var n=this.selectedIndex;-1==n?this.setSelectedIndex(r):r<=this.selectedIndex&&this.$stage&&this.setSelectedIndex(n+1),t.CollectionEvent.dispatchCollectionEvent(this,t.CollectionEvent.COLLECTION_CHANGE,t.CollectionEventKind.ADD,r,-1,[i.name])},i.prototype.$childRemoved=function(i,r){e.prototype.$childRemoved.call(this,i,r),this.showOrHide(i,!0);var n=this.selectedIndex;r==n?this.numChildren>0?0==r?(this.proposedSelectedIndex=0,this.invalidateProperties()):this.setSelectedIndex(0):this.setSelectedIndex(-1):n>r&&this.setSelectedIndex(n-1),t.CollectionEvent.dispatchCollectionEvent(this,t.CollectionEvent.COLLECTION_CHANGE,t.CollectionEventKind.REMOVE,r,-1,[i.name])},i.prototype.commitProperties=function(){e.prototype.commitProperties.call(this),this.proposedSelectedIndex!=t.ListBase.NO_PROPOSED_SELECTION&&(this.commitSelection(this.proposedSelectedIndex),this.proposedSelectedIndex=t.ListBase.NO_PROPOSED_SELECTION)},i.prototype.commitSelection=function(t){t>=0&&t<this.numChildren?(this._selectedIndex=t,this._selectedChild&&this.showOrHide(this._selectedChild,!1),this._selectedChild=this.getElementAt(this._selectedIndex),this.showOrHide(this._selectedChild,!0)):(this._selectedChild=null,this._selectedIndex=-1),this.invalidateSize(),this.invalidateDisplayList()},i.prototype.showOrHide=function(t,e){egret.is(t,"eui.UIComponent")&&(t.includeInLayout=e),t.visible=e},Object.defineProperty(i.prototype,"length",{get:function(){return this.$children.length},enumerable:!0,configurable:!0}),i.prototype.getItemAt=function(t){var e=this.$children[t];return e?e.name:""},i.prototype.getItemIndex=function(t){for(var e=this.$children,i=e.length,r=0;i>r;r++)if(e[r].name==t)return r;return-1},i}(t.Group);t.ViewStack=e,__reflect(e.prototype,"eui.ViewStack",["eui.ICollection","egret.IEventDispatcher"]),t.registerBindable(e.prototype,"selectedIndex")}(eui||(eui={}));var eui;!function(t){var e;!function(t){function e(t){return-.5*(Math.cos(Math.PI*t)-1)}var i=function(){function t(t,i){this.easerFunction=e,this.isPlaying=!1,this.duration=500,this.currentValue=0,this.from=0,this.to=0,this.startTime=0,this.endFunction=null,this.updateFunction=t,this.thisObject=i}return t.prototype.play=function(){this.stop(),this.start()},t.prototype.start=function(){this.isPlaying=!1,this.currentValue=0,this.startTime=egret.getTimer(),this.doInterval(this.startTime),egret.startTick(this.doInterval,this)},t.prototype.stop=function(){this.isPlaying=!1,this.startTime=0,egret.stopTick(this.doInterval,this)},t.prototype.doInterval=function(t){var e=t-this.startTime;this.isPlaying||(this.isPlaying=!0);var i=this.duration,r=0==i?1:Math.min(e,i)/i;this.easerFunction&&(r=this.easerFunction(r)),this.currentValue=this.from+(this.to-this.from)*r,this.updateFunction&&this.updateFunction.call(this.thisObject,this);var n=e>=i;return n&&this.stop(),n&&this.endFunction&&this.endFunction.call(this.thisObject,this),!0},t}();t.Animation=i,__reflect(i.prototype,"eui.sys.Animation")}(e=t.sys||(t.sys={}))}(eui||(eui={}));var eui;!function(t){var e=function(){function t(){}return t.prototype.getTheme=function(t,e,i,r){function n(t){var i=t.target;e.call(r,i.response)}function a(t){i.call(r)}var o=new egret.HttpRequest;o.addEventListener(egret.Event.COMPLETE,n,r),o.addEventListener(egret.IOErrorEvent.IO_ERROR,a,r),o.responseType=egret.HttpResponseType.TEXT,o.open(t),o.send()},t}();t.DefaultThemeAdapter=e,__reflect(e.prototype,"eui.DefaultThemeAdapter",["eui.IThemeAdapter"])}(eui||(eui={}));var eui;!function(t){function e(t,i){var r=Object.getOwnPropertyDescriptor(t,i);if(r)return r;var n=Object.getPrototypeOf(t);return n?e(n,i):null}function i(t,e){for(var i=t[r],n=i.length,a=0;n>a;a+=2){var o=i[a],s=i[a+1];o.call(s,e)}}var r="__listeners__",n="__bindables__",a=0,o=function(){function o(t,e,i,r){this.isExecuting=!1,this.property=t,this.handler=e,this.next=r,this.thisObject=i}return o.watch=function(t,e,i,r){if(e.length>0){var n=e.shift(),a=o.watch(null,e,i,r),s=new o(n,i,r,a);return s.reset(t),s}return null},o.checkBindable=function(o,s){var l=o[n];if(l&&-1!=l.indexOf(s))return!0;var h=egret.is(o,"egret.IEventDispatcher");h||o[r]||(o[r]=[]);var c=e(o,s);if(c&&c.set&&c.get){var u=c.set;c.set=function(e){this[s]!=e&&(u.call(this,e),h?t.PropertyEvent.dispatchPropertyEvent(this,t.PropertyEvent.PROPERTY_CHANGE,s):i(this,s))}}else{if(c&&(c.get||c.set))return!1;a++;var p="_"+a+s;o[p]=c?c.value:null,c={enumerable:!0,configurable:!0},c.get=function(){return this[p]},c.set=function(e){this[p]!=e&&(this[p]=e,h?t.PropertyEvent.dispatchPropertyEvent(this,t.PropertyEvent.PROPERTY_CHANGE,s):i(this,s))}}Object.defineProperty(o,s,c),t.registerBindable(o,s)},o.prototype.unwatch=function(){this.reset(null),this.handler=null,this.next&&(this.next.handler=null)},o.prototype.getValue=function(){return this.next?this.next.getValue():this.getHostPropertyValue()},o.prototype.setHandler=function(t,e){this.handler=t,this.thisObject=e,this.next&&this.next.setHandler(t,e)},o.prototype.reset=function(e){var i=this.host;if(i)if(egret.is(i,"egret.IEventDispatcher"))i.removeEventListener(t.PropertyEvent.PROPERTY_CHANGE,this.wrapHandler,this);else{var n=i[r],a=n.indexOf(this);n.splice(a-1,2)}if(this.host=e,e)if(o.checkBindable(e,this.property),egret.is(e,"egret.IEventDispatcher"))e.addEventListener(t.PropertyEvent.PROPERTY_CHANGE,this.wrapHandler,this,!1,100);else{var n=e[r];n.push(this.onPropertyChange),n.push(this)}this.next&&this.next.reset(this.getHostPropertyValue())},o.prototype.getHostPropertyValue=function(){return this.host?this.host[this.property]:null},o.prototype.wrapHandler=function(t){this.onPropertyChange(t.property)},o.prototype.onPropertyChange=function(t){if(t==this.property&&!this.isExecuting)try{this.isExecuting=!0,this.next&&this.next.reset(this.getHostPropertyValue()),this.handler.call(this.thisObject,this.getValue())}finally{this.isExecuting=!1}},o}();t.Watcher=o,__reflect(o.prototype,"eui.Watcher")}(eui||(eui={}));var eui;!function(t){function e(e){for(var i=e[0],r=i instanceof t.Watcher?i.getValue():i,n=e.length,a=1;n>a;a++){var o=e[a];o instanceof t.Watcher&&(o=o.getValue()),r+=o}return r}var i=function(){function i(){}return i.bindProperty=function(e,i,r,n){var a=t.Watcher.watch(e,i,null,null);if(a){var o=function(t){r[n]=t};a.setHandler(o,null),o(a.getValue())}return a},i.bindHandler=function(e,i,r,n){var a=t.Watcher.watch(e,i,r,n);return a&&r.call(n,a.getValue()),a},i.$bindProperties=function(r,n,a,o,s){if(1==n.length&&1==a.length)return i.bindProperty(r,n[0].split("."),o,s);for(var l,h=function(){o[s]=e(n)},c=a.length,u=0;c>u;u++){var p=a[u],d=n[p].split(".");l=t.Watcher.watch(r,d,null,null),l&&(n[p]=l,l.setHandler(h,null))}return h(),l},i}();t.Binding=i,__reflect(i.prototype,"eui.Binding")}(eui||(eui={}));var eui;!function(t){var e=function(e){function i(t){var i=e.call(this)||this;return t?i._source=t:i._source=[],i}return __extends(i,e),Object.defineProperty(i.prototype,"source",{get:function(){return this._source},set:function(e){e||(e=[]),this._source=e,this.dispatchCoEvent(t.CollectionEventKind.RESET)},enumerable:!0,configurable:!0}),i.prototype.refresh=function(){this.dispatchCoEvent(t.CollectionEventKind.REFRESH)},Object.defineProperty(i.prototype,"length",{get:function(){return this._source.length},enumerable:!0,configurable:!0}),i.prototype.addItem=function(e){this._source.push(e),this.dispatchCoEvent(t.CollectionEventKind.ADD,this._source.length-1,-1,[e])},i.prototype.addItemAt=function(e,i){0>i||i>this._source.length,this._source.splice(i,0,e),this.dispatchCoEvent(t.CollectionEventKind.ADD,i,-1,[e])},i.prototype.getItemAt=function(t){return this._source[t]},i.prototype.getItemIndex=function(t){for(var e=this._source.length,i=0;e>i;i++)if(this._source[i]===t)return i;return-1},i.prototype.itemUpdated=function(e){var i=this.getItemIndex(e);-1!=i&&this.dispatchCoEvent(t.CollectionEventKind.UPDATE,i,-1,[e])},i.prototype.removeAll=function(){var e=this._source.concat();this._source=[],this.dispatchCoEvent(t.CollectionEventKind.REMOVE,0,-1,e)},i.prototype.removeItemAt=function(e){if(!(0>e||e>=this._source.length)){var i=this._source.splice(e,1)[0];return this.dispatchCoEvent(t.CollectionEventKind.REMOVE,e,-1,[i]),i}},i.prototype.replaceItemAt=function(e,i){if(!(0>i||i>=this._source.length)){var r=this._source.splice(i,1,e)[0];return this.dispatchCoEvent(t.CollectionEventKind.REPLACE,i,-1,[e],[r]),r}},i.prototype.replaceAll=function(t){t||(t=[]);for(var e=t.length,i=this._source.length,r=e;i>r;r++)this.removeItemAt(e);for(var r=0;e>r;r++)r>=i?this.addItemAt(t[r],r):this.replaceItemAt(t[r],r);this._source=t},i.prototype.dispatchCoEvent=function(e,i,r,n,a){t.CollectionEvent.dispatchCollectionEvent(this,t.CollectionEvent.COLLECTION_CHANGE,e,i,r,n,a)},i}(egret.EventDispatcher);t.ArrayCollection=e,__reflect(e.prototype,"eui.ArrayCollection",["eui.ICollection","egret.IEventDispatcher"]),t.registerProperty(e,"source","Array",!0)}(eui||(eui={}));var eui;!function(t){var e=t.sys.UIComponentImpl,i=function(i){function r(){var t=i.call(this)||this;return t._widthConstraint=0/0,t.$isShowPrompt=!1,t.$promptColor=6710886,t.$isFocusIn=!1,t.$isTouchCancle=!1,t.initializeUIValues(),t.type=egret.TextFieldType.INPUT,t.$EditableText={0:null,1:16777215,2:!1},t}return __extends(r,i),r.prototype.$invalidateTextField=function(){i.prototype.$invalidateTextField.call(this),this.invalidateSize()},r.prototype.$setWidth=function(t){var r=i.prototype.$setWidth.call(this,t),n=e.prototype.$setWidth.call(this,t);return r&&n},r.prototype.$setHeight=function(t){var r=i.prototype.$setHeight.call(this,t),n=e.prototype.$setHeight.call(this,t);return r&&n},r.prototype.$getText=function(){var t=i.prototype.$getText.call(this);return t==this.$EditableText[0]&&(t=""),t},r.prototype.$setText=function(e){var r=this.$EditableText[0];(r!=e||null==r)&&(this.$isShowPrompt=!1,this.textColor=this.$EditableText[1],this.displayAsPassword=this.$EditableText[2]),this.$isFocusIn||(""==e||null==e)&&(e=r,this.$isShowPrompt=!0,i.prototype.$setTextColor.call(this,this.$promptColor),i.prototype.$setDisplayAsPassword.call(this,!1));var n=i.prototype.$setText.call(this,e);return t.PropertyEvent.dispatchPropertyEvent(this,t.PropertyEvent.PROPERTY_CHANGE,"text"),n},r.prototype.$onAddToStage=function(e,i){t.sys.UIComponentImpl.prototype.$onAddToStage.call(this,e,i),this.addEventListener(egret.FocusEvent.FOCUS_IN,this.onfocusIn,this),this.addEventListener(egret.FocusEvent.FOCUS_OUT,this.onfocusOut,this),this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this),this.addEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onTouchCancle,this)},r.prototype.$onRemoveFromStage=function(){i.prototype.$onRemoveFromStage.call(this),this.removeEventListener(egret.FocusEvent.FOCUS_IN,this.onfocusIn,this),this.removeEventListener(egret.FocusEvent.FOCUS_OUT,this.onfocusOut,this),this.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this),this.removeEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onTouchCancle,this)},Object.defineProperty(r.prototype,"prompt",{get:function(){return this.$EditableText[0]},set:function(t){var e=this.$EditableText,i=e[0];if(i!=t){e[0]=t;var r=this.text;r&&r!=i||this.showPromptText()}},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"promptColor",{get:function(){return this.$promptColor},set:function(t){if(t=0|+t,this.$promptColor!=t){this.$promptColor=t;var e=this.text;e&&e!=this.$EditableText[0]||this.showPromptText()}},enumerable:!0,configurable:!0}),r.prototype.onfocusOut=function(){this.$isFocusIn=!1,this.text||this.showPromptText()},r.prototype.onTouchBegin=function(){this.$isTouchCancle=!1},r.prototype.onTouchCancle=function(){this.$isTouchCancle=!0},r.prototype.onfocusIn=function(){if(!egret.Capabilities.isMobile&&this.$isTouchCancle)return void this.inputUtils.stageText.$hide();this.$isFocusIn=!0,this.$isShowPrompt=!1,this.displayAsPassword=this.$EditableText[2];var t=this.$EditableText,e=this.text;e&&e!=t[0]||(this.textColor=t[1],this.text="")},r.prototype.showPromptText=function(){var t=this.$EditableText;this.$isShowPrompt=!0,i.prototype.$setTextColor.call(this,this.$promptColor),i.prototype.$setDisplayAsPassword.call(this,!1),this.text=t[0]},r.prototype.$setTextColor=function(t){return t=0|+t,this.$EditableText[1]=t,this.$isShowPrompt||i.prototype.$setTextColor.call(this,t),!0},r.prototype.$setDisplayAsPassword=function(t){return this.$EditableText[2]=t,this.$isShowPrompt||i.prototype.$setDisplayAsPassword.call(this,t),!0},r.prototype.createChildren=function(){this.onfocusOut()},r.prototype.childrenCreated=function(){},r.prototype.commitProperties=function(){},r.prototype.measure=function(){var t=this.$UIComponent,e=this.$TextField,r=e[3],n=0/0;isNaN(this._widthConstraint)?isNaN(t[8])?1e5!=t[13]&&(n=t[13]):n=t[8]:(n=this._widthConstraint,this._widthConstraint=0/0),i.prototype.$setWidth.call(this,n),this.setMeasuredSize(this.textWidth,this.textHeight),i.prototype.$setWidth.call(this,r)},r.prototype.updateDisplayList=function(t,e){i.prototype.$setWidth.call(this,t),i.prototype.$setHeight.call(this,e)},r.prototype.invalidateParentLayout=function(){},r.prototype.setMeasuredSize=function(t,e){},r.prototype.invalidateProperties=function(){},r.prototype.validateProperties=function(){},r.prototype.invalidateSize=function(){},r.prototype.validateSize=function(t){},r.prototype.invalidateDisplayList=function(){},r.prototype.validateDisplayList=function(){},r.prototype.validateNow=function(){},r.prototype.setLayoutBoundsSize=function(t,i){if(e.prototype.setLayoutBoundsSize.call(this,t,i),!isNaN(t)&&t!==this._widthConstraint&&0!=t){var r=this.$UIComponent;isNaN(r[9])&&t!=r[16]&&(this._widthConstraint=t,this.invalidateSize())}},r.prototype.setLayoutBoundsPosition=function(t,e){},r.prototype.getLayoutBounds=function(t){},r.prototype.getPreferredBounds=function(t){},r}(egret.TextField);t.EditableText=i,__reflect(i.prototype,"eui.EditableText",["eui.UIComponent","egret.DisplayObject","eui.IDisplayText"]),t.sys.implementUIComponent(i,egret.TextField),t.registerBindable(i.prototype,"text")}(eui||(eui={}));var eui;!function(t){var e;!function(t){function e(t){var e=t-1;return e*e*e+1}var i=4,r=[1,1.33,1.66,2],n=2.33,a=.02,o=.998,s=.95,l=Math.log(o),h=function(){function h(i,r,n){this.$scrollFactor=1,this.previousTime=0,this.velocity=0,this.previousVelocity=[],this.currentPosition=0,this.previousPosition=0,this.currentScrollPos=0,this.maxScrollPos=0,this.offsetPoint=0,this.$bounces=!0,this.started=!0,this.updateFunction=i,this.endFunction=r,this.target=n,this.animation=new t.Animation(this.onScrollingUpdate,this),this.animation.endFunction=this.finishScrolling,this.animation.easerFunction=e
}return h.prototype.isPlaying=function(){return this.animation.isPlaying},h.prototype.stop=function(){this.animation.stop(),egret.stopTick(this.onTick,this),this.started=!1},h.prototype.isStarted=function(){return this.started},h.prototype.start=function(t){this.started=!0,this.velocity=0,this.previousVelocity.length=0,this.previousTime=egret.getTimer(),this.previousPosition=this.currentPosition=t,this.offsetPoint=t,egret.startTick(this.onTick,this)},h.prototype.update=function(t,e,i){e=Math.max(e,0),this.currentPosition=t,this.maxScrollPos=e;var r=this.offsetPoint-t,n=r+i;this.offsetPoint=t,0>n&&(this.$bounces?n-=.5*r:n=0),n>e&&(this.$bounces?n-=.5*r:n=e),this.currentScrollPos=n,this.updateFunction.call(this.target,n)},h.prototype.finish=function(t,e){egret.stopTick(this.onTick,this),this.started=!1;for(var i=this.velocity*n,h=this.previousVelocity,c=h.length,u=n,p=0;c>p;p++){var d=r[p];i+=h[0]*d,u+=d}var f=i/u,g=Math.abs(f),m=0,y=0;if(g>a)if(y=t+(f-a)/l*2*this.$scrollFactor,0>y||y>e)for(y=t;Math.abs(f)>a;)y-=f,f*=0>y||y>e?o*s:o,m++;else m=Math.log(a/g)/l;else y=t;if(this.target.$getThrowInfo){var v=this.target.$getThrowInfo(t,y);y=v.toPos}m>0?(this.$bounces||(0>y?y=0:y>e&&(y=e)),this.throwTo(y,m)):this.finishScrolling()},h.prototype.onTick=function(t){var e=t-this.previousTime;if(e>10){var r=this.previousVelocity;r.length>=i&&r.shift(),this.velocity=(this.currentPosition-this.previousPosition)/e,r.push(this.velocity),this.previousTime=t,this.previousPosition=this.currentPosition}return!0},h.prototype.finishScrolling=function(t){var e=this.currentScrollPos,i=this.maxScrollPos,r=e;0>e&&(r=0),e>i&&(r=i),this.throwTo(r,300)},h.prototype.throwTo=function(t,e){void 0===e&&(e=500);var i=this.currentScrollPos;if(i==t)return void this.endFunction.call(this.target);var r=this.animation;r.duration=e,r.from=i,r.to=t,r.play()},h.prototype.onScrollingUpdate=function(t){this.currentScrollPos=t.currentValue,this.updateFunction.call(this.target,t.currentValue)},h}();t.TouchScroll=h,__reflect(h.prototype,"eui.sys.TouchScroll")}(e=t.sys||(t.sys={}))}(eui||(eui={}));var eui;!function(t){var e=function(){function t(){}return t.LTR="ltr",t.RTL="rtl",t.TTB="ttb",t.BTT="btt",t}();t.Direction=e,__reflect(e.prototype,"eui.Direction")}(eui||(eui={}));var eui;!function(t){var e=function(){function t(){}return t.AUTO="auto",t.OFF="off",t.ON="on",t}();t.ScrollPolicy=e,__reflect(e.prototype,"eui.ScrollPolicy")}(eui||(eui={}));var eui;!function(t){var e=function(e){function i(t,i){var r=e.call(this)||this;return r.delayList=[],r.skinMap={},r.$styles={},r.initialized=!t,i&&egret.registerImplementation("eui.Theme",r),r.$configURL=t,r.load(t),r}return __extends(i,e),i.prototype.load=function(e){var i=this;t.getTheme(e,function(t){return i.onConfigLoaded(t)})},i.prototype.onConfigLoaded=function(t){var e;if("string"==typeof t)try{e=JSON.parse(t)}catch(i){egret.$error(3e3)}else e=t;if(e&&e.skins)for(var r=this.skinMap,n=e.skins,a=Object.keys(n),o=a.length,s=0;o>s;s++){var l=a[s];r[l]||this.mapSkin(l,n[l])}e.styles&&(this.$styles=e.styles);var h=e.paths;for(var c in h)EXML.update(c,h[c]);e.exmls&&0!=e.exmls.length?e.exmls[0].gjs?(e.exmls.forEach(function(t){return EXML.$parseURLContentAsJs(t.path,t.gjs,t.className)}),this.onLoaded()):e.exmls[0].content?(e.exmls.forEach(function(t){return EXML.$parseURLContent(t.path,t.content)}),this.onLoaded()):EXML.$loadAll(e.exmls,this.onLoaded,this,!0):this.onLoaded()},i.prototype.onLoaded=function(t,e){this.initialized=!0,this.handleDelayList(),this.dispatchEventWith(egret.Event.COMPLETE)},i.prototype.handleDelayList=function(){for(var t=this.delayList,e=t.length,i=0;e>i;i++){var r=t[i];if(!r.$Component[5]){var n=this.getSkinName(r);n&&(r.$Component[1]=n,r.$parseSkinName())}}t.length=0},i.prototype.getSkinName=function(t){if(!this.initialized)return-1==this.delayList.indexOf(t)&&this.delayList.push(t),"";var e=this.skinMap,i=e[t.hostComponentKey];return i||(i=this.findSkinName(t)),i},i.prototype.findSkinName=function(t){if(!t)return"";var e=t.__class__;if(void 0===e)return"";var i=this.skinMap[e];return i||"eui.Component"==e?i:this.findSkinName(Object.getPrototypeOf(t))},i.prototype.mapSkin=function(t,e){this.skinMap[t]=e},i.prototype.$getStyleConfig=function(t){return this.$styles[t]},i}(egret.EventDispatcher);t.Theme=e,__reflect(e.prototype,"eui.Theme")}(eui||(eui={}));var eui;!function(t){var e=function(t){function e(e,i,r,n,a,o,s,l){var h=t.call(this,e,i,r)||this;return h.$initTo(n,a,o,s,l),h}return __extends(e,t),e.prototype.$initTo=function(t,e,i,r,n){this.kind=t,this.location=0|+e,this.oldLocation=0|+i,this.items=r||[],this.oldItems=n||[]},e.prototype.clean=function(){t.prototype.clean.call(this),this.items=this.oldItems=null},e.dispatchCollectionEvent=function(t,i,r,n,a,o,s){if(!t.hasEventListener(i))return!0;var l=egret.Event.create(e,i);l.$initTo(r,n,a,o,s);var h=t.dispatchEvent(l);return egret.Event.release(l),h},e.COLLECTION_CHANGE="collectionChange",e}(egret.Event);t.CollectionEvent=e,__reflect(e.prototype,"eui.CollectionEvent")}(eui||(eui={}));var eui;!function(t){var e=function(){function t(){}return t.ADD="add",t.REFRESH="refresh",t.REMOVE="remove",t.REPLACE="replace",t.RESET="reset",t.UPDATE="update",t}();t.CollectionEventKind=e,__reflect(e.prototype,"eui.CollectionEventKind")}(eui||(eui={}));var eui;!function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.item=null,e.itemRenderer=null,e.itemIndex=-1,e}return __extends(e,t),e.prototype.clean=function(){t.prototype.clean.call(this),this.item=this.itemRenderer=null},e.dispatchItemTapEvent=function(t,i,r){if(!t.hasEventListener(i))return!0;var n=egret.Event.create(e,i);n.item=r.data,n.itemIndex=r.itemIndex,n.itemRenderer=r;var a=t.dispatchEvent(n);return egret.Event.release(n),a},e.ITEM_TAP="itemTap",e}(egret.Event);t.ItemTapEvent=e,__reflect(e.prototype,"eui.ItemTapEvent")}(eui||(eui={}));var eui;!function(t){var e=function(t){function e(e,i,r,n){var a=t.call(this,e,i,r)||this;return a.property=n,a}return __extends(e,t),e.dispatchPropertyEvent=function(t,i,r){if(!t.hasEventListener(i))return!0;var n=egret.Event.create(e,i);n.property=r;var a=t.dispatchEvent(n);return egret.Event.release(n),a},e.PROPERTY_CHANGE="propertyChange",e}(egret.Event);t.PropertyEvent=e,__reflect(e.prototype,"eui.PropertyEvent")}(eui||(eui={}));var eui;!function(t){var e=function(t){function e(e,i,r,n,a){var o=t.call(this,e,i,r)||this;return n=+n,a=+a,o.currentPos=n,o.toPos=a,o}return __extends(e,t),e.THROW="throw",e}(egret.Event);t.ScrollerThrowEvent=e,__reflect(e.prototype,"eui.ScrollerThrowEvent")}(eui||(eui={}));var eui;!function(t){var e=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return __extends(e,t),e.dispatchUIEvent=function(t,i,r,n){if(!t.hasEventListener(i))return!0;var a=egret.Event.create(e,i,r,n),o=t.dispatchEvent(a);return egret.Event.release(a),o},e.CREATION_COMPLETE="creationComplete",e.CHANGE_END="changeEnd",e.CHANGE_START="changeStart",e.CLOSING="closing",e.MOVE="move",e}(egret.Event);t.UIEvent=e,__reflect(e.prototype,"eui.UIEvent")}(eui||(eui={}));var eui;!function(t){var e;!function(t){var e="eui.State",i="eui.AddItems",r="eui.SetProperty",n="eui.SetStateProperty",a="eui.Binding.$bindProperties",o=function(){function t(){this.indent=0}return t.prototype.toCode=function(){return""},t.prototype.getIndent=function(t){void 0===t&&(t=this.indent);for(var e="",i=0;t>i;i++)e+="	";return e},t}();t.CodeBase=o,__reflect(o.prototype,"eui.sys.CodeBase");var s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.className="",e.superClass="",e.innerClassBlock=[],e.variableBlock=[],e.functionBlock=[],e}return __extends(e,t),e.prototype.addInnerClass=function(t){-1==this.innerClassBlock.indexOf(t)&&this.innerClassBlock.push(t)},e.prototype.addVariable=function(t){-1==this.variableBlock.indexOf(t)&&this.variableBlock.push(t)},e.prototype.getVariableByName=function(t){for(var e=this.variableBlock,i=e.length,r=0;i>r;r++){var n=e[r];if(n.name==t)return n}return null},e.prototype.addFunction=function(t){-1==this.functionBlock.indexOf(t)&&this.functionBlock.push(t)},e.prototype.getFuncByName=function(t){for(var e=this.functionBlock,i=e.length,r=0;i>r;r++){var n=e[r];if(n.name==t)return n}return null},e.prototype.toCode=function(){var t=this.indent,e=this.getIndent(t),i=this.getIndent(t+1),r=this.getIndent(t+2),n=e+"(function (";n+=this.superClass?"_super) {\n"+i+"__extends("+this.className+", _super);\n":") {\n";for(var a=this.innerClassBlock,o=a.length,s=0;o>s;s++){var l=a[s];l.indent=t+1,n+=i+"var "+l.className+" = "+l.toCode()+"\n\n"}n+=i+"function "+this.className+"() {\n",this.superClass&&(n+=r+"_super.call(this);\n");var h=this.variableBlock;o=h.length;for(var s=0;o>s;s++){var c=h[s];c.defaultValue&&(n+=r+c.toCode()+"\n")}if(this.constructCode){var u=this.constructCode.toCode().split("\n");o=u.length;for(var s=0;o>s;s++){var p=u[s];n+=r+p+"\n"}}n+=i+"}\n",n+=i+"var _proto = "+this.className+".prototype;\n\n";var d=this.functionBlock;o=d.length;for(var s=0;o>s;s++){var f=d[s];f.indent=t+1,n+=f.toCode()+"\n"}return n+=i+"return "+this.className+";\n"+e,n+=this.superClass?"})("+this.superClass+");":"})();"},e}(o);t.EXClass=s,__reflect(s.prototype,"eui.sys.EXClass");var l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.lines=[],e}return __extends(e,t),e.prototype.addVar=function(t,e){var i=e?" = "+e:"";this.addCodeLine("var "+t+i+";")},e.prototype.addAssignment=function(t,e,i){var r=i?"."+i:"";this.addCodeLine(t+r+" = "+e+";")},e.prototype.addReturn=function(t){this.addCodeLine("return "+t+";")},e.prototype.addEmptyLine=function(){this.addCodeLine("")},e.prototype.startIf=function(t){this.addCodeLine("if("+t+")"),this.startBlock()},e.prototype.startElse=function(){this.addCodeLine("else"),this.startBlock()},e.prototype.startElseIf=function(t){this.addCodeLine("else if("+t+")"),this.startBlock()},e.prototype.startBlock=function(){this.addCodeLine("{"),this.indent++},e.prototype.endBlock=function(){this.indent--,this.addCodeLine("}")},e.prototype.doFunction=function(t,e){var i=e.join(",");this.addCodeLine(t+"("+i+")")},e.prototype.addCodeLine=function(t){this.lines.push(this.getIndent()+t)},e.prototype.addCodeLineAt=function(t,e){this.lines.splice(e,0,this.getIndent()+t)},e.prototype.containsCodeLine=function(t){return-1!=this.lines.indexOf(t)},e.prototype.concat=function(t){this.lines=this.lines.concat(t.lines)},e.prototype.toCode=function(){return this.lines.join("\n")},e}(o);t.EXCodeBlock=l,__reflect(l.prototype,"eui.sys.EXCodeBlock");var h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.codeBlock=null,e.isGet=!1,e.name="",e}return __extends(e,t),e.prototype.toCode=function(){var t,e=this.getIndent(),i=this.getIndent(this.indent+1),r=e;if(this.isGet?(t=this.getIndent(this.indent+2),r+='Object.defineProperty(_proto, "skinParts", {\n',r+=i+"get: function () {\n"):(t=i,r+="_proto."+this.name+" = function () {\n"),this.codeBlock)for(var n=this.codeBlock.toCode().split("\n"),a=n.length,o=0;a>o;o++){var s=n[o];r+=t+s+"\n"}return r+=this.isGet?i+"},\n"+i+"enumerable: true,\n"+i+"configurable: true\n"+e+"});":e+"};"},e}(o);t.EXFunction=h,__reflect(h.prototype,"eui.sys.EXFunction");var c=function(t){function e(e,i){var r=t.call(this)||this;return r.indent=2,r.name=e,r.defaultValue=i,r}return __extends(e,t),e.prototype.toCode=function(){return this.defaultValue?"this."+this.name+" = "+this.defaultValue+";":""},e}(o);t.EXVariable=c,__reflect(c.prototype,"eui.sys.EXVariable");var u=function(t){function i(e,i){var r=t.call(this)||this;return r.name="",r.stateGroups=[],r.addItems=[],r.setProperty=[],r.name=e,i&&(r.stateGroups=i),r}return __extends(i,t),i.prototype.addOverride=function(t){t instanceof p?this.addItems.push(t):this.setProperty.push(t)},i.prototype.toCode=function(){for(var t=this.getIndent(1),i="new "+e+' ("'+this.name+'",\n'+t+"[\n",r=0,n=!0,a=this.addItems.concat(this.setProperty);r<a.length;){n?n=!1:i+=",\n";for(var o=a[r],s=o.toCode().split("\n"),l=s.length,h=0;l>h;h++){var c=s[h];s[h]=t+t+c}i+=s.join("\n"),r++}return i+="\n"+t+"])"},i}(o);t.EXState=u,__reflect(u.prototype,"eui.sys.EXState");var p=function(t){function e(e,i,r,n){var a=t.call(this)||this;return a.target=e,a.property=i,a.position=r,a.relativeTo=n,a}return __extends(e,t),e.prototype.toCode=function(){var t="new "+i+'("'+this.target+'","'+this.property+'",'+this.position+',"'+this.relativeTo+'")';return t},e}(o);t.EXAddItems=p,__reflect(p.prototype,"eui.sys.EXAddItems");var d=function(t){function e(e,i,r){var n=t.call(this)||this;return n.target=e,n.name=i,n.value=r,n}return __extends(e,t),e.prototype.toCode=function(){return"new "+r+'("'+this.target+'","'+this.name+'",'+this.value+")"},e}(o);t.EXSetProperty=d,__reflect(d.prototype,"eui.sys.EXSetProperty");var f=function(t){function e(e,i,r,n){var a=t.call(this)||this;return e=e?"this."+e:"this",a.target=e,a.property=i,a.templates=r,a.chainIndex=n,a}return __extends(e,t),e.prototype.toCode=function(){var t=this.templates.join(","),e=this.chainIndex.join(",");return"new "+n+"(this, ["+t+"],["+e+"],"+this.target+',"'+this.property+'")'},e}(o);t.EXSetStateProperty=f,__reflect(f.prototype,"eui.sys.EXSetStateProperty");var g=function(t){function e(e,i,r,n){var a=t.call(this)||this;return a.target=e,a.property=i,a.templates=r,a.chainIndex=n,a}return __extends(e,t),e.prototype.toCode=function(){var t=this.templates.join(","),e=this.chainIndex.join(",");return a+"(this, ["+t+"],["+e+"],"+this.target+',"'+this.property+'")'},e}(o);t.EXBinding=g,__reflect(g.prototype,"eui.sys.EXBinding")}(e=t.sys||(t.sys={}))}(eui||(eui={}));var eui;!function(t){var e=t.sys.UIComponentImpl,i=function(i){function r(t){var e=i.call(this)||this;return e.$createChildrenCalled=!1,e.$fontChanged=!1,e._widthConstraint=0/0,e._heightConstraint=0/0,e.initializeUIValues(),e.text=t,e}return __extends(r,i),r.prototype.$invalidateContentBounds=function(){i.prototype.$invalidateContentBounds.call(this),this.invalidateSize()},r.prototype.$setWidth=function(t){var r=i.prototype.$setWidth.call(this,t),n=e.prototype.$setWidth.call(this,t);return r&&n},r.prototype.$setHeight=function(t){var r=i.prototype.$setHeight.call(this,t),n=e.prototype.$setHeight.call(this,t);return r&&n},r.prototype.$setText=function(e){var r=i.prototype.$setText.call(this,e);return t.PropertyEvent.dispatchPropertyEvent(this,t.PropertyEvent.PROPERTY_CHANGE,"text"),r},r.prototype.$setFont=function(t){return this.$fontForBitmapLabel==t?!1:(this.$fontForBitmapLabel=t,this.$createChildrenCalled?this.$parseFont():this.$fontChanged=!0,this.$fontStringChanged=!0,!0)},r.prototype.$parseFont=function(){this.$fontChanged=!1;var e=this.$fontForBitmapLabel;"string"==typeof e?t.getAssets(e,function(t){this.$setFontData(t,e)},this):this.$setFontData(e)},r.prototype.$setFontData=function(t,e){return e&&e!=this.$fontForBitmapLabel?void 0:t==this.$font?!1:(this.$font=t,this.$invalidateContentBounds(),!0)},r.prototype.createChildren=function(){this.$fontChanged&&this.$parseFont(),this.$createChildrenCalled=!0},r.prototype.childrenCreated=function(){},r.prototype.commitProperties=function(){},r.prototype.measure=function(){var t=this.$UIComponent,e=this.$textFieldWidth,r=this.$textFieldHeight,n=0/0;isNaN(this._widthConstraint)?isNaN(t[8])?1e5!=t[13]&&(n=t[13]):n=t[8]:(n=this._widthConstraint,this._widthConstraint=0/0),i.prototype.$setWidth.call(this,n);var a=0/0;isNaN(this._heightConstraint)?isNaN(t[9])?1e5!=t[15]&&(a=t[15]):a=t[9]:(a=this._heightConstraint,this._heightConstraint=0/0),i.prototype.$setHeight.call(this,a),this.setMeasuredSize(this.textWidth,this.textHeight),i.prototype.$setWidth.call(this,e),i.prototype.$setHeight.call(this,r)},r.prototype.updateDisplayList=function(t,e){i.prototype.$setWidth.call(this,t),i.prototype.$setHeight.call(this,e)},r.prototype.invalidateParentLayout=function(){},r.prototype.setMeasuredSize=function(t,e){},r.prototype.invalidateProperties=function(){},r.prototype.validateProperties=function(){},r.prototype.invalidateSize=function(){},r.prototype.validateSize=function(t){},r.prototype.invalidateDisplayList=function(){},r.prototype.validateDisplayList=function(){},r.prototype.validateNow=function(){},r.prototype.setLayoutBoundsSize=function(t,i){if(e.prototype.setLayoutBoundsSize.call(this,t,i),!isNaN(t)&&t!==this._widthConstraint&&0!=t){var r=this.$UIComponent;isNaN(r[9])&&t!=r[16]&&(this._widthConstraint=t,this._heightConstraint=i,this.invalidateSize())}},r.prototype.setLayoutBoundsPosition=function(t,e){},r.prototype.getLayoutBounds=function(t){},r.prototype.getPreferredBounds=function(t){},r}(egret.BitmapText);t.BitmapLabel=i,__reflect(i.prototype,"eui.BitmapLabel",["eui.UIComponent","egret.DisplayObject","eui.IDisplayText"]),t.sys.implementUIComponent(i,egret.BitmapText),t.registerBindable(i.prototype,"text")}(eui||(eui={}));var EXML;!function(t){function e(t){return h.parse(t)}function i(t,e,i,r){if(void 0===r&&(r=!1),r&&t in u)return void(e&&e.call(i,u[t],t));var n=c[t];return n?void n.push([e,i]):(c[t]=[[e,i]],void l(t,s))}function r(t,e,i,r){if(void 0===r&&(r=!1),!t||0==t.length)return void(e&&e.call(i,[],t));var a=[];t.forEach(function(o){var s=function(r,o){a[r]=o,a.push(r),a.length==t.length&&n(t,a,e,i)};return r&&o in u?void s(o,""):void l(o,s)})}function n(t,e,i,r){var n=[];t.forEach(function(t,i){if(t in u&&!e[t])return void(n[i]=u[t]);var r=e[t],a=s(t,r);n[i]=a}),i&&i.call(r,n,t)}function a(t,e){u[t]=e;var i=c[t];delete c[t];for(var r=i?i.length:0,n=0;r>n;n++){var a=i[n];a[0]&&a[1]&&a[0].call(a[1],e,t)}}function o(t,e,i){var r=null;e&&(r=h.$parseCode(e,i),a(t,r))}function s(t,i){var r=null;if(i&&"string"==typeof i)try{r=e(i)}catch(n){console.error(t+"\n"+n.message)}if(i&&i.prototype&&(r=i),t){r&&(u[t]=r);var a=c[t];delete c[t];for(var o=a?a.length:0,s=0;o>s;s++){var l=a[s];l[0]&&l[1]&&l[0].call(l[1],r,t)}}return r}function l(t,e){var i=t;-1==t.indexOf("://")&&(i=p+t);var r=function(i){i||(i=""),e(t,i)};eui.getTheme(i,r)}var h=new eui.sys.EXMLParser,c={},u={},p="";Object.defineProperty(t,"prefixURL",{get:function(){return p},set:function(t){p=t},enumerable:!0,configurable:!0}),t.parse=e,t.load=i,t.$loadAll=r,t.update=a,t.$parseURLContentAsJs=o,t.$parseURLContent=s}(EXML||(EXML={}));var eui;!function(t){var e;!function(t){function e(t){return"[object Array]"===Object.prototype.toString.call(t)}function i(t){var e=egret.getDefinitionByName(t);return e?e.prototype:null}function r(t){if(!t)return null;var e;return e=new t}t.NS_S="http://ns.egret.com/eui",t.NS_W="http://ns.egret.com/wing";var n=["Point","Matrix","Rectangle"],a=["Array","boolean","string","number"],o="eui.",s=0,l={},h=function(){function h(){}return h.prototype.$describe=function(t){if(!t)return null;var i=Object.getPrototypeOf(t);if(!i)return null;var n;if(i.hasOwnProperty("__hashCode__")&&(n=l[i.__hashCode__]))return n;var o=Object.getPrototypeOf(i);if(!o)return null;var h=r(o.constructor),c=this.$describe(h);if(c){var u=function(){};u.prototype=c,n=new u}else n={};for(var p=Object.keys(i).concat(Object.keys(t)),d=p.length,f=t.__meta__,g=0;d>g;g++){var m=p[g];if("constructor"!=m&&"_"!=m.charAt(0)&&"$"!=m.charAt(0)){var y=void 0;if(f&&f[m])y=f[m];else if(e(t[m]))y="Array";else{if(y=typeof t[m],"function"==y)continue;-1==a.indexOf(y)&&(y="any")}n[m]=y}}return Object.getPrototypeOf(o)&&(i.__hashCode__=s++,l[i.__hashCode__]=n),n},h.prototype.getClassNameById=function(e,r){if(r==t.NS_S){if("Object"==e)return e;if(-1!=n.indexOf(e))return"egret."+e}var s="";return-1!=a.indexOf(e)?e:(r==t.NS_W||(s=r&&r!=t.NS_S?r.substring(0,r.length-1)+e:o+e),i(s)||(s=""),s)},h.prototype.getDefaultPropById=function(t,e){var r,n=this.getClassNameById(t,e),a=i(n);return a&&(r=a.__defaultProperty__),r?r:""},h.prototype.getPropertyType=function(t,e){if("Object"==e)return"any";var n="",a=i(e);if(a){if(!a.hasOwnProperty("__hashCode__")){var o=egret.getDefinitionByName(e),s=r(o);if(!s)return n;this.$describe(s)}var h=l[a.__hashCode__];h&&(n=h[t])}return n},h}();t.EXMLConfig=h,__reflect(h.prototype,"eui.sys.EXMLConfig")}(e=t.sys||(t.sys={}))}(eui||(eui={}));var eui;!function(t){egret.$locale_strings=egret.$locale_strings||{},egret.$locale_strings.en_US=egret.$locale_strings.en_US||{};var e=egret.$locale_strings.en_US;e[2001]="EXML parsing error {0}: EXML file can't be found ",e[2002]="EXML parsing error : invalid XML file:\n{0}",e[2003]="EXML parsing error {0}: the class definitions corresponding to nodes can't be found  \n {1}",e[2004]="EXML parsing error {0}: nodes cannot contain id property with the same name \n {1}",e[2005]="EXML parsing error {0}: property with the name of '{1}' does not exist on the node, or the property does not have a default value: \n {2}",e[2006]="EXML parsing error {0}: undefined view state name: '{1}' \n {2}",e[2007]="EXML parsing error {0}: only UIComponent objects within the container can use the includeIn and excludeFrom properties\n {1}",e[2008]="EXML parsing error {0}: fail to assign values of '{1}' class to property: '{2}' \n {3}",e[2009]="EXML parsing error {0}: only one ID can be referenced in the node property value '{}' label; and complex expression is not allowed to use \n {1}",e[2010]="EXML parsing error {0}: ID referenced by property: '{1}':  '{2}' does not exist \n {3}",e[2011]="EXML parsing error {0}: fail to assign more than one child nodes to the same property: '{1}' \n {2}",e[2012]="EXML parsing error {0}: no default property exists on the node; and you must explicitly declare the property name that the child node  is assigned to \n {1}",e[2013]="EXML parsing error {0}: view state grammar is not allowed to use on property nodes of Array class \n {1} ",e[2014]="EXML parsing error {0}: assigning the skin class itself to the node property is not allowed \n {1}",e[2015]="EXML parsing error {0}: class definition referenced by node: {1} does not exist \n {2}",e[2016]="EXML parsing error {0}: format error of 'scale9Grid' property value on the node: {1}",e[2017]="EXML parsing error {0}: namespace prefix missing on the node: {1}",e[2018]="EXML parsing error {0}: format error of 'skinName' property value on the node: {1}",e[2019]="EXML parsing error {0}: the container’s child item must be visible nodes: {1}",e[2020]="EXML parsing error {0}: for child nodes in w: Declarations, the includeIn and excludeFrom properties are not allowed to use \n {1}",e[2021]="Compile errors in {0}, the attribute name: {1}, the attribute value: {2}.",e[2022]="EXML parsing error: there contains illegal characters in the id `{0}`",e[2101]="EXML parsing warnning : fail to register the class property : {0},there is already a class with the same name in the global,please try to rename the class name for the exml. \n {1}",e[2102]="EXML parsing warnning {0}: no child node can be found on the property code \n {1}",e[2103]="EXML parsing warnning {0}: the same property '{1}' on the node is assigned multiple times \n {2}",e[2104]="EXML parsing warnning, Instantiate class {0} error，the parameters of its constructor method must be empty.",e[2201]="BasicLayout doesn't support virtualization.",e[2202]="parse skinName error，the parsing result of skinName must be a instance of eui.Skin.",e[2203]="Could not find the skin class '{0}'。",e[2204]="Undefined event.kind type (CollectionEventKind) = '{0}'.",e[2301]="parse source failed，could not find asset from URL：{0} ."}(eui||(eui={}));var eui;!function(t){egret.$locale_strings=egret.$locale_strings||{},egret.$locale_strings.zh_CN=egret.$locale_strings.zh_CN||{};var e=egret.$locale_strings.zh_CN;e[2001]="EXML解析错误 {0}: 找不到EXML文件",e[2002]="EXML解析错误: 不是有效的XML文件:\n{0}",e[2003]="EXML解析错误 {0}: 无法找到节点所对应的类定义\n{1}",e[2004]="EXML解析错误 {0}: 节点不能含有同名的id属性\n{1}",e[2005]="EXML解析错误 {0}: 节点上不存在名为'{1}'的属性，或者该属性没有初始值:\n{2}",e[2006]="EXML解析错误 {0}: 未定义的视图状态名称:'{1}'\n{2}",e[2007]="EXML解析错误 {0}: 只有处于容器内的 UIComponent 对象可以使用includeIn和excludeFrom属性\n{1}",e[2008]="EXML解析错误 {0}: 无法将'{1}'类型的值赋给属性:'{2}'\n{3}",e[2009]="EXML解析错误 {0}: 在节点属性值的‘{}’标签内只能引用一个ID，不允许使用复杂表达式\n{1}",e[2010]="EXML解析错误 {0}: 属性:'{1}'所引用的ID: '{2}'不存在\n{3}",e[2011]="EXML解析错误 {0}: 无法将多个子节点赋值给同一个属性:'{1}'\n{2}",e[2012]="EXML解析错误 {0}: 节点上不存在默认属性，必须显式声明子节点要赋值到的属性名\n{1}",e[2013]="EXML解析错误 {0}: 类型为Array的属性节点上不允许使用视图状态语法\n{1}",e[2014]="EXML解析错误 {0}: 不允许将皮肤类自身赋值给节点属性\n{1}",e[2015]="EXML解析错误 {0}: 节点引用的类定义:{1}不存在\n{2}",e[2016]="EXML解析错误 {0}: 节点上'scale9Grid'属性值的格式错误:{1}",e[2017]="EXML解析错误 {0}: 节点上缺少命名空间前缀:{1}",e[2018]="EXML解析错误 {0}: 节点上'skinName'属性值的格式错误:{1}",e[2019]="EXML解析错误 {0}: 容器的子项必须是可视节点:{1}",e[2020]="EXML解析错误 {0}: 在w:Declarations内的子节点，不允许使用includeIn和excludeFrom属性\n{1}",e[2021]="{0} 中存在编译错误，属性名 : {1}，属性值 : {2}",e[2022]="EXML解析错误: id `{0}` 中含有非法字符",e[2101]="EXML解析警告: 在EXML根节点上声明的 class 属性: {0} 注册失败，所对应的类已经存在，请尝试重命名要注册的类名。\n{1}",e[2102]="EXML解析警告 {0}: 在属性节点上找不到任何子节点\n{1}",e[2103]="EXML解析警告 {0}: 节点上的同一个属性'{1}'被多次赋值\n{2}",e[2104]="EXML解析警告，无法直接实例化自定义组件：{0} ，在EXML中使用的自定义组件必须要能直接被实例化，否则可能导致后续EXML解析报错。",e[2201]="BasicLayout 不支持虚拟化。",e[2202]="皮肤解析出错，属性 skinName 的值必须要能够解析为一个 eui.Skin 的实例。",e[2203]="找不到指定的皮肤类 '{0}'。",e[2204]="未定义的event.kind类型(CollectionEventKind) = '{0}'.",e[2301]="素材解析失败，找不到URL：{0} 所对应的资源。"}(eui||(eui={}));var eui;!function(t){var e=function(e){function i(){return e.call(this)||this}return __extends(i,e),i.prototype.measure=function(){e.prototype.measure.call(this),t.sys.measure(this.$target)},i.prototype.updateDisplayList=function(i,r){e.prototype.updateDisplayList.call(this,i,r);var n=this.$target,a=t.sys.updateDisplayList(n,i,r);n.setContentSize(Math.ceil(a.x),Math.ceil(a.y))},i}(t.LayoutBase);t.BasicLayout=e,__reflect(e.prototype,"eui.BasicLayout")}(eui||(eui={})),function(t){var e;!function(t){function e(t,e){if(!t||"number"==typeof t)return t;var i=t,r=i.indexOf("%");if(-1==r)return+i;var n=+i.substring(0,r);return.01*n*e}function i(t){if(t){for(var e=0,i=0,r=egret.$TempRectangle,a=t.numChildren,o=0;a>o;o++){var s=t.getChildAt(o);if(egret.is(s,n)&&s.$includeInLayout){var l=s.$UIComponent,h=+l[4],c=+l[5],u=+l[0],p=+l[1],d=+l[2],f=+l[3],g=void 0,m=void 0;s.getPreferredBounds(r),isNaN(u)||isNaN(p)?isNaN(h)?isNaN(u)&&isNaN(p)?g=r.x:(g=isNaN(u)?0:u,g+=isNaN(p)?0:p):g=2*Math.abs(h):g=u+p,isNaN(d)||isNaN(f)?isNaN(c)?isNaN(d)&&isNaN(f)?m=r.y:(m=isNaN(d)?0:d,m+=isNaN(f)?0:f):m=2*Math.abs(c):m=d+f;var y=r.width,v=r.height;e=Math.ceil(Math.max(e,g+y)),i=Math.ceil(Math.max(i,m+v))}}t.setMeasuredSize(e,i)}}function r(t,i,r){if(t){for(var a=t.numChildren,o=0,s=0,l=egret.$TempRectangle,h=0;a>h;h++){var c=t.getChildAt(h);if(egret.is(c,n)&&c.$includeInLayout){var u=c.$UIComponent,p=e(u[4],.5*i),d=e(u[5],.5*r),f=e(u[0],i),g=e(u[1],i),m=e(u[2],r),y=e(u[3],r),v=u[6],_=u[7],b=0/0,x=0/0;isNaN(f)||isNaN(g)?isNaN(v)||(b=Math.round(i*Math.min(.01*v,1))):b=i-g-f,isNaN(m)||isNaN(y)?isNaN(_)||(x=Math.round(r*Math.min(.01*_,1))):x=r-y-m,c.setLayoutBoundsSize(b,x),c.getLayoutBounds(l);var T=l.width,E=l.height,S=0/0,C=0/0;S=isNaN(p)?isNaN(f)?isNaN(g)?l.x:i-T-g:f:Math.round((i-T)/2+p),C=isNaN(d)?isNaN(m)?isNaN(y)?l.y:r-E-y:m:Math.round((r-E)/2+d),c.setLayoutBoundsPosition(S,C),o=Math.max(o,S+T),s=Math.max(s,C+E)}}return egret.$TempPoint.setTo(o,s)}}var n="eui.UIComponent";t.measure=i,t.updateDisplayList=r}(e=t.sys||(t.sys={}))}(eui||(eui={}));var eui;!function(t){var e=function(){function t(){}return t.LEFT="left",t.JUSTIFY_USING_GAP="justifyUsingGap",t.JUSTIFY_USING_WIDTH="justifyUsingWidth",t}();t.ColumnAlign=e,__reflect(e.prototype,"eui.ColumnAlign")}(eui||(eui={}));var eui;!function(t){var e="eui.UIComponent",i=function(i){function r(){return null!==i&&i.apply(this,arguments)||this}return __extends(r,i),r.prototype.measureReal=function(){for(var t=this.$target,i=t.numElements,r=i,n=0,a=0,o=egret.$TempRectangle,s=0;i>s;s++){var l=t.getElementAt(s);egret.is(l,e)&&l.$includeInLayout?(l.getPreferredBounds(o),n+=o.width,a=Math.max(a,o.height)):r--}n+=(r-1)*this.$gap;var h=this.$paddingLeft+this.$paddingRight,c=this.$paddingTop+this.$paddingBottom;t.setMeasuredSize(n+h,a+c)},r.prototype.measureVirtual=function(){for(var t=this.$target,i=this.$typicalWidth,r=this.getElementTotalSize(),n=Math.max(this.maxElementSize,this.$typicalHeight),a=egret.$TempRectangle,o=this.endIndex,s=this.elementSizeTable,l=this.startIndex;o>l;l++){var h=t.getElementAt(l);egret.is(h,e)&&h.$includeInLayout&&(h.getPreferredBounds(a),r+=a.width,r-=isNaN(s[l])?i:s[l],n=Math.max(n,a.height))}var c=this.$paddingLeft+this.$paddingRight,u=this.$paddingTop+this.$paddingBottom;t.setMeasuredSize(r+c,n+u)},r.prototype.updateDisplayListReal=function(i,r){var n=this.$target,a=this.$paddingLeft,o=this.$paddingRight,s=this.$paddingTop,l=this.$paddingBottom,h=this.$gap,c=Math.max(0,i-a-o),u=Math.max(0,r-s-l),p=this.$horizontalAlign==t.JustifyAlign.JUSTIFY,d=this.$verticalAlign==t.JustifyAlign.JUSTIFY||this.$verticalAlign==t.JustifyAlign.CONTENT_JUSTIFY,f=0;d||(this.$verticalAlign==egret.VerticalAlign.MIDDLE?f=.5:this.$verticalAlign==egret.VerticalAlign.BOTTOM&&(f=1));var g,m,y,v=n.numElements,_=v,b=a,x=s,T=0,E=0,S=[],C=c,w=this.maxElementSize,P=egret.$TempRectangle;for(g=0;v>g;g++){var D=n.getElementAt(g);if(egret.is(D,e)&&D.$includeInLayout)if(D.getPreferredBounds(P),w=Math.max(w,P.height),p)T+=P.width;else{var A=D.$UIComponent;isNaN(A[6])?C-=P.width:(E+=A[6],y=new t.sys.ChildInfo,y.layoutElement=D,y.percent=A[6],y.min=A[12],y.max=A[13],S.push(y))}else _--}C-=h*(_-1),C=C>0?C:0;var I,M=c-T-h*(_-1),$=_,O={};if(p){if(0>M){for(I=C/_,g=0;v>g;g++)m=n.getElementAt(g),egret.is(m,e)&&m.$includeInLayout&&(m.getPreferredBounds(P),P.width<=I&&(C-=P.width,$--));C=C>0?C:0}}else if(E>0){this.flexChildrenProportionally(c,C,E,S);var R=0,L=S.length;for(g=0;L>g;g++){y=S[g];var B=Math.round(y.size+R);R+=y.size-B,O[y.layoutElement.$hashCode]=B,C-=B}C=C>0?C:0}this.$horizontalAlign==egret.HorizontalAlign.CENTER?b=a+.5*C:this.$horizontalAlign==egret.HorizontalAlign.RIGHT&&(b=a+C);var k=a,N=s,F=0,G=0,U=Math.ceil(u);this.$verticalAlign==t.JustifyAlign.CONTENT_JUSTIFY&&(U=Math.ceil(Math.max(u,w)));var V,H,j=0;for(g=0;v>g;g++){var W=0;if(m=n.getElementAt(g),egret.is(m,e)&&m.$includeInLayout){if(m.getPreferredBounds(P),V=0/0,p?(H=0/0,M>0?H=C*P.width/T:0>M&&P.width>I&&(H=C/$),isNaN(H)||(V=Math.round(H+j),j+=H-V)):V=O[m.$hashCode],d)x=s,m.setLayoutBoundsSize(V,U),m.getLayoutBounds(P);else{var X=0/0,A=m.$UIComponent;if(!isNaN(m.percentHeight)){var z=Math.min(100,A[7]);X=Math.round(u*z*.01)}m.setLayoutBoundsSize(V,X),m.getLayoutBounds(P),W=(u-P.height)*f,W=W>0?W:0,x=s+W}m.setLayoutBoundsPosition(Math.round(b),Math.round(x)),F=Math.ceil(P.width),G=Math.ceil(P.height),k=Math.max(k,b+F),N=Math.max(N,x+G),b+=F+h}}this.maxElementSize=w,n.setContentSize(k+o,N+l)},r.prototype.updateDisplayListVirtual=function(i,r){var n=this.$target;this.indexInViewCalculated?this.indexInViewCalculated=!1:this.getIndexInView();var a,o=this.$paddingRight,s=this.$paddingTop,l=this.$paddingBottom,h=this.$gap,c=n.numElements;if(-1==this.startIndex||-1==this.endIndex)return a=this.getStartPosition(c)-h+o,void n.setContentSize(a,n.contentHeight);var u=this.endIndex;n.setVirtualElementIndicesInView(this.startIndex,u);var p=this.$verticalAlign==t.JustifyAlign.JUSTIFY||this.$verticalAlign==t.JustifyAlign.CONTENT_JUSTIFY,d=this.$verticalAlign==t.JustifyAlign.CONTENT_JUSTIFY,f=0;p||(this.$verticalAlign==egret.VerticalAlign.MIDDLE?f=.5:this.$verticalAlign==egret.VerticalAlign.BOTTOM&&(f=1));var g,m=egret.$TempRectangle,y=Math.max(0,r-s-l),v=Math.ceil(y),_=this.$typicalHeight,b=this.$typicalWidth,x=this.maxElementSize,T=Math.max(_,this.maxElementSize);if(d){for(var E=this.startIndex;u>=E;E++)g=n.getVirtualElementAt(E),egret.is(g,e)&&g.$includeInLayout&&(g.getPreferredBounds(m),x=Math.max(x,m.height));v=Math.ceil(Math.max(y,x))}for(var S,C=0,w=0,P=0,D=!1,A=this.elementSizeTable,I=this.startIndex;u>=I;I++){var M=0;g=n.getVirtualElementAt(I),egret.is(g,e)&&g.$includeInLayout&&(g.getPreferredBounds(m),d||(x=Math.max(x,m.height)),p?(w=s,g.setLayoutBoundsSize(0/0,v),g.getLayoutBounds(m)):(g.getLayoutBounds(m),M=(y-m.height)*f,M=M>0?M:0,w=s+M),P=Math.max(P,m.height),D||(S=isNaN(A[I])?b:A[I],S!=m.width&&(D=!0)),A[I]=m.width,C=this.getStartPosition(I),g.setLayoutBoundsPosition(Math.round(C),Math.round(w)))
}P+=s+l,a=this.getStartPosition(c)-h+o,this.maxElementSize=x,n.setContentSize(a,P),(D||T<this.maxElementSize)&&n.invalidateSize()},r.prototype.getStartPosition=function(t){if(!this.$useVirtualLayout&&this.$target){var e=this.$target.getElementAt(t);if(e)return e.x}for(var i=this.$typicalWidth,r=this.$paddingLeft,n=this.$gap,a=this.elementSizeTable,o=0;t>o;o++){var s=a[o];isNaN(s)&&(s=i),r+=s+n}return r},r.prototype.getElementSize=function(t){if(this.$useVirtualLayout){var e=this.elementSizeTable[t];return isNaN(e)&&(e=this.$typicalWidth),e}return this.$target?this.$target.getElementAt(t).width:0},r.prototype.getElementTotalSize=function(){for(var t=this.$typicalWidth,e=this.$gap,i=0,r=this.$target.numElements,n=this.elementSizeTable,a=0;r>a;a++){var o=n[a];isNaN(o)&&(o=t),i+=o+e}return i-=e},r.prototype.elementAdded=function(t){this.useVirtualLayout&&(i.prototype.elementAdded.call(this,t),this.elementSizeTable.splice(t,0,this.$typicalWidth))},r.prototype.getIndexInView=function(){var t=this.$target;if(!t||0==t.numElements)return this.startIndex=this.endIndex=-1,!1;var e=t.$UIComponent;if(e[10]<=0||e[11]<=0)return this.startIndex=this.endIndex=-1,!1;var i=t.numElements,r=this.getStartPosition(i-1)+this.elementSizeTable[i-1]+this.$paddingRight,n=t.scrollH;if(n>r-this.$paddingRight)return this.startIndex=-1,this.endIndex=-1,!1;var a=t.scrollH+e[10];if(a<this.$paddingLeft)return this.startIndex=-1,this.endIndex=-1,!1;var o=this.startIndex,s=this.endIndex;return this.startIndex=this.findIndexAt(n,0,i-1),-1==this.startIndex&&(this.startIndex=0),this.endIndex=this.findIndexAt(a,0,i-1),-1==this.endIndex&&(this.endIndex=i-1),o!=this.startIndex||s!=this.endIndex},r}(t.LinearLayoutBase);t.HorizontalLayout=i,__reflect(i.prototype,"eui.HorizontalLayout")}(eui||(eui={}));var eui;!function(t){var e=function(){function t(){}return t.JUSTIFY="justify",t.CONTENT_JUSTIFY="contentJustify",t}();t.JustifyAlign=e,__reflect(e.prototype,"eui.JustifyAlign")}(eui||(eui={}));var eui;!function(t){var e=function(){function t(){}return t.TOP="top",t.JUSTIFY_USING_GAP="justifyUsingGap",t.JUSTIFY_USING_HEIGHT="justifyUsingHeight",t}();t.RowAlign=e,__reflect(e.prototype,"eui.RowAlign")}(eui||(eui={}));var eui;!function(t){var e="eui.UIComponent",i=function(i){function r(){var e=i.call(this)||this;return e.explicitHorizontalGap=0/0,e._horizontalGap=6,e.explicitVerticalGap=0/0,e._verticalGap=6,e._columnCount=-1,e._requestedColumnCount=0,e._rowCount=-1,e._requestedRowCount=0,e.explicitColumnWidth=0/0,e._columnWidth=0/0,e.explicitRowHeight=0/0,e._rowHeight=0/0,e._paddingLeft=0,e._paddingRight=0,e._paddingTop=0,e._paddingBottom=0,e._horizontalAlign=t.JustifyAlign.JUSTIFY,e._verticalAlign=t.JustifyAlign.JUSTIFY,e._columnAlign=t.ColumnAlign.LEFT,e._rowAlign=t.RowAlign.TOP,e._orientation=t.TileOrientation.ROWS,e.maxElementWidth=0,e.maxElementHeight=0,e.startIndex=-1,e.endIndex=-1,e.indexInViewCalculated=!1,e}return __extends(r,i),Object.defineProperty(r.prototype,"horizontalGap",{get:function(){return this._horizontalGap},set:function(t){t=+t,t!==this._horizontalGap&&(this.explicitHorizontalGap=t,this._horizontalGap=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"verticalGap",{get:function(){return this._verticalGap},set:function(t){t=+t,t!==this._verticalGap&&(this.explicitVerticalGap=t,this._verticalGap=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"columnCount",{get:function(){return this._columnCount},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"requestedColumnCount",{get:function(){return this._requestedColumnCount},set:function(t){t=+t||0,this._requestedColumnCount!==t&&(this._requestedColumnCount=t,this._columnCount=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"rowCount",{get:function(){return this._rowCount},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"requestedRowCount",{get:function(){return this._requestedRowCount},set:function(t){t=+t||0,this._requestedRowCount!=t&&(this._requestedRowCount=t,this._rowCount=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"columnWidth",{get:function(){return this._columnWidth},set:function(t){t=+t,t!==this._columnWidth&&(this.explicitColumnWidth=t,this._columnWidth=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"rowHeight",{get:function(){return this._rowHeight},set:function(t){t=+t,t!==this._rowHeight&&(this.explicitRowHeight=t,this._rowHeight=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"paddingLeft",{get:function(){return this._paddingLeft},set:function(t){t=+t||0,this._paddingLeft!=t&&(this._paddingLeft=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"paddingRight",{get:function(){return this._paddingRight},set:function(t){t=+t||0,this._paddingRight!==t&&(this._paddingRight=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"paddingTop",{get:function(){return this._paddingTop},set:function(t){t=+t||0,this._paddingTop!=t&&(this._paddingTop=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"paddingBottom",{get:function(){return this._paddingBottom},set:function(t){t=+t||0,this._paddingBottom!==t&&(this._paddingBottom=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"horizontalAlign",{get:function(){return this._horizontalAlign},set:function(t){this._horizontalAlign!=t&&(this._horizontalAlign=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"verticalAlign",{get:function(){return this._verticalAlign},set:function(t){this._verticalAlign!=t&&(this._verticalAlign=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"columnAlign",{get:function(){return this._columnAlign},set:function(t){this._columnAlign!=t&&(this._columnAlign=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"rowAlign",{get:function(){return this._rowAlign},set:function(t){this._rowAlign!=t&&(this._rowAlign=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"orientation",{get:function(){return this._orientation},set:function(t){this._orientation!=t&&(this._orientation=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),r.prototype.invalidateTargetLayout=function(){var t=this.$target;t&&(t.invalidateSize(),t.invalidateDisplayList())},r.prototype.measure=function(){var t=this.$target;if(t){var e=this._columnCount,i=this._rowCount,r=this._columnWidth,n=this._rowHeight,a=0,o=0,s=t.$UIComponent;this.calculateRowAndColumn(s[8],s[9]);var l=this._requestedColumnCount>0?this._requestedColumnCount:this._columnCount,h=this._requestedRowCount>0?this._requestedRowCount:this._rowCount,c=isNaN(this._horizontalGap)?0:this._horizontalGap,u=isNaN(this._verticalGap)?0:this._verticalGap;l>0&&(a=l*(this._columnWidth+c)-c),h>0&&(o=h*(this._rowHeight+u)-u);var p=this._paddingLeft+this._paddingRight,d=this._paddingTop+this._paddingBottom;t.setMeasuredSize(a+p,o+d),this._columnCount=e,this._rowCount=i,this._columnWidth=r,this._rowHeight=n}},r.prototype.calculateRowAndColumn=function(i,r){var n=this.$target,a=isNaN(this._horizontalGap)?0:this._horizontalGap,o=isNaN(this._verticalGap)?0:this._verticalGap;this._rowCount=this._columnCount=-1;for(var s=n.numElements,l=s,h=0;l>h;h++){var c=n.getElementAt(h);!c||egret.is(c,e)&&c.$includeInLayout||s--}if(0==s)return void(this._rowCount=this._columnCount=0);(isNaN(this.explicitColumnWidth)||isNaN(this.explicitRowHeight))&&this.updateMaxElementSize(),isNaN(this.explicitColumnWidth)?this._columnWidth=this.maxElementWidth:this._columnWidth=this.explicitColumnWidth,isNaN(this.explicitRowHeight)?this._rowHeight=this.maxElementHeight:this._rowHeight=this.explicitRowHeight;var u=this._columnWidth+a;0>=u&&(u=1);var p=this._rowHeight+o;0>=p&&(p=1);var d=this._orientation==t.TileOrientation.COLUMNS,f=!isNaN(i),g=!isNaN(r),m=this._paddingLeft,y=this._paddingRight,v=this._paddingTop,_=this._paddingBottom;if(this._requestedColumnCount>0||this._requestedRowCount>0)this._requestedRowCount>0&&(this._rowCount=Math.min(this._requestedRowCount,s)),this._requestedColumnCount>0&&(this._columnCount=Math.min(this._requestedColumnCount,s));else if(f||g)if(!f||g&&d){var b=Math.max(0,r-v-_);this._rowCount=Math.floor((b+o)/p),this._rowCount=Math.max(1,Math.min(this._rowCount,s))}else{var x=Math.max(0,i-m-y);this._columnCount=Math.floor((x+a)/u),this._columnCount=Math.max(1,Math.min(this._columnCount,s))}else{var T=Math.sqrt(s*u*p);d?this._rowCount=Math.max(1,Math.round(T/p)):this._columnCount=Math.max(1,Math.round(T/u))}-1==this._rowCount&&(this._rowCount=Math.max(1,Math.ceil(s/this._columnCount))),-1==this._columnCount&&(this._columnCount=Math.max(1,Math.ceil(s/this._rowCount))),this._requestedColumnCount>0&&this._requestedRowCount>0&&(this._orientation==t.TileOrientation.ROWS?this._rowCount=Math.max(1,Math.ceil(s/this._requestedColumnCount)):this._columnCount=Math.max(1,Math.ceil(s/this._requestedRowCount)))},r.prototype.updateMaxElementSize=function(){this.$target&&(this.$useVirtualLayout?(this.maxElementWidth=Math.max(this.maxElementWidth,this.$typicalWidth),this.maxElementHeight=Math.max(this.maxElementHeight,this.$typicalHeight),this.doUpdateMaxElementSize(this.startIndex,this.endIndex)):this.doUpdateMaxElementSize(0,this.$target.numElements-1))},r.prototype.doUpdateMaxElementSize=function(t,i){var r=this.maxElementWidth,n=this.maxElementHeight,a=egret.$TempRectangle,o=this.$target;if(-1!=t&&-1!=i)for(var s=t;i>=s;s++){var l=o.getVirtualElementAt(s);egret.is(l,e)&&l.$includeInLayout&&(l.getPreferredBounds(a),r=Math.max(r,a.width),n=Math.max(n,a.height))}this.maxElementWidth=r,this.maxElementHeight=n},r.prototype.clearVirtualLayoutCache=function(){i.prototype.clearVirtualLayoutCache.call(this),this.maxElementWidth=0,this.maxElementHeight=0},r.prototype.scrollPositionChanged=function(){if(this.$useVirtualLayout){var t=this.getIndexInView();t&&(this.indexInViewCalculated=!0,this.$target.invalidateDisplayList())}},r.prototype.getIndexInView=function(){if(!this.$target||0==this.$target.numElements)return this.startIndex=this.endIndex=-1,!1;var e=this.$target,i=e.numElements;if(!this.$useVirtualLayout)return this.startIndex=0,this.endIndex=i-1,!1;var r=e.$UIComponent;if(0==r[10]||0==r[11])return this.startIndex=this.endIndex=-1,!1;var n=this.startIndex,a=this.endIndex,o=this._paddingLeft,s=this._paddingTop,l=isNaN(this._horizontalGap)?0:this._horizontalGap,h=isNaN(this._verticalGap)?0:this._verticalGap;if(this._orientation==t.TileOrientation.COLUMNS){var c=this._columnWidth+l;if(0>=c)return this.startIndex=0,this.endIndex=i-1,!1;var u=e.scrollH,p=u+r[10],d=Math.floor((u-o)/c);0>d&&(d=0);var f=Math.ceil((p-o)/c);0>f&&(f=0),this.startIndex=Math.min(i-1,Math.max(0,d*this._rowCount)),this.endIndex=Math.min(i-1,Math.max(0,f*this._rowCount-1))}else{var g=this._rowHeight+h;if(0>=g)return this.startIndex=0,this.endIndex=i-1,!1;var m=e.scrollV,y=m+r[11],v=Math.floor((m-s)/g);0>v&&(v=0);var _=Math.ceil((y-s)/g);0>_&&(_=0),this.startIndex=Math.min(i-1,Math.max(0,v*this._columnCount)),this.endIndex=Math.min(i-1,Math.max(0,_*this._columnCount-1))}return this.startIndex!=n||this.endIndex!=a},r.prototype.updateDisplayList=function(r,n){if(i.prototype.updateDisplayList.call(this,r,n),this.$target){var a=this.$target,o=this._paddingLeft,s=this._paddingRight,l=this._paddingTop,h=this._paddingBottom;if(this.indexInViewCalculated)this.indexInViewCalculated=!1;else{if(this.calculateRowAndColumn(r,n),0==this._rowCount||0==this._columnCount)return void a.setContentSize(o+s,l+h);this.adjustForJustify(r,n),this.getIndexInView()}if(this.$useVirtualLayout&&(this.calculateRowAndColumn(r,n),this.adjustForJustify(r,n)),-1==this.startIndex||-1==this.endIndex)return void a.setContentSize(0,0);var c=this.endIndex;a.setVirtualElementIndicesInView(this.startIndex,c);for(var u,p,d,f,g,m=this._orientation==t.TileOrientation.COLUMNS,y=this.startIndex,v=isNaN(this._horizontalGap)?0:this._horizontalGap,_=isNaN(this._verticalGap)?0:this._verticalGap,b=this._rowCount,x=this._columnCount,T=this._columnWidth,E=this._rowHeight,S=this.startIndex;c>=S;S++)if(u=this.$useVirtualLayout?this.target.getVirtualElementAt(S):this.target.getElementAt(S),egret.is(u,e)&&u.$includeInLayout){switch(m?(f=Math.ceil((y+1)/b)-1,g=Math.ceil((y+1)%b)-1,-1==g&&(g=b-1)):(f=Math.ceil((y+1)%x)-1,-1==f&&(f=x-1),g=Math.ceil((y+1)/x)-1),this._horizontalAlign){case egret.HorizontalAlign.RIGHT:p=r-(f+1)*(T+v)+v-s;break;case egret.HorizontalAlign.LEFT:p=f*(T+v)+o;break;default:p=f*(T+v)+o}switch(this._verticalAlign){case egret.VerticalAlign.TOP:d=g*(E+_)+l;break;case egret.VerticalAlign.BOTTOM:d=n-(g+1)*(E+_)+_-h;break;default:d=g*(E+_)+l}this.sizeAndPositionElement(u,p,d,T,E),y++}var C=o+s,w=l+h,P=(T+v)*x-v,D=(E+_)*b-_;a.setContentSize(P+C,D+w)}},r.prototype.sizeAndPositionElement=function(e,i,r,n,a){var o=0/0,s=0/0,l=e.$UIComponent;this._horizontalAlign==t.JustifyAlign.JUSTIFY?o=n:isNaN(l[6])||(o=n*l[6]*.01),this._verticalAlign==t.JustifyAlign.JUSTIFY?s=a:isNaN(l[7])||(s=a*l[7]*.01),e.setLayoutBoundsSize(Math.round(o),Math.round(s));var h=i,c=egret.$TempRectangle;switch(e.getLayoutBounds(c),this._horizontalAlign){case egret.HorizontalAlign.RIGHT:h+=n-c.width;break;case egret.HorizontalAlign.CENTER:h=i+(n-c.width)/2}var u=r;switch(this._verticalAlign){case egret.VerticalAlign.BOTTOM:u+=a-c.height;break;case egret.VerticalAlign.MIDDLE:u+=(a-c.height)/2}e.setLayoutBoundsPosition(Math.round(h),Math.round(u))},r.prototype.adjustForJustify=function(e,i){var r=this._paddingLeft,n=this._paddingRight,a=this._paddingTop,o=this._paddingBottom,s=Math.max(0,e-r-n),l=Math.max(0,i-a-o);isNaN(this.explicitVerticalGap)||(this._verticalGap=this.explicitVerticalGap),isNaN(this.explicitHorizontalGap)||(this._horizontalGap=this.explicitHorizontalGap),this._verticalGap=isNaN(this._verticalGap)?0:this._verticalGap,this._horizontalGap=isNaN(this._horizontalGap)?0:this._horizontalGap;var h,c=l-this._rowHeight*this._rowCount,u=s-this._columnWidth*this._columnCount;c>0&&(this._rowAlign==t.RowAlign.JUSTIFY_USING_GAP?(h=Math.max(1,this._rowCount-1),this._verticalGap=c/h):this._rowAlign==t.RowAlign.JUSTIFY_USING_HEIGHT&&this._rowCount>0&&(this._rowHeight+=(c-(this._rowCount-1)*this._verticalGap)/this._rowCount)),u>0&&(this._columnAlign==t.ColumnAlign.JUSTIFY_USING_GAP?(h=Math.max(1,this._columnCount-1),this._horizontalGap=u/h):this._columnAlign==t.ColumnAlign.JUSTIFY_USING_WIDTH&&this._columnCount>0&&(this._columnWidth+=(u-(this._columnCount-1)*this._horizontalGap)/this._columnCount))},r}(t.LayoutBase);t.TileLayout=i,__reflect(i.prototype,"eui.TileLayout")}(eui||(eui={}));var eui;!function(t){var e=function(){function t(){}return t.ROWS="rows",t.COLUMNS="columns",t}();t.TileOrientation=e,__reflect(e.prototype,"eui.TileOrientation")}(eui||(eui={}));var eui;!function(t){var e="eui.UIComponent",i=function(i){function r(){return null!==i&&i.apply(this,arguments)||this}return __extends(r,i),r.prototype.measureReal=function(){for(var t=this.$target,i=t.numElements,r=i,n=0,a=0,o=egret.$TempRectangle,s=0;i>s;s++){var l=t.getElementAt(s);egret.is(l,e)&&l.$includeInLayout?(l.getPreferredBounds(o),a+=o.height,n=Math.max(n,o.width)):r--}a+=(r-1)*this.$gap;var h=this.$paddingLeft+this.$paddingRight,c=this.$paddingTop+this.$paddingBottom;t.setMeasuredSize(n+h,a+c)},r.prototype.measureVirtual=function(){for(var t=this.$target,i=this.$typicalHeight,r=this.getElementTotalSize(),n=Math.max(this.maxElementSize,this.$typicalWidth),a=egret.$TempRectangle,o=this.endIndex,s=this.elementSizeTable,l=this.startIndex;o>l;l++){var h=t.getElementAt(l);egret.is(h,e)&&h.$includeInLayout&&(h.getPreferredBounds(a),r+=a.height,r-=isNaN(s[l])?i:s[l],n=Math.max(n,a.width))}var c=this.$paddingLeft+this.$paddingRight,u=this.$paddingTop+this.$paddingBottom;t.setMeasuredSize(n+c,r+u)},r.prototype.updateDisplayListReal=function(i,r){var n=this.$target,a=this.$paddingLeft,o=this.$paddingRight,s=this.$paddingTop,l=this.$paddingBottom,h=this.$gap,c=Math.max(0,i-a-o),u=Math.max(0,r-s-l),p=this.$verticalAlign==t.JustifyAlign.JUSTIFY,d=this.$horizontalAlign==t.JustifyAlign.JUSTIFY||this.$horizontalAlign==t.JustifyAlign.CONTENT_JUSTIFY,f=0;d||(this.$horizontalAlign==egret.HorizontalAlign.CENTER?f=.5:this.$horizontalAlign==egret.HorizontalAlign.RIGHT&&(f=1));var g,m,y,v=n.numElements,_=v,b=a,x=s,T=0,E=0,S=[],C=u,w=this.maxElementSize,P=egret.$TempRectangle;for(g=0;v>g;g++){var D=n.getElementAt(g);if(egret.is(D,e)&&D.$includeInLayout)if(D.getPreferredBounds(P),w=Math.max(w,P.width),p)T+=P.height;else{var A=D.$UIComponent;isNaN(A[7])?C-=P.height:(E+=A[7],y=new t.sys.ChildInfo,y.layoutElement=D,y.percent=A[7],y.min=A[14],y.max=A[15],S.push(y))}else _--}C-=h*(_-1),C=C>0?C:0;var I,M=u-T-h*(_-1),$=_,O={};if(p){if(0>M){for(I=C/_,g=0;v>g;g++)m=n.getElementAt(g),egret.is(m,e)&&m.$includeInLayout&&(m.getPreferredBounds(P),P.height<=I&&(C-=P.height,$--));C=C>0?C:0}}else if(E>0){this.flexChildrenProportionally(u,C,E,S);var R=0,L=S.length;for(g=0;L>g;g++){y=S[g];var B=Math.round(y.size+R);R+=y.size-B,O[y.layoutElement.$hashCode]=B,C-=B}C=C>0?C:0}this.$verticalAlign==egret.VerticalAlign.MIDDLE?x=s+.5*C:this.$verticalAlign==egret.VerticalAlign.BOTTOM&&(x=s+C);var k=a,N=s,F=0,G=0,U=Math.ceil(c);this.$horizontalAlign==t.JustifyAlign.CONTENT_JUSTIFY&&(U=Math.ceil(Math.max(c,w)));var V,H,j=0;for(g=0;v>g;g++){var W=0;if(m=n.getElementAt(g),egret.is(m,e)&&m.$includeInLayout){if(m.getPreferredBounds(P),V=0/0,p?(H=0/0,M>0?H=C*P.height/T:0>M&&P.height>I&&(H=C/$),isNaN(H)||(V=Math.round(H+j),j+=H-V)):V=O[m.$hashCode],d)b=a,m.setLayoutBoundsSize(U,V),m.getLayoutBounds(P);else{var X=0/0,A=m.$UIComponent;if(!isNaN(A[6])){var z=Math.min(100,A[6]);X=Math.round(c*z*.01)}m.setLayoutBoundsSize(X,V),m.getLayoutBounds(P),W=(c-P.width)*f,W=W>0?W:0,b=a+W}m.setLayoutBoundsPosition(Math.round(b),Math.round(x)),F=Math.ceil(P.width),G=Math.ceil(P.height),k=Math.max(k,b+F),N=Math.max(N,x+G),x+=G+h}}this.maxElementSize=w,n.setContentSize(k+o,N+l)},r.prototype.updateDisplayListVirtual=function(i,r){var n=this.$target;this.indexInViewCalculated?this.indexInViewCalculated=!1:this.getIndexInView();var a,o=this.$paddingBottom,s=this.$paddingLeft,l=this.$paddingRight,h=this.$gap,c=n.numElements;if(-1==this.startIndex||-1==this.endIndex)return a=this.getStartPosition(c)-h+o,void n.setContentSize(n.contentWidth,a);var u=this.endIndex;n.setVirtualElementIndicesInView(this.startIndex,u);var p=this.$horizontalAlign==t.JustifyAlign.JUSTIFY||this.$horizontalAlign==t.JustifyAlign.CONTENT_JUSTIFY,d=this.$horizontalAlign==t.JustifyAlign.CONTENT_JUSTIFY,f=0;p||(this.$horizontalAlign==egret.HorizontalAlign.CENTER?f=.5:this.$horizontalAlign==egret.HorizontalAlign.RIGHT&&(f=1));var g,m=egret.$TempRectangle,y=Math.max(0,i-s-l),v=Math.ceil(y),_=this.$typicalHeight,b=this.$typicalWidth,x=this.maxElementSize,T=Math.max(b,this.maxElementSize);if(d){for(var E=this.startIndex;u>=E;E++)g=n.getVirtualElementAt(E),egret.is(g,e)&&g.$includeInLayout&&(g.getPreferredBounds(m),x=Math.max(x,m.width));v=Math.ceil(Math.max(y,x))}for(var S,C=0,w=0,P=0,D=!1,A=this.elementSizeTable,I=this.startIndex;u>=I;I++){var M=0;g=n.getVirtualElementAt(I),egret.is(g,e)&&g.$includeInLayout&&(g.getPreferredBounds(m),d||(x=Math.max(x,m.width)),p?(C=s,g.setLayoutBoundsSize(v,0/0),g.getLayoutBounds(m)):(g.getLayoutBounds(m),M=(y-m.width)*f,M=M>0?M:0,C=s+M),P=Math.max(P,m.width),D||(S=isNaN(A[I])?_:A[I],S!=m.height&&(D=!0)),A[I]=m.height,w=this.getStartPosition(I),g.setLayoutBoundsPosition(Math.round(C),Math.round(w)))}P+=s+l,a=this.getStartPosition(c)-h+o,this.maxElementSize=x,n.setContentSize(P,a),(D||T<this.maxElementSize)&&n.invalidateSize()},r.prototype.getStartPosition=function(t){if(!this.$useVirtualLayout&&this.$target){var e=this.$target.getElementAt(t);if(e)return e.y}for(var i=this.$typicalHeight,r=this.$paddingTop,n=this.$gap,a=this.elementSizeTable,o=0;t>o;o++){var s=a[o];isNaN(s)&&(s=i),r+=s+n}return r},r.prototype.getElementSize=function(t){if(this.$useVirtualLayout){var e=this.elementSizeTable[t];return isNaN(e)&&(e=this.$typicalHeight),e}return this.$target?this.$target.getElementAt(t).height:0},r.prototype.getElementTotalSize=function(){for(var t=this.$typicalHeight,e=this.$gap,i=0,r=this.$target.numElements,n=this.elementSizeTable,a=0;r>a;a++){var o=n[a];isNaN(o)&&(o=t),i+=o+e}return i-=e},r.prototype.elementAdded=function(t){this.$useVirtualLayout&&(i.prototype.elementAdded.call(this,t),this.elementSizeTable.splice(t,0,this.$typicalHeight))},r.prototype.getIndexInView=function(){var t=this.$target;if(!t||0==t.numElements)return this.startIndex=this.endIndex=-1,!1;var e=t.$UIComponent;if(0==e[10]||0==e[11])return this.startIndex=this.endIndex=-1,!1;var i=t.numElements,r=this.getStartPosition(i-1)+this.elementSizeTable[i-1]+this.$paddingBottom,n=t.scrollV;if(n>r-this.$paddingBottom)return this.startIndex=-1,this.endIndex=-1,!1;var a=t.scrollV+e[11];if(a<this.$paddingTop)return this.startIndex=-1,this.endIndex=-1,!1;var o=this.startIndex,s=this.endIndex;return this.startIndex=this.findIndexAt(n,0,i-1),-1==this.startIndex&&(this.startIndex=0),this.endIndex=this.findIndexAt(a,0,i-1),-1==this.endIndex&&(this.endIndex=i-1),o!=this.startIndex||s!=this.endIndex},r}(t.LinearLayoutBase);t.VerticalLayout=i,__reflect(i.prototype,"eui.VerticalLayout")}(eui||(eui={}));var eui;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.updateDisplayList=function(e,i){t.prototype.updateDisplayList.call(this,e,i);var r=this.thumb,n=this.$viewport;if(r&&n){var a=egret.$TempRectangle;r.getPreferredBounds(a);var o=a.width,s=a.y,l=n.scrollH,h=n.contentWidth,c=n.width;if(0>=l){var u=o*(1- -l/(.5*c));u=Math.max(5,Math.round(u)),r.setLayoutBoundsSize(u,0/0),r.setLayoutBoundsPosition(0,s)}else if(l>=h-c){var u=o*(1-(l-h+c)/(.5*c));u=Math.max(5,Math.round(u)),r.setLayoutBoundsSize(u,0/0),r.setLayoutBoundsPosition(e-u,s)}else{var p=(e-o)*l/(h-c);r.setLayoutBoundsSize(0/0,0/0),r.setLayoutBoundsPosition(p,s)}}},e.prototype.onPropertyChanged=function(t){switch(t.property){case"scrollH":case"contentWidth":this.invalidateDisplayList()}},e}(t.ScrollBarBase);t.HScrollBar=e,__reflect(e.prototype,"eui.HScrollBar")}(eui||(eui={}));var eui;!function(t){var e=function(){function t(t,e,i,r){this.target=t,this.propertyName=e,this.position=i,this.relativeTo=r}return t.prototype.apply=function(t,e){var i,r=t[this.relativeTo],n=t[this.target],a=this.propertyName?t[this.propertyName]:e;if(n&&a){switch(this.position){case 0:i=0;break;case 1:i=-1;break;case 2:i=a.getChildIndex(r);break;case 3:i=a.getChildIndex(r)+1}-1==i&&(i=a.numChildren),egret.is(a,"eui.Component")&&a.$Component[8].$elementsContent.push(n),a.addChildAt(n,i)}},t.prototype.remove=function(t,e){var i=this.propertyName?t[this.propertyName]:e,r=t[this.target];if(r&&i&&(r.$parent===i&&i.removeChild(r),egret.is(i,"eui.Component"))){var n=i.$Component[8].$elementsContent,a=n.indexOf(r);a>-1&&n.splice(a,1)}},t}();t.AddItems=e,__reflect(e.prototype,"eui.AddItems",["eui.IOverride"])}(eui||(eui={}));var eui;!function(t){var e=function(){function t(t,e,i){this.target=t,this.name=e,this.value=i}return t.prototype.apply=function(t,e){var i=this.target?t[this.target]:t;i&&(this.oldValue=i[this.name],this.setPropertyValue(i,this.name,this.value,this.oldValue))},t.prototype.remove=function(t,e){var i=this.target?t[this.target]:t;i&&(this.setPropertyValue(i,this.name,this.oldValue,this.oldValue),this.oldValue=null)},t.prototype.setPropertyValue=function(t,e,i,r){void 0===i||null===i?t[e]=i:"number"==typeof r?t[e]=+i:"boolean"==typeof r?t[e]=this.toBoolean(i):t[e]=i},t.prototype.toBoolean=function(t){return"string"==typeof t?"true"==t.toLowerCase():0!=t},t}();t.SetProperty=e,__reflect(e.prototype,"eui.SetProperty",["eui.IOverride"])}(eui||(eui={}));var eui;!function(t){var e=function(){function e(t,e,i,r,n){this.host=t,this.templates=e,this.chainIndex=i,this.target=r,this.prop=n}return e.prototype.apply=function(e,i){if(this.target){var r=this.target[this.prop];this.oldValue&&this.setPropertyValue(this.target,this.prop,this.oldValue,this.oldValue),r&&(this.oldValue=r),t.Binding.$bindProperties(this.host,this.templates.concat(),this.chainIndex.concat(),this.target,this.prop)}},e.prototype.remove=function(t,e){if(this.target){var i=this.oldValue;this.target[this.prop]&&(this.oldValue=this.target[this.prop]),i&&this.setPropertyValue(this.target,this.prop,i,i)}},e.prototype.setPropertyValue=function(t,e,i,r){void 0===i||null===i?t[e]=i:"number"==typeof r?t[e]=+i:"boolean"==typeof r?t[e]=this.toBoolean(i):t[e]=i},e.prototype.toBoolean=function(t){return"string"==typeof t?"true"==t.toLowerCase():0!=t},e}();t.SetStateProperty=e,__reflect(e.prototype,"eui.SetStateProperty",["eui.IOverride"])}(eui||(eui={}));var eui;!function(t){var e;!function(t){function e(t,e,i,r,a,o,s,l,h,c){var u;if(!isNaN(i)&&isNaN(r)){if(u=n(t,e,i,o,i,l,i,c))return u}else if(isNaN(i)&&!isNaN(r)&&(u=n(t,e,a,r,s,r,h,r)))return u;return u=n(t,e,a,o,s,l,h,c)}function i(t,e,i,n,a,o,s,l,h,c){var u;if(!isNaN(i)&&isNaN(n)){if(u=r(t,e,i,o,i,l,i,c))return u}else if(isNaN(i)&&!isNaN(n)&&(u=r(t,e,a,n,s,n,h,n)))return u;return u=r(t,e,a,o,s,l,h,c)}function r(t,e,i,r,n,o,l,h){var c=e.b,u=e.d;if(c>-1e-9&&1e-9>c&&(c=0),u>-1e-9&&1e-9>u&&(u=0),0==c&&0==u)return null;if(0==c&&0==u)return null;if(0==c)return egret.Point.create(i,t/Math.abs(u));if(0==u)return egret.Point.create(t/Math.abs(c),r);var p,d,f,g=c*u>=0?u:-u;if(0!=g&&i>0){var m=1/g;i=Math.max(n,Math.min(l,i)),d=i,f=(t-c*d)*m,f>=o&&h>=f&&c*d+g*f>=0&&(p=egret.Point.create(d,f)),f=(-t-c*d)*m,f>=o&&h>=f&&0>c*d+g*f&&(!p||s(p.x,p.y,e).width>s(d,f,e).width)&&(egret.Point.release(p),p=egret.Point.create(d,f))}if(0!=c&&r>0){var y=1/c;r=Math.max(o,Math.min(h,r)),f=r,d=(t-g*f)*y,d>=n&&l>=d&&c*d+g*f>=0&&(!p||s(p.x,p.y,e).width>s(d,f,e).width)&&(p=egret.Point.create(d,f)),d=(-t-g*f)*y,d>=n&&l>=d&&0>c*d+g*f&&(!p||s(p.x,p.y,e).width>s(d,f,e).width)&&(egret.Point.release(p),p=egret.Point.create(d,f))}if(p)return p;var v=e.a,_=e.c,b=v*_>=0?_:-_;return a(c,g,t,n,o,l,h,v,b)}function n(t,e,i,r,n,o,l,h){var c=e.a,u=e.c;if(c>-1e-9&&1e-9>c&&(c=0),u>-1e-9&&1e-9>u&&(u=0),0==c&&0==u)return null;if(0==c)return egret.Point.create(i,t/Math.abs(u));if(0==u)return egret.Point.create(t/Math.abs(c),r);var p,d,f,g=c*u>=0?u:-u;if(0!=g&&i>0){var m=1/g;i=Math.max(n,Math.min(l,i)),d=i,f=(t-c*d)*m,f>=o&&h>=f&&c*d+g*f>=0&&(p=egret.Point.create(d,f)),f=(-t-c*d)*m,f>=o&&h>=f&&0>c*d+g*f&&(!p||s(p.x,p.y,e).height>s(d,f,e).height)&&(egret.Point.release(p),p=egret.Point.create(d,f))}if(0!=c&&r>0){var y=1/c;r=Math.max(o,Math.min(h,r)),f=r,d=(t-g*f)*y,d>=n&&l>=d&&c*d+g*f>=0&&(!p||s(p.x,p.y,e).height>s(d,f,e).height)&&(egret.Point.release(p),p=egret.Point.create(d,f)),d=(-t-g*f)*y,d>=n&&l>=d&&0>c*d+g*f&&(!p||s(p.x,p.y,e).height>s(d,f,e).height)&&(egret.Point.release(p),p=egret.Point.create(d,f))}if(p)return p;var v=e.b,_=e.d,b=v*_>=0?_:-_;return a(c,g,t,n,o,l,h,v,b)}function a(t,e,i,r,n,a,o,s,l){if(0==t||0==e)return null;var h,c,u=(i-r*t)/e,p=(i-a*t)/e,d=Math.max(n,Math.min(u,p)),f=Math.min(o,Math.max(u,p)),g=s*e-t*l;return f>=d?(c=Math.abs(g)<1e-9?i/(t+e):s*i/g,c=Math.max(d,Math.min(c,f)),h=(i-e*c)/t,egret.Point.create(h,c)):(u=-(r*t+i)/e,p=-(a*t+i)/e,d=Math.max(n,Math.min(u,p)),f=Math.min(o,Math.max(u,p)),f>=d?(c=Math.abs(g)<1e-9?-i/(t+e):-s*i/g,c=Math.max(d,Math.min(c,f)),h=(-i-e*c)/t,egret.Point.create(h,c)):null)}function o(t,e,i,r,n,o,s){var h=i.a,c=i.b,u=i.c,p=i.d;if(h>-1e-9&&1e-9>h&&(h=0),c>-1e-9&&1e-9>c&&(c=0),u>-1e-9&&1e-9>u&&(u=0),p>-1e-9&&1e-9>p&&(p=0),0==c&&0==u)return 0==h||0==p?null:egret.Point.create(t/Math.abs(h),e/Math.abs(p));if(0==h&&0==p)return 0==c||0==u?null:egret.Point.create(e/Math.abs(c),t/Math.abs(u));var d=h*u>=0?u:-u,f=c*p>=0?p:-p,g=h*f-c*d;if(Math.abs(g)<1e-9)return 0==d||0==h||h==-d?null:Math.abs(h*e-c*t)>1e-9?null:a(h,d,t,r,r,o,s,c,f);var m=1/g;t*=m,e*=m;var y;return y=l(h,d,c,f,t,e),y&&r<=y.x&&y.x<=o&&n<=y.y&&y.y<=s&&h*y.x+d*y.x>=0&&c*y.x+f*y.y>=0?y:(y=l(h,d,c,f,t,-e),y&&r<=y.x&&y.x<=o&&n<=y.y&&y.y<=s&&h*y.x+d*y.x>=0&&c*y.x+f*y.y<0?y:(y=l(h,d,c,f,-t,e),y&&r<=y.x&&y.x<=o&&n<=y.y&&y.y<=s&&h*y.x+d*y.x<0&&c*y.x+f*y.y>=0?y:(y=l(h,d,c,f,-t,-e),y&&r<=y.x&&y.x<=o&&n<=y.y&&y.y<=s&&h*y.x+d*y.x<0&&c*y.x+f*y.y<0?y:(egret.Point.release(y),null))))}function s(t,e,i){var r=egret.$TempRectangle.setTo(0,0,t,e);return i.$transformBounds(r),r}function l(t,e,i,r,n,a){return egret.Point.create(r*n-e*a,t*a-i*n)}var h=.1,c=.1,u=function(){function t(){}return t.fitBounds=function(t,r,n,a,l,u,p,d,f,g,m){if(isNaN(t)&&isNaN(r))return egret.Point.create(u,p);var y,v=c>d?0:d-c,_=c>f?0:f-c,b=g+c,x=m+c;if(isNaN(t)||isNaN(r))return isNaN(t)?i(r,n,a,l,u,p,v,_,b,x):e(t,n,a,l,u,p,v,_,b,x);if(y=o(t,r,n,v,_,b,x),!y){var T=void 0;if(T=e(t,n,a,l,u,p,v,_,b,x)){var E=s(T.x,T.y,n).height;E-h>r&&(egret.Point.release(T),T=null)}var S=void 0;if(S=i(r,n,a,l,u,p,v,_,b,x)){var C=s(S.x,S.y,n).width;C-h>t&&(egret.Point.release(S),S=null)}y=T&&S?T.x*T.y>S.x*S.y?T:S:T?T:S,egret.Point.release(T),egret.Point.release(S)}return y},t}();t.MatrixUtil=u,__reflect(u.prototype,"eui.sys.MatrixUtil")}(e=t.sys||(t.sys={}))}(eui||(eui={}));var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);i.prototype=e.prototype,t.prototype=new i},egret;!function(t){var e=function(){function t(){}return t.BINARY="binary",t.TEXT="text",t.VARIABLES="variables",t.TEXTURE="texture",t.SOUND="sound",t}();t.URLLoaderDataFormat=e,__reflect(e.prototype,"egret.URLLoaderDataFormat")}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(e,i,r){var n=t.call(this)||this;return n._name=e,n._frame=0|i,r&&(n._end=0|r),n}return __extends(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"frame",{get:function(){return this._frame},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"end",{get:function(){return this._end},enumerable:!0,configurable:!0}),e.prototype.clone=function(){return new e(this._name,this._frame,this._end)},e}(t.EventDispatcher);t.FrameLabel=e,__reflect(e.prototype,"egret.FrameLabel")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.$mcData=null,t.numFrames=1,t.frames=[],t.labels=null,t.events=[],t.frameRate=0,t.textureData=null,t.spriteSheet=null,t}return __extends(i,e),i.prototype.$init=function(t,e,i){this.textureData=e,this.spriteSheet=i,this.setMCData(t)},i.prototype.getKeyFrameData=function(t){var e=this.frames[t-1];return e.frame&&(e=this.frames[e.frame-1]),e},i.prototype.getTextureByFrame=function(t){var e=this.getKeyFrameData(t);if(e.res){var i=this.getTextureByResName(e.res);return i}return null},i.prototype.$getOffsetByFrame=function(t,e){var i=this.getKeyFrameData(t);i.res&&e.setTo(0|i.x,0|i.y)},i.prototype.getTextureByResName=function(t){if(null==this.spriteSheet)return null;var e=this.spriteSheet.getTexture(t);if(!e){var i=this.textureData[t];e=this.spriteSheet.createTexture(t,i.x,i.y,i.w,i.h)}return e},i.prototype.$isDataValid=function(){return this.frames.length>0},i.prototype.$isTextureValid=function(){return null!=this.textureData&&null!=this.spriteSheet},i.prototype.$fillMCData=function(t){this.frameRate=t.frameRate||24,this.fillFramesData(t.frames),this.fillFrameLabelsData(t.labels),this.fillFrameEventsData(t.events)
},i.prototype.fillFramesData=function(t){for(var e,i=this.frames,r=t?t.length:0,n=0;r>n;n++){var a=t[n];if(i.push(a),a.duration){var o=parseInt(a.duration);if(o>1){e=i.length;for(var s=1;o>s;s++)i.push({frame:e})}}}this.numFrames=i.length},i.prototype.fillFrameLabelsData=function(e){if(e){var i=e.length;if(i>0){this.labels=[];for(var r=0;i>r;r++){var n=e[r];this.labels.push(new t.FrameLabel(n.name,n.frame,n.end))}}}},i.prototype.fillFrameEventsData=function(t){if(t){var e=t.length;if(e>0){this.events=[];for(var i=0;e>i;i++){var r=t[i];this.events[r.frame]=r.name}}}},Object.defineProperty(i.prototype,"mcData",{get:function(){return this.$mcData},set:function(t){this.setMCData(t)},enumerable:!0,configurable:!0}),i.prototype.setMCData=function(t){this.$mcData!=t&&(this.$mcData=t,t&&this.$fillMCData(t))},i}(t.HashObject);t.MovieClipData=e,__reflect(e.prototype,"egret.MovieClipData")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(t,i){var r=e.call(this)||this;return r.enableCache=!0,r.$mcDataCache={},r.$mcDataSet=t,r.setTexture(i),r}return __extends(i,e),i.prototype.clearCache=function(){this.$mcDataCache={}},i.prototype.generateMovieClipData=function(e){if(void 0===e&&(e=""),""==e&&this.$mcDataSet)for(e in this.$mcDataSet.mc)break;if(""==e)return null;var i=this.findFromCache(e,this.$mcDataCache);return i||(i=new t.MovieClipData,this.fillData(e,i,this.$mcDataCache)),i},i.prototype.findFromCache=function(t,e){return this.enableCache&&e[t]?e[t]:null},i.prototype.fillData=function(t,e,i){if(this.$mcDataSet){var r=this.$mcDataSet.mc[t];r&&(e.$init(r,this.$mcDataSet.res,this.$spriteSheet),this.enableCache&&(i[t]=e))}},Object.defineProperty(i.prototype,"mcDataSet",{get:function(){return this.$mcDataSet},set:function(t){this.$mcDataSet=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"texture",{set:function(t){this.setTexture(t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"spriteSheet",{get:function(){return this.$spriteSheet},enumerable:!0,configurable:!0}),i.prototype.setTexture=function(e){this.$spriteSheet=e?new t.SpriteSheet(e):null},i}(t.EventDispatcher);t.MovieClipDataFactory=e,__reflect(e.prototype,"egret.MovieClipDataFactory")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(t,i,r,n){void 0===i&&(i=!1),void 0===r&&(r=!1),void 0===n&&(n=null);var a=e.call(this,t,i,r)||this;return a.frameLabel=null,a.frameLabel=n,a}return __extends(i,e),i.dispatchMovieClipEvent=function(e,r,n){void 0===n&&(n=null);var a=t.Event.create(i,r);a.frameLabel=n;var o=e.dispatchEvent(a);return t.Event.release(a),o},i.FRAME_LABEL="frame_label",i}(t.Event);t.MovieClipEvent=e,__reflect(e.prototype,"egret.MovieClipEvent")}(egret||(egret={}));var egret;!function(t){var e=function(){function e(){t.$error(1014)}return e.get=function(t){return-1>t&&(t=-1),t>1&&(t=1),function(e){return 0==t?e:0>t?e*(e*-t+1+t):e*((2-e)*t+(1-t))}},e.getPowOut=function(t){return function(e){return 1-Math.pow(1-e,t)}},e.quintOut=e.getPowOut(5),e.quartOut=e.getPowOut(4),e}();t.ScrollEase=e,__reflect(e.prototype,"egret.ScrollEase");var i=function(e){function i(t,i,r){var n=e.call(this)||this;return n._target=null,n._useTicks=!1,n.ignoreGlobalPause=!1,n.loop=!1,n.pluginData=null,n._steps=null,n._actions=null,n.paused=!1,n.duration=0,n._prevPos=-1,n.position=null,n._prevPosition=0,n._stepPosition=0,n.passive=!1,n.initialize(t,i,r),n}return __extends(i,e),i.get=function(t,e,r,n){return void 0===e&&(e=null),void 0===r&&(r=null),void 0===n&&(n=!1),n&&i.removeTweens(t),new i(t,e,r)},i.removeTweens=function(t){if(t.tween_count){for(var e=i._tweens,r=e.length-1;r>=0;r--)e[r]._target==t&&(e[r].paused=!0,e.splice(r,1));t.tween_count=0}},i.tick=function(t,e){void 0===e&&(e=!1);var r=t-i._lastTime;i._lastTime=t;for(var n=i._tweens.concat(),a=n.length-1;a>=0;a--){var o=n[a];e&&!o.ignoreGlobalPause||o.paused||o.tick(o._useTicks?1:r)}return!1},i._register=function(e,r){var n=e._target,a=i._tweens;if(r)n&&(n.tween_count=n.tween_count>0?n.tween_count+1:1),a.push(e),i._inited||(i._lastTime=t.getTimer(),t.ticker.$startTick(i.tick,null),i._inited=!0);else{n&&n.tween_count--;for(var o=a.length;o--;)if(a[o]==e)return void a.splice(o,1)}},i.prototype.initialize=function(t,e,r){this._target=t,e&&(this._useTicks=e.useTicks,this.ignoreGlobalPause=e.ignoreGlobalPause,this.loop=e.loop,e.onChange&&this.addEventListener("change",e.onChange,e.onChangeObj),e.override&&i.removeTweens(t)),this.pluginData=r||{},this._curQueueProps={},this._initQueueProps={},this._steps=[],this._actions=[],e&&e.paused?this.paused=!0:i._register(this,!0),e&&null!=e.position&&this.setPosition(e.position)},i.prototype.setPosition=function(t,e){void 0===e&&(e=1),0>t&&(t=0);var i=t,r=!1;if(i>=this.duration&&(this.loop?i%=this.duration:(i=this.duration,r=!0)),i==this._prevPos)return r;var n=this._prevPos;if(this.position=this._prevPos=i,this._prevPosition=t,this._target)if(r)this._updateTargetProps(null,1);else if(this._steps.length>0){var a=void 0,o=this._steps.length;for(a=0;o>a&&!(this._steps[a].t>i);a++);var s=this._steps[a-1];this._updateTargetProps(s,(this._stepPosition=i-s.t)/s.d)}return r&&this.setPaused(!0),0!=e&&this._actions.length>0&&(this._useTicks?this._runActions(i,i):1==e&&n>i?(n!=this.duration&&this._runActions(n,this.duration),this._runActions(0,i,!0)):this._runActions(n,i)),this.dispatchEventWith("change"),r},i.prototype._runActions=function(t,e,i){void 0===i&&(i=!1);var r=t,n=e,a=-1,o=this._actions.length,s=1;for(t>e&&(r=e,n=t,a=o,o=s=-1);(a+=s)!=o;){var l=this._actions[a],h=l.t;(h==n||h>r&&n>h||i&&h==t)&&l.f.apply(l.o,l.p)}},i.prototype._updateTargetProps=function(t,e){var r,n,a,o,s,l;if(t||1!=e){if(this.passive=!!t.v,this.passive)return;t.e&&(e=t.e(e,0,1,1)),r=t.p0,n=t.p1}else this.passive=!1,r=n=this._curQueueProps;for(var h in this._initQueueProps){null==(o=r[h])&&(r[h]=o=this._initQueueProps[h]),null==(s=n[h])&&(n[h]=s=o),a=o==s||0==e||1==e||"number"!=typeof o?1==e?s:o:o+(s-o)*e;var c=!1;if(l=i._plugins[h])for(var u=0,p=l.length;p>u;u++){var d=l[u].tween(this,h,a,r,n,e,!!t&&r==n,!t);d==i.IGNORE?c=!0:a=d}c||(this._target[h]=a)}},i.prototype.setPaused=function(t){return this.paused=t,i._register(this,!t),this},i.prototype._cloneProps=function(t){var e={};for(var i in t)e[i]=t[i];return e},i.prototype._addStep=function(t){return t.d>0&&(this._steps.push(t),t.t=this.duration,this.duration+=t.d),this},i.prototype._appendQueueProps=function(t){var e,r,n,a,o;for(var s in t)if(void 0===this._initQueueProps[s]){if(r=this._target[s],e=i._plugins[s])for(n=0,a=e.length;a>n;n++)r=e[n].init(this,s,r);this._initQueueProps[s]=this._curQueueProps[s]=void 0===r?null:r}else r=this._curQueueProps[s];for(var s in t){if(r=this._curQueueProps[s],e=i._plugins[s])for(o=o||{},n=0,a=e.length;a>n;n++)e[n].step&&e[n].step(this,s,r,t[s],o);this._curQueueProps[s]=t[s]}return o&&this._appendQueueProps(o),this._curQueueProps},i.prototype._addAction=function(t){return t.t=this.duration,this._actions.push(t),this},i.prototype.to=function(t,e,i){return void 0===i&&(i=void 0),(isNaN(e)||0>e)&&(e=0),this._addStep({d:e||0,p0:this._cloneProps(this._curQueueProps),e:i,p1:this._cloneProps(this._appendQueueProps(t))})},i.prototype.call=function(t,e,i){return void 0===e&&(e=void 0),void 0===i&&(i=void 0),this._addAction({f:t,p:i?i:[],o:e?e:this._target})},i.prototype.tick=function(t){this.paused||this.setPosition(this._prevPosition+t)},i._tweens=[],i.IGNORE={},i._plugins={},i._inited=!1,i._lastTime=0,i}(t.EventDispatcher);t.ScrollTween=i,__reflect(i.prototype,"egret.ScrollTween")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(i){void 0===i&&(i=null);var r=e.call(this)||this;return r.scrollBeginThreshold=10,r.scrollSpeed=1,r._content=null,r.delayTouchBeginEvent=null,r.touchBeginTimer=null,r.touchEnabled=!0,r._ScrV_Props_=new t.ScrollViewProperties,i&&r.setContent(i),r}return __extends(i,e),Object.defineProperty(i.prototype,"bounces",{get:function(){return this._ScrV_Props_._bounces},set:function(t){this._ScrV_Props_._bounces=!!t},enumerable:!0,configurable:!0}),i.prototype.setContent=function(t){this._content!==t&&(this.removeContent(),t&&(this._content=t,e.prototype.addChild.call(this,t),this._addEvents()))},i.prototype.removeContent=function(){this._content&&(this._removeEvents(),e.prototype.removeChildAt.call(this,0)),this._content=null},Object.defineProperty(i.prototype,"verticalScrollPolicy",{get:function(){return this._ScrV_Props_._verticalScrollPolicy},set:function(t){t!=this._ScrV_Props_._verticalScrollPolicy&&(this._ScrV_Props_._verticalScrollPolicy=t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"horizontalScrollPolicy",{get:function(){return this._ScrV_Props_._horizontalScrollPolicy},set:function(t){t!=this._ScrV_Props_._horizontalScrollPolicy&&(this._ScrV_Props_._horizontalScrollPolicy=t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"scrollLeft",{get:function(){return this._ScrV_Props_._scrollLeft},set:function(t){t!=this._ScrV_Props_._scrollLeft&&(this._ScrV_Props_._scrollLeft=t,this._validatePosition(!1,!0),this._updateContentPosition())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"scrollTop",{get:function(){return this._ScrV_Props_._scrollTop},set:function(t){t!=this._ScrV_Props_._scrollTop&&(this._ScrV_Props_._scrollTop=t,this._validatePosition(!0,!1),this._updateContentPosition())},enumerable:!0,configurable:!0}),i.prototype.setScrollPosition=function(t,e,i){if(void 0===i&&(i=!1),(!i||0!=t||0!=e)&&(i||this._ScrV_Props_._scrollTop!=t||this._ScrV_Props_._scrollLeft!=e)){var r=this._ScrV_Props_._scrollTop,n=this._ScrV_Props_._scrollLeft;if(i){var a=this.getMaxScrollLeft(),o=this.getMaxScrollTop();(0>=r||r>=o)&&(t/=2),(0>=n||n>=a)&&(e/=2);var s=r+t,l=n+e,h=this._ScrV_Props_._bounces;h||((0>=s||s>=o)&&(s=Math.max(0,Math.min(s,o))),(0>=l||l>=a)&&(l=Math.max(0,Math.min(l,a)))),this._ScrV_Props_._scrollTop=s,this._ScrV_Props_._scrollLeft=l}else this._ScrV_Props_._scrollTop=t,this._ScrV_Props_._scrollLeft=e;this._validatePosition(!0,!0),this._updateContentPosition()}},i.prototype._validatePosition=function(t,e){if(void 0===t&&(t=!1),void 0===e&&(e=!1),t){var i=this.height,r=this._getContentHeight();this._ScrV_Props_._scrollTop=Math.max(this._ScrV_Props_._scrollTop,(0-i)/2),this._ScrV_Props_._scrollTop=Math.min(this._ScrV_Props_._scrollTop,r>i?r-i/2:i/2)}if(e){var n=this.width,a=this._getContentWidth();this._ScrV_Props_._scrollLeft=Math.max(this._ScrV_Props_._scrollLeft,(0-n)/2),this._ScrV_Props_._scrollLeft=Math.min(this._ScrV_Props_._scrollLeft,a>n?a-n/2:n/2)}},i.prototype.$setWidth=function(t){this.$explicitWidth!=t&&(e.prototype.$setWidth.call(this,t),this._updateContentPosition())},i.prototype.$setHeight=function(t){this.$explicitHeight!=t&&(e.prototype.$setHeight.call(this,t),this._updateContentPosition())},i.prototype._updateContentPosition=function(){var e=this.height,i=this.width;this.scrollRect=new t.Rectangle(Math.round(this._ScrV_Props_._scrollLeft),Math.round(this._ScrV_Props_._scrollTop),i,e),this.dispatchEvent(new t.Event(t.Event.CHANGE))},i.prototype._checkScrollPolicy=function(){var t=this._ScrV_Props_._horizontalScrollPolicy,e=this.__checkScrollPolicy(t,this._getContentWidth(),this.width);this._ScrV_Props_._hCanScroll=e;var i=this._ScrV_Props_._verticalScrollPolicy,r=this.__checkScrollPolicy(i,this._getContentHeight(),this.height);return this._ScrV_Props_._vCanScroll=r,e||r},i.prototype.__checkScrollPolicy=function(t,e,i){return"on"==t?!0:"off"==t?!1:e>i},i.prototype._addEvents=function(){this.addEventListener(t.TouchEvent.TOUCH_BEGIN,this._onTouchBegin,this),this.addEventListener(t.TouchEvent.TOUCH_BEGIN,this._onTouchBeginCapture,this,!0),this.addEventListener(t.TouchEvent.TOUCH_END,this._onTouchEndCapture,this,!0)},i.prototype._removeEvents=function(){this.removeEventListener(t.TouchEvent.TOUCH_BEGIN,this._onTouchBegin,this),this.removeEventListener(t.TouchEvent.TOUCH_BEGIN,this._onTouchBeginCapture,this,!0),this.removeEventListener(t.TouchEvent.TOUCH_END,this._onTouchEndCapture,this,!0)},i.prototype._onTouchBegin=function(e){if(!e.$isDefaultPrevented){var i=this._checkScrollPolicy();i&&(this._ScrV_Props_._touchStartPosition.x=e.stageX,this._ScrV_Props_._touchStartPosition.y=e.stageY,(this._ScrV_Props_._isHTweenPlaying||this._ScrV_Props_._isVTweenPlaying)&&this._onScrollFinished(),this._tempStage=this.stage,this._tempStage.addEventListener(t.TouchEvent.TOUCH_MOVE,this._onTouchMove,this),this._tempStage.addEventListener(t.TouchEvent.TOUCH_END,this._onTouchEnd,this),this._tempStage.addEventListener(t.TouchEvent.LEAVE_STAGE,this._onTouchEnd,this),this.addEventListener(t.Event.ENTER_FRAME,this._onEnterFrame,this),this._logTouchEvent(e),e.preventDefault())}},i.prototype._onTouchBeginCapture=function(e){var i=this._checkScrollPolicy();if(i){for(var r=e.target;r!=this;){if("_checkScrollPolicy"in r&&(i=r._checkScrollPolicy()))return;r=r.parent}e.stopPropagation();var n=this.cloneTouchEvent(e);this.delayTouchBeginEvent=n,this.touchBeginTimer||(this.touchBeginTimer=new t.Timer(100,1),this.touchBeginTimer.addEventListener(t.TimerEvent.TIMER_COMPLETE,this._onTouchBeginTimer,this)),this.touchBeginTimer.start(),this._onTouchBegin(e)}},i.prototype._onTouchEndCapture=function(e){var i=this;if(this.delayTouchBeginEvent){this._onTouchBeginTimer(),e.stopPropagation();var r=this.cloneTouchEvent(e);t.callLater(function(){i.stage&&i.dispatchPropagationEvent(r)},this)}},i.prototype._onTouchBeginTimer=function(){this.touchBeginTimer.stop();var t=this.delayTouchBeginEvent;this.delayTouchBeginEvent=null,this.stage&&this.dispatchPropagationEvent(t)},i.prototype.dispatchPropagationEvent=function(e){for(var i=e.$target,r=this.$getPropagationList(i),n=r.length,a=.5*r.length,o=-1,s=0;n>s;s++)if(r[s]===this._content){o=s;break}r.splice(0,o+1),a-=o+1,this.$dispatchPropagationEvent(e,r,a),t.Event.release(e)},i.prototype._onTouchMove=function(t){if(this._ScrV_Props_._lastTouchPosition.x!=t.stageX||this._ScrV_Props_._lastTouchPosition.y!=t.stageY){if(!this._ScrV_Props_._scrollStarted){var e=t.stageX-this._ScrV_Props_._touchStartPosition.x,i=t.stageY-this._ScrV_Props_._touchStartPosition.y,r=Math.sqrt(e*e+i*i);if(r<this.scrollBeginThreshold)return void this._logTouchEvent(t)}this._ScrV_Props_._scrollStarted=!0,this.delayTouchBeginEvent&&(this.delayTouchBeginEvent=null,this.touchBeginTimer.stop()),this.touchChildren=!1;var n=this._getPointChange(t);this.setScrollPosition(n.y,n.x,!0),this._calcVelocitys(t),this._logTouchEvent(t)}},i.prototype._onTouchEnd=function(e){this.touchChildren=!0,this._ScrV_Props_._scrollStarted=!1,this._tempStage.removeEventListener(t.TouchEvent.TOUCH_MOVE,this._onTouchMove,this),this._tempStage.removeEventListener(t.TouchEvent.TOUCH_END,this._onTouchEnd,this),this._tempStage.removeEventListener(t.TouchEvent.LEAVE_STAGE,this._onTouchEnd,this),this.removeEventListener(t.Event.ENTER_FRAME,this._onEnterFrame,this),this._moveAfterTouchEnd()},i.prototype._onEnterFrame=function(e){var i=t.getTimer();i-this._ScrV_Props_._lastTouchTime>100&&i-this._ScrV_Props_._lastTouchTime<300&&this._calcVelocitys(this._ScrV_Props_._lastTouchEvent)},i.prototype._logTouchEvent=function(e){this._ScrV_Props_._lastTouchPosition.x=e.stageX,this._ScrV_Props_._lastTouchPosition.y=e.stageY,this._ScrV_Props_._lastTouchEvent=this.cloneTouchEvent(e),this._ScrV_Props_._lastTouchTime=t.getTimer()},i.prototype._getPointChange=function(t){return{x:this._ScrV_Props_._hCanScroll===!1?0:this._ScrV_Props_._lastTouchPosition.x-t.stageX,y:this._ScrV_Props_._vCanScroll===!1?0:this._ScrV_Props_._lastTouchPosition.y-t.stageY}},i.prototype._calcVelocitys=function(e){var i=t.getTimer();if(0==this._ScrV_Props_._lastTouchTime)return void(this._ScrV_Props_._lastTouchTime=i);var r=this._getPointChange(e),n=i-this._ScrV_Props_._lastTouchTime;r.x/=n,r.y/=n,this._ScrV_Props_._velocitys.push(r),this._ScrV_Props_._velocitys.length>5&&this._ScrV_Props_._velocitys.shift(),this._ScrV_Props_._lastTouchPosition.x=e.stageX,this._ScrV_Props_._lastTouchPosition.y=e.stageY},i.prototype._getContentWidth=function(){return this._content.$explicitWidth||this._content.width},i.prototype._getContentHeight=function(){return this._content.$explicitHeight||this._content.height},i.prototype.getMaxScrollLeft=function(){var t=this._getContentWidth()-this.width;return Math.max(0,t)},i.prototype.getMaxScrollTop=function(){var t=this._getContentHeight()-this.height;return Math.max(0,t)},i.prototype._moveAfterTouchEnd=function(){if(0!=this._ScrV_Props_._velocitys.length){for(var t={x:0,y:0},e=0,r=0;r<this._ScrV_Props_._velocitys.length;r++){var n=this._ScrV_Props_._velocitys[r],a=i.weight[r];t.x+=n.x*a,t.y+=n.y*a,e+=a}this._ScrV_Props_._velocitys.length=0,this.scrollSpeed<=0&&(this.scrollSpeed=1);var o=t.x/e*this.scrollSpeed,s=t.y/e*this.scrollSpeed,l=Math.abs(o),h=Math.abs(s),c=this.getMaxScrollLeft(),u=this.getMaxScrollTop(),p=l>.02?this.getAnimationDatas(o,this._ScrV_Props_._scrollLeft,c):{position:this._ScrV_Props_._scrollLeft,duration:1},d=h>.02?this.getAnimationDatas(s,this._ScrV_Props_._scrollTop,u):{position:this._ScrV_Props_._scrollTop,duration:1};this.setScrollLeft(p.position,p.duration),this.setScrollTop(d.position,d.duration)}},i.prototype.onTweenFinished=function(t){t==this._ScrV_Props_._vScrollTween&&(this._ScrV_Props_._isVTweenPlaying=!1),t==this._ScrV_Props_._hScrollTween&&(this._ScrV_Props_._isHTweenPlaying=!1),0==this._ScrV_Props_._isHTweenPlaying&&0==this._ScrV_Props_._isVTweenPlaying&&this._onScrollFinished()},i.prototype._onScrollStarted=function(){},i.prototype._onScrollFinished=function(){t.ScrollTween.removeTweens(this),this._ScrV_Props_._hScrollTween=null,this._ScrV_Props_._vScrollTween=null,this._ScrV_Props_._isHTweenPlaying=!1,this._ScrV_Props_._isVTweenPlaying=!1,this.dispatchEvent(new t.Event(t.Event.COMPLETE))},i.prototype.setScrollTop=function(e,i){void 0===i&&(i=0);var r=Math.min(this.getMaxScrollTop(),Math.max(e,0));if(0==i)return void(this.scrollTop=r);0==this._ScrV_Props_._bounces&&(e=r);var n=t.ScrollTween.get(this).to({scrollTop:e},i,t.ScrollEase.quartOut);r!=e&&n.to({scrollTop:r},300,t.ScrollEase.quintOut),this._ScrV_Props_._isVTweenPlaying=!0,this._ScrV_Props_._vScrollTween=n,n.call(this.onTweenFinished,this,[n]),this._ScrV_Props_._isHTweenPlaying||this._onScrollStarted()},i.prototype.setScrollLeft=function(e,i){void 0===i&&(i=0);var r=Math.min(this.getMaxScrollLeft(),Math.max(e,0));if(0==i)return void(this.scrollLeft=r);0==this._ScrV_Props_._bounces&&(e=r);var n=t.ScrollTween.get(this).to({scrollLeft:e},i,t.ScrollEase.quartOut);r!=e&&n.to({scrollLeft:r},300,t.ScrollEase.quintOut),this._ScrV_Props_._isHTweenPlaying=!0,this._ScrV_Props_._hScrollTween=n,n.call(this.onTweenFinished,this,[n]),this._ScrV_Props_._isVTweenPlaying||this._onScrollStarted()},i.prototype.getAnimationDatas=function(t,e,i){var r=Math.abs(t),n=.95,a=0,o=.998,s=.02,l=e+500*t;if(0>l||l>i)for(l=e;Math.abs(t)!=1/0&&Math.abs(t)>s;)l+=t,t*=0>l||l>i?o*n:o,a++;else a=500*-Math.log(s/r);var h={position:Math.min(i+50,Math.max(l,-50)),duration:a};return h},i.prototype.cloneTouchEvent=function(e){var i=new t.TouchEvent(e.type,e.bubbles,e.cancelable);return i.touchPointID=e.touchPointID,i.$stageX=e.stageX,i.$stageY=e.stageY,i.touchDown=e.touchDown,i.$isDefaultPrevented=!1,i.$target=e.target,i},i.prototype.throwNotSupportedError=function(){t.$error(1023)},i.prototype.addChild=function(t){return this.throwNotSupportedError(),null},i.prototype.addChildAt=function(t,e){return this.throwNotSupportedError(),null},i.prototype.removeChild=function(t){return this.throwNotSupportedError(),null},i.prototype.removeChildAt=function(t){return this.throwNotSupportedError(),null},i.prototype.setChildIndex=function(t,e){this.throwNotSupportedError()},i.prototype.swapChildren=function(t,e){this.throwNotSupportedError()},i.prototype.swapChildrenAt=function(t,e){this.throwNotSupportedError()},i.weight=[1,1.33,1.66,2,2.33],i}(t.DisplayObjectContainer);t.ScrollView=e,__reflect(e.prototype,"egret.ScrollView")}(egret||(egret={}));var egret;!function(t){var e=function(){function e(){this._verticalScrollPolicy="auto",this._horizontalScrollPolicy="auto",this._scrollLeft=0,this._scrollTop=0,this._hCanScroll=!1,this._vCanScroll=!1,this._lastTouchPosition=new t.Point(0,0),this._touchStartPosition=new t.Point(0,0),this._scrollStarted=!1,this._lastTouchTime=0,this._lastTouchEvent=null,this._velocitys=[],this._isHTweenPlaying=!1,this._isVTweenPlaying=!1,this._hScrollTween=null,this._vScrollTween=null,this._bounces=!0}return e}();t.ScrollViewProperties=e,__reflect(e.prototype,"egret.ScrollViewProperties")}(egret||(egret={}));var egret;!function(t){function e(e){var i=e.url;return-1==i.indexOf("?")&&e.method==t.URLRequestMethod.GET&&e.data&&e.data instanceof t.URLVariables&&(i=i+"?"+e.data.toString()),i}var i=function(i){function r(e){void 0===e&&(e=null);var r=i.call(this)||this;return r.dataFormat=t.URLLoaderDataFormat.TEXT,r.data=null,r._request=null,r._status=-1,e&&r.load(e),r}return __extends(r,i),r.prototype.load=function(i){this._request=i,this.data=null;var r=this;if(r.dataFormat==t.URLLoaderDataFormat.TEXTURE)return void this.loadTexture(r);if(r.dataFormat==t.URLLoaderDataFormat.SOUND)return void this.loadSound(r);var n=e(i),a=new t.HttpRequest;a.open(n,i.method==t.URLRequestMethod.POST?t.HttpMethod.POST:t.HttpMethod.GET);var o;if(i.method!=t.URLRequestMethod.GET&&i.data)if(i.data instanceof t.URLVariables){a.setRequestHeader("Content-Type","application/x-www-form-urlencoded");var s=i.data;o=s.toString()}else a.setRequestHeader("Content-Type","multipart/form-data"),o=i.data;for(var l=i.requestHeaders.length,h=0;l>h;h++){var c=i.requestHeaders[h];a.setRequestHeader(c.name,c.value)}a.addEventListener(t.Event.COMPLETE,function(){r.data=a.response,t.Event.dispatchEvent(r,t.Event.COMPLETE)},this),a.addEventListener(t.IOErrorEvent.IO_ERROR,function(){t.IOErrorEvent.dispatchIOErrorEvent(r)},this),a.responseType=r.dataFormat==t.URLLoaderDataFormat.BINARY?t.HttpResponseType.ARRAY_BUFFER:t.HttpResponseType.TEXT,a.send(o)},r.prototype.getResponseType=function(e){switch(e){case t.URLLoaderDataFormat.TEXT:case t.URLLoaderDataFormat.VARIABLES:return t.URLLoaderDataFormat.TEXT;case t.URLLoaderDataFormat.BINARY:return"arraybuffer";default:return e}},r.prototype.loadSound=function(e){function i(t){e.dispatchEvent(t)}function r(t){a(),e.dispatchEvent(t)}function n(i){a(),e.data=l,window.setTimeout(function(){e.dispatchEventWith(t.Event.COMPLETE)},0)}function a(){l.removeEventListener(t.Event.COMPLETE,n,o),l.removeEventListener(t.IOErrorEvent.IO_ERROR,r,o),l.removeEventListener(t.ProgressEvent.PROGRESS,i,o)}var o=this,s=e._request.url,l=new t.Sound;l.addEventListener(t.Event.COMPLETE,n,o),l.addEventListener(t.IOErrorEvent.IO_ERROR,r,o),l.addEventListener(t.ProgressEvent.PROGRESS,i,o),l.load(s)},r.prototype.loadTexture=function(e){function i(t){e.dispatchEvent(t)}function r(t){a(),e.dispatchEvent(t)}function n(i){a();var r=l.data;r.source.setAttribute&&r.source.setAttribute("bitmapSrc",s);var n=new t.Texture;n._setBitmapData(r),e.data=n,window.setTimeout(function(){e.dispatchEventWith(t.Event.COMPLETE)},0)}function a(){l.removeEventListener(t.Event.COMPLETE,n,o),l.removeEventListener(t.IOErrorEvent.IO_ERROR,r,o),l.removeEventListener(t.ProgressEvent.PROGRESS,i,o)}var o=this,s=e._request.url,l=new t.ImageLoader;l.addEventListener(t.Event.COMPLETE,n,o),l.addEventListener(t.IOErrorEvent.IO_ERROR,r,o),l.addEventListener(t.ProgressEvent.PROGRESS,i,o),l.load(s)},r.prototype.__recycle=function(){this._request=null,this.data=null},r}(t.EventDispatcher);t.URLLoader=i,__reflect(i.prototype,"egret.URLLoader")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(i){var r=e.call(this)||this;return r.$texture=null,r.offsetPoint=t.Point.create(0,0),r.$movieClipData=null,r.frames=null,r.$totalFrames=0,r.frameLabels=null,r.$frameLabelStart=0,r.$frameLabelEnd=0,r.frameEvents=null,r.frameIntervalTime=0,r.$eventPool=null,r.$isPlaying=!1,r.isStopped=!0,r.playTimes=0,r.$currentFrameNum=0,r.$nextFrameNum=1,r.displayedKeyFrameNum=0,r.passedTime=0,r.$frameRate=0/0,r.lastTime=0,r.$smoothing=t.Bitmap.defaultSmoothing,r.setMovieClipData(i),t.nativeRender||(r.$renderNode=new t.sys.NormalBitmapNode),r}return __extends(i,e),i.prototype.createNativeDisplayObject=function(){this.$nativeDisplayObject=new egret_native.NativeDisplayObject(11)},Object.defineProperty(i.prototype,"smoothing",{get:function(){return this.$smoothing},set:function(t){t!=this.$smoothing&&(this.$smoothing=t)},enumerable:!0,configurable:!0}),i.prototype.$init=function(){this.$reset();var t=this.$movieClipData;t&&t.$isDataValid()&&(this.frames=t.frames,this.$totalFrames=t.numFrames,this.frameLabels=t.labels,this.frameEvents=t.events,this.$frameRate=t.frameRate,this.frameIntervalTime=1e3/this.$frameRate,this._initFrame())},i.prototype.$reset=function(){this.frames=null,this.playTimes=0,this.$isPlaying=!1,this.setIsStopped(!0),this.$currentFrameNum=0,this.$nextFrameNum=1,this.displayedKeyFrameNum=0,this.passedTime=0,this.$eventPool=[]},i.prototype._initFrame=function(){this.$movieClipData.$isTextureValid()&&(this.advanceFrame(),this.constructFrame())},i.prototype.$updateRenderNode=function(){var e=this.$texture;if(e){var i=Math.round(this.offsetPoint.x),r=Math.round(this.offsetPoint.y),n=e.$bitmapWidth,a=e.$bitmapHeight,o=e.$getTextureWidth(),s=e.$getTextureHeight(),l=Math.round(e.$getScaleBitmapWidth()),h=Math.round(e.$getScaleBitmapHeight()),c=e.$sourceWidth,u=e.$sourceHeight;t.sys.BitmapNode.$updateTextureData(this.$renderNode,e.$bitmapData,e.$bitmapX,e.$bitmapY,n,a,i,r,o,s,l,h,c,u,t.BitmapFillMode.SCALE,this.$smoothing)}},i.prototype.$measureContentBounds=function(t){var e=this.$texture;if(e){var i=this.offsetPoint.x,r=this.offsetPoint.y,n=e.$getTextureWidth(),a=e.$getTextureHeight();t.setTo(i,r,n,a)}else t.setEmpty()},i.prototype.$onAddToStage=function(t,i){e.prototype.$onAddToStage.call(this,t,i),this.$isPlaying&&this.$totalFrames>1&&this.setIsStopped(!1)},i.prototype.$onRemoveFromStage=function(){e.prototype.$onRemoveFromStage.call(this),this.setIsStopped(!0)},i.prototype.getFrameLabelByName=function(t,e){void 0===e&&(e=!1),e&&(t=t.toLowerCase());var i=this.frameLabels;if(i)for(var r=null,n=0;n<i.length;n++)if(r=i[n],e?r.name.toLowerCase()==t:r.name==t)return r;return null},i.prototype.getFrameStartEnd=function(t){var e=this.frameLabels;if(e)for(var i=null,r=0;r<e.length;r++)if(i=e[r],t==i.name){this.$frameLabelStart=i.frame,this.$frameLabelEnd=i.end;break}},i.prototype.getFrameLabelByFrame=function(t){var e=this.frameLabels;if(e)for(var i=null,r=0;r<e.length;r++)if(i=e[r],i.frame==t)return i;return null},i.prototype.getFrameLabelForFrame=function(t){var e=null,i=null,r=this.frameLabels;if(r)for(var n=0;n<r.length;n++){if(i=r[n],i.frame>t)return e;e=i}return e},i.prototype.play=function(e){void 0===e&&(e=0),this.lastTime=t.getTimer(),this.passedTime=0,this.$isPlaying=!0,this.setPlayTimes(e),this.$totalFrames>1&&this.$stage&&this.setIsStopped(!1)},i.prototype.stop=function(){this.$isPlaying=!1,this.setIsStopped(!0)},i.prototype.prevFrame=function(){this.gotoAndStop(this.$currentFrameNum-1)},i.prototype.nextFrame=function(){this.gotoAndStop(this.$currentFrameNum+1)},i.prototype.gotoAndPlay=function(e,i){void 0===i&&(i=0),(0==arguments.length||arguments.length>2)&&t.$error(1022,"MovieClip.gotoAndPlay()"),"string"==typeof e?this.getFrameStartEnd(e):(this.$frameLabelStart=0,this.$frameLabelEnd=0),this.play(i),this.gotoFrame(e)},i.prototype.gotoAndStop=function(e){1!=arguments.length&&t.$error(1022,"MovieClip.gotoAndStop()"),this.stop(),this.gotoFrame(e)},i.prototype.gotoFrame=function(e){var i;"string"==typeof e?i=this.getFrameLabelByName(e).frame:(i=parseInt(e+"",10),i!=e&&t.$error(1022,"Frame Label Not Found")),1>i?i=1:i>this.$totalFrames&&(i=this.$totalFrames),i!=this.$nextFrameNum&&(this.$nextFrameNum=i,this.advanceFrame(),this.constructFrame(),this.handlePendingEvent())},i.prototype.advanceTime=function(e){var i=this,r=e-i.lastTime;i.lastTime=e;var n=i.frameIntervalTime,a=i.passedTime+r;i.passedTime=a%n;var o=a/n;if(1>o)return!1;for(;o>=1;){if(o--,i.$nextFrameNum++,i.$nextFrameNum>i.$totalFrames||i.$frameLabelStart>0&&i.$nextFrameNum>i.$frameLabelEnd)if(-1==i.playTimes)i.$eventPool.push(t.Event.LOOP_COMPLETE),i.$nextFrameNum=1;else{if(i.playTimes--,!(i.playTimes>0)){i.$nextFrameNum=i.$totalFrames,i.$eventPool.push(t.Event.COMPLETE),i.stop();break}i.$eventPool.push(t.Event.LOOP_COMPLETE),i.$nextFrameNum=1}i.$currentFrameNum==i.$frameLabelEnd&&(i.$nextFrameNum=i.$frameLabelStart),i.advanceFrame()}return i.constructFrame(),i.handlePendingEvent(),!1},i.prototype.advanceFrame=function(){this.$currentFrameNum=this.$nextFrameNum;var e=this.frameEvents[this.$nextFrameNum];e&&""!=e&&t.MovieClipEvent.dispatchMovieClipEvent(this,t.MovieClipEvent.FRAME_LABEL,e)},i.prototype.constructFrame=function(){var e=this,i=e.$currentFrameNum;if(e.displayedKeyFrameNum!=i){var r=e.$movieClipData.getTextureByFrame(i);if(e.$texture=r,e.$movieClipData.$getOffsetByFrame(i,e.offsetPoint),e.displayedKeyFrameNum=i,e.$renderDirty=!0,t.nativeRender)e.$nativeDisplayObject.setDataToBitmapNode(e.$nativeDisplayObject.id,r,[r.$bitmapX,r.$bitmapY,r.$bitmapWidth,r.$bitmapHeight,e.offsetPoint.x,e.offsetPoint.y,r.$getScaleBitmapWidth(),r.$getScaleBitmapHeight(),r.$sourceWidth,r.$sourceHeight]),e.$nativeDisplayObject.setWidth(r.$getTextureWidth()+e.offsetPoint.x),e.$nativeDisplayObject.setHeight(r.$getTextureHeight()+e.offsetPoint.y);else{var n=e.$parent;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp());var a=e.$maskedObject;a&&!a.$cacheDirty&&(a.$cacheDirty=!0,a.$cacheDirtyUp())}}},i.prototype.$renderFrame=function(){var t=this;t.$texture=t.$movieClipData.getTextureByFrame(t.$currentFrameNum),t.$renderDirty=!0;var e=t.$parent;e&&!e.$cacheDirty&&(e.$cacheDirty=!0,e.$cacheDirtyUp());var i=t.$maskedObject;i&&!i.$cacheDirty&&(i.$cacheDirty=!0,i.$cacheDirtyUp())},i.prototype.handlePendingEvent=function(){if(0!=this.$eventPool.length){this.$eventPool.reverse();for(var e=this.$eventPool,i=e.length,r=!1,n=!1,a=0;i>a;a++){var o=e.pop();o==t.Event.LOOP_COMPLETE?n=!0:o==t.Event.COMPLETE?r=!0:this.dispatchEventWith(o)}n&&this.dispatchEventWith(t.Event.LOOP_COMPLETE),r&&this.dispatchEventWith(t.Event.COMPLETE)}},Object.defineProperty(i.prototype,"totalFrames",{get:function(){return this.$totalFrames},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"currentFrame",{get:function(){return this.$currentFrameNum},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"currentFrameLabel",{get:function(){var t=this.getFrameLabelByFrame(this.$currentFrameNum);return t&&t.name},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"currentLabel",{get:function(){var t=this.getFrameLabelForFrame(this.$currentFrameNum);return t?t.name:null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"frameRate",{get:function(){return this.$frameRate},set:function(t){t!=this.$frameRate&&(this.$frameRate=t,this.frameIntervalTime=1e3/this.$frameRate)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isPlaying",{get:function(){return this.$isPlaying},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"movieClipData",{get:function(){return this.$movieClipData},set:function(t){this.setMovieClipData(t)},enumerable:!0,configurable:!0}),i.prototype.setMovieClipData=function(t){this.$movieClipData!=t&&(this.$movieClipData=t,this.$init())},i.prototype.setPlayTimes=function(t){(0>t||t>=1)&&(this.playTimes=0>t?-1:Math.floor(t))},i.prototype.setIsStopped=function(e){this.isStopped!=e&&(this.isStopped=e,e?t.ticker.$stopTick(this.advanceTime,this):(this.playTimes=0==this.playTimes?1:this.playTimes,this.lastTime=t.getTimer(),t.ticker.$startTick(this.advanceTime,this)))},i}(t.DisplayObject);t.MovieClip=e,__reflect(e.prototype,"egret.MovieClip")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(i){void 0===i&&(i=null);
var r=e.call(this)||this;return r.data=null,r.method=t.URLRequestMethod.GET,r.url="",r.requestHeaders=[],r.url=i,r}return __extends(i,e),i}(t.HashObject);t.URLRequest=e,__reflect(e.prototype,"egret.URLRequest")}(egret||(egret={}));var egret;!function(t){var e=function(){function t(t,e){this.name="",this.value="",this.name=t,this.value=e}return t}();t.URLRequestHeader=e,__reflect(e.prototype,"egret.URLRequestHeader")}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.GET="get",t.POST="post",t}();t.URLRequestMethod=e,__reflect(e.prototype,"egret.URLRequestMethod")}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this)||this;return i.variables=null,null!==e&&i.decode(e),i}return __extends(e,t),e.prototype.decode=function(t){this.variables||(this.variables={}),t=t.split("+").join(" ");for(var e,i=/[?&]?([^=]+)=([^&]*)/g;e=i.exec(t);){var r=decodeURIComponent(e[1]),n=decodeURIComponent(e[2]);if(r in this.variables!=0){var a=this.variables[r];a instanceof Array?a.push(n):this.variables[r]=[a,n]}else this.variables[r]=n}},e.prototype.toString=function(){if(!this.variables)return"";var t=this.variables,e=[];for(var i in t)e.push(this.encodeValue(i,t[i]));return e.join("&")},e.prototype.encodeValue=function(t,e){return e instanceof Array?this.encodeArray(t,e):encodeURIComponent(t)+"="+encodeURIComponent(e)},e.prototype.encodeArray=function(t,e){return t?0==e.length?encodeURIComponent(t)+"=":e.map(function(e){return encodeURIComponent(t)+"="+encodeURIComponent(e)}).join("&"):""},e}(t.HashObject);t.URLVariables=e,__reflect(e.prototype,"egret.URLVariables")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(){var r=e.call(this)||this;return r._timeScale=1,r._paused=!1,r._callIndex=-1,r._lastTime=0,r.callBackList=[],null!=i.instance,t.ticker.$startTick(r.update,r),r._lastTime=t.getTimer(),r}return __extends(i,e),i.prototype.update=function(t){var e=t-this._lastTime;if(this._lastTime=t,this._paused)return!1;var i=e*this._timeScale;for(this._callList=this.callBackList.concat(),this._callIndex=0;this._callIndex<this._callList.length;this._callIndex++){var r=this._callList[this._callIndex];r.listener.call(r.thisObject,i)}return this._callIndex=-1,this._callList=null,!1},i.prototype.register=function(t,e,i){void 0===i&&(i=0),this.$insertEventBin(this.callBackList,"",t,e,!1,i,!1)},i.prototype.unregister=function(t,e){this.$removeEventBin(this.callBackList,t,e)},i.prototype.setTimeScale=function(t){this._timeScale=t},i.prototype.getTimeScale=function(){return this._timeScale},i.prototype.pause=function(){this._paused=!0},i.prototype.resume=function(){this._paused=!1},i.getInstance=function(){return null==i.instance&&(i.instance=new i),i.instance},i}(t.EventDispatcher);t.Ticker=e,__reflect(e.prototype,"egret.Ticker")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(){return e.call(this)||this}return __extends(i,e),Object.defineProperty(i.prototype,"stage",{get:function(){return t.sys.$TempStage},enumerable:!0,configurable:!0}),Object.defineProperty(i,"instance",{get:function(){return null==i._instance&&(i._instance=new i),i._instance},enumerable:!0,configurable:!0}),i.deviceType=null,i.DEVICE_PC="web",i.DEVICE_MOBILE="native",i}(t.EventDispatcher);t.MainContext=e,__reflect(e.prototype,"egret.MainContext")}(egret||(egret={})),egret.testDeviceType1=function(){if(!window.navigator||!navigator)return!0;var t=navigator.userAgent.toLowerCase();return-1!=t.indexOf("mobile")||-1!=t.indexOf("android")},egret.MainContext.deviceType=egret.testDeviceType1()?egret.MainContext.DEVICE_MOBILE:egret.MainContext.DEVICE_PC,delete egret.testDeviceType1;var egret;!function(t){var e=function(e){function i(t){void 0===t&&(t=300);var i=e.call(this)||this;return i.objectPool=[],i._length=0,1>t&&(t=1),i.autoDisposeTime=t,i.frameCount=0,i}return __extends(i,e),i.$init=function(){t.ticker.$startTick(i.onUpdate,i)},i.onUpdate=function(t){for(var e=i._callBackList,r=e.length-1;r>=0;r--)e[r].$checkFrame();return!1},i.prototype.$checkFrame=function(){this.frameCount--,this.frameCount<=0&&this.dispose()},Object.defineProperty(i.prototype,"length",{get:function(){return this._length},enumerable:!0,configurable:!0}),i.prototype.push=function(t){var e=this.objectPool;-1==e.indexOf(t)&&(e.push(t),t.__recycle&&t.__recycle(),this._length++,0==this.frameCount&&(this.frameCount=this.autoDisposeTime,i._callBackList.push(this)))},i.prototype.pop=function(){return 0==this._length?null:(this._length--,this.objectPool.pop())},i.prototype.dispose=function(){this._length>0&&(this.objectPool=[],this._length=0),this.frameCount=0;var t=i._callBackList,e=t.indexOf(this);-1!=e&&t.splice(e,1)},i._callBackList=[],i}(t.HashObject);t.Recycler=e,__reflect(e.prototype,"egret.Recycler"),e.$init()}(egret||(egret={}));var egret;!function(t){function e(e,i,l){for(var h=[],c=3;c<arguments.length;c++)h[c-3]=arguments[c];var u={listener:e,thisObject:i,delay:l,originDelay:l,params:h};return o++,1==o&&(s=t.getTimer(),t.ticker.$startTick(r,null)),a++,n[a]=u,a}function i(e){n[e]&&(o--,delete n[e],0==o&&t.ticker.$stopTick(r,null))}function r(t){var e=t-s;s=t;for(var i in n){var r=n[i];r.delay-=e,r.delay<=0&&(r.delay=r.originDelay,r.listener.apply(r.thisObject,r.params))}return!1}var n={},a=0,o=0,s=0;t.setInterval=e,t.clearInterval=i}(egret||(egret={}));var egret;!function(t){function e(e,i,l){for(var h=[],c=3;c<arguments.length;c++)h[c-3]=arguments[c];var u={listener:e,thisObject:i,delay:l,params:h};return o++,1==o&&t.ticker&&(s=t.getTimer(),t.ticker.$startTick(r,null)),a++,n[a]=u,a}function i(e){n[e]&&(o--,delete n[e],0==o&&t.ticker&&t.ticker.$stopTick(r,null))}function r(t){var e=t-s;s=t;for(var r in n){var a=r,o=n[a];o.delay-=e,o.delay<=0&&(i(a),o.listener.apply(o.thisObject,o.params))}return!1}var n={},a=0,o=0,s=0;t.setTimeout=e,t.clearTimeout=i}(egret||(egret={}));var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);i.prototype=e.prototype,t.prototype=new i},egret;!function(t){var e=function(){function e(){t.$error(1014)}return e.get=function(t){return-1>t&&(t=-1),t>1&&(t=1),function(e){return 0==t?e:0>t?e*(e*-t+1+t):e*((2-e)*t+(1-t))}},e.getPowIn=function(t){return function(e){return Math.pow(e,t)}},e.getPowOut=function(t){return function(e){return 1-Math.pow(1-e,t)}},e.getPowInOut=function(t){return function(e){return(e*=2)<1?.5*Math.pow(e,t):1-.5*Math.abs(Math.pow(2-e,t))}},e.sineIn=function(t){return 1-Math.cos(t*Math.PI/2)},e.sineOut=function(t){return Math.sin(t*Math.PI/2)},e.sineInOut=function(t){return-.5*(Math.cos(Math.PI*t)-1)},e.getBackIn=function(t){return function(e){return e*e*((t+1)*e-t)}},e.getBackOut=function(t){return function(e){return--e*e*((t+1)*e+t)+1}},e.getBackInOut=function(t){return t*=1.525,function(e){return(e*=2)<1?.5*(e*e*((t+1)*e-t)):.5*((e-=2)*e*((t+1)*e+t)+2)}},e.circIn=function(t){return-(Math.sqrt(1-t*t)-1)},e.circOut=function(t){return Math.sqrt(1- --t*t)},e.circInOut=function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},e.bounceIn=function(t){return 1-e.bounceOut(1-t)},e.bounceOut=function(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},e.bounceInOut=function(t){return.5>t?.5*e.bounceIn(2*t):.5*e.bounceOut(2*t-1)+.5},e.getElasticIn=function(t,e){var i=2*Math.PI;return function(r){if(0==r||1==r)return r;var n=e/i*Math.asin(1/t);return-(t*Math.pow(2,10*(r-=1))*Math.sin((r-n)*i/e))}},e.getElasticOut=function(t,e){var i=2*Math.PI;return function(r){if(0==r||1==r)return r;var n=e/i*Math.asin(1/t);return t*Math.pow(2,-10*r)*Math.sin((r-n)*i/e)+1}},e.getElasticInOut=function(t,e){var i=2*Math.PI;return function(r){var n=e/i*Math.asin(1/t);return(r*=2)<1?-.5*(t*Math.pow(2,10*(r-=1))*Math.sin((r-n)*i/e)):t*Math.pow(2,-10*(r-=1))*Math.sin((r-n)*i/e)*.5+1}},e.quadIn=e.getPowIn(2),e.quadOut=e.getPowOut(2),e.quadInOut=e.getPowInOut(2),e.cubicIn=e.getPowIn(3),e.cubicOut=e.getPowOut(3),e.cubicInOut=e.getPowInOut(3),e.quartIn=e.getPowIn(4),e.quartOut=e.getPowOut(4),e.quartInOut=e.getPowInOut(4),e.quintIn=e.getPowIn(5),e.quintOut=e.getPowOut(5),e.quintInOut=e.getPowInOut(5),e.backIn=e.getBackIn(1.7),e.backOut=e.getBackOut(1.7),e.backInOut=e.getBackInOut(1.7),e.elasticIn=e.getElasticIn(1,.3),e.elasticOut=e.getElasticOut(1,.3),e.elasticInOut=e.getElasticInOut(1,.3*1.5),e}();t.Ease=e,__reflect(e.prototype,"egret.Ease")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(t,i,r){var n=e.call(this)||this;return n._target=null,n._useTicks=!1,n.ignoreGlobalPause=!1,n.loop=!1,n.pluginData=null,n._steps=null,n.paused=!1,n.duration=0,n._prevPos=-1,n.position=null,n._prevPosition=0,n._stepPosition=0,n.passive=!1,n.initialize(t,i,r),n}return __extends(i,e),i.get=function(e,r,n,a){return void 0===n&&(n=null),void 0===a&&(a=!1),a&&i.removeTweens(e),i.AUTOREMOVE&&e&&e.stage&&e.once&&!e.__tween_remove_once&&(e.__tween_remove_once=!0,e.once(t.Event.REMOVED_FROM_STAGE,function(){e&&(i.removeTweens(e),e.__tween_remove_once=!1)},this)),new i(e,r,n)},i.removeTweens=function(t){if(t.tween_count){for(var e=i._tweens,r=e.length-1;r>=0;r--)e[r]._target==t&&(e[r].paused=!0,e.splice(r,1));t.tween_count=0}},i.pauseTweens=function(e){if(e.tween_count)for(var i=t.Tween._tweens,r=i.length-1;r>=0;r--)i[r]._target==e&&(i[r].paused=!0)},i.resumeTweens=function(e){if(e.tween_count)for(var i=t.Tween._tweens,r=i.length-1;r>=0;r--)i[r]._target==e&&(i[r].paused=!1)},i.tick=function(t,e){void 0===e&&(e=!1);var r=t-i._lastTime;i._lastTime=t;for(var n=i._tweens.concat(),a=n.length-1;a>=0;a--){var o=n[a];e&&!o.ignoreGlobalPause||o.paused||o.$tick(o._useTicks?1:r)}return!1},i._register=function(e,r){var n=e._target,a=i._tweens;if(r)n&&(n.tween_count=n.tween_count>0?n.tween_count+1:1),a.push(e),i._inited||(i._lastTime=t.getTimer(),t.ticker.$startTick(i.tick,null),i._inited=!0);else{n&&n.tween_count--;for(var o=a.length;o--;)if(a[o]==e)return void a.splice(o,1)}},i.removeAllTweens=function(){for(var t=i._tweens,e=0,r=t.length;r>e;e++){var n=t[e];n.paused=!0,n._target.tween_count=0}t.length=0},i.prototype.initialize=function(t,e,r){this._target=t,e&&(this._useTicks=e.useTicks,this.ignoreGlobalPause=e.ignoreGlobalPause,this.loop=e.loop,e.onChange&&this.addEventListener("change",e.onChange,e.onChangeObj),e.override&&i.removeTweens(t)),this.pluginData=r||{},this._curQueueProps={},this._initQueueProps={},this._steps=[],e&&e.paused?this.paused=!0:i._register(this,!0),e&&null!=e.position&&this.setPosition(e.position,i.NONE)},i.prototype.setPosition=function(t,e){void 0===e&&(e=1),0>t&&(t=0);var i=t,r=!1;if(i>=this.duration)if(this.loop){var n=i%this.duration;i=i>0&&0===n?this.duration:n}else i=this.duration,r=!0;if(i==this._prevPos)return r;r&&this.setPaused(!0);var a=this._prevPos;if(this.position=this._prevPos=i,this._prevPosition=t,this._target&&this._steps.length>0){for(var o=this._steps.length,s=-1,l=0;o>l&&!("step"==this._steps[l].type&&(s=l,this._steps[l].t<=i&&this._steps[l].t+this._steps[l].d>=i));l++);for(var l=0;o>l;l++)if("action"==this._steps[l].type)0!=e&&(this._useTicks?this._runAction(this._steps[l],i,i):1==e&&a>i?(a!=this.duration&&this._runAction(this._steps[l],a,this.duration),this._runAction(this._steps[l],0,i,!0)):this._runAction(this._steps[l],a,i));else if("step"==this._steps[l].type&&s==l){var h=this._steps[s];this._updateTargetProps(h,Math.min((this._stepPosition=i-h.t)/h.d,1))}}return this.dispatchEventWith("change"),r},i.prototype._runAction=function(t,e,i,r){void 0===r&&(r=!1);var n=e,a=i;e>i&&(n=i,a=e);var o=t.t;(o==a||o>n&&a>o||r&&o==e)&&t.f.apply(t.o,t.p)},i.prototype._updateTargetProps=function(t,e){var r,n,a,o,s,l;if(t||1!=e){if(this.passive=!!t.v,this.passive)return;t.e&&(e=t.e(e,0,1,1)),r=t.p0,n=t.p1}else this.passive=!1,r=n=this._curQueueProps;for(var h in this._initQueueProps){null==(o=r[h])&&(r[h]=o=this._initQueueProps[h]),null==(s=n[h])&&(n[h]=s=o),a=o==s||0==e||1==e||"number"!=typeof o?1==e?s:o:o+(s-o)*e;var c=!1;if(l=i._plugins[h])for(var u=0,p=l.length;p>u;u++){var d=l[u].tween(this,h,a,r,n,e,!!t&&r==n,!t);d==i.IGNORE?c=!0:a=d}c||(this._target[h]=a)}},i.prototype.setPaused=function(t){return this.paused==t?this:(this.paused=t,i._register(this,!t),this)},i.prototype._cloneProps=function(t){var e={};for(var i in t)e[i]=t[i];return e},i.prototype._addStep=function(t){return t.d>0&&(t.type="step",this._steps.push(t),t.t=this.duration,this.duration+=t.d),this},i.prototype._appendQueueProps=function(t){var e,r,n,a,o;for(var s in t)if(void 0===this._initQueueProps[s]){if(r=this._target[s],e=i._plugins[s])for(n=0,a=e.length;a>n;n++)r=e[n].init(this,s,r);this._initQueueProps[s]=this._curQueueProps[s]=void 0===r?null:r}else r=this._curQueueProps[s];for(var s in t){if(r=this._curQueueProps[s],e=i._plugins[s])for(o=o||{},n=0,a=e.length;a>n;n++)e[n].step&&e[n].step(this,s,r,t[s],o);this._curQueueProps[s]=t[s]}return o&&this._appendQueueProps(o),this._curQueueProps},i.prototype._addAction=function(t){return t.t=this.duration,t.type="action",this._steps.push(t),this},i.prototype._set=function(t,e){for(var i in t)e[i]=t[i]},i.prototype.wait=function(t,e){if(null==t||0>=t)return this;var i=this._cloneProps(this._curQueueProps);return this._addStep({d:t,p0:i,p1:i,v:e})},i.prototype.to=function(t,e,i){return void 0===i&&(i=void 0),(isNaN(e)||0>e)&&(e=0),this._addStep({d:e||0,p0:this._cloneProps(this._curQueueProps),e:i,p1:this._cloneProps(this._appendQueueProps(t))}),this.set(t)},i.prototype.call=function(t,e,i){return void 0===e&&(e=void 0),void 0===i&&(i=void 0),this._addAction({f:t,p:i?i:[],o:e?e:this._target})},i.prototype.set=function(t,e){return void 0===e&&(e=null),this._appendQueueProps(t),this._addAction({f:this._set,o:this,p:[t,e?e:this._target]})},i.prototype.play=function(t){return t||(t=this),this.call(t.setPaused,t,[!1])},i.prototype.pause=function(t){return t||(t=this),this.call(t.setPaused,t,[!0])},i.prototype.$tick=function(t){this.paused||this.setPosition(this._prevPosition+t)},i.NONE=0,i.LOOP=1,i.REVERSE=2,i._tweens=[],i.IGNORE={},i._plugins={},i._inited=!1,i.AUTOREMOVE=!1,i._lastTime=0,i}(t.EventDispatcher);t.Tween=e,__reflect(e.prototype,"egret.Tween")}(egret||(egret={}));var egret;!function(t){var e;!function(e){function i(e){if("function"==typeof e)return e;var i=t.Ease[e];return"function"==typeof i?i:null}function r(t,e,i,r){var n=t.prototype;n.__meta__=n.__meta__||{},n.__meta__[e]=i,r&&(n.__defaultProperty__=e)}var n=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="",e}return __extends(e,t),e}(t.EventDispatcher);e.BasePath=n,__reflect(n.prototype,"egret.tween.BasePath");var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.props=void 0,e.duration=500,e.ease=void 0,e}return __extends(e,t),e}(n);e.To=a,__reflect(a.prototype,"egret.tween.To");var o=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.duration=500,e.passive=void 0,e}return __extends(e,t),e}(n);e.Wait=o,__reflect(o.prototype,"egret.tween.Wait");var s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.props=void 0,e}return __extends(e,t),e}(n);e.Set=s,__reflect(s.prototype,"egret.tween.Set");var l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.delta=0,e}return __extends(e,t),e}(n);e.Tick=l,__reflect(l.prototype,"egret.tween.Tick");var h=function(e){function r(){var t=e.call(this)||this;return t.isStop=!1,t}return __extends(r,e),Object.defineProperty(r.prototype,"props",{get:function(){return this._props},set:function(t){this._props=t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"target",{get:function(){return this._target},set:function(t){this._target=t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"paths",{get:function(){return this._paths},set:function(t){this._paths=t||[]},enumerable:!0,configurable:!0}),r.prototype.play=function(t){this.tween?(this.tween.setPaused(!1),this.isStop&&void 0==t&&(t=0,this.isStop=!1),void 0!==t&&null!==t&&this.tween.setPosition(t)):this.createTween(t)},r.prototype.pause=function(){this.tween&&this.tween.setPaused(!0)},r.prototype.stop=function(){this.pause(),this.isStop=!0},r.prototype.createTween=function(e){this.tween=t.Tween.get(this._target,this._props),this._paths&&this.applyPaths(),void 0!==e&&null!==e&&this.tween.setPosition(e)},r.prototype.applyPaths=function(){for(var t=0;t<this._paths.length;t++){var e=this._paths[t];this.applyPath(e)}},r.prototype.applyPath=function(t){var e=this;t instanceof a?this.tween.to(t.props,t.duration,i(t.ease)):t instanceof o?this.tween.wait(t.duration,t.passive):t instanceof s?this.tween.set(t.props):t instanceof l&&this.tween.$tick(t.delta),this.tween.call(function(){return e.pathComplete(t)})},r.prototype.pathComplete=function(t){t.dispatchEventWith("complete"),this.dispatchEventWith("pathComplete",!1,t);var e=this._paths.indexOf(t);e>=0&&e===this._paths.length-1&&this.dispatchEventWith("complete")},r}(t.EventDispatcher);e.TweenItem=h,__reflect(h.prototype,"egret.tween.TweenItem"),r(h,"paths","Array",!0);var c=function(t){function e(){var e=t.call(this)||this;return e.completeCount=0,e}return __extends(e,t),Object.defineProperty(e.prototype,"items",{get:function(){return this._items},set:function(t){this.completeCount=0,this.registerEvent(!1),this._items=t,this.registerEvent(!0)},enumerable:!0,configurable:!0}),e.prototype.registerEvent=function(t){var e=this;this._items&&this._items.forEach(function(i){t?i.addEventListener("complete",e.itemComplete,e):i.removeEventListener("complete",e.itemComplete,e)})},e.prototype.play=function(t){if(this._items)for(var e=0;e<this._items.length;e++){var i=this._items[e];i.play(t)}},e.prototype.pause=function(){if(this._items)for(var t=0;t<this._items.length;t++){var e=this._items[t];e.pause()}},e.prototype.stop=function(){if(this._items)for(var t=0;t<this._items.length;t++){var e=this._items[t];e.stop()}},e.prototype.itemComplete=function(t){var e=t.currentTarget;this.completeCount++,this.dispatchEventWith("itemComplete",!1,e),this.completeCount===this.items.length&&(this.dispatchEventWith("complete"),this.completeCount=0)},e}(t.EventDispatcher);e.TweenGroup=c,__reflect(c.prototype,"egret.tween.TweenGroup"),r(c,"items","Array",!0)}(e=t.tween||(t.tween={}))}(egret||(egret={})),!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.ES6Promise=e()}(this,function(){"use strict";function t(t){return"function"==typeof t||"object"==typeof t&&null!==t}function e(t){return"function"==typeof t}function i(t){X=t}function r(t){z=t}function n(){return function(){return process.nextTick(h)}}function a(){return"undefined"!=typeof W?function(){W(h)}:l()}function o(){var t=0,e=new Q(h),i=document.createTextNode("");return e.observe(i,{characterData:!0}),function(){i.data=t=++t%2}}function s(){var t=new MessageChannel;return t.port1.onmessage=h,function(){return t.port2.postMessage(0)}}function l(){var t=setTimeout;return function(){return t(h,1)}}function h(){for(var t=0;j>t;t+=2){var e=Z[t],i=Z[t+1];e(i),Z[t]=void 0,Z[t+1]=void 0}j=0}function c(){try{var t=require,e=t("vertx");return W=e.runOnLoop||e.runOnContext,a()}catch(i){return l()}}function u(t,e){var i=arguments,r=this,n=new this.constructor(d);void 0===n[ee]&&$(n);var a=r._state;return a?!function(){var t=i[a-1];z(function(){return A(a,n,t,r._result)})}():C(r,n,t,e),n}function p(t){var e=this;if(t&&"object"==typeof t&&t.constructor===e)return t;var i=new e(d);return x(i,t),i}function d(){}function f(){return new TypeError("You cannot resolve a promise with itself")}function g(){return new TypeError("A promises callback cannot return that same promise.")}function m(t){try{return t.then}catch(e){return ae.error=e,ae}}function y(t,e,i,r){try{t.call(e,i,r)}catch(n){return n}}function v(t,e,i){z(function(t){var r=!1,n=y(i,e,function(i){r||(r=!0,e!==i?x(t,i):E(t,i))},function(e){r||(r=!0,S(t,e))},"Settle: "+(t._label||" unknown promise"));!r&&n&&(r=!0,S(t,n))},t)}function _(t,e){e._state===re?E(t,e._result):e._state===ne?S(t,e._result):C(e,void 0,function(e){return x(t,e)},function(e){return S(t,e)})}function b(t,i,r){i.constructor===t.constructor&&r===u&&i.constructor.resolve===p?_(t,i):r===ae?S(t,ae.error):void 0===r?E(t,i):e(r)?v(t,i,r):E(t,i)}function x(e,i){e===i?S(e,f()):t(i)?b(e,i,m(i)):E(e,i)}function T(t){t._onerror&&t._onerror(t._result),w(t)}function E(t,e){t._state===ie&&(t._result=e,t._state=re,0!==t._subscribers.length&&z(w,t))}function S(t,e){t._state===ie&&(t._state=ne,t._result=e,z(T,t))}function C(t,e,i,r){var n=t._subscribers,a=n.length;t._onerror=null,n[a]=e,n[a+re]=i,n[a+ne]=r,0===a&&t._state&&z(w,t)}function w(t){var e=t._subscribers,i=t._state;if(0!==e.length){for(var r=void 0,n=void 0,a=t._result,o=0;o<e.length;o+=3)r=e[o],n=e[o+i],r?A(i,r,n,a):n(a);t._subscribers.length=0}}function P(){this.error=null}function D(t,e){try{return t(e)}catch(i){return oe.error=i,oe}}function A(t,i,r,n){var a=e(r),o=void 0,s=void 0,l=void 0,h=void 0;if(a){if(o=D(r,n),o===oe?(h=!0,s=o.error,o=null):l=!0,i===o)return void S(i,g())}else o=n,l=!0;i._state!==ie||(a&&l?x(i,o):h?S(i,s):t===re?E(i,o):t===ne&&S(i,o))}function I(t,e){try{e(function(e){x(t,e)},function(e){S(t,e)})}catch(i){S(t,i)}}function M(){return se++}function $(t){t[ee]=se++,t._state=void 0,t._result=void 0,t._subscribers=[]}function O(t,e){this._instanceConstructor=t,this.promise=new t(d),this.promise[ee]||$(this.promise),H(e)?(this._input=e,this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?E(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&E(this.promise,this._result))):S(this.promise,R())}function R(){return new Error("Array Methods must be provided an Array")}function L(t){return new O(this,t).promise}function B(t){var e=this;return new e(H(t)?function(i,r){for(var n=t.length,a=0;n>a;a++)e.resolve(t[a]).then(i,r)}:function(t,e){return e(new TypeError("You must pass an array to race."))})}function k(t){var e=this,i=new e(d);return S(i,t),i}function N(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function F(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function G(t){this[ee]=M(),this._result=this._state=void 0,this._subscribers=[],d!==t&&("function"!=typeof t&&N(),this instanceof G?I(this,t):F())}function U(){var t=void 0;if("undefined"!=typeof global)t=global;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var i=t.Promise;if("undefined"!=typeof egret_native&&egret_native.capability&&!egret_native.capability("Promise")&&(i=void 0),i){var r=null;try{r=Object.prototype.toString.call(i.resolve())}catch(e){}if("[object Promise]"===r&&!i.cast)return}t.Promise=G}var V=void 0;V=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};var H=V,j=0,W=void 0,X=void 0,z=function(t,e){Z[j]=t,Z[j+1]=e,j+=2,2===j&&(X?X(h):te())},Y="undefined"!=typeof window?window:void 0,q=Y||{},Q=q.MutationObserver||q.WebKitMutationObserver,K="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),J="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,Z=new Array(1e3),te=void 0;te=K?n():Q?o():J?s():void 0===Y&&"function"==typeof require?c():l();var ee=Math.random().toString(36).substring(16),ie=void 0,re=1,ne=2,ae=new P,oe=new P,se=0;return O.prototype._enumerate=function(){for(var t=this.length,e=this._input,i=0;this._state===ie&&t>i;i++)this._eachEntry(e[i],i)},O.prototype._eachEntry=function(t,e){var i=this._instanceConstructor,r=i.resolve;if(r===p){var n=m(t);if(n===u&&t._state!==ie)this._settledAt(t._state,e,t._result);else if("function"!=typeof n)this._remaining--,this._result[e]=t;else if(i===G){var a=new i(d);b(a,t,n),this._willSettleAt(a,e)}else this._willSettleAt(new i(function(e){return e(t)}),e)}else this._willSettleAt(r(t),e)},O.prototype._settledAt=function(t,e,i){var r=this.promise;r._state===ie&&(this._remaining--,t===ne?S(r,i):this._result[e]=i),0===this._remaining&&E(r,this._result)},O.prototype._willSettleAt=function(t,e){var i=this;C(t,void 0,function(t){return i._settledAt(re,e,t)},function(t){return i._settledAt(ne,e,t)})},G.all=L,G.race=B,G.resolve=p,G.reject=k,G._setScheduler=i,G._setAsap=r,G._asap=z,G.prototype={constructor:G,then:u,"catch":function(t){return this.then(null,t)}},G.polyfill=U,G.Promise=G,G}),ES6Promise.polyfill();var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),dragonBones;!function(t){}(dragonBones||(dragonBones={}));var dragonBones;if(function(t){var e=function(){function e(i){this._clock=new t.WorldClock,this._events=[],this._objects=[],this._eventManager=null,this._eventManager=i,console.info("DragonBones: "+e.VERSION+"\nWebsite: http://dragonbones.com/\nSource and Demo: https://github.com/DragonBones/")}return e.prototype.advanceTime=function(e){if(this._objects.length>0){for(var i=0,r=this._objects;i<r.length;i++){var n=r[i];n.returnToPool()}this._objects.length=0}if(this._clock.advanceTime(e),this._events.length>0){for(var a=0;a<this._events.length;++a){var o=this._events[a],s=o.armature;null!==s._armatureData&&(s.eventDispatcher.dispatchDBEvent(o.type,o),o.type===t.EventObject.SOUND_EVENT&&this._eventManager.dispatchDBEvent(o.type,o)),this.bufferObject(o)}this._events.length=0}},e.prototype.bufferEvent=function(t){this._events.indexOf(t)<0&&this._events.push(t)},e.prototype.bufferObject=function(t){this._objects.indexOf(t)<0&&this._objects.push(t)},Object.defineProperty(e.prototype,"clock",{get:function(){return this._clock},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"eventManager",{get:function(){return this._eventManager},enumerable:!0,configurable:!0}),e.VERSION="5.6.300",e.yDown=!0,e.debug=!1,e.debugDraw=!1,e.webAssembly=!1,e}();t.DragonBones=e}(dragonBones||(dragonBones={})),"undefined"==typeof global)var global=window;console.warn||(console.warn=function(){}),console.assert||(console.assert=function(){}),Date.now||(Date.now=function(){return(new Date).getTime()});var __extends=function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);i.prototype=e.prototype,t.prototype=new i},dragonBones;!function(t){var e=function(){function t(){this.hashCode=t._hashCode++,this._isInPool=!1}return t._returnObject=function(e){var i=String(e.constructor),r=i in t._maxCountMap?t._maxCountMap[i]:t._defaultMaxCount,n=t._poolsMap[i]=t._poolsMap[i]||[];n.length<r&&(e._isInPool?console.warn("The object is already in the pool."):(e._isInPool=!0,n.push(e)))},t.toString=function(){throw new Error},t.setMaxCount=function(e,i){if((0>i||i!==i)&&(i=0),null!==e){var r=String(e),n=r in t._poolsMap?t._poolsMap[r]:null;null!==n&&n.length>i&&(n.length=i),t._maxCountMap[r]=i}else{t._defaultMaxCount=i;for(var r in t._poolsMap){var n=t._poolsMap[r];n.length>i&&(n.length=i),r in t._maxCountMap&&(t._maxCountMap[r]=i)}}},t.clearPool=function(e){if(void 0===e&&(e=null),null!==e){var i=String(e),r=i in t._poolsMap?t._poolsMap[i]:null;null!==r&&r.length>0&&(r.length=0)}else for(var n in t._poolsMap){var r=t._poolsMap[n];r.length=0}},t.borrowObject=function(e){var i=String(e),r=i in t._poolsMap?t._poolsMap[i]:null;if(null!==r&&r.length>0){var n=r.pop();return n._isInPool=!1,n}var a=new e;return a._onClear(),a},t.prototype.returnToPool=function(){this._onClear(),t._returnObject(this)},t._hashCode=0,t._defaultMaxCount=3e3,t._maxCountMap={},t._poolsMap={},t}();t.BaseObject=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function t(t,e,i,r,n,a){void 0===t&&(t=1),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=1),void 0===n&&(n=0),void 0===a&&(a=0),this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=a}return t.prototype.toString=function(){return"[object dragonBones.Matrix] a:"+this.a+" b:"+this.b+" c:"+this.c+" d:"+this.d+" tx:"+this.tx+" ty:"+this.ty},t.prototype.copyFrom=function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},t.prototype.copyFromArray=function(t,e){return void 0===e&&(e=0),this.a=t[e],this.b=t[e+1],this.c=t[e+2],this.d=t[e+3],this.tx=t[e+4],this.ty=t[e+5],this},t.prototype.identity=function(){return this.a=this.d=1,this.b=this.c=0,this.tx=this.ty=0,this},t.prototype.concat=function(t){var e=this.a*t.a,i=0,r=0,n=this.d*t.d,a=this.tx*t.a+t.tx,o=this.ty*t.d+t.ty;return(0!==this.b||0!==this.c)&&(e+=this.b*t.c,i+=this.b*t.d,r+=this.c*t.a,n+=this.c*t.b),(0!==t.b||0!==t.c)&&(i+=this.a*t.b,r+=this.d*t.c,a+=this.ty*t.c,o+=this.tx*t.b),this.a=e,this.b=i,this.c=r,this.d=n,this.tx=a,this.ty=o,this},t.prototype.invert=function(){var t=this.a,e=this.b,i=this.c,r=this.d,n=this.tx,a=this.ty;if(0===e&&0===i)return this.b=this.c=0,0===t||0===r?this.a=this.b=this.tx=this.ty=0:(t=this.a=1/t,r=this.d=1/r,this.tx=-t*n,this.ty=-r*a),this;var o=t*r-e*i;if(0===o)return this.a=this.d=1,this.b=this.c=0,this.tx=this.ty=0,this;o=1/o;var s=this.a=r*o;return e=this.b=-e*o,i=this.c=-i*o,r=this.d=t*o,this.tx=-(s*n+i*a),this.ty=-(e*n+r*a),this},t.prototype.transformPoint=function(t,e,i,r){void 0===r&&(r=!1),i.x=this.a*t+this.c*e,i.y=this.b*t+this.d*e,r||(i.x+=this.tx,i.y+=this.ty)},t.prototype.transformRectangle=function(t,e){void 0===e&&(e=!1);var i=this.a,r=this.b,n=this.c,a=this.d,o=e?0:this.tx,s=e?0:this.ty,l=t.x,h=t.y,c=l+t.width,u=h+t.height,p=i*l+n*h+o,d=r*l+a*h+s,f=i*c+n*h+o,g=r*c+a*h+s,m=i*c+n*u+o,y=r*c+a*u+s,v=i*l+n*u+o,_=r*l+a*u+s,b=0;p>f&&(b=p,p=f,f=b),m>v&&(b=m,m=v,v=b),t.x=Math.floor(m>p?p:m),t.width=Math.ceil((f>v?f:v)-t.x),d>g&&(b=d,d=g,g=b),y>_&&(b=y,y=_,_=b),t.y=Math.floor(y>d?d:y),t.height=Math.ceil((g>_?g:_)-t.y)},t}();t.Matrix=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function t(t,e,i,r,n,a){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),void 0===n&&(n=1),void 0===a&&(a=1),this.x=t,this.y=e,this.skew=i,this.rotation=r,this.scaleX=n,this.scaleY=a}return t.normalizeRadian=function(t){return t=(t+Math.PI)%(2*Math.PI),t+=t>0?-Math.PI:Math.PI},t.prototype.toString=function(){return"[object dragonBones.Transform] x:"+this.x+" y:"+this.y+" skewX:"+180*this.skew/Math.PI+" skewY:"+180*this.rotation/Math.PI+" scaleX:"+this.scaleX+" scaleY:"+this.scaleY},t.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.skew=t.skew,this.rotation=t.rotation,this.scaleX=t.scaleX,this.scaleY=t.scaleY,this},t.prototype.identity=function(){return this.x=this.y=0,this.skew=this.rotation=0,this.scaleX=this.scaleY=1,this},t.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this.skew+=t.skew,this.rotation+=t.rotation,this.scaleX*=t.scaleX,this.scaleY*=t.scaleY,this},t.prototype.minus=function(t){return this.x-=t.x,this.y-=t.y,this.skew-=t.skew,this.rotation-=t.rotation,this.scaleX/=t.scaleX,this.scaleY/=t.scaleY,this},t.prototype.fromMatrix=function(e){var i=this.scaleX,r=this.scaleY,n=t.PI_Q;this.x=e.tx,this.y=e.ty,this.rotation=Math.atan(e.b/e.a);var a=Math.atan(-e.c/e.d);return this.scaleX=this.rotation>-n&&this.rotation<n?e.a/Math.cos(this.rotation):e.b/Math.sin(this.rotation),this.scaleY=a>-n&&n>a?e.d/Math.cos(a):-e.c/Math.sin(a),i>=0&&this.scaleX<0&&(this.scaleX=-this.scaleX,this.rotation=this.rotation-Math.PI),r>=0&&this.scaleY<0&&(this.scaleY=-this.scaleY,a-=Math.PI),this.skew=a-this.rotation,this
},t.prototype.toMatrix=function(t){return 0===this.rotation?(t.a=1,t.b=0):(t.a=Math.cos(this.rotation),t.b=Math.sin(this.rotation)),0===this.skew?(t.c=-t.b,t.d=t.a):(t.c=-Math.sin(this.skew+this.rotation),t.d=Math.cos(this.skew+this.rotation)),1!==this.scaleX&&(t.a*=this.scaleX,t.b*=this.scaleX),1!==this.scaleY&&(t.c*=this.scaleY,t.d*=this.scaleY),t.tx=this.x,t.ty=this.y,this},t.PI=Math.PI,t.PI_D=2*Math.PI,t.PI_H=Math.PI/2,t.PI_Q=Math.PI/4,t.RAD_DEG=180/Math.PI,t.DEG_RAD=Math.PI/180,t}();t.Transform=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function t(t,e,i,r,n,a,o,s){void 0===t&&(t=1),void 0===e&&(e=1),void 0===i&&(i=1),void 0===r&&(r=1),void 0===n&&(n=0),void 0===a&&(a=0),void 0===o&&(o=0),void 0===s&&(s=0),this.alphaMultiplier=t,this.redMultiplier=e,this.greenMultiplier=i,this.blueMultiplier=r,this.alphaOffset=n,this.redOffset=a,this.greenOffset=o,this.blueOffset=s}return t.prototype.copyFrom=function(t){this.alphaMultiplier=t.alphaMultiplier,this.redMultiplier=t.redMultiplier,this.greenMultiplier=t.greenMultiplier,this.blueMultiplier=t.blueMultiplier,this.alphaOffset=t.alphaOffset,this.redOffset=t.redOffset,this.greenOffset=t.greenOffset,this.blueOffset=t.blueOffset},t.prototype.identity=function(){this.alphaMultiplier=this.redMultiplier=this.greenMultiplier=this.blueMultiplier=1,this.alphaOffset=this.redOffset=this.greenOffset=this.blueOffset=0},t}();t.ColorTransform=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}return t.prototype.copyFrom=function(t){this.x=t.x,this.y=t.y},t.prototype.clear=function(){this.x=this.y=0},t}();t.Point=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function t(t,e,i,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),this.x=t,this.y=e,this.width=i,this.height=r}return t.prototype.copyFrom=function(t){this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height},t.prototype.clear=function(){this.x=this.y=0,this.width=this.height=0},t}();t.Rectangle=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ints=[],e.floats=[],e.strings=[],e}return __extends(e,t),e.toString=function(){return"[class dragonBones.UserData]"},e.prototype._onClear=function(){this.ints.length=0,this.floats.length=0,this.strings.length=0},e.prototype.addInt=function(t){this.ints.push(t)},e.prototype.addFloat=function(t){this.floats.push(t)},e.prototype.addString=function(t){this.strings.push(t)},e.prototype.getInt=function(t){return void 0===t&&(t=0),t>=0&&t<this.ints.length?this.ints[t]:0},e.prototype.getFloat=function(t){return void 0===t&&(t=0),t>=0&&t<this.floats.length?this.floats[t]:0},e.prototype.getString=function(t){return void 0===t&&(t=0),t>=0&&t<this.strings.length?this.strings[t]:""},e}(t.BaseObject);t.UserData=e;var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.data=null,e}return __extends(e,t),e.toString=function(){return"[class dragonBones.ActionData]"},e.prototype._onClear=function(){null!==this.data&&this.data.returnToPool(),this.type=0,this.name="",this.bone=null,this.slot=null,this.data=null},e}(t.BaseObject);t.ActionData=i}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.frameIndices=[],e.cachedFrames=[],e.armatureNames=[],e.armatures={},e.userData=null,e}return __extends(e,t),e.toString=function(){return"[class dragonBones.DragonBonesData]"},e.prototype._onClear=function(){for(var t in this.armatures)this.armatures[t].returnToPool(),delete this.armatures[t];null!==this.userData&&this.userData.returnToPool(),this.autoSearch=!1,this.frameRate=0,this.version="",this.name="",this.stage=null,this.frameIndices.length=0,this.cachedFrames.length=0,this.armatureNames.length=0,this.binary=null,this.intArray=null,this.floatArray=null,this.frameIntArray=null,this.frameFloatArray=null,this.frameArray=null,this.timelineArray=null,this.userData=null},e.prototype.addArmature=function(t){return t.name in this.armatures?void console.warn("Same armature: "+t.name):(t.parent=this,this.armatures[t.name]=t,void this.armatureNames.push(t.name))},e.prototype.getArmature=function(t){return t in this.armatures?this.armatures[t]:null},e.prototype.dispose=function(){console.warn("已废弃"),this.returnToPool()},e}(t.BaseObject);t.DragonBonesData=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.aabb=new t.Rectangle,i.animationNames=[],i.sortedBones=[],i.sortedSlots=[],i.defaultActions=[],i.actions=[],i.bones={},i.slots={},i.constraints={},i.skins={},i.animations={},i.canvas=null,i.userData=null,i}return __extends(i,e),i.toString=function(){return"[class dragonBones.ArmatureData]"},i.prototype._onClear=function(){for(var t=0,e=this.defaultActions;t<e.length;t++){var i=e[t];i.returnToPool()}for(var r=0,n=this.actions;r<n.length;r++){var i=n[r];i.returnToPool()}for(var a in this.bones)this.bones[a].returnToPool(),delete this.bones[a];for(var a in this.slots)this.slots[a].returnToPool(),delete this.slots[a];for(var a in this.constraints)this.constraints[a].returnToPool(),delete this.constraints[a];for(var a in this.skins)this.skins[a].returnToPool(),delete this.skins[a];for(var a in this.animations)this.animations[a].returnToPool(),delete this.animations[a];null!==this.canvas&&this.canvas.returnToPool(),null!==this.userData&&this.userData.returnToPool(),this.type=0,this.frameRate=0,this.cacheFrameRate=0,this.scale=1,this.name="",this.aabb.clear(),this.animationNames.length=0,this.sortedBones.length=0,this.sortedSlots.length=0,this.defaultActions.length=0,this.actions.length=0,this.defaultSkin=null,this.defaultAnimation=null,this.canvas=null,this.userData=null,this.parent=null},i.prototype.sortBones=function(){var t=this.sortedBones.length;if(!(0>=t)){var e=this.sortedBones.concat(),i=0,r=0;for(this.sortedBones.length=0;t>r;){var n=e[i++];if(i>=t&&(i=0),!(this.sortedBones.indexOf(n)>=0)){var a=!1;for(var o in this.constraints){var s=this.constraints[o];if(s.root===n&&this.sortedBones.indexOf(s.target)<0){a=!0;break}}a||null!==n.parent&&this.sortedBones.indexOf(n.parent)<0||(this.sortedBones.push(n),r++)}}}},i.prototype.cacheFrames=function(t){if(!(this.cacheFrameRate>0)){this.cacheFrameRate=t;for(var e in this.animations)this.animations[e].cacheFrames(this.cacheFrameRate)}},i.prototype.setCacheFrame=function(t,e){var i=this.parent.cachedFrames,r=i.length;return i.length+=10,i[r]=t.a,i[r+1]=t.b,i[r+2]=t.c,i[r+3]=t.d,i[r+4]=t.tx,i[r+5]=t.ty,i[r+6]=e.rotation,i[r+7]=e.skew,i[r+8]=e.scaleX,i[r+9]=e.scaleY,r},i.prototype.getCacheFrame=function(t,e,i){var r=this.parent.cachedFrames;t.a=r[i],t.b=r[i+1],t.c=r[i+2],t.d=r[i+3],t.tx=r[i+4],t.ty=r[i+5],e.rotation=r[i+6],e.skew=r[i+7],e.scaleX=r[i+8],e.scaleY=r[i+9],e.x=t.tx,e.y=t.ty},i.prototype.addBone=function(t){return t.name in this.bones?void console.warn("Same bone: "+t.name):(this.bones[t.name]=t,void this.sortedBones.push(t))},i.prototype.addSlot=function(t){return t.name in this.slots?void console.warn("Same slot: "+t.name):(this.slots[t.name]=t,void this.sortedSlots.push(t))},i.prototype.addConstraint=function(t){return t.name in this.constraints?void console.warn("Same constraint: "+t.name):void(this.constraints[t.name]=t)},i.prototype.addSkin=function(t){return t.name in this.skins?void console.warn("Same skin: "+t.name):(t.parent=this,this.skins[t.name]=t,null===this.defaultSkin&&(this.defaultSkin=t),void("default"===t.name&&(this.defaultSkin=t)))},i.prototype.addAnimation=function(t){return t.name in this.animations?void console.warn("Same animation: "+t.name):(t.parent=this,this.animations[t.name]=t,this.animationNames.push(t.name),void(null===this.defaultAnimation&&(this.defaultAnimation=t)))},i.prototype.addAction=function(t,e){e?this.defaultActions.push(t):this.actions.push(t)},i.prototype.getBone=function(t){return t in this.bones?this.bones[t]:null},i.prototype.getSlot=function(t){return t in this.slots?this.slots[t]:null},i.prototype.getConstraint=function(t){return t in this.constraints?this.constraints[t]:null},i.prototype.getSkin=function(t){return t in this.skins?this.skins[t]:null},i.prototype.getMesh=function(t,e,i){var r=this.getSkin(t);return null===r?null:r.getDisplay(e,i)},i.prototype.getAnimation=function(t){return t in this.animations?this.animations[t]:null},i}(t.BaseObject);t.ArmatureData=e;var i=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transform=new t.Transform,i.userData=null,i}return __extends(i,e),i.toString=function(){return"[class dragonBones.BoneData]"},i.prototype._onClear=function(){null!==this.userData&&this.userData.returnToPool(),this.inheritTranslation=!1,this.inheritRotation=!1,this.inheritScale=!1,this.inheritReflection=!1,this.type=0,this.length=0,this.name="",this.transform.identity(),this.userData=null,this.parent=null},i}(t.BaseObject);t.BoneData=i;var r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.vertices=[],e}return __extends(e,t),e.toString=function(){return"[class dragonBones.SurfaceData]"},e.prototype._onClear=function(){t.prototype._onClear.call(this),this.type=1,this.segmentX=0,this.segmentY=0,this.vertices.length=0},e}(i);t.SurfaceData=r;var n=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.color=null,t.userData=null,t}return __extends(i,e),i.createColor=function(){return new t.ColorTransform},i.toString=function(){return"[class dragonBones.SlotData]"},i.prototype._onClear=function(){null!==this.userData&&this.userData.returnToPool(),this.blendMode=0,this.displayIndex=0,this.zOrder=0,this.name="",this.color=null,this.userData=null,this.parent=null},i.DEFAULT_COLOR=new t.ColorTransform,i}(t.BaseObject);t.SlotData=n}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.toString=function(){return"[class dragonBones.CanvasData]"},e.prototype._onClear=function(){this.hasBackground=!1,this.color=0,this.x=0,this.y=0,this.width=0,this.height=0},e}(t.BaseObject);t.CanvasData=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.displays={},e}return __extends(e,t),e.toString=function(){return"[class dragonBones.SkinData]"},e.prototype._onClear=function(){for(var t in this.displays){for(var e=this.displays[t],i=0,r=e;i<r.length;i++){var n=r[i];null!==n&&n.returnToPool()}delete this.displays[t]}this.name="",this.parent=null},e.prototype.addDisplay=function(t,e){t in this.displays||(this.displays[t]=[]),null!==e&&(e.parent=this);var i=this.displays[t];i.push(e)},e.prototype.getDisplay=function(t,e){var i=this.getDisplays(t);if(null!==i)for(var r=0,n=i;r<n.length;r++){var a=n[r];if(null!==a&&a.name===e)return a}return null},e.prototype.getDisplays=function(t){return t in this.displays?this.displays[t]:null},e}(t.BaseObject);t.SkinData=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype._onClear=function(){this.order=0,this.name="",this.type=0,this.target=null,this.root=null,this.bone=null},e}(t.BaseObject);t.ConstraintData=e;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.toString=function(){return"[class dragonBones.IKConstraintData]"},e.prototype._onClear=function(){t.prototype._onClear.call(this),this.scaleEnabled=!1,this.bendPositive=!1,this.weight=1},e}(e);t.IKConstraintData=i;var r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bones=[],e}return __extends(e,t),e.toString=function(){return"[class dragonBones.PathConstraintData]"},e.prototype._onClear=function(){t.prototype._onClear.call(this),this.pathSlot=null,this.pathDisplayData=null,this.bones.length=0,this.positionMode=0,this.spacingMode=1,this.rotateMode=1,this.position=0,this.spacing=0,this.rotateOffset=0,this.rotateMix=0,this.translateMix=0},e.prototype.AddBone=function(t){this.bones.push(t)},e}(e);t.PathConstraintData=r}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function t(){this.weight=null}return t.prototype.clear=function(){this.isShared||null===this.weight||this.weight.returnToPool(),this.isShared=!1,this.inheritDeform=!1,this.offset=0,this.data=null,this.weight=null},t.prototype.shareFrom=function(t){this.isShared=!0,this.offset=t.offset,this.weight=t.weight},t}();t.VerticesData=e;var i=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.transform=new t.Transform,i}return __extends(i,e),i.prototype._onClear=function(){this.name="",this.path="",this.transform.identity(),this.parent=null},i}(t.BaseObject);t.DisplayData=i;var r=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.pivot=new t.Point,i}return __extends(i,e),i.toString=function(){return"[class dragonBones.ImageDisplayData]"},i.prototype._onClear=function(){e.prototype._onClear.call(this),this.type=0,this.pivot.clear(),this.texture=null},i}(i);t.ImageDisplayData=r;var n=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.actions=[],e}return __extends(e,t),e.toString=function(){return"[class dragonBones.ArmatureDisplayData]"},e.prototype._onClear=function(){t.prototype._onClear.call(this);for(var e=0,i=this.actions;e<i.length;e++){var r=i[e];r.returnToPool()}this.type=1,this.inheritAnimation=!1,this.actions.length=0,this.armature=null},e.prototype.addAction=function(t){this.actions.push(t)},e}(i);t.ArmatureDisplayData=n;var a=function(t){function i(){var i=null!==t&&t.apply(this,arguments)||this;return i.vertices=new e,i}return __extends(i,t),i.toString=function(){return"[class dragonBones.MeshDisplayData]"},i.prototype._onClear=function(){t.prototype._onClear.call(this),this.type=2,this.vertices.clear(),this.texture=null},i}(i);t.MeshDisplayData=a;var o=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.boundingBox=null,e}return __extends(e,t),e.toString=function(){return"[class dragonBones.BoundingBoxDisplayData]"},e.prototype._onClear=function(){t.prototype._onClear.call(this),null!==this.boundingBox&&this.boundingBox.returnToPool(),this.type=3,this.boundingBox=null},e}(i);t.BoundingBoxDisplayData=o;var s=function(t){function i(){var i=null!==t&&t.apply(this,arguments)||this;return i.vertices=new e,i.curveLengths=[],i}return __extends(i,t),i.toString=function(){return"[class dragonBones.PathDisplayData]"},i.prototype._onClear=function(){t.prototype._onClear.call(this),this.type=4,this.closed=!1,this.constantSpeed=!1,this.vertices.clear(),this.curveLengths.length=0},i}(i);t.PathDisplayData=s;var l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bones=[],e}return __extends(e,t),e.toString=function(){return"[class dragonBones.WeightData]"},e.prototype._onClear=function(){this.count=0,this.offset=0,this.bones.length=0},e.prototype.addBone=function(t){this.bones.push(t)},e}(t.BaseObject);t.WeightData=l}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype._onClear=function(){this.color=0,this.width=0,this.height=0},e}(t.BaseObject);t.BoundingBoxData=e;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.toString=function(){return"[class dragonBones.RectangleBoundingBoxData]"},e._computeOutCode=function(t,e,i,r,n,a){var o=0;return i>t?o|=1:t>n&&(o|=2),r>e?o|=4:e>a&&(o|=8),o},e.rectangleIntersectsSegment=function(t,i,r,n,a,o,s,l,h,c,u){void 0===h&&(h=null),void 0===c&&(c=null),void 0===u&&(u=null);var p=t>a&&s>t&&i>o&&l>i,d=r>a&&s>r&&n>o&&l>n;if(p&&d)return-1;for(var f=0,g=e._computeOutCode(t,i,a,o,s,l),m=e._computeOutCode(r,n,a,o,s,l);;){if(0===(g|m)){f=2;break}if(0!==(g&m))break;var y=0,v=0,_=0,b=0!==g?g:m;0!==(4&b)?(y=t+(r-t)*(o-i)/(n-i),v=o,null!==u&&(_=.5*-Math.PI)):0!==(8&b)?(y=t+(r-t)*(l-i)/(n-i),v=l,null!==u&&(_=.5*Math.PI)):0!==(2&b)?(v=i+(n-i)*(s-t)/(r-t),y=s,null!==u&&(_=0)):0!==(1&b)&&(v=i+(n-i)*(a-t)/(r-t),y=a,null!==u&&(_=Math.PI)),b===g?(t=y,i=v,g=e._computeOutCode(t,i,a,o,s,l),null!==u&&(u.x=_)):(r=y,n=v,m=e._computeOutCode(r,n,a,o,s,l),null!==u&&(u.y=_))}return f&&(p?(f=2,null!==h&&(h.x=r,h.y=n),null!==c&&(c.x=r,c.y=r),null!==u&&(u.x=u.y+Math.PI)):d?(f=1,null!==h&&(h.x=t,h.y=i),null!==c&&(c.x=t,c.y=i),null!==u&&(u.y=u.x+Math.PI)):(f=3,null!==h&&(h.x=t,h.y=i),null!==c&&(c.x=r,c.y=n))),f},e.prototype._onClear=function(){t.prototype._onClear.call(this),this.type=0},e.prototype.containsPoint=function(t,e){var i=.5*this.width;if(t>=-i&&i>=t){var r=.5*this.height;if(e>=-r&&r>=e)return!0}return!1},e.prototype.intersectsSegment=function(t,i,r,n,a,o,s){void 0===a&&(a=null),void 0===o&&(o=null),void 0===s&&(s=null);var l=.5*this.width,h=.5*this.height,c=e.rectangleIntersectsSegment(t,i,r,n,-l,-h,l,h,a,o,s);return c},e}(e);t.RectangleBoundingBoxData=i;var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.toString=function(){return"[class dragonBones.EllipseData]"},e.ellipseIntersectsSegment=function(t,e,i,r,n,a,o,s,l,h,c){void 0===l&&(l=null),void 0===h&&(h=null),void 0===c&&(c=null);var u=o/s,p=u*u;e*=u,r*=u;var d=i-t,f=r-e,g=Math.sqrt(d*d+f*f),m=d/g,y=f/g,v=(n-t)*m+(a-e)*y,_=v*v,b=t*t+e*e,x=o*o,T=x-b+_,E=0;if(T>=0){var S=Math.sqrt(T),C=v-S,w=v+S,P=0>C?-1:g>=C?0:1,D=0>w?-1:g>=w?0:1,A=P*D;if(0>A)return-1;0===A&&(-1===P?(E=2,i=t+w*m,r=(e+w*y)/u,null!==l&&(l.x=i,l.y=r),null!==h&&(h.x=i,h.y=r),null!==c&&(c.x=Math.atan2(r/x*p,i/x),c.y=c.x+Math.PI)):1===D?(E=1,t+=C*m,e=(e+C*y)/u,null!==l&&(l.x=t,l.y=e),null!==h&&(h.x=t,h.y=e),null!==c&&(c.x=Math.atan2(e/x*p,t/x),c.y=c.x+Math.PI)):(E=3,null!==l&&(l.x=t+C*m,l.y=(e+C*y)/u,null!==c&&(c.x=Math.atan2(l.y/x*p,l.x/x))),null!==h&&(h.x=t+w*m,h.y=(e+w*y)/u,null!==c&&(c.y=Math.atan2(h.y/x*p,h.x/x)))))}return E},e.prototype._onClear=function(){t.prototype._onClear.call(this),this.type=1},e.prototype.containsPoint=function(t,e){var i=.5*this.width;if(t>=-i&&i>=t){var r=.5*this.height;if(e>=-r&&r>=e)return e*=i/r,Math.sqrt(t*t+e*e)<=i}return!1},e.prototype.intersectsSegment=function(t,i,r,n,a,o,s){void 0===a&&(a=null),void 0===o&&(o=null),void 0===s&&(s=null);var l=e.ellipseIntersectsSegment(t,i,r,n,0,0,.5*this.width,.5*this.height,a,o,s);return l},e}(e);t.EllipseBoundingBoxData=r;var n=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.vertices=[],e}return __extends(e,t),e.toString=function(){return"[class dragonBones.PolygonBoundingBoxData]"},e.polygonIntersectsSegment=function(t,e,i,r,n,a,o,s){void 0===a&&(a=null),void 0===o&&(o=null),void 0===s&&(s=null),t===i&&(t=i+1e-6),e===r&&(e=r+1e-6);for(var l=n.length,h=t-i,c=e-r,u=t*r-e*i,p=0,d=n[l-2],f=n[l-1],g=0,m=0,y=0,v=0,_=0,b=0,x=0;l>x;x+=2){var T=n[x],E=n[x+1];d===T&&(d=T+1e-4),f===E&&(f=E+1e-4);var S=d-T,C=f-E,w=d*E-f*T,P=h*C-c*S,D=(u*S-h*w)/P;if((D>=d&&T>=D||D>=T&&d>=D)&&(0===h||D>=t&&i>=D||D>=i&&t>=D)){var A=(u*C-c*w)/P;if((A>=f&&E>=A||A>=E&&f>=A)&&(0===c||A>=e&&r>=A||A>=r&&e>=A)){if(null===o){y=D,v=A,_=D,b=A,p++,null!==s&&(s.x=Math.atan2(E-f,T-d)-.5*Math.PI,s.y=s.x);break}var I=D-t;0>I&&(I=-I),0===p?(g=I,m=I,y=D,v=A,_=D,b=A,null!==s&&(s.x=Math.atan2(E-f,T-d)-.5*Math.PI,s.y=s.x)):(g>I&&(g=I,y=D,v=A,null!==s&&(s.x=Math.atan2(E-f,T-d)-.5*Math.PI)),I>m&&(m=I,_=D,b=A,null!==s&&(s.y=Math.atan2(E-f,T-d)-.5*Math.PI))),p++}}d=T,f=E}return 1===p?(null!==a&&(a.x=y,a.y=v),null!==o&&(o.x=y,o.y=v),null!==s&&(s.y=s.x+Math.PI)):p>1&&(p++,null!==a&&(a.x=y,a.y=v),null!==o&&(o.x=_,o.y=b)),p},e.prototype._onClear=function(){t.prototype._onClear.call(this),this.type=2,this.x=0,this.y=0,this.vertices.length=0},e.prototype.containsPoint=function(t,e){var i=!1;if(t>=this.x&&t<=this.width&&e>=this.y&&e<=this.height)for(var r=0,n=this.vertices.length,a=n-2;n>r;r+=2){var o=this.vertices[a+1],s=this.vertices[r+1];if(e>s&&o>=e||e>o&&s>=e){var l=this.vertices[a],h=this.vertices[r];t>(e-s)*(l-h)/(o-s)+h&&(i=!i)}a=r}return i},e.prototype.intersectsSegment=function(t,r,n,a,o,s,l){void 0===o&&(o=null),void 0===s&&(s=null),void 0===l&&(l=null);var h=0;return 0!==i.rectangleIntersectsSegment(t,r,n,a,this.x,this.y,this.x+this.width,this.y+this.height,null,null,null)&&(h=e.polygonIntersectsSegment(t,r,n,a,this.vertices,o,s,l)),h},e}(e);t.PolygonBoundingBoxData=n}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.cachedFrames=[],e.boneTimelines={},e.surfaceTimelines={},e.slotTimelines={},e.constraintTimelines={},e.animationTimelines={},e.boneCachedFrameIndices={},e.slotCachedFrameIndices={},e.actionTimeline=null,e.zOrderTimeline=null,e}return __extends(e,t),e.toString=function(){return"[class dragonBones.AnimationData]"},e.prototype._onClear=function(){for(var t in this.boneTimelines){for(var e=0,i=this.boneTimelines[t];e<i.length;e++){var r=i[e];r.returnToPool()}delete this.boneTimelines[t]}for(var t in this.surfaceTimelines){for(var n=0,a=this.surfaceTimelines[t];n<a.length;n++){var r=a[n];r.returnToPool()}delete this.surfaceTimelines[t]}for(var t in this.slotTimelines){for(var o=0,s=this.slotTimelines[t];o<s.length;o++){var r=s[o];r.returnToPool()}delete this.slotTimelines[t]}for(var t in this.constraintTimelines){for(var l=0,h=this.constraintTimelines[t];l<h.length;l++){var r=h[l];r.returnToPool()}delete this.constraintTimelines[t]}for(var t in this.animationTimelines){for(var c=0,u=this.animationTimelines[t];c<u.length;c++){var r=u[c];r.returnToPool()}delete this.animationTimelines[t]}for(var t in this.boneCachedFrameIndices)delete this.boneCachedFrameIndices[t];for(var t in this.slotCachedFrameIndices)delete this.slotCachedFrameIndices[t];null!==this.actionTimeline&&this.actionTimeline.returnToPool(),null!==this.zOrderTimeline&&this.zOrderTimeline.returnToPool(),this.frameIntOffset=0,this.frameFloatOffset=0,this.frameOffset=0,this.frameCount=0,this.playTimes=0,this.duration=0,this.scale=1,this.fadeInTime=0,this.cacheFrameRate=0,this.name="",this.cachedFrames.length=0,this.actionTimeline=null,this.zOrderTimeline=null,this.parent=null},e.prototype.cacheFrames=function(t){if(!(this.cacheFrameRate>0)){this.cacheFrameRate=Math.max(Math.ceil(t*this.scale),1);var e=Math.ceil(this.cacheFrameRate*this.duration)+1;this.cachedFrames.length=e;for(var i=0,r=this.cacheFrames.length;r>i;++i)this.cachedFrames[i]=!1;for(var n=0,a=this.parent.sortedBones;n<a.length;n++){for(var o=a[n],s=new Array(e),i=0,r=s.length;r>i;++i)s[i]=-1;this.boneCachedFrameIndices[o.name]=s}for(var l=0,h=this.parent.sortedSlots;l<h.length;l++){for(var c=h[l],s=new Array(e),i=0,r=s.length;r>i;++i)s[i]=-1;this.slotCachedFrameIndices[c.name]=s}}},e.prototype.addBoneTimeline=function(t,e){var i=t.name in this.boneTimelines?this.boneTimelines[t.name]:this.boneTimelines[t.name]=[];i.indexOf(e)<0&&i.push(e)},e.prototype.addSurfaceTimeline=function(t,e){var i=t.name in this.surfaceTimelines?this.surfaceTimelines[t.name]:this.surfaceTimelines[t.name]=[];i.indexOf(e)<0&&i.push(e)},e.prototype.addSlotTimeline=function(t,e){var i=t.name in this.slotTimelines?this.slotTimelines[t.name]:this.slotTimelines[t.name]=[];i.indexOf(e)<0&&i.push(e)},e.prototype.addConstraintTimeline=function(t,e){var i=t.name in this.constraintTimelines?this.constraintTimelines[t.name]:this.constraintTimelines[t.name]=[];i.indexOf(e)<0&&i.push(e)},e.prototype.addAnimationTimeline=function(t,e){var i=t in this.animationTimelines?this.animationTimelines[t]:this.animationTimelines[t]=[];i.indexOf(e)<0&&i.push(e)},e.prototype.getBoneTimelines=function(t){return t in this.boneTimelines?this.boneTimelines[t]:null},e.prototype.getSurfaceTimelines=function(t){return t in this.surfaceTimelines?this.surfaceTimelines[t]:null},e.prototype.getSlotTimelines=function(t){return t in this.slotTimelines?this.slotTimelines[t]:null},e.prototype.getConstraintTimelines=function(t){return t in this.constraintTimelines?this.constraintTimelines[t]:null},e.prototype.getAnimationTimelines=function(t){return t in this.animationTimelines?this.animationTimelines[t]:null},e.prototype.getBoneCachedFrameIndices=function(t){return t in this.boneCachedFrameIndices?this.boneCachedFrameIndices[t]:null},e.prototype.getSlotCachedFrameIndices=function(t){return t in this.slotCachedFrameIndices?this.slotCachedFrameIndices[t]:null},e}(t.BaseObject);t.AnimationData=e;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.toString=function(){return"[class dragonBones.TimelineData]"},e.prototype._onClear=function(){this.type=10,this.offset=0,this.frameIndicesOffset=-1},e}(t.BaseObject);t.TimelineData=i}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.boneMask=[],e}return __extends(e,t),e.toString=function(){return"[class dragonBones.AnimationConfig]"},e.prototype._onClear=function(){this.pauseFadeOut=!0,this.fadeOutMode=4,this.fadeOutTweenType=1,this.fadeOutTime=-1,this.actionEnabled=!0,this.additiveBlending=!1,this.displayControl=!0,this.pauseFadeIn=!0,this.resetToPose=!0,this.fadeInTweenType=1,this.playTimes=-1,this.layer=0,this.position=0,this.duration=-1,this.timeScale=-100,this.weight=1,this.fadeInTime=-1,this.autoFadeOutTime=-1,this.name="",this.animation="",this.group="",this.boneMask.length=0},e.prototype.clear=function(){this._onClear()},e.prototype.copyFrom=function(t){this.pauseFadeOut=t.pauseFadeOut,this.fadeOutMode=t.fadeOutMode,this.autoFadeOutTime=t.autoFadeOutTime,this.fadeOutTweenType=t.fadeOutTweenType,this.actionEnabled=t.actionEnabled,this.additiveBlending=t.additiveBlending,this.displayControl=t.displayControl,this.pauseFadeIn=t.pauseFadeIn,this.resetToPose=t.resetToPose,this.playTimes=t.playTimes,this.layer=t.layer,this.position=t.position,this.duration=t.duration,this.timeScale=t.timeScale,this.fadeInTime=t.fadeInTime,this.fadeOutTime=t.fadeOutTime,this.fadeInTweenType=t.fadeInTweenType,this.weight=t.weight,this.name=t.name,this.animation=t.animation,this.group=t.group,this.boneMask.length=t.boneMask.length;for(var e=0,i=this.boneMask.length;i>e;++e)this.boneMask[e]=t.boneMask[e]},e.prototype.containsBoneMask=function(t){return 0===this.boneMask.length||this.boneMask.indexOf(t)>=0},e.prototype.addBoneMask=function(t,e,i){void 0===i&&(i=!0);var r=t.getBone(e);if(null!==r&&(this.boneMask.indexOf(e)<0&&this.boneMask.push(e),i))for(var n=0,a=t.getBones();n<a.length;n++){var o=a[n];this.boneMask.indexOf(o.name)<0&&r.contains(o)&&this.boneMask.push(o.name)}},e.prototype.removeBoneMask=function(t,e,i){void 0===i&&(i=!0);var r=this.boneMask.indexOf(e);if(r>=0&&this.boneMask.splice(r,1),i){var n=t.getBone(e);if(null!==n)if(this.boneMask.length>0)for(var a=0,o=t.getBones();a<o.length;a++){var s=o[a],l=this.boneMask.indexOf(s.name);l>=0&&n.contains(s)&&this.boneMask.splice(l,1)}else for(var h=0,c=t.getBones();h<c.length;h++){var s=c[h];s!==n&&(n.contains(s)||this.boneMask.push(s.name))}}},e}(t.BaseObject);t.AnimationConfig=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.textures={},e}return __extends(e,t),e.prototype._onClear=function(){for(var t in this.textures)this.textures[t].returnToPool(),delete this.textures[t];this.autoSearch=!1,this.width=0,this.height=0,this.scale=1,this.name="",this.imagePath=""},e.prototype.copyFrom=function(t){this.autoSearch=t.autoSearch,this.scale=t.scale,this.width=t.width,this.height=t.height,this.name=t.name,this.imagePath=t.imagePath;for(var e in this.textures)this.textures[e].returnToPool(),delete this.textures[e];for(var e in t.textures){var i=this.createTexture();i.copyFrom(t.textures[e]),this.textures[e]=i}},e.prototype.addTexture=function(t){return t.name in this.textures?void console.warn("Same texture: "+t.name):(t.parent=this,void(this.textures[t.name]=t))},e.prototype.getTexture=function(t){return t in this.textures?this.textures[t]:null},e}(t.BaseObject);t.TextureAtlasData=e;var i=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.region=new t.Rectangle,i.frame=null,i}return __extends(i,e),i.createRectangle=function(){return new t.Rectangle},i.prototype._onClear=function(){this.rotated=!1,this.name="",this.region.clear(),this.parent=null,this.frame=null},i.prototype.copyFrom=function(t){this.rotated=t.rotated,this.name=t.name,this.region.copyFrom(t.region),this.parent=t.parent,null===this.frame&&null!==t.frame?this.frame=i.createRectangle():null!==this.frame&&null===t.frame&&(this.frame=null),null!==this.frame&&null!==t.frame&&this.frame.copyFrom(t.frame)},i}(t.BaseObject);t.TextureData=i}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.vertices=[],e.bones=[],e}return __extends(e,t),e.toString=function(){return"[class dragonBones.DeformVertices]"},e.prototype._onClear=function(){this.verticesDirty=!1,this.vertices.length=0,this.bones.length=0,this.verticesData=null},e.prototype.init=function(t,e){if(this.verticesData=t,null!==this.verticesData){var i=0;i=null!==this.verticesData.weight?2*this.verticesData.weight.count:2*this.verticesData.data.intArray[this.verticesData.offset+0],this.verticesDirty=!0,this.vertices.length=i,this.bones.length=0;for(var r=0,n=this.vertices.length;n>r;++r)this.vertices[r]=0;if(null!==this.verticesData.weight)for(var r=0,n=this.verticesData.weight.bones.length;n>r;++r){var a=e.getBone(this.verticesData.weight.bones[r].name);this.bones.push(a)}}else this.verticesDirty=!1,this.vertices.length=0,this.bones.length=0,this.verticesData=null},e.prototype.isBonesUpdate=function(){for(var t=0,e=this.bones;t<e.length;t++){var i=e[t];if(null!==i&&i._childrenTransformDirty)return!0}return!1},e}(t.BaseObject);t.DeformVertices=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t._bones=[],t._slots=[],t._constraints=[],t._actions=[],t._animation=null,t._proxy=null,t._replaceTextureAtlasData=null,t._clock=null,t}return __extends(i,e),i.toString=function(){return"[class dragonBones.Armature]"},i._onSortSlots=function(t,e){return t._zOrder>e._zOrder?1:-1},i.prototype._onClear=function(){null!==this._clock&&this._clock.remove(this);for(var t=0,e=this._bones;t<e.length;t++){var i=e[t];i.returnToPool()}for(var r=0,n=this._slots;r<n.length;r++){var a=n[r];a.returnToPool()}for(var o=0,s=this._constraints;o<s.length;o++){var l=s[o];l.returnToPool()}for(var h=0,c=this._actions;h<c.length;h++){var u=c[h];u.returnToPool()}null!==this._animation&&this._animation.returnToPool(),null!==this._proxy&&this._proxy.dbClear(),null!==this._replaceTextureAtlasData&&this._replaceTextureAtlasData.returnToPool(),this.inheritAnimation=!0,this.userData=null,this._lockUpdate=!1,this._slotsDirty=!0,this._zOrderDirty=!1,this._flipX=!1,this._flipY=!1,this._cacheFrameIndex=-1,this._bones.length=0,this._slots.length=0,this._constraints.length=0,this._actions.length=0,this._armatureData=null,this._animation=null,this._proxy=null,this._display=null,this._replaceTextureAtlasData=null,this._replacedTexture=null,this._dragonBones=null,this._clock=null,this._parent=null},i.prototype._sortZOrder=function(t,e){var i=this._armatureData.sortedSlots,r=null===t;if(this._zOrderDirty||!r){for(var n=0,a=i.length;a>n;++n){var o=r?n:t[e+n];if(!(0>o||o>=a)){var s=i[o],l=this.getSlot(s.name);null!==l&&l._setZorder(n)}}this._slotsDirty=!0,this._zOrderDirty=!r
}},i.prototype._addBone=function(t){this._bones.indexOf(t)<0&&this._bones.push(t)},i.prototype._addSlot=function(t){this._slots.indexOf(t)<0&&this._slots.push(t)},i.prototype._addConstraint=function(t){this._constraints.indexOf(t)<0&&this._constraints.push(t)},i.prototype._bufferAction=function(t,e){this._actions.indexOf(t)<0&&(e?this._actions.push(t):this._actions.unshift(t))},i.prototype.dispose=function(){null!==this._armatureData&&(this._lockUpdate=!0,this._dragonBones.bufferObject(this))},i.prototype.init=function(e,i,r,n){null===this._armatureData&&(this._armatureData=e,this._animation=t.BaseObject.borrowObject(t.Animation),this._proxy=i,this._display=r,this._dragonBones=n,this._proxy.dbInit(this),this._animation.init(this),this._animation.animations=this._armatureData.animations)},i.prototype.advanceTime=function(t){if(!this._lockUpdate){if(null===this._armatureData)return void console.warn("The armature has been disposed.");if(null===this._armatureData.parent)return void console.warn("The armature data has been disposed.\nPlease make sure dispose armature before call factory.clear().");var e=this._cacheFrameIndex;if(this._animation.advanceTime(t),this._slotsDirty&&(this._slotsDirty=!1,this._slots.sort(i._onSortSlots)),this._cacheFrameIndex<0||this._cacheFrameIndex!==e){var r=0,n=0;for(r=0,n=this._bones.length;n>r;++r)this._bones[r].update(this._cacheFrameIndex);for(r=0,n=this._slots.length;n>r;++r)this._slots[r].update(this._cacheFrameIndex)}if(this._actions.length>0){this._lockUpdate=!0;for(var a=0,o=this._actions;a<o.length;a++){var s=o[a],l=s.actionData;if(null!==l&&0===l.type)if(null!==s.slot){var h=s.slot.childArmature;null!==h&&h.animation.fadeIn(l.name)}else if(null!==s.bone)for(var c=0,u=this.getSlots();c<u.length;c++){var p=u[c];if(p.parent===s.bone){var h=p.childArmature;null!==h&&h.animation.fadeIn(l.name)}}else this._animation.fadeIn(l.name);s.returnToPool()}this._actions.length=0,this._lockUpdate=!1}this._proxy.dbUpdate()}},i.prototype.invalidUpdate=function(t,e){if(void 0===t&&(t=null),void 0===e&&(e=!1),null!==t&&t.length>0){var i=this.getBone(t);if(null!==i&&(i.invalidUpdate(),e))for(var r=0,n=this._slots;r<n.length;r++){var a=n[r];a.parent===i&&a.invalidUpdate()}}else{for(var o=0,s=this._bones;o<s.length;o++){var i=s[o];i.invalidUpdate()}if(e)for(var l=0,h=this._slots;l<h.length;l++){var a=h[l];a.invalidUpdate()}}},i.prototype.containsPoint=function(t,e){for(var i=0,r=this._slots;i<r.length;i++){var n=r[i];if(n.containsPoint(t,e))return n}return null},i.prototype.intersectsSegment=function(t,e,i,r,n,a,o){void 0===n&&(n=null),void 0===a&&(a=null),void 0===o&&(o=null);for(var s=t===i,l=0,h=0,c=0,u=0,p=0,d=0,f=0,g=0,m=null,y=null,v=0,_=this._slots;v<_.length;v++){var b=_[v],x=b.intersectsSegment(t,e,i,r,n,a,o);if(x>0){if(null===n&&null===a){m=b;break}if(null!==n){var T=s?n.y-e:n.x-t;0>T&&(T=-T),(null===m||l>T)&&(l=T,c=n.x,u=n.y,m=b,o&&(f=o.x))}if(null!==a){var T=a.x-t;0>T&&(T=-T),(null===y||T>h)&&(h=T,p=a.x,d=a.y,y=b,null!==o&&(g=o.y))}}}return null!==m&&null!==n&&(n.x=c,n.y=u,null!==o&&(o.x=f)),null!==y&&null!==a&&(a.x=p,a.y=d,null!==o&&(o.y=g)),m},i.prototype.getBone=function(t){for(var e=0,i=this._bones;e<i.length;e++){var r=i[e];if(r.name===t)return r}return null},i.prototype.getBoneByDisplay=function(t){var e=this.getSlotByDisplay(t);return null!==e?e.parent:null},i.prototype.getSlot=function(t){for(var e=0,i=this._slots;e<i.length;e++){var r=i[e];if(r.name===t)return r}return null},i.prototype.getSlotByDisplay=function(t){if(null!==t)for(var e=0,i=this._slots;e<i.length;e++){var r=i[e];if(r.display===t)return r}return null},i.prototype.getBones=function(){return this._bones},i.prototype.getSlots=function(){return this._slots},Object.defineProperty(i.prototype,"flipX",{get:function(){return this._flipX},set:function(t){this._flipX!==t&&(this._flipX=t,this.invalidUpdate())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"flipY",{get:function(){return this._flipY},set:function(t){this._flipY!==t&&(this._flipY=t,this.invalidUpdate())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"cacheFrameRate",{get:function(){return this._armatureData.cacheFrameRate},set:function(t){if(this._armatureData.cacheFrameRate!==t){this._armatureData.cacheFrames(t);for(var e=0,i=this._slots;e<i.length;e++){var r=i[e],n=r.childArmature;null!==n&&(n.cacheFrameRate=t)}}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"name",{get:function(){return this._armatureData.name},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"armatureData",{get:function(){return this._armatureData},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"animation",{get:function(){return this._animation},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"proxy",{get:function(){return this._proxy},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"eventDispatcher",{get:function(){return this._proxy},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"display",{get:function(){return this._display},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"replacedTexture",{get:function(){return this._replacedTexture},set:function(t){if(this._replacedTexture!==t){null!==this._replaceTextureAtlasData&&(this._replaceTextureAtlasData.returnToPool(),this._replaceTextureAtlasData=null),this._replacedTexture=t;for(var e=0,i=this._slots;e<i.length;e++){var r=i[e];r.invalidUpdate(),r.update(-1)}}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"clock",{get:function(){return this._clock},set:function(t){if(this._clock!==t){null!==this._clock&&this._clock.remove(this),this._clock=t,this._clock&&this._clock.add(this);for(var e=0,i=this._slots;e<i.length;e++){var r=i[e],n=r.childArmature;null!==n&&(n.clock=this._clock)}}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"parent",{get:function(){return this._parent},enumerable:!0,configurable:!0}),i.prototype.replaceTexture=function(t){this.replacedTexture=t},i.prototype.hasEventListener=function(t){return console.warn("Deprecated."),this._proxy.hasDBEventListener(t)},i.prototype.addEventListener=function(t,e,i){console.warn("Deprecated."),this._proxy.addDBEventListener(t,e,i)},i.prototype.removeEventListener=function(t,e,i){console.warn("Deprecated."),this._proxy.removeDBEventListener(t,e,i)},i.prototype.enableAnimationCache=function(t){console.warn("Deprecated."),this.cacheFrameRate=t},i.prototype.getDisplay=function(){return this._display},i}(t.BaseObject);t.Armature=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.globalTransformMatrix=new t.Matrix,i.global=new t.Transform,i.offset=new t.Transform,i}return __extends(i,e),i.prototype._onClear=function(){this.globalTransformMatrix.identity(),this.global.identity(),this.offset.identity(),this.origin=null,this.userData=null,this._globalDirty=!1,this._armature=null},i.prototype.updateGlobalTransform=function(){this._globalDirty&&(this._globalDirty=!1,this.global.fromMatrix(this.globalTransformMatrix))},Object.defineProperty(i.prototype,"armature",{get:function(){return this._armature},enumerable:!0,configurable:!0}),i._helpMatrix=new t.Matrix,i._helpTransform=new t.Transform,i._helpPoint=new t.Point,i}(t.BaseObject);t.TransformObject=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.animationPose=new t.Transform,i._blendState=new t.BlendState,i}return __extends(i,e),i.toString=function(){return"[class dragonBones.Bone]"},i.prototype._onClear=function(){e.prototype._onClear.call(this),this.offsetMode=1,this.animationPose.identity(),this._transformDirty=!1,this._childrenTransformDirty=!1,this._localDirty=!0,this._hasConstraint=!1,this._visible=!0,this._cachedFrameIndex=-1,this._blendState.clear(),this._boneData=null,this._parent=null,this._cachedFrameIndices=null},i.prototype._updateGlobalTransformMatrix=function(e){var i=this._boneData,r=this.global,n=this.globalTransformMatrix,a=this.origin,o=this.offset,s=this.animationPose,l=this._parent,h=this._armature.flipX,c=this._armature.flipY===t.DragonBones.yDown,u=null!==l,p=0;if(1===this.offsetMode?null!==a?(r.x=a.x+o.x+s.x,r.y=a.y+o.y+s.y,r.skew=a.skew+o.skew+s.skew,r.rotation=a.rotation+o.rotation+s.rotation,r.scaleX=a.scaleX*o.scaleX*s.scaleX,r.scaleY=a.scaleY*o.scaleY*s.scaleY):r.copyFrom(o).add(s):0===this.offsetMode?null!==a?r.copyFrom(a).add(s):r.copyFrom(s):(u=!1,r.copyFrom(o)),u){var d=0===l._boneData.type?l.globalTransformMatrix:l._getGlobalTransformMatrix(r.x,r.y);if(i.inheritScale)i.inheritRotation||(l.updateGlobalTransform(),p=h&&c?r.rotation-(l.global.rotation+Math.PI):h?r.rotation+l.global.rotation+Math.PI:c?r.rotation+l.global.rotation:r.rotation-l.global.rotation,r.rotation=p),r.toMatrix(n),n.concat(d),i.inheritTranslation?(r.x=n.tx,r.y=n.ty):(n.tx=r.x,n.ty=r.y),e?r.fromMatrix(n):this._globalDirty=!0;else{if(i.inheritTranslation){var f=r.x,g=r.y;r.x=d.a*f+d.c*g+d.tx,r.y=d.b*f+d.d*g+d.ty}else h&&(r.x=-r.x),c&&(r.y=-r.y);i.inheritRotation?(l.updateGlobalTransform(),p=l.global.scaleX<0?r.rotation+l.global.rotation+Math.PI:r.rotation+l.global.rotation,d.a*d.d-d.b*d.c<0&&(p-=2*r.rotation,(h!==c||i.inheritReflection)&&(r.skew+=Math.PI)),r.rotation=p):(h||c)&&(h&&c?p=r.rotation+Math.PI:(p=h?Math.PI-r.rotation:-r.rotation,r.skew+=Math.PI),r.rotation=p),r.toMatrix(n)}}else(h||c)&&(h&&(r.x=-r.x),c&&(r.y=-r.y),h&&c?p=r.rotation+Math.PI:(p=h?Math.PI-r.rotation:-r.rotation,r.skew+=Math.PI),r.rotation=p),r.toMatrix(n)},i.prototype.init=function(t,e){null===this._boneData&&(this._boneData=t,this._armature=e,null!==this._boneData.parent&&(this._parent=this._armature.getBone(this._boneData.parent.name)),this._armature._addBone(this),this.origin=this._boneData.transform)},i.prototype.update=function(t){if(this._blendState.dirty=!1,t>=0&&null!==this._cachedFrameIndices){var e=this._cachedFrameIndices[t];if(e>=0&&this._cachedFrameIndex===e)this._transformDirty=!1;else if(e>=0)this._transformDirty=!0,this._cachedFrameIndex=e;else{if(this._hasConstraint)for(var i=0,r=this._armature._constraints;i<r.length;i++){var n=r[i];n._root===this&&n.update()}this._transformDirty||null!==this._parent&&this._parent._childrenTransformDirty?(this._transformDirty=!0,this._cachedFrameIndex=-1):this._cachedFrameIndex>=0?(this._transformDirty=!1,this._cachedFrameIndices[t]=this._cachedFrameIndex):(this._transformDirty=!0,this._cachedFrameIndex=-1)}}else{if(this._hasConstraint)for(var a=0,o=this._armature._constraints;a<o.length;a++){var n=o[a];n._root===this&&n.update()}(this._transformDirty||null!==this._parent&&this._parent._childrenTransformDirty)&&(t=-1,this._transformDirty=!0,this._cachedFrameIndex=-1)}if(this._transformDirty)if(this._transformDirty=!1,this._childrenTransformDirty=!0,this._cachedFrameIndex<0){var s=t>=0;this._localDirty&&this._updateGlobalTransformMatrix(s),s&&null!==this._cachedFrameIndices&&(this._cachedFrameIndex=this._cachedFrameIndices[t]=this._armature._armatureData.setCacheFrame(this.globalTransformMatrix,this.global))}else this._armature._armatureData.getCacheFrame(this.globalTransformMatrix,this.global,this._cachedFrameIndex);else this._childrenTransformDirty&&(this._childrenTransformDirty=!1);this._localDirty=!0},i.prototype.updateByConstraint=function(){this._localDirty&&(this._localDirty=!1,(this._transformDirty||null!==this._parent&&this._parent._childrenTransformDirty)&&this._updateGlobalTransformMatrix(!0),this._transformDirty=!0)},i.prototype.invalidUpdate=function(){this._transformDirty=!0},i.prototype.contains=function(t){if(t===this)return!1;for(var e=t;e!==this&&null!==e;)e=e.parent;return e===this},Object.defineProperty(i.prototype,"boneData",{get:function(){return this._boneData},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"visible",{get:function(){return this._visible},set:function(t){if(this._visible!==t){this._visible=t;for(var e=0,i=this._armature.getSlots();e<i.length;e++){var r=i[e];r.parent===this&&r._updateVisible()}}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"name",{get:function(){return this._boneData.name},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"parent",{get:function(){return this._parent},enumerable:!0,configurable:!0}),i.prototype.getBones=function(){console.warn("Deprecated.");for(var t=new Array,e=0,i=this._armature.getBones();e<i.length;e++){var r=i[e];r.parent===this&&t.push(r)}return t},i.prototype.getSlots=function(){console.warn("Deprecated.");for(var t=new Array,e=0,i=this._armature.getSlots();e<i.length;e++){var r=i[e];r.parent===this&&t.push(r)}return t},Object.defineProperty(i.prototype,"slot",{get:function(){console.warn("Deprecated.");for(var t=0,e=this._armature.getSlots();t<e.length;t++){var i=e[t];if(i.parent===this)return i}return null},enumerable:!0,configurable:!0}),i}(t.TransformObject);t.Bone=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._vertices=[],e._deformVertices=[],e._hullCache=[],e._matrixCahce=[],e}return __extends(e,t),e.toString=function(){return"[class dragonBones.Surface]"},e.prototype._onClear=function(){t.prototype._onClear.call(this),this._dX=0,this._dY=0,this._k=0,this._kX=0,this._kY=0,this._vertices.length=0,this._deformVertices.length=0,this._matrixCahce.length=0,this._hullCache.length=0},e.prototype._getAffineTransform=function(t,e,i,r,n,a,o,s,l,h,c,u,p){var d=o-n,f=s-a,g=l-n,m=h-a;c.rotation=Math.atan2(f,d),c.skew=Math.atan2(m,g)-.5*Math.PI-c.rotation,p&&(c.rotation+=Math.PI),c.scaleX=Math.sqrt(d*d+f*f)/i,c.scaleY=Math.sqrt(g*g+m*m)/r,c.toMatrix(u),c.x=u.tx=n-(u.a*t+u.c*e),c.y=u.ty=a-(u.b*t+u.d*e)},e.prototype._updateVertices=function(){var t=this._boneData.vertices,e=this._vertices,i=this._deformVertices;if(null!==this._parent)if(1===this._parent._boneData.type)for(var r=0,n=t.length;n>r;r+=2){var a=t[r]+i[r],o=t[r+1]+i[r],s=this._parent._getGlobalTransformMatrix(a,o);e[r]=s.a*a+s.c*o+s.tx,e[r+1]=s.b*a+s.d*o+s.ty}else for(var l=this._parent.globalTransformMatrix,r=0,n=t.length;n>r;r+=2){var a=t[r]+i[r],o=t[r+1]+i[r+1];e[r]=l.a*a+l.c*o+l.tx,e[r+1]=l.b*a+l.d*o+l.ty}else for(var r=0,n=t.length;n>r;r+=2)e[r]=t[r]+i[r],e[r+1]=t[r+1]+i[r+1]},e.prototype._updateGlobalTransformMatrix=function(t){var e=2*this._boneData.segmentX,i=this._vertices.length-2,r=200,n=this._vertices[0],a=this._vertices[1],o=this._vertices[e],s=this._vertices[e+1],l=this._vertices[i],h=this._vertices[i+1],c=this._vertices[i-e],u=this._vertices[i-e+1],p=n+.5*(l-n),d=a+.5*(h-a),f=o+.5*(c-o),g=s+.5*(u-s),m=p+.5*(f-p),y=d+.5*(g-d),v=o+.5*(l-o),_=s+.5*(h-s),b=c+.5*(l-c),x=u+.5*(h-u);this._globalDirty=!1,this._getAffineTransform(0,0,r,r,m,y,v,_,b,x,this.global,this.globalTransformMatrix,!1)},e.prototype._getGlobalTransformMatrix=function(t,i){var r=1e3;if(-r>t||t>r||-r>i||i>r)return this.globalTransformMatrix;var n=!1,a=200,o=this._boneData,s=o.segmentX,l=o.segmentY,h=2*o.segmentX,c=this._dX,u=this._dY,p=Math.floor((t+a)/c),d=Math.floor((i+a)/u),f=0,g=p*c-a,m=d*u-a,y=this._matrixCahce,v=e._helpMatrix;if(-a>t){if(-a>i||i>=a)return this.globalTransformMatrix;if(n=i>this._kX*(t+a)+m,f=7*(2*(s*(l+1)+2*s+l+d)+(n?1:0)),this._matrixCahce[f]>0)v.copyFromArray(y,f+1);else{var _=d*(h+2),b=this._hullCache[4],x=this._hullCache[5],T=this._hullCache[2]-(l-d)*b,E=this._hullCache[3]-(l-d)*x,S=this._vertices;n?this._getAffineTransform(-a,m+u,r-a,u,S[_+h+2],S[_+h+3],T+b,E+x,S[_],S[_+1],e._helpTransform,v,!0):this._getAffineTransform(-r,m,r-a,u,T,E,S[_],S[_+1],T+b,E+x,e._helpTransform,v,!1),y[f]=1,y[f+1]=v.a,y[f+2]=v.b,y[f+3]=v.c,y[f+4]=v.d,y[f+5]=v.tx,y[f+6]=v.ty}}else if(t>=a){if(-a>i||i>=a)return this.globalTransformMatrix;if(n=i>this._kX*(t-r)+m,f=7*(2*(s*(l+1)+s+d)+(n?1:0)),this._matrixCahce[f]>0)v.copyFromArray(y,f+1);else{var _=(d+1)*(h+2)-2,b=this._hullCache[4],x=this._hullCache[5],T=this._hullCache[0]+d*b,E=this._hullCache[1]+d*x,S=this._vertices;n?this._getAffineTransform(r,m+u,r-a,u,T+b,E+x,S[_+h+2],S[_+h+3],T,E,e._helpTransform,v,!0):this._getAffineTransform(a,m,r-a,u,S[_],S[_+1],T,E,S[_+h+2],S[_+h+3],e._helpTransform,v,!1),y[f]=1,y[f+1]=v.a,y[f+2]=v.b,y[f+3]=v.c,y[f+4]=v.d,y[f+5]=v.tx,y[f+6]=v.ty}}else if(-a>i){if(-a>t||t>=a)return this.globalTransformMatrix;if(n=i>this._kY*(t-g-c)-r,f=7*(s*(l+1)+2*p+(n?1:0)),this._matrixCahce[f]>0)v.copyFromArray(y,f+1);else{var _=2*p,b=this._hullCache[10],x=this._hullCache[11],T=this._hullCache[8]+p*b,E=this._hullCache[9]+p*x,S=this._vertices;n?this._getAffineTransform(g+c,-a,c,r-a,S[_+2],S[_+3],S[_],S[_+1],T+b,E+x,e._helpTransform,v,!0):this._getAffineTransform(g,-r,c,r-a,T,E,T+b,E+x,S[_],S[_+1],e._helpTransform,v,!1),y[f]=1,y[f+1]=v.a,y[f+2]=v.b,y[f+3]=v.c,y[f+4]=v.d,y[f+5]=v.tx,y[f+6]=v.ty}}else if(i>=a){if(-a>t||t>=a)return this.globalTransformMatrix;if(n=i>this._kY*(t-g-c)+a,f=7*(2*(s*(l+1)+s+l+d)+(n?1:0)),this._matrixCahce[f]>0)v.copyFromArray(y,f+1);else{var _=l*(h+2)+2*p,b=this._hullCache[10],x=this._hullCache[11],T=this._hullCache[6]-(s-p)*b,E=this._hullCache[7]-(s-p)*x,S=this._vertices;n?this._getAffineTransform(g+c,r,c,r-a,T+b,E+x,T,E,S[_+2],S[_+3],e._helpTransform,v,!0):this._getAffineTransform(g,a,c,r-a,S[_],S[_+1],S[_+2],S[_+3],T,E,e._helpTransform,v,!1),y[f]=1,y[f+1]=v.a,y[f+2]=v.b,y[f+3]=v.c,y[f+4]=v.d,y[f+5]=v.tx,y[f+6]=v.ty}}else if(n=i>this._k*(t-g-c)+m,f=7*(2*(s*d+p)+(n?1:0)),this._matrixCahce[f]>0)v.copyFromArray(y,f+1);else{var _=2*p+d*(h+2),S=this._vertices;n?this._getAffineTransform(g+c,m+u,c,u,S[_+h+4],S[_+h+5],S[_+h+2],S[_+h+3],S[_+2],S[_+3],e._helpTransform,v,!0):this._getAffineTransform(g,m,c,u,S[_],S[_+1],S[_+2],S[_+3],S[_+h+2],S[_+h+3],e._helpTransform,v,!1),y[f]=1,y[f+1]=v.a,y[f+2]=v.b,y[f+3]=v.c,y[f+4]=v.d,y[f+5]=v.tx,y[f+6]=v.ty}return v},e.prototype.init=function(e,i){if(null===this._boneData){t.prototype.init.call(this,e,i);var r=e.segmentX,n=e.segmentY,a=e.vertices.length,o=1e3,s=200;this._dX=2*s/r,this._dY=2*s/n,this._k=-this._dY/this._dX,this._kX=-this._dY/(o-s),this._kY=-(o-s)/this._dX,this._vertices.length=a,this._deformVertices.length=a,this._matrixCahce.length=2*(r*n+2*r+2*n)*7,this._hullCache.length=10;for(var l=0;a>l;++l)this._deformVertices[l]=0}},e.prototype.update=function(t){if(this._blendState.dirty=!1,t>=0&&null!==this._cachedFrameIndices){var i=this._cachedFrameIndices[t];if(i>=0&&this._cachedFrameIndex===i)this._transformDirty=!1;else if(i>=0)this._transformDirty=!0,this._cachedFrameIndex=i;else{if(this._hasConstraint)for(var r=0,n=this._armature._constraints;r<n.length;r++){var a=n[r];a._root===this&&a.update()}this._transformDirty||null!==this._parent&&this._parent._childrenTransformDirty?(this._transformDirty=!0,this._cachedFrameIndex=-1):this._cachedFrameIndex>=0?(this._transformDirty=!1,this._cachedFrameIndices[t]=this._cachedFrameIndex):(this._transformDirty=!0,this._cachedFrameIndex=-1)}}else{if(this._hasConstraint)for(var o=0,s=this._armature._constraints;o<s.length;o++){var a=s[o];a._root===this&&a.update()}(this._transformDirty||null!==this._parent&&this._parent._childrenTransformDirty)&&(t=-1,this._transformDirty=!0,this._cachedFrameIndex=-1)}if(this._transformDirty){this._transformDirty=!1,this._childrenTransformDirty=!0;for(var l=0,h=this._matrixCahce.length;h>l;l+=7)this._matrixCahce[l]=-1;if(this._updateVertices(),this._cachedFrameIndex<0){var c=t>=0;this._localDirty&&this._updateGlobalTransformMatrix(c),c&&null!==this._cachedFrameIndices&&(this._cachedFrameIndex=this._cachedFrameIndices[t]=this._armature._armatureData.setCacheFrame(this.globalTransformMatrix,this.global))}else this._armature._armatureData.getCacheFrame(this.globalTransformMatrix,this.global,this._cachedFrameIndex);var u=1e3,p=200,d=2*this.global.x,f=2*this.global.y,g=e._helpPoint;this.globalTransformMatrix.transformPoint(u,-p,g),this._hullCache[0]=g.x,this._hullCache[1]=g.y,this._hullCache[2]=d-g.x,this._hullCache[3]=f-g.y,this.globalTransformMatrix.transformPoint(0,this._dY,g,!0),this._hullCache[4]=g.x,this._hullCache[5]=g.y,this.globalTransformMatrix.transformPoint(p,u,g),this._hullCache[6]=g.x,this._hullCache[7]=g.y,this._hullCache[8]=d-g.x,this._hullCache[9]=f-g.y,this.globalTransformMatrix.transformPoint(this._dX,0,g,!0),this._hullCache[10]=g.x,this._hullCache[11]=g.y}else this._childrenTransformDirty&&(this._childrenTransformDirty=!1);this._localDirty=!0},e}(t.Bone);t.Surface=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i._localMatrix=new t.Matrix,i._colorTransform=new t.ColorTransform,i._displayDatas=[],i._displayList=[],i._deformVertices=null,i._rawDisplay=null,i._meshDisplay=null,i}return __extends(i,e),i.prototype._onClear=function(){e.prototype._onClear.call(this);for(var i=[],r=0,n=this._displayList;r<n.length;r++){var a=n[r];null!==a&&a!==this._rawDisplay&&a!==this._meshDisplay&&i.indexOf(a)<0&&i.push(a)}for(var o=0,s=i;o<s.length;o++){var a=s[o];a instanceof t.Armature?a.dispose():this._disposeDisplay(a,!0)}null!==this._deformVertices&&this._deformVertices.returnToPool(),null!==this._meshDisplay&&this._meshDisplay!==this._rawDisplay&&this._disposeDisplay(this._meshDisplay,!1),null!==this._rawDisplay&&this._disposeDisplay(this._rawDisplay,!1),this.displayController=null,this._displayDirty=!1,this._zOrderDirty=!1,this._blendModeDirty=!1,this._colorDirty=!1,this._transformDirty=!1,this._visible=!0,this._blendMode=0,this._displayIndex=-1,this._animationDisplayIndex=-1,this._zOrder=0,this._cachedFrameIndex=-1,this._pivotX=0,this._pivotY=0,this._localMatrix.identity(),this._colorTransform.identity(),this._displayList.length=0,this._displayDatas.length=0,this._slotData=null,this._rawDisplayDatas=null,this._displayData=null,this._boundingBoxData=null,this._textureData=null,this._deformVertices=null,this._rawDisplay=null,this._meshDisplay=null,this._display=null,this._childArmature=null,this._parent=null,this._cachedFrameIndices=null},i.prototype._getDefaultRawDisplayData=function(t){var e=this._armature._armatureData.defaultSkin;if(null!==e){var i=e.getDisplays(this._slotData.name);if(null!==i)return t<i.length?i[t]:null}return null},i.prototype._updateDisplayData=function(){var e=this._displayData,r=null!==this._deformVertices?this._deformVertices.verticesData:null,n=this._textureData,a=null,o=null;if(this._displayData=null,this._boundingBoxData=null,this._textureData=null,this._displayIndex>=0&&(null!==this._rawDisplayDatas&&(a=this._displayIndex<this._rawDisplayDatas.length?this._rawDisplayDatas[this._displayIndex]:null),null===a&&(a=this._getDefaultRawDisplayData(this._displayIndex)),this._displayIndex<this._displayDatas.length&&(this._displayData=this._displayDatas[this._displayIndex])),null!==this._displayData&&(2===this._displayData.type?o=this._displayData.vertices:4===this._displayData.type?o=this._displayData.vertices:null!==a&&(2===a.type?o=a.vertices:4===a.type&&(o=a.vertices)),3===this._displayData.type?this._boundingBoxData=this._displayData.boundingBox:null!==a&&3===a.type&&(this._boundingBoxData=a.boundingBox),0===this._displayData.type?this._textureData=this._displayData.texture:2===this._displayData.type&&(this._textureData=this._displayData.texture)),this._displayData!==e||o!==r||this._textureData!==n){if(null===o&&null!==this._textureData){var s=this._displayData,l=this._textureData.parent.scale*this._armature._armatureData.scale,h=this._textureData.frame;this._pivotX=s.pivot.x,this._pivotY=s.pivot.y;var c=null!==h?h:this._textureData.region,u=c.width,p=c.height;this._textureData.rotated&&null===h&&(u=c.height,p=c.width),this._pivotX*=u*l,this._pivotY*=p*l,null!==h&&(this._pivotX+=h.x*l,this._pivotY+=h.y*l),null!==this._displayData&&null!==a&&this._displayData!==a&&(a.transform.toMatrix(i._helpMatrix),i._helpMatrix.invert(),i._helpMatrix.transformPoint(0,0,i._helpPoint),this._pivotX-=i._helpPoint.x,this._pivotY-=i._helpPoint.y,this._displayData.transform.toMatrix(i._helpMatrix),i._helpMatrix.invert(),i._helpMatrix.transformPoint(0,0,i._helpPoint),this._pivotX+=i._helpPoint.x,this._pivotY+=i._helpPoint.y),t.DragonBones.yDown||(this._pivotY=(this._textureData.rotated?this._textureData.region.width:this._textureData.region.height)*l-this._pivotY)}else this._pivotX=0,this._pivotY=0;null!==a?this.origin=a.transform:null!==this._displayData?this.origin=this._displayData.transform:this.origin=null,o!==r?(null===this._deformVertices&&(this._deformVertices=t.BaseObject.borrowObject(t.DeformVertices)),this._deformVertices.init(o,this._armature)):null!==this._deformVertices&&this._textureData!==n&&(this._deformVertices.verticesDirty=!0),this._displayDirty=!0,this._transformDirty=!0}},i.prototype._updateDisplay=function(){var e=null!==this._display?this._display:this._rawDisplay,i=this._childArmature;this._displayIndex>=0&&this._displayIndex<this._displayList.length?(this._display=this._displayList[this._displayIndex],null!==this._display&&this._display instanceof t.Armature?(this._childArmature=this._display,this._display=this._childArmature.display):this._childArmature=null):(this._display=null,this._childArmature=null);var r=null!==this._display?this._display:this._rawDisplay;if(r!==e&&(this._onUpdateDisplay(),this._replaceDisplay(e),this._transformDirty=!0,this._visibleDirty=!0,this._blendModeDirty=!0,this._colorDirty=!0),(r===this._rawDisplay||r===this._meshDisplay)&&this._updateFrame(),this._childArmature!==i&&(null!==i&&(i._parent=null,i.clock=null,i.inheritAnimation&&i.animation.reset()),null!==this._childArmature&&(this._childArmature._parent=this,this._childArmature.clock=this._armature.clock,this._childArmature.inheritAnimation))){if(0===this._childArmature.cacheFrameRate){var n=this._armature.cacheFrameRate;0!==n&&(this._childArmature.cacheFrameRate=n)}var a=null;if(null!==this._displayData&&1===this._displayData.type)a=this._displayData.actions;else if(this._displayIndex>=0&&null!==this._rawDisplayDatas){var o=this._displayIndex<this._rawDisplayDatas.length?this._rawDisplayDatas[this._displayIndex]:null;null===o&&(o=this._getDefaultRawDisplayData(this._displayIndex)),null!==o&&1===o.type&&(a=o.actions)}if(null!==a&&a.length>0)for(var s=0,l=a;s<l.length;s++){var h=l[s],c=t.BaseObject.borrowObject(t.EventObject);t.EventObject.actionDataToInstance(h,c,this._armature),c.slot=this,this._armature._bufferAction(c,!1)}else this._childArmature.animation.play()}},i.prototype._updateGlobalTransformMatrix=function(t){var e=0===this._parent._boneData.type?this._parent.globalTransformMatrix:this._parent._getGlobalTransformMatrix(this.global.x,this.global.y);this.globalTransformMatrix.copyFrom(this._localMatrix),this.globalTransformMatrix.concat(e),t?this.global.fromMatrix(this.globalTransformMatrix):this._globalDirty=!0},i.prototype._setDisplayIndex=function(t,e){if(void 0===e&&(e=!1),e){if(this._animationDisplayIndex===t)return!1;this._animationDisplayIndex=t}return this._displayIndex===t?!1:(this._displayIndex=t,this._displayDirty=!0,this._updateDisplayData(),this._displayDirty)},i.prototype._setZorder=function(t){return this._zOrder===t,this._zOrder=t,this._zOrderDirty=!0,this._zOrderDirty},i.prototype._setColor=function(t){return this._colorTransform.copyFrom(t),this._colorDirty=!0,this._colorDirty},i.prototype._setDisplayList=function(e){if(null!==e&&e.length>0){this._displayList.length!==e.length&&(this._displayList.length=e.length);for(var i=0,r=e.length;r>i;++i){var n=e[i];null!==n&&n!==this._rawDisplay&&n!==this._meshDisplay&&!(n instanceof t.Armature)&&this._displayList.indexOf(n)<0&&this._initDisplay(n,!0),this._displayList[i]=n}}else this._displayList.length>0&&(this._displayList.length=0);return this._displayIndex>=0&&this._displayIndex<this._displayList.length?this._displayDirty=this._display!==this._displayList[this._displayIndex]:this._displayDirty=null!==this._display,this._updateDisplayData(),this._displayDirty},i.prototype.init=function(t,e,i,r){if(null===this._slotData){this._slotData=t,this._visibleDirty=!0,this._blendModeDirty=!0,this._colorDirty=!0,this._blendMode=this._slotData.blendMode,this._zOrder=this._slotData.zOrder,this._colorTransform.copyFrom(this._slotData.color),this._rawDisplay=i,this._meshDisplay=r,this._armature=e;var n=this._armature.getBone(this._slotData.parent.name);null!==n&&(this._parent=n),this._armature._addSlot(this),this._initDisplay(this._rawDisplay,!1),this._rawDisplay!==this._meshDisplay&&this._initDisplay(this._meshDisplay,!1),this._onUpdateDisplay(),this._addDisplay()}},i.prototype.update=function(t){if(this._displayDirty&&(this._displayDirty=!1,this._updateDisplay(),this._transformDirty&&(null!==this.origin?this.global.copyFrom(this.origin).add(this.offset).toMatrix(this._localMatrix):this.global.copyFrom(this.offset).toMatrix(this._localMatrix))),this._zOrderDirty&&(this._zOrderDirty=!1,this._updateZOrder()),t>=0&&null!==this._cachedFrameIndices){var e=this._cachedFrameIndices[t];e>=0&&this._cachedFrameIndex===e?this._transformDirty=!1:e>=0?(this._transformDirty=!0,this._cachedFrameIndex=e):this._transformDirty||this._parent._childrenTransformDirty?(this._transformDirty=!0,this._cachedFrameIndex=-1):this._cachedFrameIndex>=0?(this._transformDirty=!1,this._cachedFrameIndices[t]=this._cachedFrameIndex):(this._transformDirty=!0,this._cachedFrameIndex=-1)}else(this._transformDirty||this._parent._childrenTransformDirty)&&(t=-1,this._transformDirty=!0,this._cachedFrameIndex=-1);if(null!==this._display){if(this._visibleDirty&&(this._visibleDirty=!1,this._updateVisible()),this._blendModeDirty&&(this._blendModeDirty=!1,this._updateBlendMode()),this._colorDirty&&(this._colorDirty=!1,this._updateColor()),null!==this._deformVertices&&null!==this._deformVertices.verticesData&&this._display===this._meshDisplay){var i=null!==this._deformVertices.verticesData.weight,r=0!==this._parent._boneData.type;if((this._deformVertices.verticesDirty||i&&this._deformVertices.isBonesUpdate()||r&&this._parent._childrenTransformDirty)&&(this._deformVertices.verticesDirty=!1,this._updateMesh()),i||r)return}if(this._transformDirty){if(this._transformDirty=!1,this._cachedFrameIndex<0){var n=t>=0;this._updateGlobalTransformMatrix(n),n&&null!==this._cachedFrameIndices&&(this._cachedFrameIndex=this._cachedFrameIndices[t]=this._armature._armatureData.setCacheFrame(this.globalTransformMatrix,this.global))}else this._armature._armatureData.getCacheFrame(this.globalTransformMatrix,this.global,this._cachedFrameIndex);this._updateTransform()}}},i.prototype.updateTransformAndMatrix=function(){this._transformDirty&&(this._transformDirty=!1,this._updateGlobalTransformMatrix(!1))},i.prototype.replaceDisplayData=function(t,e){if(void 0===e&&(e=-1),0>e&&(e=this._displayIndex<0?0:this._displayIndex),this._displayDatas.length<=e){this._displayDatas.length=e+1;for(var i=0,r=this._displayDatas.length;r>i;++i)this._displayDatas[i]||(this._displayDatas[i]=null)}this._displayDatas[e]=t},i.prototype.containsPoint=function(t,e){return null===this._boundingBoxData?!1:(this.updateTransformAndMatrix(),i._helpMatrix.copyFrom(this.globalTransformMatrix),i._helpMatrix.invert(),i._helpMatrix.transformPoint(t,e,i._helpPoint),this._boundingBoxData.containsPoint(i._helpPoint.x,i._helpPoint.y))},i.prototype.intersectsSegment=function(t,e,r,n,a,o,s){if(void 0===a&&(a=null),void 0===o&&(o=null),void 0===s&&(s=null),null===this._boundingBoxData)return 0;this.updateTransformAndMatrix(),i._helpMatrix.copyFrom(this.globalTransformMatrix),i._helpMatrix.invert(),i._helpMatrix.transformPoint(t,e,i._helpPoint),t=i._helpPoint.x,e=i._helpPoint.y,i._helpMatrix.transformPoint(r,n,i._helpPoint),r=i._helpPoint.x,n=i._helpPoint.y;var l=this._boundingBoxData.intersectsSegment(t,e,r,n,a,o,s);return l>0&&(1===l||2===l?null!==a?(this.globalTransformMatrix.transformPoint(a.x,a.y,a),null!==o&&(o.x=a.x,o.y=a.y)):null!==o&&this.globalTransformMatrix.transformPoint(o.x,o.y,o):(null!==a&&this.globalTransformMatrix.transformPoint(a.x,a.y,a),null!==o&&this.globalTransformMatrix.transformPoint(o.x,o.y,o)),null!==s&&(this.globalTransformMatrix.transformPoint(Math.cos(s.x),Math.sin(s.x),i._helpPoint,!0),s.x=Math.atan2(i._helpPoint.y,i._helpPoint.x),this.globalTransformMatrix.transformPoint(Math.cos(s.y),Math.sin(s.y),i._helpPoint,!0),s.y=Math.atan2(i._helpPoint.y,i._helpPoint.x))),l
},i.prototype.invalidUpdate=function(){this._displayDirty=!0,this._transformDirty=!0},Object.defineProperty(i.prototype,"visible",{get:function(){return this._visible},set:function(t){this._visible!==t&&(this._visible=t,this._updateVisible())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"displayIndex",{get:function(){return this._displayIndex},set:function(t){this._setDisplayIndex(t)&&this.update(-1)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"name",{get:function(){return this._slotData.name},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"displayList",{get:function(){return this._displayList.concat()},set:function(e){var i=this._displayList.concat(),r=new Array;this._setDisplayList(e)&&this.update(-1);for(var n=0,a=i;n<a.length;n++){var o=a[n];null!==o&&o!==this._rawDisplay&&o!==this._meshDisplay&&this._displayList.indexOf(o)<0&&r.indexOf(o)<0&&r.push(o)}for(var s=0,l=r;s<l.length;s++){var o=l[s];o instanceof t.Armature||this._disposeDisplay(o,!0)}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"slotData",{get:function(){return this._slotData},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"rawDisplayDatas",{get:function(){return this._rawDisplayDatas},set:function(t){if(this._rawDisplayDatas!==t)if(this._displayDirty=!0,this._rawDisplayDatas=t,null!==this._rawDisplayDatas){this._displayDatas.length=this._rawDisplayDatas.length;for(var e=0,i=this._displayDatas.length;i>e;++e){var r=this._rawDisplayDatas[e];null===r&&(r=this._getDefaultRawDisplayData(e)),this._displayDatas[e]=r}}else this._displayDatas.length=0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"displayData",{get:function(){return this._displayData},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"boundingBoxData",{get:function(){return this._boundingBoxData},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"rawDisplay",{get:function(){return this._rawDisplay},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"meshDisplay",{get:function(){return this._meshDisplay},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"display",{get:function(){return this._display},set:function(t){if(this._display!==t){var e=this._displayList.length;if(this._displayIndex<0&&0===e&&(this._displayIndex=0),!(this._displayIndex<0)){var i=this.displayList;e<=this._displayIndex&&(i.length=this._displayIndex+1),i[this._displayIndex]=t,this.displayList=i}}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"childArmature",{get:function(){return this._childArmature},set:function(t){this._childArmature!==t&&(this.display=t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"parent",{get:function(){return this._parent},enumerable:!0,configurable:!0}),i.prototype.getDisplay=function(){return this._display},i.prototype.setDisplay=function(t){this.display=t},i}(t.TransformObject);t.Slot=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return __extends(i,e),i.prototype._onClear=function(){this._armature=null,this._target=null,this._root=null,this._bone=null},Object.defineProperty(i.prototype,"name",{get:function(){return this._constraintData.name},enumerable:!0,configurable:!0}),i._helpMatrix=new t.Matrix,i._helpTransform=new t.Transform,i._helpPoint=new t.Point,i}(t.BaseObject);t.Constraint=e;var i=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return __extends(i,e),i.toString=function(){return"[class dragonBones.IKConstraint]"},i.prototype._onClear=function(){e.prototype._onClear.call(this),this._scaleEnabled=!1,this._bendPositive=!1,this._weight=1,this._constraintData=null},i.prototype._computeA=function(){var e=this._target.global,i=this._root.global,r=this._root.globalTransformMatrix,n=Math.atan2(e.y-i.y,e.x-i.x);i.scaleX<0&&(n+=Math.PI),i.rotation+=t.Transform.normalizeRadian(n-i.rotation)*this._weight,i.toMatrix(r)},i.prototype._computeB=function(){var e=this._bone._boneData.length,i=this._root,r=this._target.global,n=i.global,a=this._bone.global,o=this._bone.globalTransformMatrix,s=o.a*e,l=o.b*e,h=s*s+l*l,c=Math.sqrt(h),u=a.x-n.x,p=a.y-n.y,d=u*u+p*p,f=Math.sqrt(d),g=a.rotation,m=n.rotation,y=Math.atan2(p,u);u=r.x-n.x,p=r.y-n.y;var v=u*u+p*p,_=Math.sqrt(v),b=0;if(_>=c+f||f>=_+c||c>=_+f)b=Math.atan2(r.y-n.y,r.x-n.x),_>=c+f||c>f&&(b+=Math.PI);else{var x=(d-h+v)/(2*v),T=Math.sqrt(d-x*x*v)/_,E=n.x+u*x,S=n.y+p*x,C=-p*T,w=u*T,P=!1,D=i.parent;if(null!==D){var A=D.globalTransformMatrix;P=A.a*A.d-A.b*A.c<0}P!==this._bendPositive?(a.x=E-C,a.y=S-w):(a.x=E+C,a.y=S+w),b=Math.atan2(a.y-n.y,a.x-n.x)}var I=t.Transform.normalizeRadian(b-y);n.rotation=m+I*this._weight,n.toMatrix(i.globalTransformMatrix);var M=y+I*this._weight;a.x=n.x+Math.cos(M)*f,a.y=n.y+Math.sin(M)*f;var $=Math.atan2(r.y-a.y,r.x-a.x);a.scaleX<0&&($+=Math.PI),a.rotation=n.rotation+g-m+t.Transform.normalizeRadian($-I-g)*this._weight,a.toMatrix(o)},i.prototype.init=function(t,e){if(null===this._constraintData){this._constraintData=t,this._armature=e,this._target=this._armature.getBone(this._constraintData.target.name),this._root=this._armature.getBone(this._constraintData.root.name),this._bone=null!==this._constraintData.bone?this._armature.getBone(this._constraintData.bone.name):null;var i=this._constraintData;this._scaleEnabled=i.scaleEnabled,this._bendPositive=i.bendPositive,this._weight=i.weight,this._root._hasConstraint=!0}},i.prototype.update=function(){this._root.updateByConstraint(),null!==this._bone?(this._bone.updateByConstraint(),this._computeB()):this._computeA()},i.prototype.invalidUpdate=function(){this._root.invalidUpdate(),null!==this._bone&&this._bone.invalidUpdate()},i}(e);t.IKConstraint=i;var r=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t._bones=[],t._spaces=[],t._positions=[],t._curves=[],t._boneLengths=[],t._pathGlobalVertices=[],t._segments=[10],t}return __extends(i,e),i.toString=function(){return"[class dragonBones.PathConstraint]"},i.prototype._onClear=function(){e.prototype._onClear.call(this),this.dirty=!1,this.pathOffset=0,this.position=0,this.spacing=0,this.rotateOffset=0,this.rotateMix=1,this.translateMix=1,this._pathSlot=null,this._bones.length=0,this._spaces.length=0,this._positions.length=0,this._curves.length=0,this._boneLengths.length=0,this._pathGlobalVertices.length=0},i.prototype._updatePathVertices=function(t){var e=this._armature,i=e.armatureData.parent,r=e.armatureData.scale,n=i.intArray,a=i.floatArray,o=t.offset,s=n[o+0],l=n[o+2];this._pathGlobalVertices.length=2*s;var h=t.weight;if(null!==h)for(var c=this._pathSlot._deformVertices.bones,u=h.bones.length,p=h.offset,d=n[p+1],f=d,g=p+2+u,m=0,y=0;s>m;m++){for(var v=n[g++],_=0,b=0,x=0,T=v;T>x;x++){var E=n[g++],S=c[E];if(null!==S){S.updateByConstraint();var C=S.globalTransformMatrix,w=a[f++],P=a[f++]*r,D=a[f++]*r;_+=(C.a*P+C.c*D+C.tx)*w,b+=(C.b*P+C.d*D+C.ty)*w}}this._pathGlobalVertices[y++]=_,this._pathGlobalVertices[y++]=b}else{var A=this._pathSlot.parent;A.updateByConstraint();for(var C=A.globalTransformMatrix,m=0,I=l;s>m;m+=2){var P=a[I++]*r,D=a[I++]*r,M=C.a*P+C.c*D+C.tx,$=C.b*P+C.d*D+C.ty;this._pathGlobalVertices[m]=M,this._pathGlobalVertices[m+1]=$}}},i.prototype._computeVertices=function(t,e,i,r){for(var n=i,a=t;e>n;n+=2)r[n]=this._pathGlobalVertices[a++],r[n+1]=this._pathGlobalVertices[a++]},i.prototype._computeBezierCurve=function(t,e,i,r,n){var a=this._armature,o=a.armatureData.parent.intArray,s=o[t.vertices.offset+0],l=this._positions,h=this._spaces,c=t.closed,u=Array(),p=2*s,d=p/6,f=-1,g=this.position;l.length=3*e+2;var m=0;if(t.constantSpeed){c?(p+=2,u.length=s,this._computeVertices(2,p-4,0,u),this._computeVertices(0,2,p-4,u),u[p-2]=u[0],u[p-1]=u[1]):(d--,p-=4,u.length=p,this._computeVertices(2,p,0,u));var y=new Array(d);m=0;for(var v,_,b,x,T,E,S,C,w=u[0],P=u[1],D=0,A=0,I=0,M=0,$=0,O=0,R=0,L=2;d>R;R++,L+=6)D=u[L],A=u[L+1],I=u[L+2],M=u[L+3],$=u[L+4],O=u[L+5],v=.1875*(w-2*D+I),_=.1875*(P-2*A+M),b=.09375*(3*(D-I)-w+$),x=.09375*(3*(A-M)-P+O),T=2*v+b,E=2*_+x,S=.75*(D-w)+v+.16666667*b,C=.75*(A-P)+_+.16666667*x,m+=Math.sqrt(S*S+C*C),S+=T,C+=E,T+=b,E+=x,m+=Math.sqrt(S*S+C*C),S+=T,C+=E,m+=Math.sqrt(S*S+C*C),S+=T+b,C+=E+x,m+=Math.sqrt(S*S+C*C),y[R]=m,w=$,P=O;if(r&&(g*=m),n)for(var R=0;e>R;R++)h[R]*=m;for(var B=this._segments,k=0,R=0,N=0,F=0,G=0;e>R;R++,N+=3){var U=h[R];g+=U;var V=g;if(c)V%=m,0>V&&(V+=m),F=0;else{if(0>V)continue;if(V>m)continue}for(;;F++){var H=y[F];if(!(V>H)){if(0===F)V/=H;else{var j=y[F-1];V=(V-j)/(H-j)}break}}if(F!==f){f=F;var W=6*F;for(w=u[W],P=u[W+1],D=u[W+2],A=u[W+3],I=u[W+4],M=u[W+5],$=u[W+6],O=u[W+7],v=.03*(w-2*D+I),_=.03*(P-2*A+M),b=.006*(3*(D-I)-w+$),x=.006*(3*(A-M)-P+O),T=2*v+b,E=2*_+x,S=.3*(D-w)+v+.16666667*b,C=.3*(A-P)+_+.16666667*x,k=Math.sqrt(S*S+C*C),B[0]=k,W=1;8>W;W++)S+=T,C+=E,T+=b,E+=x,k+=Math.sqrt(S*S+C*C),B[W]=k;S+=T,C+=E,k+=Math.sqrt(S*S+C*C),B[8]=k,S+=T+b,C+=E+x,k+=Math.sqrt(S*S+C*C),B[9]=k,G=0}for(V*=k;;G++){var X=B[G];if(!(V>X)){if(0===G)V/=X;else{var j=B[G-1];V=G+(V-j)/(X-j)}break}}this.addCurvePosition(.1*V,w,P,D,A,I,M,$,O,l,N,i)}}else{var z=t.curveLengths;if(d-=c?1:2,m=z[d],r&&(g*=m),n)for(var R=0;e>R;R++)h[R]*=m;u.length=8;for(var R=0,N=0,F=0;e>R;R++,N+=3){var U=h[R];if(g+=U,c)g%=m,0>g&&(g+=m),F=0;else{if(0>g)continue;if(g>m)continue}for(var Y=0;;F++){var q=z[F];if(!(g>q)){if(0===F)Y=g/q;else{var Q=z[F-1];Y=(g-Q)/(q-Q)}break}}F!==f&&(f=F,c&&F===d?(this._computeVertices(p-4,4,0,u),this._computeVertices(0,4,4,u)):this._computeVertices(6*F+2,8,0,u)),this.addCurvePosition(Y,u[0],u[1],u[2],u[3],u[4],u[5],u[6],u[7],l,N,i)}}},i.prototype.addCurvePosition=function(t,e,i,r,n,a,o,s,l,h,c,u){if(0===t)return h[c]=e,h[c+1]=i,void(h[c+2]=0);if(1===t)return h[c]=s,h[c+1]=l,void(h[c+2]=0);var p=1-t,d=p*p,f=t*t,g=d*p,m=d*t*3,y=p*f*3,v=t*f,_=g*e+m*r+y*a+v*s,b=g*i+m*n+y*o+v*l;h[c]=_,h[c+1]=b,u?h[c+2]=Math.atan2(b-(g*i+m*n+y*o),_-(g*e+m*r+y*a)):h[c+2]=0},i.prototype.init=function(t,e){this._constraintData=t,this._armature=e;var i=t;this.pathOffset=i.pathDisplayData.vertices.offset,this.position=i.position,this.spacing=i.spacing,this.rotateOffset=i.rotateOffset,this.rotateMix=i.rotateMix,this.translateMix=i.translateMix,this._root=this._armature.getBone(i.root.name),this._target=this._armature.getBone(i.target.name),this._pathSlot=this._armature.getSlot(i.pathSlot.name);for(var r=0,n=i.bones.length;n>r;r++){var a=this._armature.getBone(i.bones[r].name);null!==a&&this._bones.push(a)}2===i.rotateMode&&(this._boneLengths.length=this._bones.length),this._root._hasConstraint=!0},i.prototype.update=function(){var e=this._pathSlot;if(null!==e._deformVertices&&null!==e._deformVertices.verticesData&&e._deformVertices.verticesData.offset===this.pathOffset){var i=this._constraintData,r=e._displayData,n=!1,a=e._deformVertices;if(this._root._childrenTransformDirty?(this._updatePathVertices(r.vertices),n=!0):null!==a&&(a.verticesDirty||a.isBonesUpdate())&&(this._updatePathVertices(r.vertices),a.verticesDirty=!1,n=!0),n||this.dirty){var o=i.positionMode,s=i.spacingMode,l=i.rotateMode,h=this._bones,c=0===s,u=2===l,p=0===l,d=h.length,f=p?d:d+1,g=this.spacing,m=this._spaces;if(m.length=f,u||c){m[0]=0;for(var y=0,v=f-1;v>y;y++){var _=h[y];_.updateByConstraint();var b=_._boneData.length,x=_.globalTransformMatrix,T=b*x.a,E=b*x.b,S=Math.sqrt(T*T+E*E);u&&(this._boneLengths[y]=S),m[y+1]=(b+g)*S/b}}else for(var y=0;f>y;y++)m[y]=g;this._computeBezierCurve(r,f,p,1===o,2===s);var C,w=this._positions,P=this.rotateOffset,D=w[0],A=w[1];if(0===P)C=1===l;else{C=!1;var _=e.parent;if(null!==_){var x=_.globalTransformMatrix;P*=x.a*x.d-x.b*x.c>0?t.Transform.DEG_RAD:-t.Transform.DEG_RAD}}for(var I=this.rotateMix,M=this.translateMix,y=0,$=3;d>y;y++,$+=3){var _=h[y];_.updateByConstraint();var x=_.globalTransformMatrix;x.tx+=(D-x.tx)*M,x.ty+=(A-x.ty)*M;var T=w[$],E=w[$+1],O=T-D,R=E-A;if(u){var L=this._boneLengths[y],B=(Math.sqrt(O*O+R*R)/L-1)*I+1;x.a*=B,x.b*=B}if(D=T,A=E,I>0){var k=x.a,N=x.b,F=x.c,G=x.d,U=void 0,V=void 0,H=void 0;if(U=p?w[$-1]:Math.atan2(R,O),U-=Math.atan2(N,k),C){V=Math.cos(U),H=Math.sin(U);var j=_._boneData.length;D+=(j*(V*k-H*N)-O)*I,A+=(j*(H*k+V*N)-R)*I}else U+=P;U>t.Transform.PI?U-=t.Transform.PI_D:U<-t.Transform.PI&&(U+=t.Transform.PI_D),U*=I,V=Math.cos(U),H=Math.sin(U),x.a=V*k-H*N,x.b=H*k+V*N,x.c=V*F-H*G,x.d=H*F+V*G}_.global.fromMatrix(x)}this.dirty=!1}}},i.prototype.invalidUpdate=function(){},i}(e);t.PathConstraint=r}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function t(t){void 0===t&&(t=0),this.time=0,this.timeScale=1,this._systemTime=0,this._animatebles=[],this._clock=null,this.time=t,this._systemTime=.001*(new Date).getTime()}return t.prototype.advanceTime=function(t){t!==t&&(t=0);var e=.001*Date.now();if(0>t&&(t=e-this._systemTime),this._systemTime=e,1!==this.timeScale&&(t*=this.timeScale),0!==t){0>t?this.time-=t:this.time+=t;for(var i=0,r=0,n=this._animatebles.length;n>i;++i){var a=this._animatebles[i];null!==a?(r>0&&(this._animatebles[i-r]=a,this._animatebles[i]=null),a.advanceTime(t)):r++}if(r>0){for(n=this._animatebles.length;n>i;++i){var o=this._animatebles[i];null!==o?this._animatebles[i-r]=o:r++}this._animatebles.length-=r}}},t.prototype.contains=function(t){if(t===this)return!1;for(var e=t;e!==this&&null!==e;)e=e.clock;return e===this},t.prototype.add=function(t){this._animatebles.indexOf(t)<0&&(this._animatebles.push(t),t.clock=this)},t.prototype.remove=function(t){var e=this._animatebles.indexOf(t);e>=0&&(this._animatebles[e]=null,t.clock=null)},t.prototype.clear=function(){for(var t=0,e=this._animatebles;t<e.length;t++){var i=e[t];null!==i&&(i.clock=null)}},Object.defineProperty(t.prototype,"clock",{get:function(){return this._clock},set:function(t){this._clock!==t&&(null!==this._clock&&this._clock.remove(this),this._clock=t,null!==this._clock&&this._clock.add(this))},enumerable:!0,configurable:!0}),t.clock=new t,t}();t.WorldClock=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t._animationNames=[],t._animationStates=[],t._animations={},t._animationConfig=null,t}return __extends(i,e),i.toString=function(){return"[class dragonBones.Animation]"},i.prototype._onClear=function(){for(var t=0,e=this._animationStates;t<e.length;t++){var i=e[t];i.returnToPool()}for(var r in this._animations)delete this._animations[r];null!==this._animationConfig&&this._animationConfig.returnToPool(),this.timeScale=1,this._lockUpdate=!1,this._animationDirty=!1,this._inheritTimeScale=1,this._animationNames.length=0,this._animationStates.length=0,this._armature=null,this._animationConfig=null,this._lastAnimationState=null},i.prototype._fadeOut=function(t){switch(t.fadeOutMode){case 1:for(var e=0,i=this._animationStates;e<i.length;e++){var r=i[e];null===r._parent&&r.layer===t.layer&&r.fadeOut(t.fadeOutTime,t.pauseFadeOut)}break;case 2:for(var n=0,a=this._animationStates;n<a.length;n++){var r=a[n];null===r._parent&&r.group===t.group&&r.fadeOut(t.fadeOutTime,t.pauseFadeOut)}break;case 3:for(var o=0,s=this._animationStates;o<s.length;o++){var r=s[o];null===r._parent&&r.layer===t.layer&&r.group===t.group&&r.fadeOut(t.fadeOutTime,t.pauseFadeOut)}break;case 4:for(var l=0,h=this._animationStates;l<h.length;l++){var r=h[l];null===r._parent&&r.fadeOut(t.fadeOutTime,t.pauseFadeOut)}break;case 0:case 5:}},i.prototype.init=function(e){null===this._armature&&(this._armature=e,this._animationConfig=t.BaseObject.borrowObject(t.AnimationConfig))},i.prototype.advanceTime=function(t){0>t&&(t=-t),this._armature.inheritAnimation&&null!==this._armature._parent?this._inheritTimeScale=this._armature._parent._armature.animation._inheritTimeScale*this.timeScale:this._inheritTimeScale=this.timeScale,1!==this._inheritTimeScale&&(t*=this._inheritTimeScale);var e=this._animationStates.length;if(1===e){var i=this._animationStates[0];if(i._fadeState>0&&i._subFadeState>0)this._armature._dragonBones.bufferObject(i),this._animationStates.length=0,this._lastAnimationState=null;else{var r=i._animationData,n=r.cacheFrameRate;if(this._animationDirty&&n>0){this._animationDirty=!1;for(var a=0,o=this._armature.getBones();a<o.length;a++){var s=o[a];s._cachedFrameIndices=r.getBoneCachedFrameIndices(s.name)}for(var l=0,h=this._armature.getSlots();l<h.length;l++){var c=h[l],u=c.rawDisplayDatas;if(null!==u&&u.length>0){var p=u[0];if(null!==p&&p.parent===this._armature.armatureData.defaultSkin){c._cachedFrameIndices=r.getSlotCachedFrameIndices(c.name);continue}}c._cachedFrameIndices=null}}i.advanceTime(t,n)}}else if(e>1){for(var d=0,f=0;e>d;++d){var i=this._animationStates[d];i._fadeState>0&&i._subFadeState>0?(f++,this._armature._dragonBones.bufferObject(i),this._animationDirty=!0,this._lastAnimationState===i&&(this._lastAnimationState=null)):(f>0&&(this._animationStates[d-f]=i),i.advanceTime(t,0)),d===e-1&&f>0&&(this._animationStates.length-=f,null===this._lastAnimationState&&this._animationStates.length>0&&(this._lastAnimationState=this._animationStates[this._animationStates.length-1]))}this._armature._cacheFrameIndex=-1}else this._armature._cacheFrameIndex=-1},i.prototype.reset=function(){for(var t=0,e=this._animationStates;t<e.length;t++){var i=e[t];i.returnToPool()}this._animationDirty=!1,this._animationConfig.clear(),this._animationStates.length=0,this._lastAnimationState=null},i.prototype.stop=function(t){if(void 0===t&&(t=null),null!==t){var e=this.getState(t);null!==e&&e.stop()}else for(var i=0,r=this._animationStates;i<r.length;i++){var e=r[i];e.stop()}},i.prototype.playConfig=function(e){var i=e.animation;if(!(i in this._animations))return console.warn("Non-existent animation.\n","DragonBones name: "+this._armature.armatureData.parent.name,"Armature name: "+this._armature.name,"Animation name: "+i),null;var r=this._animations[i];if(5===e.fadeOutMode)for(var n=0,a=this._animationStates;n<a.length;n++){var o=a[n];if(o._animationData===r)return o}0===this._animationStates.length?e.fadeInTime=0:e.fadeInTime<0&&(e.fadeInTime=r.fadeInTime),e.fadeOutTime<0&&(e.fadeOutTime=e.fadeInTime),e.timeScale<=-100&&(e.timeScale=1/r.scale),r.frameCount>1?(e.position<0?(e.position%=r.duration,e.position=r.duration-e.position):e.position===r.duration?e.position-=1e-6:e.position>r.duration&&(e.position%=r.duration),e.duration>0&&e.position+e.duration>r.duration&&(e.duration=r.duration-e.position),e.playTimes<0&&(e.playTimes=r.playTimes)):(e.playTimes=1,e.position=0,e.duration>0&&(e.duration=0)),0===e.duration&&(e.duration=-1),this._fadeOut(e);var s=t.BaseObject.borrowObject(t.AnimationState);if(s.init(this._armature,r,e),this._animationDirty=!0,this._armature._cacheFrameIndex=-1,this._animationStates.length>0){for(var l=!1,h=0,c=this._animationStates.length;c>h;++h){if(s.layer>this._animationStates[h].layer){l=!0,this._animationStates.splice(h,0,s);break}if(h!==c-1&&s.layer>this._animationStates[h+1].layer){l=!0,this._animationStates.splice(h+1,0,s);break}}l||this._animationStates.push(s)}else this._animationStates.push(s);for(var u=0,p=this._armature.getSlots();u<p.length;u++){var d=p[u],f=d.childArmature;null!==f&&f.inheritAnimation&&f.animation.hasAnimation(i)&&null===f.animation.getState(i)&&f.animation.fadeIn(i)}var g=!1;for(var m in r.animationTimelines){this._lockUpdate||(g=!0,this._lockUpdate=!0);var y=this.fadeIn(m,e.fadeInTime,1,s.layer,null,0);null!==y&&(y.resetToPose=!1,y._parent=s,y.stop())}return g&&(this._lockUpdate=!1),this._lockUpdate||(e.fadeInTime<=0&&this._armature.advanceTime(0),this._lastAnimationState=s),s},i.prototype.play=function(t,e){if(void 0===t&&(t=null),void 0===e&&(e=-1),this._animationConfig.clear(),this._animationConfig.resetToPose=!0,this._animationConfig.playTimes=e,this._animationConfig.fadeInTime=0,this._animationConfig.animation=null!==t?t:"",null!==t&&t.length>0)this.playConfig(this._animationConfig);else if(null===this._lastAnimationState){var i=this._armature.armatureData.defaultAnimation;null!==i&&(this._animationConfig.animation=i.name,this.playConfig(this._animationConfig))}else this._lastAnimationState.isPlaying||this._lastAnimationState.isCompleted?(this._animationConfig.animation=this._lastAnimationState.name,this.playConfig(this._animationConfig)):this._lastAnimationState.play();return this._lastAnimationState},i.prototype.fadeIn=function(t,e,i,r,n,a){return void 0===e&&(e=-1),void 0===i&&(i=-1),void 0===r&&(r=0),void 0===n&&(n=null),void 0===a&&(a=3),this._animationConfig.clear(),this._animationConfig.fadeOutMode=a,this._animationConfig.playTimes=i,this._animationConfig.layer=r,this._animationConfig.fadeInTime=e,this._animationConfig.animation=t,this._animationConfig.group=null!==n?n:"",this.playConfig(this._animationConfig)},i.prototype.gotoAndPlayByTime=function(t,e,i){return void 0===e&&(e=0),void 0===i&&(i=-1),this._animationConfig.clear(),this._animationConfig.resetToPose=!0,this._animationConfig.playTimes=i,this._animationConfig.position=e,this._animationConfig.fadeInTime=0,this._animationConfig.animation=t,this.playConfig(this._animationConfig)},i.prototype.gotoAndPlayByFrame=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=-1),this._animationConfig.clear(),this._animationConfig.resetToPose=!0,this._animationConfig.playTimes=i,this._animationConfig.fadeInTime=0,this._animationConfig.animation=t;var r=t in this._animations?this._animations[t]:null;return null!==r&&(this._animationConfig.position=r.duration*e/r.frameCount),this.playConfig(this._animationConfig)},i.prototype.gotoAndPlayByProgress=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=-1),this._animationConfig.clear(),this._animationConfig.resetToPose=!0,this._animationConfig.playTimes=i,this._animationConfig.fadeInTime=0,this._animationConfig.animation=t;var r=t in this._animations?this._animations[t]:null;return null!==r&&(this._animationConfig.position=r.duration*(e>0?e:0)),this.playConfig(this._animationConfig)},i.prototype.gotoAndStopByTime=function(t,e){void 0===e&&(e=0);var i=this.gotoAndPlayByTime(t,e,1);return null!==i&&i.stop(),i},i.prototype.gotoAndStopByFrame=function(t,e){void 0===e&&(e=0);var i=this.gotoAndPlayByFrame(t,e,1);return null!==i&&i.stop(),i},i.prototype.gotoAndStopByProgress=function(t,e){void 0===e&&(e=0);var i=this.gotoAndPlayByProgress(t,e,1);return null!==i&&i.stop(),i},i.prototype.getState=function(t){for(var e=this._animationStates.length;e--;){var i=this._animationStates[e];if(i.name===t)return i}return null},i.prototype.hasAnimation=function(t){return t in this._animations},i.prototype.getStates=function(){return this._animationStates},Object.defineProperty(i.prototype,"isPlaying",{get:function(){for(var t=0,e=this._animationStates;t<e.length;t++){var i=e[t];if(i.isPlaying)return!0}return!1},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isCompleted",{get:function(){for(var t=0,e=this._animationStates;t<e.length;t++){var i=e[t];if(!i.isCompleted)return!1}return this._animationStates.length>0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"lastAnimationName",{get:function(){return null!==this._lastAnimationState?this._lastAnimationState.name:""},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"animationNames",{get:function(){return this._animationNames},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"animations",{get:function(){return this._animations},set:function(t){if(this._animations!==t){this._animationNames.length=0;for(var e in this._animations)delete this._animations[e];for(var e in t)this._animationNames.push(e),this._animations[e]=t[e]}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"animationConfig",{get:function(){return this._animationConfig.clear(),this._animationConfig},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"lastAnimationState",{get:function(){return this._lastAnimationState},enumerable:!0,configurable:!0}),i.prototype.gotoAndPlay=function(t,e,i,r,n,a,o,s,l){void 0===e&&(e=-1),void 0===i&&(i=-1),void 0===r&&(r=-1),void 0===n&&(n=0),void 0===a&&(a=null),void 0===o&&(o=3),void 0===s&&(s=!0),void 0===l&&(l=!0),console.warn("Deprecated."),this._animationConfig.clear(),this._animationConfig.resetToPose=!0,this._animationConfig.fadeOutMode=o,this._animationConfig.playTimes=r,this._animationConfig.layer=n,this._animationConfig.fadeInTime=e,this._animationConfig.animation=t,this._animationConfig.group=null!==a?a:"";var h=this._animations[t];return h&&i>0&&(this._animationConfig.timeScale=h.duration/i),this.playConfig(this._animationConfig)},i.prototype.gotoAndStop=function(t,e){return void 0===e&&(e=0),console.warn("Deprecated."),this.gotoAndStopByTime(t,e)},Object.defineProperty(i.prototype,"animationList",{get:function(){return console.warn("Deprecated."),this._animationNames},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"animationDataList",{get:function(){console.warn("Deprecated.");for(var t=[],e=0,i=this._animationNames.length;i>e;++e)t.push(this._animations[this._animationNames[e]]);return t},enumerable:!0,configurable:!0}),i}(t.BaseObject);t.Animation=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t._blendState=new r,t._boneMask=[],t._boneTimelines=[],t._surfaceTimelines=[],t._slotTimelines=[],t._constraintTimelines=[],t._animationTimelines=[],t._poseTimelines=[],t._bonePoses={},t._actionTimeline=null,t._zOrderTimeline=null,t._parent=null,t}return __extends(n,e),n.toString=function(){return"[class dragonBones.AnimationState]"},n.prototype._onClear=function(){for(var t=0,e=this._boneTimelines;t<e.length;t++){var i=e[t];i.returnToPool()}for(var r=0,n=this._surfaceTimelines;r<n.length;r++){var i=n[r];i.returnToPool()}for(var a=0,o=this._slotTimelines;a<o.length;a++){var i=o[a];i.returnToPool()}for(var s=0,l=this._constraintTimelines;s<l.length;s++){var i=l[s];i.returnToPool()}for(var h=0,c=this._animationTimelines;h<c.length;h++){var i=c[h];i.returnToPool()}for(var u in this._bonePoses)this._bonePoses[u].returnToPool(),delete this._bonePoses[u];null!==this._actionTimeline&&this._actionTimeline.returnToPool(),null!==this._zOrderTimeline&&this._zOrderTimeline.returnToPool(),this.actionEnabled=!1,this.additiveBlending=!1,this.displayControl=!1,this.resetToPose=!1,this.playTimes=1,this.layer=0,this.timeScale=1,this.weight=1,this.autoFadeOutTime=0,this.fadeTotalTime=0,this.name="",this.group="",this._timelineDirty=2,this._playheadState=0,this._fadeState=-1,this._subFadeState=-1,this._position=0,this._duration=0,this._fadeTime=0,this._time=0,this._fadeProgress=0,this._weightResult=0,this._blendState.clear(),this._boneMask.length=0,this._boneTimelines.length=0,this._surfaceTimelines.length=0,this._slotTimelines.length=0,this._constraintTimelines.length=0,this._animationTimelines.length=0,this._poseTimelines.length=0,this._animationData=null,this._armature=null,this._actionTimeline=null,this._zOrderTimeline=null,this._parent=null},n.prototype._updateTimelines=function(){for(var e=0,i=this._armature._constraints;e<i.length;e++){var r=i[e],n=this._animationData.getConstraintTimelines(r.name);if(null!==n)for(var a=0,o=n;a<o.length;a++){var s=o[a];switch(s.type){case 30:var l=t.BaseObject.borrowObject(t.IKConstraintTimelineState);l.constraint=r,l.init(this._armature,this,s),this._constraintTimelines.push(l)}}else if(this.resetToPose){var l=t.BaseObject.borrowObject(t.IKConstraintTimelineState);l.constraint=r,l.init(this._armature,this,null),this._constraintTimelines.push(l),this._poseTimelines.push(l)}}for(var h=0,c=this._armature.animation.getStates();h<c.length;h++){var u=c[h];if(u._parent===this){var n=this._animationData.getAnimationTimelines(u.name);if(null!==n)for(var p=0,d=n;p<d.length;p++){var s=d[p];switch(s.type){case 40:var l=t.BaseObject.borrowObject(t.AnimationTimelineState);l.animationState=u,l.init(this._armature,this,s),this._animationTimelines.push(l)}}}}},n.prototype._updateBoneAndSlotTimelines=function(){for(var e={},r=0,n=this._boneTimelines;r<n.length;r++){var a=n[r],o=a.bone.name;o in e||(e[o]=[]),e[o].push(a)}for(var s=0,l=this._armature.getBones();s<l.length;s++){var h=l[s],o=h.name;if(this.containsBoneMask(o))if(o in e)delete e[o];else if(0===h._boneData.type){var c=this._animationData.getBoneTimelines(o),u=o in this._bonePoses?this._bonePoses[o]:this._bonePoses[o]=t.BaseObject.borrowObject(i);if(null!==c)for(var p=0,d=c;p<d.length;p++){var f=d[p];switch(f.type){case 10:var a=t.BaseObject.borrowObject(t.BoneAllTimelineState);a.bone=h,a.bonePose=u,a.init(this._armature,this,f),this._boneTimelines.push(a);break;case 11:var a=t.BaseObject.borrowObject(t.BoneTranslateTimelineState);a.bone=h,a.bonePose=u,a.init(this._armature,this,f),this._boneTimelines.push(a);break;case 12:var a=t.BaseObject.borrowObject(t.BoneRotateTimelineState);a.bone=h,a.bonePose=u,a.init(this._armature,this,f),this._boneTimelines.push(a);break;case 13:var a=t.BaseObject.borrowObject(t.BoneScaleTimelineState);a.bone=h,a.bonePose=u,a.init(this._armature,this,f),this._boneTimelines.push(a)}}else if(this.resetToPose){var a=t.BaseObject.borrowObject(t.BoneAllTimelineState);a.bone=h,a.bonePose=u,a.init(this._armature,this,null),this._boneTimelines.push(a),this._poseTimelines.push(a)}}else if(1===h._boneData.type){var c=this._animationData.getSurfaceTimelines(o);if(null!==c)for(var g=0,m=c;g<m.length;g++){var f=m[g];switch(f.type){case 50:var a=t.BaseObject.borrowObject(t.SurfaceTimelineState);a.surface=h,a.init(this._armature,this,f),this._surfaceTimelines.push(a)}}else if(this.resetToPose){var a=t.BaseObject.borrowObject(t.SurfaceTimelineState);a.surface=h,a.init(this._armature,this,null),this._surfaceTimelines.push(a),this._poseTimelines.push(a)}}}for(var y in e)for(var v=0,_=e[y];v<_.length;v++){var a=_[v];this._boneTimelines.splice(this._boneTimelines.indexOf(a),1),a.returnToPool()}for(var b={},x=[],T=0,E=this._slotTimelines;T<E.length;T++){var a=E[T],o=a.slot.name;o in b||(b[o]=[]),b[o].push(a)}for(var S=0,C=this._armature.getSlots();S<C.length;S++){var w=C[S],P=w.parent.name;if(this.containsBoneMask(P)){var o=w.name,c=this._animationData.getSlotTimelines(o);if(o in b)delete b[o];else{var D=!1,A=!1;if(x.length=0,null!==c)for(var I=0,M=c;I<M.length;I++){var f=M[I];switch(f.type){case 20:var a=t.BaseObject.borrowObject(t.SlotDislayTimelineState);a.slot=w,a.init(this._armature,this,f),this._slotTimelines.push(a),D=!0;break;case 21:var a=t.BaseObject.borrowObject(t.SlotColorTimelineState);a.slot=w,a.init(this._armature,this,f),this._slotTimelines.push(a),A=!0;break;case 22:var a=t.BaseObject.borrowObject(t.DeformTimelineState);a.slot=w,a.init(this._armature,this,f),this._slotTimelines.push(a),x.push(a.vertexOffset)}}if(this.resetToPose){if(!D){var a=t.BaseObject.borrowObject(t.SlotDislayTimelineState);a.slot=w,a.init(this._armature,this,null),this._slotTimelines.push(a),this._poseTimelines.push(a)}if(!A){var a=t.BaseObject.borrowObject(t.SlotColorTimelineState);a.slot=w,a.init(this._armature,this,null),this._slotTimelines.push(a),this._poseTimelines.push(a)}if(null!==w.rawDisplayDatas)for(var $=0,O=w.rawDisplayDatas;$<O.length;$++){var R=O[$];if(null!==R&&2===R.type){var L=R.vertices.offset;if(x.indexOf(L)<0){var a=t.BaseObject.borrowObject(t.DeformTimelineState);a.vertexOffset=L,a.slot=w,a.init(this._armature,this,null),this._slotTimelines.push(a),this._poseTimelines.push(a)}}}}}}}for(var y in b)for(var B=0,k=b[y];B<k.length;B++){var a=k[B];this._slotTimelines.splice(this._slotTimelines.indexOf(a),1),a.returnToPool()}},n.prototype._advanceFadeTime=function(e){var i=this._fadeState>0;if(this._subFadeState<0){this._subFadeState=0;var r=i?t.EventObject.FADE_OUT:t.EventObject.FADE_IN;if(this._armature.eventDispatcher.hasDBEventListener(r)){var n=t.BaseObject.borrowObject(t.EventObject);n.type=r,n.armature=this._armature,n.animationState=this,this._armature._dragonBones.bufferEvent(n)}}if(0>e&&(e=-e),this._fadeTime+=e,this._fadeTime>=this.fadeTotalTime?(this._subFadeState=1,this._fadeProgress=i?0:1):this._fadeTime>0?this._fadeProgress=i?1-this._fadeTime/this.fadeTotalTime:this._fadeTime/this.fadeTotalTime:this._fadeProgress=i?1:0,this._subFadeState>0){i||(this._playheadState|=1,this._fadeState=0);
var r=i?t.EventObject.FADE_OUT_COMPLETE:t.EventObject.FADE_IN_COMPLETE;if(this._armature.eventDispatcher.hasDBEventListener(r)){var n=t.BaseObject.borrowObject(t.EventObject);n.type=r,n.armature=this._armature,n.animationState=this,this._armature._dragonBones.bufferEvent(n)}}},n.prototype.init=function(e,i,r){if(null===this._armature){if(this._armature=e,this._animationData=i,this.resetToPose=r.resetToPose,this.additiveBlending=r.additiveBlending,this.displayControl=r.displayControl,this.actionEnabled=r.actionEnabled,this.layer=r.layer,this.playTimes=r.playTimes,this.timeScale=r.timeScale,this.fadeTotalTime=r.fadeInTime,this.autoFadeOutTime=r.autoFadeOutTime,this.weight=r.weight,this.name=r.name.length>0?r.name:r.animation,this.group=r.group,r.pauseFadeIn?this._playheadState=2:this._playheadState=3,r.duration<0?(this._position=0,this._duration=this._animationData.duration,0!==r.position?this.timeScale>=0?this._time=r.position:this._time=r.position-this._duration:this._time=0):(this._position=r.position,this._duration=r.duration,this._time=0),this.timeScale<0&&0===this._time&&(this._time=-1e-6),this.fadeTotalTime<=0&&(this._fadeProgress=.999999),r.boneMask.length>0){this._boneMask.length=r.boneMask.length;for(var n=0,a=this._boneMask.length;a>n;++n)this._boneMask[n]=r.boneMask[n]}this._actionTimeline=t.BaseObject.borrowObject(t.ActionTimelineState),this._actionTimeline.init(this._armature,this,this._animationData.actionTimeline),this._actionTimeline.currentTime=this._time,this._actionTimeline.currentTime<0&&(this._actionTimeline.currentTime=this._duration-this._actionTimeline.currentTime),null!==this._animationData.zOrderTimeline&&(this._zOrderTimeline=t.BaseObject.borrowObject(t.ZOrderTimelineState),this._zOrderTimeline.init(this._armature,this,this._animationData.zOrderTimeline))}},n.prototype.advanceTime=function(e,i){if(this._blendState.dirty=!1,(0!==this._fadeState||0!==this._subFadeState)&&this._advanceFadeTime(e),3===this._playheadState&&(1!==this.timeScale&&(e*=this.timeScale),this._time+=e),0!==this._timelineDirty&&(2===this._timelineDirty&&this._updateTimelines(),this._timelineDirty=0,this._updateBoneAndSlotTimelines()),0!==this.weight){var r=0===this._fadeState&&i>0,n=!0,a=!0,o=this._time;if(this._weightResult=this.weight*this._fadeProgress,null!==this._parent&&(this._weightResult*=this._parent._weightResult/this._parent._fadeProgress),this._actionTimeline.playState<=0&&this._actionTimeline.update(o),r){var s=2*i;this._actionTimeline.currentTime=Math.floor(this._actionTimeline.currentTime*s)/s}if(null!==this._zOrderTimeline&&this._zOrderTimeline.playState<=0&&this._zOrderTimeline.update(o),r){var l=Math.floor(this._actionTimeline.currentTime*i);this._armature._cacheFrameIndex===l?(n=!1,a=!1):(this._armature._cacheFrameIndex=l,this._animationData.cachedFrames[l]?a=!1:this._animationData.cachedFrames[l]=!0)}if(n){if(a)for(var h=0,c=this._boneTimelines.length;c>h;++h){var u=this._boneTimelines[h];if(u.playState<=0&&u.update(o),h===c-1||u.bone!==this._boneTimelines[h+1].bone){var p=u.bone._blendState.update(this._weightResult,this.layer);0!==p&&u.blend(p)}}for(var h=0,c=this._surfaceTimelines.length;c>h;++h){var u=this._surfaceTimelines[h],p=u.surface._blendState.update(this._weightResult,this.layer);u.playState<=0&&u.update(o),0!==p&&u.blend(p)}if(this.displayControl)for(var h=0,c=this._slotTimelines.length;c>h;++h){var u=this._slotTimelines[h],d=u.slot.displayController;(null===d||d===this.name||d===this.group)&&u.playState<=0&&u.update(o)}for(var h=0,c=this._constraintTimelines.length;c>h;++h){var u=this._constraintTimelines[h];u.playState<=0&&u.update(o)}for(var h=0,c=this._animationTimelines.length;c>h;++h){var u=this._animationTimelines[h],p=u.animationState._blendState.update(this._weightResult,this.layer);u.playState<=0&&u.update(o),0!==p&&u.blend(p)}}if(0===this._fadeState){if(this._subFadeState>0&&(this._subFadeState=0,this._poseTimelines.length>0)){for(var f=0,g=this._poseTimelines;f<g.length;f++){var u=g[f];u instanceof t.BoneTimelineState?this._boneTimelines.splice(this._boneTimelines.indexOf(u),1):u instanceof t.SurfaceTimelineState?this._surfaceTimelines.splice(this._surfaceTimelines.indexOf(u),1):u instanceof t.SlotTimelineState?this._slotTimelines.splice(this._slotTimelines.indexOf(u),1):u instanceof t.ConstraintTimelineState&&this._constraintTimelines.splice(this._constraintTimelines.indexOf(u),1),u.returnToPool()}this._poseTimelines.length=0}this._actionTimeline.playState>0&&this.autoFadeOutTime>=0&&this.fadeOut(this.autoFadeOutTime)}}},n.prototype.play=function(){this._playheadState=3},n.prototype.stop=function(){this._playheadState&=1},n.prototype.fadeOut=function(t,e){if(void 0===e&&(e=!0),0>t&&(t=0),e&&(this._playheadState&=2),this._fadeState>0){if(t>this.fadeTotalTime-this._fadeTime)return}else{this._fadeState=1,this._subFadeState=-1,(0>=t||this._fadeProgress<=0)&&(this._fadeProgress=1e-6);for(var i=0,r=this._boneTimelines;i<r.length;i++){var n=r[i];n.fadeOut()}for(var a=0,o=this._surfaceTimelines;a<o.length;a++){var n=o[a];n.fadeOut()}for(var s=0,l=this._slotTimelines;s<l.length;s++){var n=l[s];n.fadeOut()}for(var h=0,c=this._constraintTimelines;h<c.length;h++){var n=c[h];n.fadeOut()}for(var u=0,p=this._animationTimelines;u<p.length;u++){var n=p[u];n.animationState.fadeOut(t,e),n.fadeOut()}}this.displayControl=!1,this.fadeTotalTime=this._fadeProgress>1e-6?t/this._fadeProgress:0,this._fadeTime=this.fadeTotalTime*(1-this._fadeProgress)},n.prototype.containsBoneMask=function(t){return 0===this._boneMask.length||this._boneMask.indexOf(t)>=0},n.prototype.addBoneMask=function(t,e){void 0===e&&(e=!0);var i=this._armature.getBone(t);if(null!==i){if(this._boneMask.indexOf(t)<0&&this._boneMask.push(t),e)for(var r=0,n=this._armature.getBones();r<n.length;r++){var a=n[r];this._boneMask.indexOf(a.name)<0&&i.contains(a)&&this._boneMask.push(a.name)}this._timelineDirty=1}},n.prototype.removeBoneMask=function(t,e){void 0===e&&(e=!0);var i=this._boneMask.indexOf(t);if(i>=0&&this._boneMask.splice(i,1),e){var r=this._armature.getBone(t);if(null!==r){var n=this._armature.getBones();if(this._boneMask.length>0)for(var a=0,o=n;a<o.length;a++){var s=o[a],l=this._boneMask.indexOf(s.name);l>=0&&r.contains(s)&&this._boneMask.splice(l,1)}else for(var h=0,c=n;h<c.length;h++){var s=c[h];s!==r&&(r.contains(s)||this._boneMask.push(s.name))}}}this._timelineDirty=1},n.prototype.removeAllBoneMask=function(){this._boneMask.length=0,this._timelineDirty=1},Object.defineProperty(n.prototype,"isFadeIn",{get:function(){return this._fadeState<0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isFadeOut",{get:function(){return this._fadeState>0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isFadeComplete",{get:function(){return 0===this._fadeState},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isPlaying",{get:function(){return 0!==(2&this._playheadState)&&this._actionTimeline.playState<=0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isCompleted",{get:function(){return this._actionTimeline.playState>0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"currentPlayTimes",{get:function(){return this._actionTimeline.currentPlayTimes},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"totalTime",{get:function(){return this._duration},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"currentTime",{get:function(){return this._actionTimeline.currentTime},set:function(t){var e=this._actionTimeline.currentPlayTimes-(this._actionTimeline.playState>0?1:0);if((0>t||this._duration<t)&&(t=t%this._duration+e*this._duration,0>t&&(t+=this._duration)),this.playTimes>0&&e===this.playTimes-1&&t===this._duration&&(t=this._duration-1e-6),this._time!==t){this._time=t,this._actionTimeline.setCurrentTime(this._time),null!==this._zOrderTimeline&&(this._zOrderTimeline.playState=-1);for(var i=0,r=this._boneTimelines;i<r.length;i++){var n=r[i];n.playState=-1}for(var a=0,o=this._slotTimelines;a<o.length;a++){var n=o[a];n.playState=-1}}},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"animationData",{get:function(){return this._animationData},enumerable:!0,configurable:!0}),n}(t.BaseObject);t.AnimationState=e;var i=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.current=new t.Transform,i.delta=new t.Transform,i.result=new t.Transform,i}return __extends(i,e),i.toString=function(){return"[class dragonBones.BonePose]"},i.prototype._onClear=function(){this.current.identity(),this.delta.identity(),this.result.identity()},i}(t.BaseObject);t.BonePose=i;var r=function(){function t(){}return t.prototype.update=function(t,e){if(this.dirty){if(!(this.leftWeight>0))return 0;if(this.layer!==e){if(this.layerWeight>=this.leftWeight)return this.leftWeight=0,0;this.layer=e,this.leftWeight-=this.layerWeight,this.layerWeight=0}return t*=this.leftWeight,this.layerWeight+=t,this.blendWeight=t,2}return this.dirty=!0,this.layer=e,this.layerWeight=t,this.leftWeight=1,this.blendWeight=t,1},t.prototype.clear=function(){this.dirty=!1,this.layer=0,this.leftWeight=0,this.layerWeight=0,this.blendWeight=0},t}();t.BlendState=r}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype._onClear=function(){this.playState=-1,this.currentPlayTimes=-1,this.currentTime=-1,this._tweenState=0,this._frameRate=0,this._frameValueOffset=0,this._frameCount=0,this._frameOffset=0,this._frameIndex=-1,this._frameRateR=0,this._position=0,this._duration=0,this._timeScale=1,this._timeOffset=0,this._dragonBonesData=null,this._animationData=null,this._timelineData=null,this._armature=null,this._animationState=null,this._actionTimeline=null,this._frameArray=null,this._frameIntArray=null,this._frameFloatArray=null,this._timelineArray=null,this._frameIndices=null},e.prototype._setCurrentTime=function(t){var e=this.playState,i=this.currentPlayTimes,r=this.currentTime;if(null!==this._actionTimeline&&this._frameCount<=1)this.playState=this._actionTimeline.playState>=0?1:-1,this.currentPlayTimes=1,this.currentTime=this._actionTimeline.currentTime;else if(null===this._actionTimeline||1!==this._timeScale||0!==this._timeOffset){var n=this._animationState.playTimes,a=n*this._duration;t*=this._timeScale,0!==this._timeOffset&&(t+=this._timeOffset*this._animationData.duration),n>0&&(t>=a||-a>=t)?(this.playState<=0&&3===this._animationState._playheadState&&(this.playState=1),this.currentPlayTimes=n,0>t?this.currentTime=0:this.currentTime=this._duration+1e-6):(0!==this.playState&&3===this._animationState._playheadState&&(this.playState=0),0>t?(t=-t,this.currentPlayTimes=Math.floor(t/this._duration),this.currentTime=this._duration-t%this._duration):(this.currentPlayTimes=Math.floor(t/this._duration),this.currentTime=t%this._duration)),this.currentTime+=this._position}else this.playState=this._actionTimeline.playState,this.currentPlayTimes=this._actionTimeline.currentPlayTimes,this.currentTime=this._actionTimeline.currentTime;return this.currentPlayTimes===i&&this.currentTime===r?!1:((0>e&&this.playState!==e||this.playState<=0&&this.currentPlayTimes!==i)&&(this._frameIndex=-1),!0)},e.prototype.init=function(t,e,i){this._armature=t,this._animationState=e,this._timelineData=i,this._actionTimeline=this._animationState._actionTimeline,this===this._actionTimeline&&(this._actionTimeline=null),this._animationData=this._animationState._animationData,this._frameRate=this._animationData.parent.frameRate,this._frameRateR=1/this._frameRate,this._position=this._animationState._position,this._duration=this._animationState._duration,this._dragonBonesData=this._animationData.parent.parent,null!==this._timelineData&&(this._frameIntArray=this._dragonBonesData.frameIntArray,this._frameFloatArray=this._dragonBonesData.frameFloatArray,this._frameArray=this._dragonBonesData.frameArray,this._timelineArray=this._dragonBonesData.timelineArray,this._frameIndices=this._dragonBonesData.frameIndices,this._frameCount=this._timelineArray[this._timelineData.offset+2],this._frameValueOffset=this._timelineArray[this._timelineData.offset+4],this._timeScale=100/this._timelineArray[this._timelineData.offset+0],this._timeOffset=.01*this._timelineArray[this._timelineData.offset+1])},e.prototype.fadeOut=function(){},e.prototype.update=function(t){if(this._setCurrentTime(t)){if(this._frameCount>1){var e=Math.floor(this.currentTime*this._frameRate),i=this._frameIndices[this._timelineData.frameIndicesOffset+e];this._frameIndex!==i&&(this._frameIndex=i,this._frameOffset=this._animationData.frameOffset+this._timelineArray[this._timelineData.offset+5+this._frameIndex],this._onArriveAtFrame())}else this._frameIndex<0&&(this._frameIndex=0,null!==this._timelineData&&(this._frameOffset=this._animationData.frameOffset+this._timelineArray[this._timelineData.offset+5]),this._onArriveAtFrame());0!==this._tweenState&&this._onUpdateFrame()}},e}(t.BaseObject);t.TimelineState=e;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e._getEasingValue=function(t,e,i){var r=e;switch(t){case 3:r=Math.pow(e,2);break;case 4:r=1-Math.pow(1-e,2);break;case 5:r=.5*(1-Math.cos(e*Math.PI))}return(r-e)*i+e},e._getEasingCurveValue=function(t,e,i,r){if(0>=t)return 0;if(t>=1)return 1;var n=i+1,a=Math.floor(t*n),o=0===a?0:e[r+a-1],s=a===n-1?1e4:e[r+a];return 1e-4*(o+(s-o)*(t*n-a))},e.prototype._onClear=function(){t.prototype._onClear.call(this),this._tweenType=0,this._curveCount=0,this._framePosition=0,this._frameDurationR=0,this._tweenProgress=0,this._tweenEasing=0},e.prototype._onArriveAtFrame=function(){if(this._frameCount>1&&(this._frameIndex!==this._frameCount-1||0===this._animationState.playTimes||this._animationState.currentPlayTimes<this._animationState.playTimes-1))if(this._tweenType=this._frameArray[this._frameOffset+1],this._tweenState=0===this._tweenType?1:2,2===this._tweenType?this._curveCount=this._frameArray[this._frameOffset+2]:0!==this._tweenType&&1!==this._tweenType&&(this._tweenEasing=.01*this._frameArray[this._frameOffset+2]),this._framePosition=this._frameArray[this._frameOffset]*this._frameRateR,this._frameIndex===this._frameCount-1)this._frameDurationR=1/(this._animationData.duration-this._framePosition);else{var t=this._animationData.frameOffset+this._timelineArray[this._timelineData.offset+5+this._frameIndex+1],e=this._frameArray[t]*this._frameRateR-this._framePosition;e>0?this._frameDurationR=1/e:this._frameDurationR=0}else this._tweenState=1},e.prototype._onUpdateFrame=function(){2===this._tweenState?(this._tweenProgress=(this.currentTime-this._framePosition)*this._frameDurationR,2===this._tweenType?this._tweenProgress=e._getEasingCurveValue(this._tweenProgress,this._frameArray,this._curveCount,this._frameOffset+3):1!==this._tweenType&&(this._tweenProgress=e._getEasingValue(this._tweenType,this._tweenProgress,this._tweenEasing))):this._tweenProgress=0},e}(e);t.TweenTimelineState=i;var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype._onClear=function(){t.prototype._onClear.call(this),this.bone=null,this.bonePose=null},e.prototype.blend=function(t){var e=this.bone._blendState.blendWeight,i=this.bone.animationPose,r=this.bonePose.result;2===t?(i.x+=r.x*e,i.y+=r.y*e,i.rotation+=r.rotation*e,i.skew+=r.skew*e,i.scaleX+=(r.scaleX-1)*e,i.scaleY+=(r.scaleY-1)*e):1!==e?(i.x=r.x*e,i.y=r.y*e,i.rotation=r.rotation*e,i.skew=r.skew*e,i.scaleX=(r.scaleX-1)*e+1,i.scaleY=(r.scaleY-1)*e+1):(i.x=r.x,i.y=r.y,i.rotation=r.rotation,i.skew=r.skew,i.scaleX=r.scaleX,i.scaleY=r.scaleY),(0!==this._animationState._fadeState||0!==this._animationState._subFadeState)&&(this.bone._transformDirty=!0)},e}(i);t.BoneTimelineState=r;var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype._onClear=function(){t.prototype._onClear.call(this),this.slot=null},e}(i);t.SlotTimelineState=n;var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype._onClear=function(){t.prototype._onClear.call(this),this.constraint=null},e}(i);t.ConstraintTimelineState=a}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return __extends(i,e),i.toString=function(){return"[class dragonBones.ActionTimelineState]"},i.prototype._onCrossFrame=function(e){var i=this._armature.eventDispatcher;if(this._animationState.actionEnabled)for(var r=this._animationData.frameOffset+this._timelineArray[this._timelineData.offset+5+e],n=this._frameArray[r+1],a=this._animationData.parent.actions,o=0;n>o;++o){var s=this._frameArray[r+2+o],l=a[s];if(0===l.type){var h=t.BaseObject.borrowObject(t.EventObject);h.time=this._frameArray[r]/this._frameRate,h.animationState=this._animationState,t.EventObject.actionDataToInstance(l,h,this._armature),this._armature._bufferAction(h,!0)}else{var c=10===l.type?t.EventObject.FRAME_EVENT:t.EventObject.SOUND_EVENT;if(11===l.type||i.hasDBEventListener(c)){var h=t.BaseObject.borrowObject(t.EventObject);h.time=this._frameArray[r]/this._frameRate,h.animationState=this._animationState,t.EventObject.actionDataToInstance(l,h,this._armature),this._armature._dragonBones.bufferEvent(h)}}}},i.prototype._onArriveAtFrame=function(){},i.prototype._onUpdateFrame=function(){},i.prototype.update=function(e){var i=this.playState,r=this.currentPlayTimes,n=this.currentTime;if(this._setCurrentTime(e)){var a=this._armature.eventDispatcher;if(0>i){if(this.playState===i)return;if(this._animationState.displayControl&&this._animationState.resetToPose&&this._armature._sortZOrder(null,0),r=this.currentPlayTimes,a.hasDBEventListener(t.EventObject.START)){var o=t.BaseObject.borrowObject(t.EventObject);o.type=t.EventObject.START,o.armature=this._armature,o.animationState=this._animationState,this._armature._dragonBones.bufferEvent(o)}}var s=this._animationState.timeScale<0,l=null,h=null;if(this.currentPlayTimes!==r&&(a.hasDBEventListener(t.EventObject.LOOP_COMPLETE)&&(l=t.BaseObject.borrowObject(t.EventObject),l.type=t.EventObject.LOOP_COMPLETE,l.armature=this._armature,l.animationState=this._animationState),this.playState>0&&a.hasDBEventListener(t.EventObject.COMPLETE)&&(h=t.BaseObject.borrowObject(t.EventObject),h.type=t.EventObject.COMPLETE,h.armature=this._armature,h.animationState=this._animationState)),this._frameCount>1){var c=this._timelineData,u=Math.floor(this.currentTime*this._frameRate),p=this._frameIndices[c.frameIndicesOffset+u];if(this._frameIndex!==p){var d=this._frameIndex;if(this._frameIndex=p,null!==this._timelineArray)if(this._frameOffset=this._animationData.frameOffset+this._timelineArray[c.offset+5+this._frameIndex],s){if(0>d){var f=Math.floor(n*this._frameRate);d=this._frameIndices[c.frameIndicesOffset+f],this.currentPlayTimes===r&&d===p&&(d=-1)}for(;d>=0;){var g=this._animationData.frameOffset+this._timelineArray[c.offset+5+d],m=this._frameArray[g]/this._frameRate;if(this._position<=m&&m<=this._position+this._duration&&this._onCrossFrame(d),null!==l&&0===d&&(this._armature._dragonBones.bufferEvent(l),l=null),d>0?d--:d=this._frameCount-1,d===p)break}}else{if(0>d){var f=Math.floor(n*this._frameRate);d=this._frameIndices[c.frameIndicesOffset+f];var g=this._animationData.frameOffset+this._timelineArray[c.offset+5+d],m=this._frameArray[g]/this._frameRate;this.currentPlayTimes===r&&(m>=n?d>0?d--:d=this._frameCount-1:d===p&&(d=-1))}for(;d>=0;){d<this._frameCount-1?d++:d=0;var g=this._animationData.frameOffset+this._timelineArray[c.offset+5+d],m=this._frameArray[g]/this._frameRate;if(this._position<=m&&m<=this._position+this._duration&&this._onCrossFrame(d),null!==l&&0===d&&(this._armature._dragonBones.bufferEvent(l),l=null),d===p)break}}}}else if(this._frameIndex<0&&(this._frameIndex=0,null!==this._timelineData)){this._frameOffset=this._animationData.frameOffset+this._timelineArray[this._timelineData.offset+5];var m=this._frameArray[this._frameOffset]/this._frameRate;this.currentPlayTimes===r?m>=n&&this._onCrossFrame(this._frameIndex):this._position<=m&&(s||null===l||(this._armature._dragonBones.bufferEvent(l),l=null),this._onCrossFrame(this._frameIndex))}null!==l&&this._armature._dragonBones.bufferEvent(l),null!==h&&this._armature._dragonBones.bufferEvent(h)}},i.prototype.setCurrentTime=function(t){this._setCurrentTime(t),this._frameIndex=-1},i}(t.TimelineState);t.ActionTimelineState=e;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.toString=function(){return"[class dragonBones.ZOrderTimelineState]"},e.prototype._onArriveAtFrame=function(){if(this.playState>=0){var t=this._frameArray[this._frameOffset+1];t>0?this._armature._sortZOrder(this._frameArray,this._frameOffset+2):this._armature._sortZOrder(null,0)}},e.prototype._onUpdateFrame=function(){},e}(t.TimelineState);t.ZOrderTimelineState=i;var r=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return __extends(i,e),i.toString=function(){return"[class dragonBones.BoneAllTimelineState]"},i.prototype._onArriveAtFrame=function(){if(e.prototype._onArriveAtFrame.call(this),null!==this._timelineData){var t=this._animationData.frameFloatOffset+this._frameValueOffset+6*this._frameIndex,i=this._armature._armatureData.scale,r=this._frameFloatArray,n=this.bonePose.current,a=this.bonePose.delta;n.x=r[t++]*i,n.y=r[t++]*i,n.rotation=r[t++],n.skew=r[t++],n.scaleX=r[t++],n.scaleY=r[t++],2===this._tweenState?(this._frameIndex===this._frameCount-1&&(t=this._animationData.frameFloatOffset+this._frameValueOffset),a.x=r[t++]*i-n.x,a.y=r[t++]*i-n.y,a.rotation=r[t++]-n.rotation,a.skew=r[t++]-n.skew,a.scaleX=r[t++]-n.scaleX,a.scaleY=r[t++]-n.scaleY):(a.x=0,a.y=0,a.rotation=0,a.skew=0,a.scaleX=0,a.scaleY=0)}else{var n=this.bonePose.current,a=this.bonePose.delta;n.x=0,n.y=0,n.rotation=0,n.skew=0,n.scaleX=1,n.scaleY=1,a.x=0,a.y=0,a.rotation=0,a.skew=0,a.scaleX=0,a.scaleY=0}},i.prototype._onUpdateFrame=function(){e.prototype._onUpdateFrame.call(this);var t=this.bonePose.current,i=this.bonePose.delta,r=this.bonePose.result;this.bone._transformDirty=!0,2!==this._tweenState&&(this._tweenState=0),r.x=t.x+i.x*this._tweenProgress,r.y=t.y+i.y*this._tweenProgress,r.rotation=t.rotation+i.rotation*this._tweenProgress,r.skew=t.skew+i.skew*this._tweenProgress,r.scaleX=t.scaleX+i.scaleX*this._tweenProgress,r.scaleY=t.scaleY+i.scaleY*this._tweenProgress},i.prototype.fadeOut=function(){var e=this.bonePose.result;e.rotation=t.Transform.normalizeRadian(e.rotation),e.skew=t.Transform.normalizeRadian(e.skew)},i}(t.BoneTimelineState);t.BoneAllTimelineState=r;var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.toString=function(){return"[class dragonBones.BoneTranslateTimelineState]"},e.prototype._onArriveAtFrame=function(){if(t.prototype._onArriveAtFrame.call(this),null!==this._timelineData){var e=this._animationData.frameFloatOffset+this._frameValueOffset+2*this._frameIndex,i=this._armature._armatureData.scale,r=this._frameFloatArray,n=this.bonePose.current,a=this.bonePose.delta;n.x=r[e++]*i,n.y=r[e++]*i,2===this._tweenState?(this._frameIndex===this._frameCount-1&&(e=this._animationData.frameFloatOffset+this._frameValueOffset),a.x=r[e++]*i-n.x,a.y=r[e++]*i-n.y):(a.x=0,a.y=0)}else{var n=this.bonePose.current,a=this.bonePose.delta;n.x=0,n.y=0,a.x=0,a.y=0}},e.prototype._onUpdateFrame=function(){t.prototype._onUpdateFrame.call(this);var e=this.bonePose.current,i=this.bonePose.delta,r=this.bonePose.result;this.bone._transformDirty=!0,2!==this._tweenState&&(this._tweenState=0),r.x=e.x+i.x*this._tweenProgress,r.y=e.y+i.y*this._tweenProgress},e}(t.BoneTimelineState);t.BoneTranslateTimelineState=n;var a=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return __extends(i,e),i.toString=function(){return"[class dragonBones.BoneRotateTimelineState]"},i.prototype._onArriveAtFrame=function(){if(e.prototype._onArriveAtFrame.call(this),null!==this._timelineData){var i=this._animationData.frameFloatOffset+this._frameValueOffset+2*this._frameIndex,r=this._frameFloatArray,n=this.bonePose.current,a=this.bonePose.delta;n.rotation=r[i++],n.skew=r[i++],2===this._tweenState?(this._frameIndex===this._frameCount-1?(i=this._animationData.frameFloatOffset+this._frameValueOffset,a.rotation=t.Transform.normalizeRadian(r[i++]-n.rotation)):a.rotation=r[i++]-n.rotation,a.skew=r[i++]-n.skew):(a.rotation=0,a.skew=0)}else{var n=this.bonePose.current,a=this.bonePose.delta;n.rotation=0,n.skew=0,a.rotation=0,a.skew=0}},i.prototype._onUpdateFrame=function(){e.prototype._onUpdateFrame.call(this);var t=this.bonePose.current,i=this.bonePose.delta,r=this.bonePose.result;this.bone._transformDirty=!0,2!==this._tweenState&&(this._tweenState=0),r.rotation=t.rotation+i.rotation*this._tweenProgress,r.skew=t.skew+i.skew*this._tweenProgress},i.prototype.fadeOut=function(){var e=this.bonePose.result;e.rotation=t.Transform.normalizeRadian(e.rotation),e.skew=t.Transform.normalizeRadian(e.skew)},i}(t.BoneTimelineState);t.BoneRotateTimelineState=a;var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.toString=function(){return"[class dragonBones.BoneScaleTimelineState]"},e.prototype._onArriveAtFrame=function(){if(t.prototype._onArriveAtFrame.call(this),null!==this._timelineData){var e=this._animationData.frameFloatOffset+this._frameValueOffset+2*this._frameIndex,i=this._frameFloatArray,r=this.bonePose.current,n=this.bonePose.delta;r.scaleX=i[e++],r.scaleY=i[e++],2===this._tweenState?(this._frameIndex===this._frameCount-1&&(e=this._animationData.frameFloatOffset+this._frameValueOffset),n.scaleX=i[e++]-r.scaleX,n.scaleY=i[e++]-r.scaleY):(n.scaleX=0,n.scaleY=0)}else{var r=this.bonePose.current,n=this.bonePose.delta;r.scaleX=1,r.scaleY=1,n.scaleX=0,n.scaleY=0}},e.prototype._onUpdateFrame=function(){t.prototype._onUpdateFrame.call(this);var e=this.bonePose.current,i=this.bonePose.delta,r=this.bonePose.result;this.bone._transformDirty=!0,2!==this._tweenState&&(this._tweenState=0),r.scaleX=e.scaleX+i.scaleX*this._tweenProgress,r.scaleY=e.scaleY+i.scaleY*this._tweenProgress},e}(t.BoneTimelineState);t.BoneScaleTimelineState=o;var s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._current=[],e._delta=[],e._result=[],e}return __extends(e,t),e.toString=function(){return"[class dragonBones.SurfaceTimelineState]"},e.prototype._onClear=function(){t.prototype._onClear.call(this),this.surface=null,this._frameFloatOffset=0,this._valueCount=0,this._deformCount=0,this._valueOffset=0,this._current.length=0,this._delta.length=0,this._result.length=0},e.prototype._onArriveAtFrame=function(){if(t.prototype._onArriveAtFrame.call(this),null!==this._timelineData){var e=this._animationData.frameFloatOffset+this._frameValueOffset+this._frameIndex*this._valueCount,i=this._armature._armatureData.scale,r=this._frameFloatArray;if(2===this._tweenState){var n=e+this._valueCount;this._frameIndex===this._frameCount-1&&(n=this._animationData.frameFloatOffset+this._frameValueOffset);for(var a=0;a<this._valueCount;++a)this._delta[a]=r[n+a]*i-(this._current[a]=r[e+a]*i)}else for(var a=0;a<this._valueCount;++a)this._current[a]=r[e+a]*i}else for(var a=0;a<this._valueCount;++a)this._current[a]=0},e.prototype._onUpdateFrame=function(){t.prototype._onUpdateFrame.call(this),this.surface._transformDirty=!0,2!==this._tweenState&&(this._tweenState=0);for(var e=0;e<this._valueCount;++e)this._result[e]=this._current[e]+this._delta[e]*this._tweenProgress},e.prototype.init=function(e,i,r){if(t.prototype.init.call(this,e,i,r),null!==this._timelineData){var n=this._animationData.frameIntOffset+this._timelineArray[this._timelineData.offset+3];this._deformCount=this._frameIntArray[n+1],this._valueCount=this._frameIntArray[n+2],this._valueOffset=this._frameIntArray[n+3],this._frameFloatOffset=this._frameIntArray[n+4]+this._animationData.frameFloatOffset}else this._deformCount=this.surface._deformVertices.length,this._valueCount=this._deformCount,this._valueOffset=0,this._frameFloatOffset=0;this._current.length=this._valueCount,this._delta.length=this._valueCount,this._result.length=this._valueCount;for(var a=0;a<this._valueCount;++a)this._delta[a]=0},e.prototype.blend=function(t){for(var e=this.surface._blendState.blendWeight,i=this.surface._deformVertices,r=0;r<this._deformCount;++r){var n=0;n=r<this._valueOffset?this._frameFloatArray[this._frameFloatOffset+r]:r<this._valueOffset+this._valueCount?this._result[r-this._valueOffset]:this._frameFloatArray[this._frameFloatOffset+r-this._valueCount],2===t?i[r]+=n*e:1!==e?i[r]=n*e:i[r]=n}(0!==this._animationState._fadeState||0!==this._animationState._subFadeState)&&(this.surface._transformDirty=!0)},e}(t.TweenTimelineState);t.SurfaceTimelineState=s;var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.toString=function(){return"[class dragonBones.SlotDislayTimelineState]"},e.prototype._onArriveAtFrame=function(){if(this.playState>=0){var t=null!==this._timelineData?this._frameArray[this._frameOffset+1]:this.slot._slotData.displayIndex;this.slot.displayIndex!==t&&this.slot._setDisplayIndex(t,!0)}},e}(t.SlotTimelineState);t.SlotDislayTimelineState=l;var h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._current=[0,0,0,0,0,0,0,0],e._delta=[0,0,0,0,0,0,0,0],e._result=[0,0,0,0,0,0,0,0],e}return __extends(e,t),e.toString=function(){return"[class dragonBones.SlotColorTimelineState]"},e.prototype._onClear=function(){t.prototype._onClear.call(this),this._dirty=!1},e.prototype._onArriveAtFrame=function(){if(t.prototype._onArriveAtFrame.call(this),null!==this._timelineData){var e=this._dragonBonesData.intArray,i=this._frameIntArray,r=this._animationData.frameIntOffset+this._frameValueOffset+1*this._frameIndex,n=i[r];0>n&&(n+=65536),this._current[0]=e[n++],this._current[1]=e[n++],this._current[2]=e[n++],this._current[3]=e[n++],this._current[4]=e[n++],this._current[5]=e[n++],this._current[6]=e[n++],this._current[7]=e[n++],2===this._tweenState&&(n=this._frameIndex===this._frameCount-1?i[this._animationData.frameIntOffset+this._frameValueOffset]:i[r+1],0>n&&(n+=65536),this._delta[0]=e[n++]-this._current[0],this._delta[1]=e[n++]-this._current[1],this._delta[2]=e[n++]-this._current[2],this._delta[3]=e[n++]-this._current[3],this._delta[4]=e[n++]-this._current[4],this._delta[5]=e[n++]-this._current[5],this._delta[6]=e[n++]-this._current[6],this._delta[7]=e[n++]-this._current[7])}else{var a=this.slot._slotData.color;this._current[0]=100*a.alphaMultiplier,this._current[1]=100*a.redMultiplier,this._current[2]=100*a.greenMultiplier,this._current[3]=100*a.blueMultiplier,this._current[4]=a.alphaOffset,this._current[5]=a.redOffset,this._current[6]=a.greenOffset,this._current[7]=a.blueOffset}},e.prototype._onUpdateFrame=function(){t.prototype._onUpdateFrame.call(this),this._dirty=!0,2!==this._tweenState&&(this._tweenState=0),this._result[0]=.01*(this._current[0]+this._delta[0]*this._tweenProgress),this._result[1]=.01*(this._current[1]+this._delta[1]*this._tweenProgress),this._result[2]=.01*(this._current[2]+this._delta[2]*this._tweenProgress),this._result[3]=.01*(this._current[3]+this._delta[3]*this._tweenProgress),this._result[4]=this._current[4]+this._delta[4]*this._tweenProgress,this._result[5]=this._current[5]+this._delta[5]*this._tweenProgress,this._result[6]=this._current[6]+this._delta[6]*this._tweenProgress,this._result[7]=this._current[7]+this._delta[7]*this._tweenProgress},e.prototype.fadeOut=function(){this._tweenState=0,this._dirty=!1},e.prototype.update=function(e){if(t.prototype.update.call(this,e),0!==this._tweenState||this._dirty){var i=this.slot._colorTransform;if(0!==this._animationState._fadeState||0!==this._animationState._subFadeState){if(i.alphaMultiplier!==this._result[0]||i.redMultiplier!==this._result[1]||i.greenMultiplier!==this._result[2]||i.blueMultiplier!==this._result[3]||i.alphaOffset!==this._result[4]||i.redOffset!==this._result[5]||i.greenOffset!==this._result[6]||i.blueOffset!==this._result[7]){var r=Math.pow(this._animationState._fadeProgress,4);
i.alphaMultiplier+=(this._result[0]-i.alphaMultiplier)*r,i.redMultiplier+=(this._result[1]-i.redMultiplier)*r,i.greenMultiplier+=(this._result[2]-i.greenMultiplier)*r,i.blueMultiplier+=(this._result[3]-i.blueMultiplier)*r,i.alphaOffset+=(this._result[4]-i.alphaOffset)*r,i.redOffset+=(this._result[5]-i.redOffset)*r,i.greenOffset+=(this._result[6]-i.greenOffset)*r,i.blueOffset+=(this._result[7]-i.blueOffset)*r,this.slot._colorDirty=!0}}else this._dirty&&(this._dirty=!1,(i.alphaMultiplier!==this._result[0]||i.redMultiplier!==this._result[1]||i.greenMultiplier!==this._result[2]||i.blueMultiplier!==this._result[3]||i.alphaOffset!==this._result[4]||i.redOffset!==this._result[5]||i.greenOffset!==this._result[6]||i.blueOffset!==this._result[7])&&(i.alphaMultiplier=this._result[0],i.redMultiplier=this._result[1],i.greenMultiplier=this._result[2],i.blueMultiplier=this._result[3],i.alphaOffset=this._result[4],i.redOffset=this._result[5],i.greenOffset=this._result[6],i.blueOffset=this._result[7],this.slot._colorDirty=!0))}},e}(t.SlotTimelineState);t.SlotColorTimelineState=h;var c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._current=[],e._delta=[],e._result=[],e}return __extends(e,t),e.toString=function(){return"[class dragonBones.DeformTimelineState]"},e.prototype._onClear=function(){t.prototype._onClear.call(this),this.vertexOffset=0,this._dirty=!1,this._frameFloatOffset=0,this._valueCount=0,this._deformCount=0,this._valueOffset=0,this._current.length=0,this._delta.length=0,this._result.length=0},e.prototype._onArriveAtFrame=function(){if(t.prototype._onArriveAtFrame.call(this),null!==this._timelineData){var e=this._animationData.frameFloatOffset+this._frameValueOffset+this._frameIndex*this._valueCount,i=this._armature._armatureData.scale,r=this._frameFloatArray;if(2===this._tweenState){var n=e+this._valueCount;this._frameIndex===this._frameCount-1&&(n=this._animationData.frameFloatOffset+this._frameValueOffset);for(var a=0;a<this._valueCount;++a)this._delta[a]=r[n+a]*i-(this._current[a]=r[e+a]*i)}else for(var a=0;a<this._valueCount;++a)this._current[a]=r[e+a]*i}else for(var a=0;a<this._valueCount;++a)this._current[a]=0},e.prototype._onUpdateFrame=function(){t.prototype._onUpdateFrame.call(this),this._dirty=!0,2!==this._tweenState&&(this._tweenState=0);for(var e=0;e<this._valueCount;++e)this._result[e]=this._current[e]+this._delta[e]*this._tweenProgress},e.prototype.init=function(e,i,r){if(t.prototype.init.call(this,e,i,r),null!==this._timelineData){var n=this._animationData.frameIntOffset+this._timelineArray[this._timelineData.offset+3];this.vertexOffset=this._frameIntArray[n+0],this.vertexOffset<0&&(this.vertexOffset+=65536),this._deformCount=this._frameIntArray[n+1],this._valueCount=this._frameIntArray[n+2],this._valueOffset=this._frameIntArray[n+3],this._frameFloatOffset=this._frameIntArray[n+4]+this._animationData.frameFloatOffset}else{var a=this.slot._deformVertices;this._deformCount=null!==a?a.vertices.length:0,this._valueCount=this._deformCount,this._valueOffset=0,this._frameFloatOffset=0}this._current.length=this._valueCount,this._delta.length=this._valueCount,this._result.length=this._valueCount;for(var o=0;o<this._valueCount;++o)this._delta[o]=0},e.prototype.fadeOut=function(){this._tweenState=0,this._dirty=!1},e.prototype.update=function(e){var i=this.slot._deformVertices;if(null!==i&&null!==i.verticesData&&i.verticesData.offset===this.vertexOffset&&(t.prototype.update.call(this,e),0!==this._tweenState||this._dirty)){var r=i.vertices;if(0!==this._animationState._fadeState||0!==this._animationState._subFadeState){for(var n=Math.pow(this._animationState._fadeProgress,2),a=0;a<this._deformCount;++a)a<this._valueOffset?r[a]+=(this._frameFloatArray[this._frameFloatOffset+a]-r[a])*n:a<this._valueOffset+this._valueCount?r[a]+=(this._result[a-this._valueOffset]-r[a])*n:r[a]+=(this._frameFloatArray[this._frameFloatOffset+a-this._valueCount]-r[a])*n;i.verticesDirty=!0}else if(this._dirty){this._dirty=!1;for(var a=0;a<this._deformCount;++a)a<this._valueOffset?r[a]=this._frameFloatArray[this._frameFloatOffset+a]:a<this._valueOffset+this._valueCount?r[a]=this._result[a-this._valueOffset]:r[a]=this._frameFloatArray[this._frameFloatOffset+a-this._valueCount];i.verticesDirty=!0}}},e}(t.SlotTimelineState);t.DeformTimelineState=c;var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.toString=function(){return"[class dragonBones.IKConstraintTimelineState]"},e.prototype._onClear=function(){t.prototype._onClear.call(this),this._current=0,this._delta=0},e.prototype._onArriveAtFrame=function(){t.prototype._onArriveAtFrame.call(this);var e=this.constraint;if(null!==this._timelineData){var i=this._animationData.frameIntOffset+this._frameValueOffset+2*this._frameIndex,r=this._frameIntArray,n=0!==r[i++];this._current=.01*r[i++],2===this._tweenState?(this._frameIndex===this._frameCount-1&&(i=this._animationData.frameIntOffset+this._frameValueOffset),this._delta=.01*r[i+1]-this._current):this._delta=0,e._bendPositive=n}else{var a=e._constraintData;this._current=a.weight,this._delta=0,e._bendPositive=a.bendPositive}e.invalidUpdate()},e.prototype._onUpdateFrame=function(){t.prototype._onUpdateFrame.call(this),2!==this._tweenState&&(this._tweenState=0);var e=this.constraint;e._weight=this._current+this._delta*this._tweenProgress,e.invalidUpdate()},e}(t.ConstraintTimelineState);t.IKConstraintTimelineState=u;var p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._floats=[0,0,0,0,0,0],e}return __extends(e,t),e.toString=function(){return"[class dragonBones.AnimationTimelineState]"},e.prototype._onClear=function(){t.prototype._onClear.call(this),this.animationState=null},e.prototype._onArriveAtFrame=function(){if(t.prototype._onArriveAtFrame.call(this),null!==this._timelineData){var e=this._animationData.frameIntOffset+this._frameValueOffset+2*this._frameIndex,i=1/this.animationState._animationData.parent.frameRate,r=this._frameIntArray;this._floats[0]=r[e++]*i,this._floats[3]=.01*r[e++],2===this._tweenState?(this._frameIndex===this._frameCount-1&&(e=this._animationData.frameIntOffset+this._frameValueOffset),this._floats[1]=r[e++]*i-this._floats[0],this._floats[4]=.01*r[e++]-this._floats[3]):(this._floats[1]=0,this._floats[4]=0)}},e.prototype._onUpdateFrame=function(){t.prototype._onUpdateFrame.call(this),2!==this._tweenState&&(this._tweenState=0),this._floats[0]>=0&&(this._floats[2]=this._floats[0]+this._floats[1]*this._tweenProgress),this._floats[5]=this._floats[3]+this._floats[4]*this._tweenProgress},e.prototype.blend=function(t){var e=this.animationState,i=e._blendState.blendWeight;2===t?(e.weight+=this._floats[5]*i,e.currentTime+=this._floats[2]*i):(e.weight=this._floats[5]*i,e.currentTime=this._floats[2]*i)},e}(t.TweenTimelineState);t.AnimationTimelineState=p}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.actionDataToInstance=function(t,i,r){0===t.type?i.type=e.FRAME_EVENT:i.type=10===t.type?e.FRAME_EVENT:e.SOUND_EVENT,i.name=t.name,i.armature=r,i.actionData=t,i.data=t.data,null!==t.bone&&(i.bone=r.getBone(t.bone.name)),null!==t.slot&&(i.slot=r.getSlot(t.slot.name))},e.toString=function(){return"[class dragonBones.EventObject]"},e.prototype._onClear=function(){this.time=0,this.type="",this.name="",this.armature=null,this.bone=null,this.slot=null,this.animationState=null,this.actionData=null,this.data=null},e.START="start",e.LOOP_COMPLETE="loopComplete",e.COMPLETE="complete",e.FADE_IN="fadeIn",e.FADE_IN_COMPLETE="fadeInComplete",e.FADE_OUT="fadeOut",e.FADE_OUT_COMPLETE="fadeOutComplete",e.FRAME_EVENT="frameEvent",e.SOUND_EVENT="soundEvent",e}(t.BaseObject);t.EventObject=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function e(){}return e._getArmatureType=function(t){switch(t.toLowerCase()){case"stage":return 2;case"armature":return 0;case"movieclip":return 1;default:return 0}},e._getBoneType=function(t){switch(t.toLowerCase()){case"bone":return 0;case"surface":return 1;default:return 0}},e._getDisplayType=function(t){switch(t.toLowerCase()){case"image":return 0;case"mesh":return 2;case"armature":return 1;case"boundingbox":return 3;case"path":return 4;default:return 0}},e._getBoundingBoxType=function(t){switch(t.toLowerCase()){case"rectangle":return 0;case"ellipse":return 1;case"polygon":return 2;default:return 0}},e._getActionType=function(t){switch(t.toLowerCase()){case"play":return 0;case"frame":return 10;case"sound":return 11;default:return 0}},e._getBlendMode=function(t){switch(t.toLowerCase()){case"normal":return 0;case"add":return 1;case"alpha":return 2;case"darken":return 3;case"difference":return 4;case"erase":return 5;case"hardlight":return 6;case"invert":return 7;case"layer":return 8;case"lighten":return 9;case"multiply":return 10;case"overlay":return 11;case"screen":return 12;case"subtract":return 13;default:return 0}},e._getPositionMode=function(t){switch(t.toLocaleLowerCase()){case"percent":return 1;case"fixed":return 0;default:return 1}},e._getSpacingMode=function(t){switch(t.toLocaleLowerCase()){case"length":return 0;case"percent":return 2;case"fixed":return 1;default:return 0}},e._getRotateMode=function(t){switch(t.toLocaleLowerCase()){case"tangent":return 0;case"chain":return 1;case"chainscale":return 2;default:return 0}},e.parseDragonBonesData=function(e){return console.warn("Deprecated."),e instanceof ArrayBuffer?t.BinaryDataParser.getInstance().parseDragonBonesData(e):t.ObjectDataParser.getInstance().parseDragonBonesData(e)},e.parseTextureAtlasData=function(i,r){void 0===r&&(r=1),console.warn("已废弃");for(var n={},a=i[e.SUB_TEXTURE],o=0,s=a.length;s>o;o++){var l=a[o],h=l[e.NAME],c=new t.Rectangle,u=null;c.x=l[e.X]/r,c.y=l[e.Y]/r,c.width=l[e.WIDTH]/r,c.height=l[e.HEIGHT]/r,e.FRAME_WIDTH in l&&(u=new t.Rectangle,u.x=l[e.FRAME_X]/r,u.y=l[e.FRAME_Y]/r,u.width=l[e.FRAME_WIDTH]/r,u.height=l[e.FRAME_HEIGHT]/r),n[h]={region:c,frame:u,rotated:!1}}return n},e.DATA_VERSION_2_3="2.3",e.DATA_VERSION_3_0="3.0",e.DATA_VERSION_4_0="4.0",e.DATA_VERSION_4_5="4.5",e.DATA_VERSION_5_0="5.0",e.DATA_VERSION_5_5="5.5",e.DATA_VERSION=e.DATA_VERSION_5_5,e.DATA_VERSIONS=[e.DATA_VERSION_4_0,e.DATA_VERSION_4_5,e.DATA_VERSION_5_0,e.DATA_VERSION_5_5],e.TEXTURE_ATLAS="textureAtlas",e.SUB_TEXTURE="SubTexture",e.FORMAT="format",e.IMAGE_PATH="imagePath",e.WIDTH="width",e.HEIGHT="height",e.ROTATED="rotated",e.FRAME_X="frameX",e.FRAME_Y="frameY",e.FRAME_WIDTH="frameWidth",e.FRAME_HEIGHT="frameHeight",e.DRADON_BONES="dragonBones",e.USER_DATA="userData",e.ARMATURE="armature",e.BONE="bone",e.SURFACE="surface",e.SLOT="slot",e.CONSTRAINT="constraint",e.IK="ik",e.PATH_CONSTRAINT="path",e.SKIN="skin",e.DISPLAY="display",e.ANIMATION="animation",e.Z_ORDER="zOrder",e.FFD="ffd",e.FRAME="frame",e.TRANSLATE_FRAME="translateFrame",e.ROTATE_FRAME="rotateFrame",e.SCALE_FRAME="scaleFrame",e.DISPLAY_FRAME="displayFrame",e.COLOR_FRAME="colorFrame",e.DEFAULT_ACTIONS="defaultActions",e.ACTIONS="actions",e.EVENTS="events",e.INTS="ints",e.FLOATS="floats",e.STRINGS="strings",e.CANVAS="canvas",e.TRANSFORM="transform",e.PIVOT="pivot",e.AABB="aabb",e.COLOR="color",e.VERSION="version",e.COMPATIBLE_VERSION="compatibleVersion",e.FRAME_RATE="frameRate",e.TYPE="type",e.SUB_TYPE="subType",e.NAME="name",e.PARENT="parent",e.TARGET="target",e.STAGE="stage",e.SHARE="share",e.PATH="path",e.LENGTH="length",e.DISPLAY_INDEX="displayIndex",e.BLEND_MODE="blendMode",e.INHERIT_TRANSLATION="inheritTranslation",e.INHERIT_ROTATION="inheritRotation",e.INHERIT_SCALE="inheritScale",e.INHERIT_REFLECTION="inheritReflection",e.INHERIT_ANIMATION="inheritAnimation",e.INHERIT_DEFORM="inheritDeform",e.SEGMENT_X="segmentX",e.SEGMENT_Y="segmentY",e.BEND_POSITIVE="bendPositive",e.CHAIN="chain",e.WEIGHT="weight",e.FADE_IN_TIME="fadeInTime",e.PLAY_TIMES="playTimes",e.SCALE="scale",e.OFFSET="offset",e.POSITION="position",e.DURATION="duration",e.TWEEN_EASING="tweenEasing",e.TWEEN_ROTATE="tweenRotate",e.TWEEN_SCALE="tweenScale",e.CLOCK_WISE="clockwise",e.CURVE="curve",e.SOUND="sound",e.EVENT="event",e.ACTION="action",e.X="x",e.Y="y",e.SKEW_X="skX",e.SKEW_Y="skY",e.SCALE_X="scX",e.SCALE_Y="scY",e.VALUE="value",e.ROTATE="rotate",e.SKEW="skew",e.ALPHA_OFFSET="aO",e.RED_OFFSET="rO",e.GREEN_OFFSET="gO",e.BLUE_OFFSET="bO",e.ALPHA_MULTIPLIER="aM",e.RED_MULTIPLIER="rM",e.GREEN_MULTIPLIER="gM",e.BLUE_MULTIPLIER="bM",e.UVS="uvs",e.VERTICES="vertices",e.TRIANGLES="triangles",e.WEIGHTS="weights",e.SLOT_POSE="slotPose",e.BONE_POSE="bonePose",e.GLUE_WEIGHTS="glueWeights",e.GLUE_MESHES="glueMeshes",e.BONES="bones",e.POSITION_MODE="positionMode",e.SPACING_MODE="spacingMode",e.ROTATE_MODE="rotateMode",e.SPACING="spacing",e.ROTATE_OFFSET="rotateOffset",e.ROTATE_MIX="rotateMix",e.TRANSLATE_MIX="translateMix",e.TARGET_DISPLAY="targetDisplay",e.CLOSED="closed",e.CONSTANT_SPEED="constantSpeed",e.VERTEX_COUNT="vertexCount",e.LENGTHS="lengths",e.GOTO_AND_PLAY="gotoAndPlay",e.DEFAULT_NAME="default",e}();t.DataParser=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function r(){var i=null!==e&&e.apply(this,arguments)||this;return i._rawTextureAtlasIndex=0,i._rawBones=[],i._data=null,i._armature=null,i._bone=null,i._surface=null,i._slot=null,i._skin=null,i._mesh=null,i._animation=null,i._timeline=null,i._rawTextureAtlases=null,i._defaultColorOffset=-1,i._prevClockwise=0,i._prevRotation=0,i._helpMatrixA=new t.Matrix,i._helpMatrixB=new t.Matrix,i._helpTransform=new t.Transform,i._helpColorTransform=new t.ColorTransform,i._helpPoint=new t.Point,i._helpArray=[],i._intArray=[],i._floatArray=[],i._frameIntArray=[],i._frameFloatArray=[],i._frameArray=[],i._timelineArray=[],i._cacheRawMeshes=[],i._cacheMeshes=[],i._actionFrames=[],i._weightSlotPose={},i._weightBonePoses={},i._cacheBones={},i._slotChildActions={},i}return __extends(r,e),r._getBoolean=function(t,e,i){if(e in t){var r=t[e],n=typeof r;if("boolean"===n)return r;if("string"!==n)return!!r;switch(r){case"0":case"NaN":case"":case"false":case"null":case"undefined":return!1;default:return!0}}return i},r._getNumber=function(t,e,i){if(e in t){var r=t[e];return null===r||"NaN"===r?i:+r||0}return i},r._getString=function(e,i,r){if(i in e){var n=e[i],a=typeof n;if("string"===a){if(t.DragonBones.webAssembly)for(var o=0,s=n.length;s>o;++o)if(n.charCodeAt(o)>255)return encodeURI(n);return n}return String(n)}return r},r.prototype._getCurvePoint=function(t,e,i,r,n,a,o,s,l,h){var c=1-l,u=c*c,p=l*l,d=c*u,f=3*l*u,g=3*c*p,m=l*p;h.x=d*t+f*i+g*n+m*o,h.y=d*e+f*r+g*a+m*s},r.prototype._samplingEasingCurve=function(t,e){for(var i=t.length,r=-2,n=0,a=e.length;a>n;++n){for(var o=(n+1)/(a+1);(i>r+6?t[r+6]:1)<o;)r+=6;for(var s=r>=0&&i>r+6,l=s?t[r]:0,h=s?t[r+1]:0,c=t[r+2],u=t[r+3],p=t[r+4],d=t[r+5],f=s?t[r+6]:1,g=s?t[r+7]:1,m=0,y=1;y-m>1e-4;){var v=.5*(y+m);this._getCurvePoint(l,h,c,u,p,d,f,g,v,this._helpPoint),o-this._helpPoint.x>0?m=v:y=v}e[n]=this._helpPoint.y}},r.prototype._parseActionDataInFrame=function(e,i,r,n){t.DataParser.EVENT in e&&this._mergeActionFrame(e[t.DataParser.EVENT],i,10,r,n),t.DataParser.SOUND in e&&this._mergeActionFrame(e[t.DataParser.SOUND],i,11,r,n),t.DataParser.ACTION in e&&this._mergeActionFrame(e[t.DataParser.ACTION],i,0,r,n),t.DataParser.EVENTS in e&&this._mergeActionFrame(e[t.DataParser.EVENTS],i,10,r,n),t.DataParser.ACTIONS in e&&this._mergeActionFrame(e[t.DataParser.ACTIONS],i,0,r,n)},r.prototype._mergeActionFrame=function(e,r,n,a,o){for(var s=t.DragonBones.webAssembly?this._armature.actions.size():this._armature.actions.length,l=this._parseActionData(e,n,a,o),h=0,c=null,u=0,p=l;u<p.length;u++){var d=p[u];this._armature.addAction(d,!1)}0===this._actionFrames.length&&(c=new i,c.frameStart=0,this._actionFrames.push(c),c=null);for(var f=0,g=this._actionFrames;f<g.length;f++){var m=g[f];if(m.frameStart===r){c=m;break}if(m.frameStart>r)break;h++}null===c&&(c=new i,c.frameStart=r,this._actionFrames.splice(h+1,0,c));for(var y=0;y<l.length;++y)c.actions.push(s+y)},r.prototype._parseArmature=function(e,i){var n=t.BaseObject.borrowObject(t.ArmatureData);if(n.name=r._getString(e,t.DataParser.NAME,""),n.frameRate=r._getNumber(e,t.DataParser.FRAME_RATE,this._data.frameRate),n.scale=i,t.DataParser.TYPE in e&&"string"==typeof e[t.DataParser.TYPE]?n.type=t.DataParser._getArmatureType(e[t.DataParser.TYPE]):n.type=r._getNumber(e,t.DataParser.TYPE,0),0===n.frameRate&&(n.frameRate=24),this._armature=n,t.DataParser.CANVAS in e){var a=e[t.DataParser.CANVAS],o=t.BaseObject.borrowObject(t.CanvasData);t.DataParser.COLOR in a?o.hasBackground=!0:o.hasBackground=!1,o.color=r._getNumber(a,t.DataParser.COLOR,0),o.x=r._getNumber(a,t.DataParser.X,0)*n.scale,o.y=r._getNumber(a,t.DataParser.Y,0)*n.scale,o.width=r._getNumber(a,t.DataParser.WIDTH,0)*n.scale,o.height=r._getNumber(a,t.DataParser.HEIGHT,0)*n.scale,n.canvas=o}if(t.DataParser.AABB in e){var s=e[t.DataParser.AABB];n.aabb.x=r._getNumber(s,t.DataParser.X,0)*n.scale,n.aabb.y=r._getNumber(s,t.DataParser.Y,0)*n.scale,n.aabb.width=r._getNumber(s,t.DataParser.WIDTH,0)*n.scale,n.aabb.height=r._getNumber(s,t.DataParser.HEIGHT,0)*n.scale}if(t.DataParser.BONE in e)for(var l=e[t.DataParser.BONE],h=0,c=l;h<c.length;h++){var u=c[h],p=r._getString(u,t.DataParser.PARENT,""),d=this._parseBone(u);if(p.length>0){var f=n.getBone(p);null!==f?d.parent=f:(p in this._cacheBones||(this._cacheBones[p]=[]),this._cacheBones[p].push(d))}if(d.name in this._cacheBones){for(var g=0,m=this._cacheBones[d.name];g<m.length;g++){var y=m[g];y.parent=d}delete this._cacheBones[d.name]}n.addBone(d),this._rawBones.push(d)}if(t.DataParser.IK in e)for(var v=e[t.DataParser.IK],_=0,b=v;_<b.length;_++){var x=b[_],T=this._parseIKConstraint(x);T&&n.addConstraint(T)}if(n.sortBones(),t.DataParser.SLOT in e)for(var E=0,S=e[t.DataParser.SLOT],C=0,w=S;C<w.length;C++){var P=w[C];n.addSlot(this._parseSlot(P,E++))}if(t.DataParser.SKIN in e)for(var D=e[t.DataParser.SKIN],A=0,I=D;A<I.length;A++){var M=I[A];n.addSkin(this._parseSkin(M))}if(t.DataParser.PATH_CONSTRAINT in e)for(var $=e[t.DataParser.PATH_CONSTRAINT],O=0,R=$;O<R.length;O++){var L=R[O],T=this._parsePathConstraint(L);T&&n.addConstraint(T)}for(var B=0,k=this._cacheRawMeshes.length;k>B;++B){var N=this._cacheRawMeshes[B];t.DataParser.GLUE_WEIGHTS in N&&t.DataParser.GLUE_MESHES in N&&this._parseMeshGlue(N,this._cacheMeshes[B])}for(var B=0,k=this._cacheRawMeshes.length;k>B;++B){var F=this._cacheRawMeshes[B],G=r._getString(F,t.DataParser.SHARE,"");if(0!==G.length){var U=r._getString(F,t.DataParser.SKIN,t.DataParser.DEFAULT_NAME);0===U.length&&(U=t.DataParser.DEFAULT_NAME);var V=n.getMesh(U,"",G);if(null!==V){var H=this._cacheMeshes[B];H.vertices.shareFrom(V.vertices)}}}if(t.DataParser.ANIMATION in e)for(var j=e[t.DataParser.ANIMATION],W=0,X=j;W<X.length;W++){var z=X[W],Y=this._parseAnimation(z);n.addAnimation(Y)}if(t.DataParser.DEFAULT_ACTIONS in e)for(var q=this._parseActionData(e[t.DataParser.DEFAULT_ACTIONS],0,null,null),Q=0,K=q;Q<K.length;Q++){var J=K[Q];if(n.addAction(J,!0),0===J.type){var Y=n.getAnimation(J.name);null!==Y&&(n.defaultAnimation=Y)}}if(t.DataParser.ACTIONS in e)for(var q=this._parseActionData(e[t.DataParser.ACTIONS],0,null,null),Z=0,te=q;Z<te.length;Z++){var J=te[Z];n.addAction(J,!1)}this._rawBones.length=0,this._cacheRawMeshes.length=0,this._cacheMeshes.length=0,this._armature=null;for(var ee in this._weightSlotPose)delete this._weightSlotPose[ee];for(var ee in this._weightBonePoses)delete this._weightBonePoses[ee];for(var ee in this._cacheBones)delete this._cacheBones[ee];for(var ee in this._slotChildActions)delete this._slotChildActions[ee];return n},r.prototype._parseBone=function(e){var i=0,n=this._armature.scale;if(i=t.DataParser.TYPE in e&&"string"==typeof e[t.DataParser.TYPE]?t.DataParser._getBoneType(e[t.DataParser.TYPE]):r._getNumber(e,t.DataParser.TYPE,0),0===i){var a=t.BaseObject.borrowObject(t.BoneData);return a.inheritTranslation=r._getBoolean(e,t.DataParser.INHERIT_TRANSLATION,!0),a.inheritRotation=r._getBoolean(e,t.DataParser.INHERIT_ROTATION,!0),a.inheritScale=r._getBoolean(e,t.DataParser.INHERIT_SCALE,!0),a.inheritReflection=r._getBoolean(e,t.DataParser.INHERIT_REFLECTION,!0),a.length=r._getNumber(e,t.DataParser.LENGTH,0)*n,a.name=r._getString(e,t.DataParser.NAME,""),t.DataParser.TRANSFORM in e&&this._parseTransform(e[t.DataParser.TRANSFORM],a.transform,n),a}var o=t.BaseObject.borrowObject(t.SurfaceData);if(o.name=r._getString(e,t.DataParser.NAME,""),o.segmentX=r._getNumber(e,t.DataParser.SEGMENT_X,0),o.segmentY=r._getNumber(e,t.DataParser.SEGMENT_Y,0),o.vertices.length=(o.segmentX+1)*(o.segmentY+1)*2,t.DataParser.VERTICES in e)for(var s=e[t.DataParser.VERTICES],l=0,h=o.vertices.length;h>l;++l)l<s.length?o.vertices[l]=s[l]*n:o.vertices[l]=0;return o},r.prototype._parseIKConstraint=function(e){var i=this._armature.getBone(r._getString(e,t.DataParser.BONE,""));if(null===i)return null;var n=this._armature.getBone(r._getString(e,t.DataParser.TARGET,""));if(null===n)return null;var a=t.BaseObject.borrowObject(t.IKConstraintData);a.scaleEnabled=r._getBoolean(e,t.DataParser.SCALE,!1),a.bendPositive=r._getBoolean(e,t.DataParser.BEND_POSITIVE,!0),a.weight=r._getNumber(e,t.DataParser.WEIGHT,1),a.name=r._getString(e,t.DataParser.NAME,""),a.type=0,a.target=n;var o=r._getNumber(e,t.DataParser.CHAIN,0);return o>0&&null!==i.parent?(a.root=i.parent,a.bone=i):(a.root=i,a.bone=null),a},r.prototype._parsePathConstraint=function(e){var i=this._armature.getSlot(r._getString(e,t.DataParser.TARGET,""));if(null===i)return null;var n=this._armature.defaultSkin;if(null===n)return null;var a=n.getDisplay(i.name,r._getString(e,t.DataParser.TARGET_DISPLAY,i.name));if(null===a||!(a instanceof t.PathDisplayData))return null;var o=e[t.DataParser.BONES];if(null===o||0===o.length)return null;var s=t.BaseObject.borrowObject(t.PathConstraintData);s.name=r._getString(e,t.DataParser.NAME,""),s.type=1,s.pathSlot=i,s.pathDisplayData=a,s.target=i.parent,s.positionMode=t.DataParser._getPositionMode(r._getString(e,t.DataParser.POSITION_MODE,"")),s.spacingMode=t.DataParser._getSpacingMode(r._getString(e,t.DataParser.SPACING_MODE,"")),s.rotateMode=t.DataParser._getRotateMode(r._getString(e,t.DataParser.ROTATE_MODE,"")),s.position=r._getNumber(e,t.DataParser.POSITION,0),s.spacing=r._getNumber(e,t.DataParser.SPACING,0),s.rotateOffset=r._getNumber(e,t.DataParser.ROTATE_OFFSET,0),s.rotateMix=r._getNumber(e,t.DataParser.ROTATE_MIX,1),s.translateMix=r._getNumber(e,t.DataParser.TRANSLATE_MIX,1);for(var l=0,h=o;l<h.length;l++){var c=h[l],u=this._armature.getBone(c);null!==u&&(s.AddBone(u),null===s.root&&(s.root=u))}return s},r.prototype._parseSlot=function(e,i){var n=t.BaseObject.borrowObject(t.SlotData);return n.displayIndex=r._getNumber(e,t.DataParser.DISPLAY_INDEX,0),n.zOrder=i,n.name=r._getString(e,t.DataParser.NAME,""),n.parent=this._armature.getBone(r._getString(e,t.DataParser.PARENT,"")),t.DataParser.BLEND_MODE in e&&"string"==typeof e[t.DataParser.BLEND_MODE]?n.blendMode=t.DataParser._getBlendMode(e[t.DataParser.BLEND_MODE]):n.blendMode=r._getNumber(e,t.DataParser.BLEND_MODE,0),t.DataParser.COLOR in e?(n.color=t.SlotData.createColor(),this._parseColorTransform(e[t.DataParser.COLOR],n.color)):n.color=t.SlotData.DEFAULT_COLOR,t.DataParser.ACTIONS in e&&(this._slotChildActions[n.name]=this._parseActionData(e[t.DataParser.ACTIONS],0,null,null)),n},r.prototype._parseSkin=function(e){var i=t.BaseObject.borrowObject(t.SkinData);if(i.name=r._getString(e,t.DataParser.NAME,t.DataParser.DEFAULT_NAME),0===i.name.length&&(i.name=t.DataParser.DEFAULT_NAME),t.DataParser.SLOT in e){var n=e[t.DataParser.SLOT];this._skin=i;for(var a=0,o=n;a<o.length;a++){var s=o[a],l=r._getString(s,t.DataParser.NAME,""),h=this._armature.getSlot(l);if(null!==h){if(this._slot=h,t.DataParser.DISPLAY in s)for(var c=s[t.DataParser.DISPLAY],u=0,p=c;u<p.length;u++){var d=p[u];d?i.addDisplay(l,this._parseDisplay(d)):i.addDisplay(l,null)}this._slot=null}}this._skin=null}return i},r.prototype._parseDisplay=function(e){var i=r._getString(e,t.DataParser.NAME,""),n=r._getString(e,t.DataParser.PATH,""),a=0,o=null;switch(a=t.DataParser.TYPE in e&&"string"==typeof e[t.DataParser.TYPE]?t.DataParser._getDisplayType(e[t.DataParser.TYPE]):r._getNumber(e,t.DataParser.TYPE,a)){case 0:var s=o=t.BaseObject.borrowObject(t.ImageDisplayData);s.name=i,s.path=n.length>0?n:i,this._parsePivot(e,s);break;case 1:var l=o=t.BaseObject.borrowObject(t.ArmatureDisplayData);if(l.name=i,l.path=n.length>0?n:i,l.inheritAnimation=!0,t.DataParser.ACTIONS in e)for(var h=this._parseActionData(e[t.DataParser.ACTIONS],0,null,null),c=0,u=h;c<u.length;c++){var p=u[c];l.addAction(p)}else if(this._slot.name in this._slotChildActions){var d=this._skin.getDisplays(this._slot.name);if(null===d?0===this._slot.displayIndex:this._slot.displayIndex===d.length){for(var f=0,g=this._slotChildActions[this._slot.name];f<g.length;f++){var p=g[f];l.addAction(p)}delete this._slotChildActions[this._slot.name]}}break;case 2:var m=o=t.BaseObject.borrowObject(t.MeshDisplayData);m.vertices.inheritDeform=r._getBoolean(e,t.DataParser.INHERIT_DEFORM,!0),m.name=i,m.path=n.length>0?n:i,m.vertices.data=this._data,t.DataParser.SHARE in e?(this._cacheRawMeshes.push(e),this._cacheMeshes.push(m)):this._parseMesh(e,m),t.DataParser.GLUE_WEIGHTS in e&&t.DataParser.GLUE_MESHES in e&&(this._cacheRawMeshes.push(e),this._cacheMeshes.push(m));break;case 3:var y=this._parseBoundingBox(e);if(null!==y){var v=o=t.BaseObject.borrowObject(t.BoundingBoxDisplayData);v.name=i,v.path=n.length>0?n:i,v.boundingBox=y}break;case 4:var _=e[t.DataParser.LENGTHS],b=o=t.BaseObject.borrowObject(t.PathDisplayData);b.closed=r._getBoolean(e,t.DataParser.CLOSED,!1),b.constantSpeed=r._getBoolean(e,t.DataParser.CONSTANT_SPEED,!1),b.name=i,b.path=n.length>0?n:i,b.vertices.data=this._data,b.curveLengths.length=_.length;for(var x=0,T=_.length;T>x;++x)b.curveLengths[x]=_[x];this._parsePath(e,b)}return null!==o&&t.DataParser.TRANSFORM in e&&this._parseTransform(e[t.DataParser.TRANSFORM],o.transform,this._armature.scale),o},r.prototype._parsePath=function(e,i){var n=e[t.DataParser.VERTICES],a=r._getNumber(e,t.DataParser.VERTEX_COUNT,0),o=this._floatArray.length,s=this._intArray.length;if(i.vertices.offset=s,this._intArray.length+=2,this._intArray[s+0]=a,this._intArray[s+2]=o,t.DataParser.WEIGHTS in e){var l=e[t.DataParser.WEIGHTS],h=e[t.DataParser.BONES],c=h.length,u=Math.floor(l.length-a)/2,p=this._intArray.length,d=this._floatArray.length,f=this._armature.sortedBones,g=t.BaseObject.borrowObject(t.WeightData);g.count=u,g.offset=p,this._intArray.length+=2+c+a+u,this._intArray[p+0]=c,this._intArray[p+1]=d;for(var m=0;c>m;m++){var y=h[m],v=this._rawBones[y];g.addBone(v),this._intArray[p+2+m]=f.indexOf(v)}this._floatArray.length+=3*u;for(var m=0,_=0,b=0,x=p+2+c,T=d;u>m;m++){var E=l[_++];this._intArray[x++]=E;for(var S=0;E>S;S++){var C=l[_++],w=l[_++],P=n[b++],D=n[b++];this._intArray[x++]=h.indexOf(C),this._floatArray[T++]=w,this._floatArray[T++]=P,this._floatArray[T++]=D}}i.vertices.weight=g}else{this._floatArray.length+=n.length;for(var m=0,A=n.length;A>m;++m)this._floatArray[o+m]=n[m]}},r.prototype._parsePivot=function(e,i){if(t.DataParser.PIVOT in e){var n=e[t.DataParser.PIVOT];i.pivot.x=r._getNumber(n,t.DataParser.X,0),i.pivot.y=r._getNumber(n,t.DataParser.Y,0)}else i.pivot.x=.5,i.pivot.y=.5},r.prototype._parseMesh=function(e,i){var r=e[t.DataParser.VERTICES],n=e[t.DataParser.UVS],a=e[t.DataParser.TRIANGLES],o=Math.floor(r.length/2),s=Math.floor(a.length/3),l=this._floatArray.length,h=l+2*o,c=this._intArray.length,u=this._skin.name+"_"+this._slot.name+"_"+i.name;i.vertices.offset=c,this._intArray.length+=4+3*s,this._intArray[c+0]=o,this._intArray[c+1]=s,this._intArray[c+2]=l;for(var p=0,d=3*s;d>p;++p)this._intArray[c+4+p]=a[p];this._floatArray.length+=2*o+2*o;for(var p=0,d=2*o;d>p;++p)this._floatArray[l+p]=r[p],this._floatArray[h+p]=n[p];if(t.DataParser.WEIGHTS in e){var f=e[t.DataParser.WEIGHTS],g=e[t.DataParser.SLOT_POSE],m=e[t.DataParser.BONE_POSE],y=this._armature.sortedBones,v=new Array,_=Math.floor(m.length/7),b=this._floatArray.length,x=Math.floor(f.length-o)/2,T=this._intArray.length,E=t.BaseObject.borrowObject(t.WeightData);E.count=x,E.offset=T,v.length=_,this._intArray.length+=2+_+o+x,this._intArray[T+1]=b;for(var p=0;_>p;++p){var S=m[7*p],C=this._rawBones[S];E.addBone(C),v[p]=S,this._intArray[T+2+p]=y.indexOf(C)}this._floatArray.length+=3*x,this._helpMatrixA.copyFromArray(g,0);for(var p=0,w=0,P=T+2+_,D=b;o>p;++p){var A=2*p,I=this._intArray[P++]=f[w++],M=this._floatArray[l+A],$=this._floatArray[l+A+1];this._helpMatrixA.transformPoint(M,$,this._helpPoint),M=this._helpPoint.x,$=this._helpPoint.y;for(var O=0;I>O;++O){var S=f[w++],R=v.indexOf(S);this._helpMatrixB.copyFromArray(m,7*R+1),this._helpMatrixB.invert(),this._helpMatrixB.transformPoint(M,$,this._helpPoint),this._intArray[P++]=R,this._floatArray[D++]=f[w++],this._floatArray[D++]=this._helpPoint.x,this._floatArray[D++]=this._helpPoint.y}}i.vertices.weight=E,this._weightSlotPose[u]=g,this._weightBonePoses[u]=m}},r.prototype._parseMeshGlue=function(t,e){},r.prototype._parseBoundingBox=function(e){var i=null,n=0;switch(n=t.DataParser.SUB_TYPE in e&&"string"==typeof e[t.DataParser.SUB_TYPE]?t.DataParser._getBoundingBoxType(e[t.DataParser.SUB_TYPE]):r._getNumber(e,t.DataParser.SUB_TYPE,n)){case 0:i=t.BaseObject.borrowObject(t.RectangleBoundingBoxData);break;case 1:i=t.BaseObject.borrowObject(t.EllipseBoundingBoxData);break;case 2:i=this._parsePolygonBoundingBox(e)}return null!==i&&(i.color=r._getNumber(e,t.DataParser.COLOR,0),(0===i.type||1===i.type)&&(i.width=r._getNumber(e,t.DataParser.WIDTH,0),i.height=r._getNumber(e,t.DataParser.HEIGHT,0))),i},r.prototype._parsePolygonBoundingBox=function(e){var i=t.BaseObject.borrowObject(t.PolygonBoundingBoxData);if(t.DataParser.VERTICES in e){var r=this._armature.scale,n=e[t.DataParser.VERTICES],a=i.vertices;t.DragonBones.webAssembly?a.resize(n.length,0):a.length=n.length;for(var o=0,s=n.length;s>o;o+=2){var l=n[o]*r,h=n[o+1]*r;t.DragonBones.webAssembly?(a.set(o,l),a.set(o+1,h)):(a[o]=l,a[o+1]=h),0===o?(i.x=l,i.y=h,i.width=l,i.height=h):(l<i.x?i.x=l:l>i.width&&(i.width=l),h<i.y?i.y=h:h>i.height&&(i.height=h))}i.width-=i.x,i.height-=i.y}else console.warn("Data error.\n Please reexport DragonBones Data to fixed the bug.");return i},r.prototype._parseAnimation=function(e){var i=t.BaseObject.borrowObject(t.AnimationData);if(i.frameCount=Math.max(r._getNumber(e,t.DataParser.DURATION,1),1),i.playTimes=r._getNumber(e,t.DataParser.PLAY_TIMES,1),i.duration=i.frameCount/this._armature.frameRate,i.fadeInTime=r._getNumber(e,t.DataParser.FADE_IN_TIME,0),i.scale=r._getNumber(e,t.DataParser.SCALE,1),i.name=r._getString(e,t.DataParser.NAME,t.DataParser.DEFAULT_NAME),0===i.name.length&&(i.name=t.DataParser.DEFAULT_NAME),i.frameIntOffset=this._frameIntArray.length,i.frameFloatOffset=this._frameFloatArray.length,i.frameOffset=this._frameArray.length,this._animation=i,t.DataParser.FRAME in e){var n=e[t.DataParser.FRAME],a=n.length;if(a>0)for(var o=0,s=0;a>o;++o){var l=n[o];this._parseActionDataInFrame(l,s,null,null),s+=r._getNumber(l,t.DataParser.DURATION,1)}}if(t.DataParser.Z_ORDER in e&&(this._animation.zOrderTimeline=this._parseTimeline(e[t.DataParser.Z_ORDER],null,t.DataParser.FRAME,1,!1,!1,0,this._parseZOrderFrame)),t.DataParser.BONE in e)for(var h=e[t.DataParser.BONE],c=0,u=h;c<u.length;c++){var p=u[c];this._parseBoneTimeline(p)}if(t.DataParser.SURFACE in e)for(var h=e[t.DataParser.SURFACE],d=0,f=h;d<f.length;d++){var p=f[d],g=r._getString(p,t.DataParser.NAME,"");if(this._surface=this._armature.getBone(g),null!==this._surface){var m=this._parseTimeline(p,null,t.DataParser.FRAME,50,!1,!0,0,this._parseSurfaceFrame);null!==m&&this._animation.addSurfaceTimeline(this._surface,m),this._surface=null}}if(t.DataParser.SLOT in e)for(var h=e[t.DataParser.SLOT],y=0,v=h;y<v.length;y++){var p=v[y];this._parseSlotTimeline(p)}if(t.DataParser.FFD in e)for(var h=e[t.DataParser.FFD],_=0,b=h;_<b.length;_++){var p=b[_],x=r._getString(p,t.DataParser.SKIN,t.DataParser.DEFAULT_NAME),T=r._getString(p,t.DataParser.SLOT,""),E=r._getString(p,t.DataParser.NAME,"");
if(0===x.length&&(x=t.DataParser.DEFAULT_NAME),this._slot=this._armature.getSlot(T),this._mesh=this._armature.getMesh(x,T,E),null!==this._slot&&null!==this._mesh){var m=this._parseTimeline(p,null,t.DataParser.FRAME,22,!1,!0,0,this._parseSlotFFDFrame);null!==m&&this._animation.addSlotTimeline(this._slot,m),this._slot=null,this._mesh=null}}if(t.DataParser.IK in e)for(var h=e[t.DataParser.IK],S=0,C=h;S<C.length;S++){var p=C[S],w=r._getString(p,t.DataParser.NAME,""),P=this._armature.getConstraint(w);if(null!==P){var m=this._parseTimeline(p,null,t.DataParser.FRAME,30,!0,!1,2,this._parseIKConstraintFrame);null!==m&&this._animation.addConstraintTimeline(P,m)}}if(t.DataParser.ANIMATION in e)for(var h=e[t.DataParser.ANIMATION],D=0,A=h;D<A.length;D++){var p=A[D],I=r._getString(p,t.DataParser.NAME,""),m=this._parseTimeline(p,null,t.DataParser.FRAME,40,!0,!1,2,this._parseAnimationFrame);null!==m&&this._animation.addAnimationTimeline(I,m)}return this._actionFrames.length>0&&(this._animation.actionTimeline=this._parseTimeline(null,this._actionFrames,"",0,!1,!1,0,this._parseActionFrame),this._actionFrames.length=0),this._animation=null,i},r.prototype._parseTimeline=function(e,n,a,o,s,l,h,c){if(null!==e&&a.length>0&&a in e&&(n=e[a]),null===n)return null;var u=n.length;if(0===u)return null;var p=this._frameIntArray.length,d=this._frameFloatArray.length,f=t.BaseObject.borrowObject(t.TimelineData),g=this._timelineArray.length;if(this._timelineArray.length+=5+u,null!==e?(this._timelineArray[g+0]=Math.round(100*r._getNumber(e,t.DataParser.SCALE,1)),this._timelineArray[g+1]=Math.round(100*r._getNumber(e,t.DataParser.OFFSET,0))):(this._timelineArray[g+0]=100,this._timelineArray[g+1]=0),this._timelineArray[g+2]=u,this._timelineArray[g+3]=h,s?this._timelineArray[g+4]=p-this._animation.frameIntOffset:l?this._timelineArray[g+4]=d-this._animation.frameFloatOffset:this._timelineArray[g+4]=0,this._timeline=f,f.type=o,f.offset=g,1===u)f.frameIndicesOffset=-1,this._timelineArray[g+5+0]=c.call(this,n[0],0,0)-this._animation.frameOffset;else{var m=this._animation.frameCount+1,y=this._data.frameIndices,v=0;t.DragonBones.webAssembly?(v=y.size(),y.resize(v+m,0)):(v=y.length,y.length+=m),f.frameIndicesOffset=v;for(var _=0,b=0,x=0,T=0;m>_;++_){if(_>=x+T&&u>b){var E=n[b];x=_,T=b===u-1?this._animation.frameCount-x:E instanceof i?this._actionFrames[b+1].frameStart-x:r._getNumber(E,t.DataParser.DURATION,1),this._timelineArray[g+5+b]=c.call(this,E,x,T)-this._animation.frameOffset,b++}t.DragonBones.webAssembly?y.set(v+_,b-1):y[v+_]=b-1}}return this._timeline=null,f},r.prototype._parseBoneTimeline=function(e){var i=this._armature.getBone(r._getString(e,t.DataParser.NAME,""));if(null!==i){if(this._bone=i,this._slot=this._armature.getSlot(this._bone.name),t.DataParser.TRANSLATE_FRAME in e){var n=this._parseTimeline(e,null,t.DataParser.TRANSLATE_FRAME,11,!1,!0,2,this._parseBoneTranslateFrame);null!==n&&this._animation.addBoneTimeline(i,n)}if(t.DataParser.ROTATE_FRAME in e){var n=this._parseTimeline(e,null,t.DataParser.ROTATE_FRAME,12,!1,!0,2,this._parseBoneRotateFrame);null!==n&&this._animation.addBoneTimeline(i,n)}if(t.DataParser.SCALE_FRAME in e){var n=this._parseTimeline(e,null,t.DataParser.SCALE_FRAME,13,!1,!0,2,this._parseBoneScaleFrame);null!==n&&this._animation.addBoneTimeline(i,n)}if(t.DataParser.FRAME in e){var n=this._parseTimeline(e,null,t.DataParser.FRAME,10,!1,!0,6,this._parseBoneAllFrame);null!==n&&this._animation.addBoneTimeline(i,n)}this._bone=null,this._slot=null}},r.prototype._parseSlotTimeline=function(e){var i=this._armature.getSlot(r._getString(e,t.DataParser.NAME,""));if(null!==i){this._slot=i;var n=null;n=t.DataParser.DISPLAY_FRAME in e?this._parseTimeline(e,null,t.DataParser.DISPLAY_FRAME,20,!1,!1,0,this._parseSlotDisplayFrame):this._parseTimeline(e,null,t.DataParser.FRAME,20,!1,!1,0,this._parseSlotDisplayFrame),null!==n&&this._animation.addSlotTimeline(i,n);var a=null;a=t.DataParser.COLOR_FRAME in e?this._parseTimeline(e,null,t.DataParser.COLOR_FRAME,21,!0,!1,1,this._parseSlotColorFrame):this._parseTimeline(e,null,t.DataParser.FRAME,21,!0,!1,1,this._parseSlotColorFrame),null!==a&&this._animation.addSlotTimeline(i,a),this._slot=null}},r.prototype._parseFrame=function(t,e,i){var r=this._frameArray.length;return this._frameArray.length+=1,this._frameArray[r+0]=e,r},r.prototype._parseTweenFrame=function(e,i,n){var a=this._parseFrame(e,i,n);if(n>0)if(t.DataParser.CURVE in e){var o=n+1;this._helpArray.length=o,this._samplingEasingCurve(e[t.DataParser.CURVE],this._helpArray),this._frameArray.length+=2+this._helpArray.length,this._frameArray[a+1]=2,this._frameArray[a+2]=o;for(var s=0;o>s;++s)this._frameArray[a+3+s]=Math.round(1e4*this._helpArray[s])}else{var l=-2,h=l;t.DataParser.TWEEN_EASING in e&&(h=r._getNumber(e,t.DataParser.TWEEN_EASING,l)),h===l?(this._frameArray.length+=1,this._frameArray[a+1]=0):0===h?(this._frameArray.length+=1,this._frameArray[a+1]=1):0>h?(this._frameArray.length+=2,this._frameArray[a+1]=3,this._frameArray[a+2]=Math.round(100*-h)):1>=h?(this._frameArray.length+=2,this._frameArray[a+1]=4,this._frameArray[a+2]=Math.round(100*h)):(this._frameArray.length+=2,this._frameArray[a+1]=5,this._frameArray[a+2]=Math.round(100*h-100))}else this._frameArray.length+=1,this._frameArray[a+1]=0;return a},r.prototype._parseActionFrame=function(t,e,i){var r=this._frameArray.length,n=t.actions.length;this._frameArray.length+=2+n,this._frameArray[r+0]=e,this._frameArray[r+0+1]=n;for(var a=0;n>a;++a)this._frameArray[r+0+2+a]=t.actions[a];return r},r.prototype._parseZOrderFrame=function(e,i,r){var n=this._parseFrame(e,i,r);if(t.DataParser.Z_ORDER in e){var a=e[t.DataParser.Z_ORDER];if(a.length>0){for(var o=this._armature.sortedSlots.length,s=new Array(o-a.length/2),l=new Array(o),h=0;h<s.length;++h)s[h]=0;for(var c=0;o>c;++c)l[c]=-1;for(var u=0,p=0,d=0,f=a.length;f>d;d+=2){for(var g=a[d],m=a[d+1];u!==g;)s[p++]=u++;var y=u+m;l[y]=u++}for(;o>u;)s[p++]=u++;this._frameArray.length+=1+o,this._frameArray[n+1]=o;for(var v=o;v--;)-1===l[v]?this._frameArray[n+2+v]=s[--p]||0:this._frameArray[n+2+v]=l[v]||0;return n}}return this._frameArray.length+=1,this._frameArray[n+1]=0,n},r.prototype._parseBoneAllFrame=function(e,i,n){this._helpTransform.identity(),t.DataParser.TRANSFORM in e&&this._parseTransform(e[t.DataParser.TRANSFORM],this._helpTransform,1);var a=this._helpTransform.rotation;0!==i&&(0===this._prevClockwise?a=this._prevRotation+t.Transform.normalizeRadian(a-this._prevRotation):((this._prevClockwise>0?a>=this._prevRotation:a<=this._prevRotation)&&(this._prevClockwise=this._prevClockwise>0?this._prevClockwise-1:this._prevClockwise+1),a=this._prevRotation+a-this._prevRotation+t.Transform.PI_D*this._prevClockwise)),this._prevClockwise=r._getNumber(e,t.DataParser.TWEEN_ROTATE,0),this._prevRotation=a;var o=this._parseTweenFrame(e,i,n),s=this._frameFloatArray.length;return this._frameFloatArray.length+=6,this._frameFloatArray[s++]=this._helpTransform.x,this._frameFloatArray[s++]=this._helpTransform.y,this._frameFloatArray[s++]=a,this._frameFloatArray[s++]=this._helpTransform.skew,this._frameFloatArray[s++]=this._helpTransform.scaleX,this._frameFloatArray[s++]=this._helpTransform.scaleY,this._parseActionDataInFrame(e,i,this._bone,this._slot),o},r.prototype._parseBoneTranslateFrame=function(e,i,n){var a=this._parseTweenFrame(e,i,n),o=this._frameFloatArray.length;return this._frameFloatArray.length+=2,this._frameFloatArray[o++]=r._getNumber(e,t.DataParser.X,0),this._frameFloatArray[o++]=r._getNumber(e,t.DataParser.Y,0),a},r.prototype._parseBoneRotateFrame=function(e,i,n){var a=r._getNumber(e,t.DataParser.ROTATE,0)*t.Transform.DEG_RAD;0!==i&&(0===this._prevClockwise?a=this._prevRotation+t.Transform.normalizeRadian(a-this._prevRotation):((this._prevClockwise>0?a>=this._prevRotation:a<=this._prevRotation)&&(this._prevClockwise=this._prevClockwise>0?this._prevClockwise-1:this._prevClockwise+1),a=this._prevRotation+a-this._prevRotation+t.Transform.PI_D*this._prevClockwise)),this._prevClockwise=r._getNumber(e,t.DataParser.CLOCK_WISE,0),this._prevRotation=a;var o=this._parseTweenFrame(e,i,n),s=this._frameFloatArray.length;return this._frameFloatArray.length+=2,this._frameFloatArray[s++]=a,this._frameFloatArray[s++]=r._getNumber(e,t.DataParser.SKEW,0)*t.Transform.DEG_RAD,o},r.prototype._parseBoneScaleFrame=function(e,i,n){var a=this._parseTweenFrame(e,i,n),o=this._frameFloatArray.length;return this._frameFloatArray.length+=2,this._frameFloatArray[o++]=r._getNumber(e,t.DataParser.X,1),this._frameFloatArray[o++]=r._getNumber(e,t.DataParser.Y,1),a},r.prototype._parseSurfaceFrame=function(e,i,n){var a=this._frameFloatArray.length,o=this._parseTweenFrame(e,i,n),s=e[t.DataParser.VERTICES],l=r._getNumber(e,t.DataParser.OFFSET,0),h=this._surface.vertices.length/2,c=0,u=0;this._frameFloatArray.length+=2*h;for(var p=0;2*h>p;p+=2)c=l>p||p-l>=s.length?0:s[p-l],u=l>p+1||p+1-l>=s.length?0:s[p+1-l],this._frameFloatArray[a+p]=c,this._frameFloatArray[a+p+1]=u;if(0===i){var d=this._frameIntArray.length;this._frameIntArray.length+=5,this._frameIntArray[d+0]=0,this._frameIntArray[d+1]=this._frameFloatArray.length-a,this._frameIntArray[d+2]=this._frameFloatArray.length-a,this._frameIntArray[d+3]=0,this._frameIntArray[d+4]=a-this._animation.frameFloatOffset,this._timelineArray[this._timeline.offset+3]=d-this._animation.frameIntOffset}return o},r.prototype._parseSlotDisplayFrame=function(e,i,n){var a=this._parseFrame(e,i,n);return this._frameArray.length+=1,t.DataParser.VALUE in e?this._frameArray[a+1]=r._getNumber(e,t.DataParser.VALUE,0):this._frameArray[a+1]=r._getNumber(e,t.DataParser.DISPLAY_INDEX,0),this._parseActionDataInFrame(e,i,this._slot.parent,this._slot),a},r.prototype._parseSlotColorFrame=function(e,i,r){var n=this._parseTweenFrame(e,i,r),a=-1;if(t.DataParser.VALUE in e||t.DataParser.COLOR in e){var o=t.DataParser.VALUE in e?e[t.DataParser.VALUE]:e[t.DataParser.COLOR];for(var s in o){this._parseColorTransform(o,this._helpColorTransform),a=this._intArray.length,this._intArray.length+=8,this._intArray[a++]=Math.round(100*this._helpColorTransform.alphaMultiplier),this._intArray[a++]=Math.round(100*this._helpColorTransform.redMultiplier),this._intArray[a++]=Math.round(100*this._helpColorTransform.greenMultiplier),this._intArray[a++]=Math.round(100*this._helpColorTransform.blueMultiplier),this._intArray[a++]=Math.round(this._helpColorTransform.alphaOffset),this._intArray[a++]=Math.round(this._helpColorTransform.redOffset),this._intArray[a++]=Math.round(this._helpColorTransform.greenOffset),this._intArray[a++]=Math.round(this._helpColorTransform.blueOffset),a-=8;break}}0>a&&(this._defaultColorOffset<0&&(this._defaultColorOffset=a=this._intArray.length,this._intArray.length+=8,this._intArray[a++]=100,this._intArray[a++]=100,this._intArray[a++]=100,this._intArray[a++]=100,this._intArray[a++]=0,this._intArray[a++]=0,this._intArray[a++]=0,this._intArray[a++]=0),a=this._defaultColorOffset);var l=this._frameIntArray.length;return this._frameIntArray.length+=1,this._frameIntArray[l]=a,n},r.prototype._parseSlotFFDFrame=function(e,i,n){var a=this._frameFloatArray.length,o=this._parseTweenFrame(e,i,n),s=t.DataParser.VERTICES in e?e[t.DataParser.VERTICES]:null,l=r._getNumber(e,t.DataParser.OFFSET,0),h=this._intArray[this._mesh.vertices.offset+0],c=this._mesh.parent.name+"_"+this._slot.name+"_"+this._mesh.name,u=this._mesh.vertices.weight,p=0,d=0,f=0,g=0;if(null!==u){var m=this._weightSlotPose[c];this._helpMatrixA.copyFromArray(m,0),this._frameFloatArray.length+=2*u.count,f=u.offset+2+u.bones.length}else this._frameFloatArray.length+=2*h;for(var y=0;2*h>y;y+=2)if(null===s?(p=0,d=0):(p=l>y||y-l>=s.length?0:s[y-l],d=l>y+1||y+1-l>=s.length?0:s[y+1-l]),null!==u){var v=this._weightBonePoses[c],_=this._intArray[f++];this._helpMatrixA.transformPoint(p,d,this._helpPoint,!0),p=this._helpPoint.x,d=this._helpPoint.y;for(var b=0;_>b;++b){var x=this._intArray[f++];this._helpMatrixB.copyFromArray(v,7*x+1),this._helpMatrixB.invert(),this._helpMatrixB.transformPoint(p,d,this._helpPoint,!0),this._frameFloatArray[a+g++]=this._helpPoint.x,this._frameFloatArray[a+g++]=this._helpPoint.y}}else this._frameFloatArray[a+y]=p,this._frameFloatArray[a+y+1]=d;if(0===i){var T=this._frameIntArray.length;this._frameIntArray.length+=5,this._frameIntArray[T+0]=this._mesh.vertices.offset,this._frameIntArray[T+1]=this._frameFloatArray.length-a,this._frameIntArray[T+2]=this._frameFloatArray.length-a,this._frameIntArray[T+3]=0,this._frameIntArray[T+4]=a-this._animation.frameFloatOffset,this._timelineArray[this._timeline.offset+3]=T-this._animation.frameIntOffset}return o},r.prototype._parseIKConstraintFrame=function(e,i,n){var a=this._parseTweenFrame(e,i,n),o=this._frameIntArray.length;return this._frameIntArray.length+=2,this._frameIntArray[o++]=r._getBoolean(e,t.DataParser.BEND_POSITIVE,!0)?1:0,this._frameIntArray[o++]=Math.round(100*r._getNumber(e,t.DataParser.WEIGHT,1)),a},r.prototype._parseAnimationFrame=function(e,i,n){var a=this._parseTweenFrame(e,i,n),o=this._frameIntArray.length;return this._frameIntArray.length+=2,this._frameIntArray[o++]=r._getNumber(e,t.DataParser.VALUE,0),this._frameIntArray[o++]=Math.round(100*r._getNumber(e,t.DataParser.WEIGHT,1)),a},r.prototype._parseActionData=function(e,i,n,a){var o=new Array;if("string"==typeof e){var s=t.BaseObject.borrowObject(t.ActionData);s.type=i,s.name=e,s.bone=n,s.slot=a,o.push(s)}else if(e instanceof Array)for(var l=0,h=e;l<h.length;l++){var c=h[l],s=t.BaseObject.borrowObject(t.ActionData);if(t.DataParser.GOTO_AND_PLAY in c?(s.type=0,s.name=r._getString(c,t.DataParser.GOTO_AND_PLAY,"")):(t.DataParser.TYPE in c&&"string"==typeof c[t.DataParser.TYPE]?s.type=t.DataParser._getActionType(c[t.DataParser.TYPE]):s.type=r._getNumber(c,t.DataParser.TYPE,i),s.name=r._getString(c,t.DataParser.NAME,"")),t.DataParser.BONE in c){var u=r._getString(c,t.DataParser.BONE,"");s.bone=this._armature.getBone(u)}else s.bone=n;if(t.DataParser.SLOT in c){var p=r._getString(c,t.DataParser.SLOT,"");s.slot=this._armature.getSlot(p)}else s.slot=a;var d=null;if(t.DataParser.INTS in c){null===d&&(d=t.BaseObject.borrowObject(t.UserData));for(var f=c[t.DataParser.INTS],g=0,m=f;g<m.length;g++){var y=m[g];d.addInt(y)}}if(t.DataParser.FLOATS in c){null===d&&(d=t.BaseObject.borrowObject(t.UserData));for(var v=c[t.DataParser.FLOATS],_=0,b=v;_<b.length;_++){var y=b[_];d.addFloat(y)}}if(t.DataParser.STRINGS in c){null===d&&(d=t.BaseObject.borrowObject(t.UserData));for(var x=c[t.DataParser.STRINGS],T=0,E=x;T<E.length;T++){var y=E[T];d.addString(y)}}s.data=d,o.push(s)}return o},r.prototype._parseTransform=function(e,i,n){i.x=r._getNumber(e,t.DataParser.X,0)*n,i.y=r._getNumber(e,t.DataParser.Y,0)*n,t.DataParser.ROTATE in e||t.DataParser.SKEW in e?(i.rotation=t.Transform.normalizeRadian(r._getNumber(e,t.DataParser.ROTATE,0)*t.Transform.DEG_RAD),i.skew=t.Transform.normalizeRadian(r._getNumber(e,t.DataParser.SKEW,0)*t.Transform.DEG_RAD)):(t.DataParser.SKEW_X in e||t.DataParser.SKEW_Y in e)&&(i.rotation=t.Transform.normalizeRadian(r._getNumber(e,t.DataParser.SKEW_Y,0)*t.Transform.DEG_RAD),i.skew=t.Transform.normalizeRadian(r._getNumber(e,t.DataParser.SKEW_X,0)*t.Transform.DEG_RAD)-i.rotation),i.scaleX=r._getNumber(e,t.DataParser.SCALE_X,1),i.scaleY=r._getNumber(e,t.DataParser.SCALE_Y,1)},r.prototype._parseColorTransform=function(e,i){i.alphaMultiplier=.01*r._getNumber(e,t.DataParser.ALPHA_MULTIPLIER,100),i.redMultiplier=.01*r._getNumber(e,t.DataParser.RED_MULTIPLIER,100),i.greenMultiplier=.01*r._getNumber(e,t.DataParser.GREEN_MULTIPLIER,100),i.blueMultiplier=.01*r._getNumber(e,t.DataParser.BLUE_MULTIPLIER,100),i.alphaOffset=r._getNumber(e,t.DataParser.ALPHA_OFFSET,0),i.redOffset=r._getNumber(e,t.DataParser.RED_OFFSET,0),i.greenOffset=r._getNumber(e,t.DataParser.GREEN_OFFSET,0),i.blueOffset=r._getNumber(e,t.DataParser.BLUE_OFFSET,0)},r.prototype._parseArray=function(t){this._intArray.length=0,this._floatArray.length=0,this._frameIntArray.length=0,this._frameFloatArray.length=0,this._frameArray.length=0,this._timelineArray.length=0},r.prototype._modifyArray=function(){this._intArray.length%Int16Array.BYTES_PER_ELEMENT!==0&&this._intArray.push(0),this._frameIntArray.length%Int16Array.BYTES_PER_ELEMENT!==0&&this._frameIntArray.push(0),this._frameArray.length%Int16Array.BYTES_PER_ELEMENT!==0&&this._frameArray.push(0),this._timelineArray.length%Uint16Array.BYTES_PER_ELEMENT!==0&&this._timelineArray.push(0);var e=this._intArray.length*Int16Array.BYTES_PER_ELEMENT,i=this._floatArray.length*Float32Array.BYTES_PER_ELEMENT,r=this._frameIntArray.length*Int16Array.BYTES_PER_ELEMENT,n=this._frameFloatArray.length*Float32Array.BYTES_PER_ELEMENT,a=this._frameArray.length*Int16Array.BYTES_PER_ELEMENT,o=this._timelineArray.length*Uint16Array.BYTES_PER_ELEMENT,s=e+i+r+n+a+o;if(t.DragonBones.webAssembly){for(var l=t.webAssemblyModule.HEAP16.buffer,h=t.webAssemblyModule._malloc(s),c=new Int16Array(l,h,this._intArray.length),u=new Float32Array(l,h+e,this._floatArray.length),p=new Int16Array(l,h+e+i,this._frameIntArray.length),d=new Float32Array(l,h+e+i+r,this._frameFloatArray.length),f=new Int16Array(l,h+e+i+r+n,this._frameArray.length),g=new Uint16Array(l,h+e+i+r+n+a,this._timelineArray.length),m=0,y=this._intArray.length;y>m;++m)c[m]=this._intArray[m];for(var m=0,y=this._floatArray.length;y>m;++m)u[m]=this._floatArray[m];for(var m=0,y=this._frameIntArray.length;y>m;++m)p[m]=this._frameIntArray[m];for(var m=0,y=this._frameFloatArray.length;y>m;++m)d[m]=this._frameFloatArray[m];for(var m=0,y=this._frameArray.length;y>m;++m)f[m]=this._frameArray[m];for(var m=0,y=this._timelineArray.length;y>m;++m)g[m]=this._timelineArray[m];t.webAssemblyModule.setDataBinary(this._data,h,e,i,r,n,a,o)}else{for(var v=new ArrayBuffer(s),c=new Int16Array(v,0,this._intArray.length),u=new Float32Array(v,e,this._floatArray.length),p=new Int16Array(v,e+i,this._frameIntArray.length),d=new Float32Array(v,e+i+r,this._frameFloatArray.length),f=new Int16Array(v,e+i+r+n,this._frameArray.length),g=new Uint16Array(v,e+i+r+n+a,this._timelineArray.length),m=0,y=this._intArray.length;y>m;++m)c[m]=this._intArray[m];for(var m=0,y=this._floatArray.length;y>m;++m)u[m]=this._floatArray[m];for(var m=0,y=this._frameIntArray.length;y>m;++m)p[m]=this._frameIntArray[m];for(var m=0,y=this._frameFloatArray.length;y>m;++m)d[m]=this._frameFloatArray[m];for(var m=0,y=this._frameArray.length;y>m;++m)f[m]=this._frameArray[m];for(var m=0,y=this._timelineArray.length;y>m;++m)g[m]=this._timelineArray[m];this._data.binary=v,this._data.intArray=c,this._data.floatArray=u,this._data.frameIntArray=p,this._data.frameFloatArray=d,this._data.frameArray=f,this._data.timelineArray=g}this._defaultColorOffset=-1},r.prototype.parseDragonBonesData=function(e,i){void 0===i&&(i=1),console.assert(null!==e&&void 0!==e,"Data error.");var n=r._getString(e,t.DataParser.VERSION,""),a=r._getString(e,t.DataParser.COMPATIBLE_VERSION,"");if(t.DataParser.DATA_VERSIONS.indexOf(n)>=0||t.DataParser.DATA_VERSIONS.indexOf(a)>=0){var o=t.BaseObject.borrowObject(t.DragonBonesData);if(o.version=n,o.name=r._getString(e,t.DataParser.NAME,""),o.frameRate=r._getNumber(e,t.DataParser.FRAME_RATE,24),0===o.frameRate&&(o.frameRate=24),t.DataParser.ARMATURE in e){this._data=o,this._parseArray(e);for(var s=e[t.DataParser.ARMATURE],l=0,h=s;l<h.length;l++){var c=h[l];o.addArmature(this._parseArmature(c,i))}this._data.binary||this._modifyArray(),t.DataParser.STAGE in e?o.stage=o.getArmature(r._getString(e,t.DataParser.STAGE,"")):o.armatureNames.length>0&&(o.stage=o.getArmature(o.armatureNames[0])),this._data=null}return t.DataParser.TEXTURE_ATLAS in e&&(this._rawTextureAtlases=e[t.DataParser.TEXTURE_ATLAS]),o}return console.assert(!1,"Nonsupport data version: "+n+"\nPlease convert DragonBones data to support version.\nRead more: https://github.com/DragonBones/Tools/"),null},r.prototype.parseTextureAtlasData=function(e,i,n){if(void 0===n&&(n=1),console.assert(void 0!==e),null===e){if(null===this._rawTextureAtlases||0===this._rawTextureAtlases.length)return!1;var a=this._rawTextureAtlases[this._rawTextureAtlasIndex++];return this.parseTextureAtlasData(a,i,n),this._rawTextureAtlasIndex>=this._rawTextureAtlases.length&&(this._rawTextureAtlasIndex=0,this._rawTextureAtlases=null),!0}if(i.width=r._getNumber(e,t.DataParser.WIDTH,0),i.height=r._getNumber(e,t.DataParser.HEIGHT,0),i.scale=1===n?1/r._getNumber(e,t.DataParser.SCALE,1):n,i.name=r._getString(e,t.DataParser.NAME,""),i.imagePath=r._getString(e,t.DataParser.IMAGE_PATH,""),t.DataParser.SUB_TEXTURE in e)for(var o=e[t.DataParser.SUB_TEXTURE],s=0,l=o.length;l>s;++s){var h=o[s],c=i.createTexture();c.rotated=r._getBoolean(h,t.DataParser.ROTATED,!1),c.name=r._getString(h,t.DataParser.NAME,""),c.region.x=r._getNumber(h,t.DataParser.X,0),c.region.y=r._getNumber(h,t.DataParser.Y,0),c.region.width=r._getNumber(h,t.DataParser.WIDTH,0),c.region.height=r._getNumber(h,t.DataParser.HEIGHT,0);var u=r._getNumber(h,t.DataParser.FRAME_WIDTH,-1),p=r._getNumber(h,t.DataParser.FRAME_HEIGHT,-1);u>0&&p>0&&(c.frame=t.TextureData.createRectangle(),c.frame.x=r._getNumber(h,t.DataParser.FRAME_X,0),c.frame.y=r._getNumber(h,t.DataParser.FRAME_Y,0),c.frame.width=u,c.frame.height=p),i.addTexture(c)}return!0},r.getInstance=function(){return null===r._objectDataParserInstance&&(r._objectDataParserInstance=new r),r._objectDataParserInstance},r._objectDataParserInstance=null,r}(t.DataParser);t.ObjectDataParser=e;var i=function(){function t(){this.frameStart=0,this.actions=[]}return t}();t.ActionFrame=i}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return __extends(i,e),i.prototype._inRange=function(t,e,i){return t>=e&&i>=t},i.prototype._decodeUTF8=function(t){for(var e,i=-1,r=-1,n=65533,a=0,o="",s=0,l=0,h=0,c=0;t.length>a;){var u=t[a++];if(u===i)e=0!==l?n:r;else if(0===l)this._inRange(u,0,127)?e=u:(this._inRange(u,194,223)?(l=1,c=128,s=u-192):this._inRange(u,224,239)?(l=2,c=2048,s=u-224):this._inRange(u,240,244)&&(l=3,c=65536,s=u-240),s*=Math.pow(64,l),e=null);else if(this._inRange(u,128,191))if(h+=1,s+=(u-128)*Math.pow(64,l-h),h!==l)e=null;else{var p=s,d=c;s=0,l=0,h=0,c=0,e=this._inRange(p,d,1114111)&&!this._inRange(p,55296,57343)?p:u}else s=0,l=0,h=0,c=0,a--,e=u;null!==e&&e!==r&&(65535>=e?e>0&&(o+=String.fromCharCode(e)):(e-=65536,o+=String.fromCharCode(55296+(e>>10&1023)),o+=String.fromCharCode(56320+(1023&e))))}return o},i.prototype._getUTF16Key=function(t){for(var e=0,i=t.length;i>e;++e)if(t.charCodeAt(e)>255)return encodeURI(t);return t},i.prototype._parseBinaryTimeline=function(e,i,r){void 0===r&&(r=null);var n=null!==r?r:t.BaseObject.borrowObject(t.TimelineData);n.type=e,n.offset=i,this._timeline=n;var a=this._timelineArrayBuffer[n.offset+2];if(1===a)n.frameIndicesOffset=-1;else{var o=0,s=this._animation.frameCount+1,l=this._data.frameIndices;t.DragonBones.webAssembly?(o=l.size(),l.resize(o+s,0)):(o=l.length,l.length+=s),n.frameIndicesOffset=o;for(var h=0,c=0,u=0,p=0;s>h;++h)h>=u+p&&a>c&&(u=this._frameArrayBuffer[this._animation.frameOffset+this._timelineArrayBuffer[n.offset+5+c]],p=c===a-1?this._animation.frameCount-u:this._frameArrayBuffer[this._animation.frameOffset+this._timelineArrayBuffer[n.offset+5+c+1]]-u,c++),t.DragonBones.webAssembly?l.set(o+h,c-1):l[o+h]=c-1}return this._timeline=null,n},i.prototype._parseVertices=function(e,i){i.offset=e[t.DataParser.OFFSET];var r=this._intArrayBuffer[i.offset+3];if(r>=0){var n=t.BaseObject.borrowObject(t.WeightData),a=this._intArrayBuffer[i.offset+0],o=this._intArrayBuffer[r+0];n.offset=r;for(var s=0;o>s;++s){var l=this._intArrayBuffer[r+2+s];n.addBone(this._rawBones[l])}for(var h=r+2+o,c=0,s=0,u=a;u>s;++s){var p=this._intArrayBuffer[h++];c+=p,h+=p}n.count=c,i.weight=n}},i.prototype._parseMesh=function(t,e){this._parseVertices(t,e.vertices)},i.prototype._parsePath=function(t,e){this._parseVertices(t,e.vertices)},i.prototype._parseAnimation=function(e){var i=t.BaseObject.borrowObject(t.AnimationData);i.frameCount=Math.max(t.ObjectDataParser._getNumber(e,t.DataParser.DURATION,1),1),i.playTimes=t.ObjectDataParser._getNumber(e,t.DataParser.PLAY_TIMES,1),i.duration=i.frameCount/this._armature.frameRate,i.fadeInTime=t.ObjectDataParser._getNumber(e,t.DataParser.FADE_IN_TIME,0),i.scale=t.ObjectDataParser._getNumber(e,t.DataParser.SCALE,1),i.name=t.ObjectDataParser._getString(e,t.DataParser.NAME,t.DataParser.DEFAULT_NAME),0===i.name.length&&(i.name=t.DataParser.DEFAULT_NAME);var r=e[t.DataParser.OFFSET];if(i.frameIntOffset=r[0],i.frameFloatOffset=r[1],i.frameOffset=r[2],this._animation=i,t.DataParser.ACTION in e&&(i.actionTimeline=this._parseBinaryTimeline(0,e[t.DataParser.ACTION])),t.DataParser.Z_ORDER in e&&(i.zOrderTimeline=this._parseBinaryTimeline(1,e[t.DataParser.Z_ORDER])),t.DataParser.BONE in e){var n=e[t.DataParser.BONE];for(var a in n){var o=n[a];t.DragonBones.webAssembly&&(a=this._getUTF16Key(a));var s=this._armature.getBone(a);if(null!==s)for(var l=0,h=o.length;h>l;l+=2){var c=o[l],u=o[l+1],p=this._parseBinaryTimeline(c,u);this._animation.addBoneTimeline(s,p)}}}if(t.DataParser.SURFACE in e){var n=e[t.DataParser.SURFACE];for(var a in n){var o=n[a];t.DragonBones.webAssembly&&(a=this._getUTF16Key(a));var d=this._armature.getBone(a);if(null!==d)for(var l=0,h=o.length;h>l;l+=2){var c=o[l],u=o[l+1],p=this._parseBinaryTimeline(c,u);this._animation.addSurfaceTimeline(d,p)}}}if(t.DataParser.SLOT in e){var n=e[t.DataParser.SLOT];for(var a in n){var o=n[a];t.DragonBones.webAssembly&&(a=this._getUTF16Key(a));var f=this._armature.getSlot(a);if(null!==f)for(var l=0,h=o.length;h>l;l+=2){var c=o[l],u=o[l+1],p=this._parseBinaryTimeline(c,u);this._animation.addSlotTimeline(f,p)}}}if(t.DataParser.CONSTRAINT in e){var n=e[t.DataParser.CONSTRAINT];for(var a in n){var o=n[a];t.DragonBones.webAssembly&&(a=this._getUTF16Key(a));var g=this._armature.getConstraint(a);if(null!==g)for(var l=0,h=o.length;h>l;l+=2){var c=o[l],u=o[l+1],p=this._parseBinaryTimeline(c,u);this._animation.addConstraintTimeline(g,p)}}}if(t.DataParser.ANIMATION in e){var n=e[t.DataParser.ANIMATION];for(var a in n){var o=n[a];t.DragonBones.webAssembly&&(a=this._getUTF16Key(a));for(var l=0,h=o.length;h>l;l+=2){var c=o[l],u=o[l+1],p=this._parseBinaryTimeline(c,u);this._animation.addAnimationTimeline(a,p)}}}return this._animation=null,i},i.prototype._parseArray=function(e){var i=e[t.DataParser.OFFSET],r=i[1],n=i[3],a=i[5],o=i[7],s=i[9],l=i[11],h=new Int16Array(this._binary,this._binaryOffset+i[0],r/Int16Array.BYTES_PER_ELEMENT),c=new Float32Array(this._binary,this._binaryOffset+i[2],n/Float32Array.BYTES_PER_ELEMENT),u=new Int16Array(this._binary,this._binaryOffset+i[4],a/Int16Array.BYTES_PER_ELEMENT),p=new Float32Array(this._binary,this._binaryOffset+i[6],o/Float32Array.BYTES_PER_ELEMENT),d=new Int16Array(this._binary,this._binaryOffset+i[8],s/Int16Array.BYTES_PER_ELEMENT),f=new Uint16Array(this._binary,this._binaryOffset+i[10],l/Uint16Array.BYTES_PER_ELEMENT);if(t.DragonBones.webAssembly){for(var g=r+n+a+o+s+l,m=t.webAssemblyModule._malloc(g),y=new Uint8Array(this._binary,this._binaryOffset,g/Uint8Array.BYTES_PER_ELEMENT),v=new Uint8Array(t.webAssemblyModule.HEAP16.buffer,m,y.length),_=0,b=y.length;b>_;++_)v[_]=y[_];t.webAssemblyModule.setDataBinary(this._data,m,r,n,a,o,s,l),this._intArrayBuffer=h,this._floatArrayBuffer=c,this._frameIntArrayBuffer=u,this._frameFloatArrayBuffer=p,this._frameArrayBuffer=d,this._timelineArrayBuffer=f}else this._data.binary=this._binary,this._data.intArray=this._intArrayBuffer=h,this._data.floatArray=this._floatArrayBuffer=c,this._data.frameIntArray=this._frameIntArrayBuffer=u,this._data.frameFloatArray=this._frameFloatArrayBuffer=p,this._data.frameArray=this._frameArrayBuffer=d,this._data.timelineArray=this._timelineArrayBuffer=f},i.prototype.parseDragonBonesData=function(t,i){void 0===i&&(i=1),console.assert(null!==t&&void 0!==t&&t instanceof ArrayBuffer,"Data error.");var r=new Uint8Array(t,0,8);if(r[0]!=="D".charCodeAt(0)||r[1]!=="B".charCodeAt(0)||r[2]!=="D".charCodeAt(0)||r[3]!=="T".charCodeAt(0))return console.assert(!1,"Nonsupport data."),null;var n=new Uint32Array(t,8,1)[0],a=new Uint8Array(t,12,n),o=this._decodeUTF8(a),s=JSON.parse(o);return this._binaryOffset=12+n,this._binary=t,e.prototype.parseDragonBonesData.call(this,s,i)},i.getInstance=function(){return null===i._binaryDataParserInstance&&(i._binaryDataParserInstance=new i),i._binaryDataParserInstance},i._binaryDataParserInstance=null,i}(t.ObjectDataParser);t.BinaryDataParser=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function e(i){void 0===i&&(i=null),this.autoSearch=!1,this._dragonBonesDataMap={},this._textureAtlasDataMap={},this._dragonBones=null,this._dataParser=null,null===e._objectParser&&(e._objectParser=new t.ObjectDataParser),null===e._binaryParser&&(e._binaryParser=new t.BinaryDataParser),this._dataParser=null!==i?i:e._objectParser}return e.prototype._isSupportMesh=function(){return!0},e.prototype._getTextureData=function(t,e){if(t in this._textureAtlasDataMap)for(var i=0,r=this._textureAtlasDataMap[t];i<r.length;i++){var n=r[i],a=n.getTexture(e);if(null!==a)return a}if(this.autoSearch)for(var o in this._textureAtlasDataMap)for(var s=0,l=this._textureAtlasDataMap[o];s<l.length;s++){var n=l[s];if(n.autoSearch){var a=n.getTexture(e);if(null!==a)return a}}return null},e.prototype._fillBuildArmaturePackage=function(t,e,i,r,n){var a=null,o=null;if(e.length>0&&e in this._dragonBonesDataMap&&(a=this._dragonBonesDataMap[e],o=a.getArmature(i)),null===o&&(0===e.length||this.autoSearch))for(var s in this._dragonBonesDataMap)if(a=this._dragonBonesDataMap[s],(0===e.length||a.autoSearch)&&(o=a.getArmature(i),null!==o)){e=s;break}if(null!==o){if(t.dataName=e,t.textureAtlasName=n,t.data=a,t.armature=o,t.skin=null,r.length>0&&(t.skin=o.getSkin(r),null===t.skin&&this.autoSearch))for(var s in this._dragonBonesDataMap){var l=this._dragonBonesDataMap[s],h=l.getArmature(r);if(null!==h){t.skin=h.defaultSkin;break}}return null===t.skin&&(t.skin=o.defaultSkin),!0}return!1},e.prototype._buildBones=function(e,i){for(var r=0,n=e.armature.sortedBones;r<n.length;r++){var a=n[r],o=t.BaseObject.borrowObject(0===a.type?t.Bone:t.Surface);o.init(a,i)}},e.prototype._buildSlots=function(e,i){var r=e.skin,n=e.armature.defaultSkin;if(null!==r&&null!==n){var a={};for(var o in n.displays){var s=n.getDisplays(o);a[o]=s}if(r!==n)for(var o in r.displays){var s=r.getDisplays(o);a[o]=s}for(var l=0,h=e.armature.sortedSlots;l<h.length;l++){var c=h[l],u=c.name in a?a[c.name]:null,p=this._buildSlot(e,c,i);if(p.rawDisplayDatas=u,null!==u){for(var d=new Array,f=0,g=t.DragonBones.webAssembly?u.size():u.length;g>f;++f){var m=t.DragonBones.webAssembly?u.get(f):u[f];null!==m?d.push(this._getSlotDisplay(e,m,null,p)):d.push(null)}p._setDisplayList(d)}p._setDisplayIndex(c.displayIndex,!0)}}},e.prototype._buildConstraints=function(e,i){var r=e.armature.constraints;for(var n in r){var a=r[n];switch(a.type){case 0:var o=t.BaseObject.borrowObject(t.IKConstraint);o.init(a,i),i._addConstraint(o);break;case 1:var s=t.BaseObject.borrowObject(t.PathConstraint);s.init(a,i),i._addConstraint(s);break;default:var l=t.BaseObject.borrowObject(t.IKConstraint);l.init(a,i),i._addConstraint(l)}}},e.prototype._buildChildArmature=function(t,e,i){return this.buildArmature(i.path,null!==t?t.dataName:"","",null!==t?t.textureAtlasName:"")},e.prototype._getSlotDisplay=function(e,i,r,n){var a=null!==e?e.dataName:i.parent.parent.parent.name,o=null;switch(i.type){case 0:var s=i;null===s.texture?s.texture=this._getTextureData(a,i.path):null!==e&&e.textureAtlasName.length>0&&(s.texture=this._getTextureData(e.textureAtlasName,i.path)),o=null!==r&&2===r.type&&this._isSupportMesh()?n.meshDisplay:n.rawDisplay;break;case 2:var l=i;null===l.texture?l.texture=this._getTextureData(a,l.path):null!==e&&e.textureAtlasName.length>0&&(l.texture=this._getTextureData(e.textureAtlasName,l.path)),o=this._isSupportMesh()?n.meshDisplay:n.rawDisplay;break;case 1:var h=i,c=this._buildChildArmature(e,n,i);
if(null!==c){if(c.inheritAnimation=h.inheritAnimation,!c.inheritAnimation){var u=h.actions.length>0?h.actions:c.armatureData.defaultActions;if(u.length>0)for(var p=0,d=u;p<d.length;p++){var f=d[p],g=t.BaseObject.borrowObject(t.EventObject);t.EventObject.actionDataToInstance(f,g,n.armature),g.slot=n,n.armature._bufferAction(g,!1)}else c.animation.play()}h.armature=c.armatureData}o=c;break;case 3:}return o},e.prototype.parseDragonBonesData=function(t,i,r){void 0===i&&(i=null),void 0===r&&(r=1);for(var n=t instanceof ArrayBuffer?e._binaryParser:this._dataParser,a=n.parseDragonBonesData(t,r);;){var o=this._buildTextureAtlasData(null,null);if(!n.parseTextureAtlasData(null,o,r)){o.returnToPool();break}this.addTextureAtlasData(o,i)}return null!==a&&this.addDragonBonesData(a,i),a},e.prototype.parseTextureAtlasData=function(t,e,i,r){void 0===i&&(i=null),void 0===r&&(r=1);var n=this._buildTextureAtlasData(null,null);return this._dataParser.parseTextureAtlasData(t,n,r),this._buildTextureAtlasData(n,e||null),this.addTextureAtlasData(n,i),n},e.prototype.updateTextureAtlasData=function(t,e){var i=this.getTextureAtlasData(t);if(null!==i)for(var r=0,n=i.length;n>r;++r)r<e.length&&this._buildTextureAtlasData(i[r],e[r])},e.prototype.getDragonBonesData=function(t){return t in this._dragonBonesDataMap?this._dragonBonesDataMap[t]:null},e.prototype.addDragonBonesData=function(t,e){if(void 0===e&&(e=null),e=null!==e?e:t.name,e in this._dragonBonesDataMap){if(this._dragonBonesDataMap[e]===t)return;return void console.warn("Can not add same name data: "+e)}this._dragonBonesDataMap[e]=t},e.prototype.removeDragonBonesData=function(t,e){void 0===e&&(e=!0),t in this._dragonBonesDataMap&&(e&&this._dragonBones.bufferObject(this._dragonBonesDataMap[t]),delete this._dragonBonesDataMap[t])},e.prototype.getTextureAtlasData=function(t){return t in this._textureAtlasDataMap?this._textureAtlasDataMap[t]:null},e.prototype.addTextureAtlasData=function(t,e){void 0===e&&(e=null),e=null!==e?e:t.name;var i=e in this._textureAtlasDataMap?this._textureAtlasDataMap[e]:this._textureAtlasDataMap[e]=[];i.indexOf(t)<0&&i.push(t)},e.prototype.removeTextureAtlasData=function(t,e){if(void 0===e&&(e=!0),t in this._textureAtlasDataMap){var i=this._textureAtlasDataMap[t];if(e)for(var r=0,n=i;r<n.length;r++){var a=n[r];this._dragonBones.bufferObject(a)}delete this._textureAtlasDataMap[t]}},e.prototype.getArmatureData=function(t,e){void 0===e&&(e="");var r=new i;return this._fillBuildArmaturePackage(r,e,t,"","")?r.armature:null},e.prototype.clear=function(t){void 0===t&&(t=!0);for(var e in this._dragonBonesDataMap)t&&this._dragonBones.bufferObject(this._dragonBonesDataMap[e]),delete this._dragonBonesDataMap[e];for(var e in this._textureAtlasDataMap){if(t)for(var i=this._textureAtlasDataMap[e],r=0,n=i;r<n.length;r++){var a=n[r];this._dragonBones.bufferObject(a)}delete this._textureAtlasDataMap[e]}},e.prototype.buildArmature=function(t,e,r,n){void 0===e&&(e=""),void 0===r&&(r=""),void 0===n&&(n="");var a=new i;if(!this._fillBuildArmaturePackage(a,e||"",t,r||"",n||""))return console.warn("No armature data: "+t+", "+(null!==e?e:"")),null;var o=this._buildArmature(a);return this._buildBones(a,o),this._buildSlots(a,o),this._buildConstraints(a,o),o.invalidUpdate(null,!0),o.advanceTime(0),o},e.prototype.replaceDisplay=function(e,i,r){void 0===r&&(r=-1),0>r&&(r=e.displayIndex),0>r&&(r=0),e.replaceDisplayData(i,r);var n=e.displayList;if(n.length<=r){n.length=r+1;for(var a=0,o=n.length;o>a;++a)n[a]||(n[a]=null)}if(null!==i){var s=e.rawDisplayDatas,l=null;s&&(t.DragonBones.webAssembly?r<s.size()&&(l=s.get(r)):r<s.length&&(l=s[r])),n[r]=this._getSlotDisplay(null,i,l,e)}else n[r]=null;e.displayList=n},e.prototype.replaceSlotDisplay=function(t,e,i,r,n,a){void 0===a&&(a=-1);var o=this.getArmatureData(e,t||"");if(!o||!o.defaultSkin)return!1;var s=o.defaultSkin.getDisplay(i,r);return s?(this.replaceDisplay(n,s,a),!0):!1},e.prototype.replaceSlotDisplayList=function(e,i,r,n){var a=this.getArmatureData(i,e||"");if(!a||!a.defaultSkin)return!1;var o=a.defaultSkin.getDisplays(r);if(!o)return!1;for(var s=0,l=0,h=t.DragonBones.webAssembly?o.size():o.length;h>l;++l){var c=t.DragonBones.webAssembly?o.get(l):o[l];this.replaceDisplay(n,c,s++)}return!0},e.prototype.replaceSkin=function(e,i,r,n){void 0===r&&(r=!1),void 0===n&&(n=null);for(var a=!1,o=i.parent.defaultSkin,s=0,l=e.getSlots();s<l.length;s++){var h=l[s];if(!(null!==n&&n.indexOf(h.name)>=0)){var c=i.getDisplays(h.name);if(c||(null!==o&&i!==o&&(c=o.getDisplays(h.name)),c)){var u=t.DragonBones.webAssembly?c.size():c.length,p=h.displayList;p.length=u;for(var d=0,f=u;f>d;++d){var g=t.DragonBones.webAssembly?c.get(d):c[d];null!==g?p[d]=this._getSlotDisplay(null,g,null,h):p[d]=null}a=!0,h.rawDisplayDatas=c,h.displayList=p}else r&&(h.rawDisplayDatas=null,h.displayList=[])}}return a},e.prototype.replaceAnimation=function(e,i,r){void 0===r&&(r=!0);var n=i.defaultSkin;if(null===n)return!1;if(r)e.animation.animations=i.animations;else{var a=e.animation.animations,o={};for(var s in a)o[s]=a[s];for(var s in i.animations)o[s]=i.animations[s];e.animation.animations=o}for(var l=0,h=e.getSlots();l<h.length;l++)for(var c=h[l],u=0,p=0,d=c.displayList;p<d.length;p++){var f=d[p];if(f instanceof t.Armature){var g=n.getDisplays(c.name);if(null!==g&&u<(t.DragonBones.webAssembly?g.size():g.length)){var m=t.DragonBones.webAssembly?g.get(u):g[u];if(null!==m&&1===m.type){var y=this.getArmatureData(m.path,m.parent.parent.parent.name);y&&this.replaceAnimation(f,y,r)}}}u++}return!0},e.prototype.getAllDragonBonesData=function(){return this._dragonBonesDataMap},e.prototype.getAllTextureAtlasData=function(){return this._textureAtlasDataMap},Object.defineProperty(e.prototype,"clock",{get:function(){return this._dragonBones.clock},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dragonBones",{get:function(){return this._dragonBones},enumerable:!0,configurable:!0}),e.prototype.changeSkin=function(t,e,i){return void 0===i&&(i=null),this.replaceSkin(t,e,!1,i)},e.prototype.copyAnimationsToArmature=function(t,e,i,r,n){void 0===i&&(i=""),void 0===r&&(r=""),void 0===n&&(n=!0);var a=this.getArmatureData(e,r);return a?this.replaceAnimation(t,a,n):!1},e._objectParser=null,e._binaryParser=null,e}();t.BaseFactory=e;var i=function(){function t(){this.dataName="",this.textureAtlasName="",this.skin=null}return t}();t.BuildArmaturePackage=i}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function r(){var t=null!==e&&e.apply(this,arguments)||this;return t._renderTexture=null,t}return __extends(r,e),r.toString=function(){return"[class dragonBones.EgretTextureAtlasData]"},r.prototype._onClear=function(){e.prototype._onClear.call(this),this.disposeEnabled&&null!==this._renderTexture&&this._renderTexture.dispose(),this.disposeEnabled=!1,this._renderTexture=null},r.prototype.createTexture=function(){return t.BaseObject.borrowObject(i)},Object.defineProperty(r.prototype,"renderTexture",{get:function(){return this._renderTexture},set:function(t){if(this._renderTexture!==t)if(this._renderTexture=t,null!==this._renderTexture){var e=this._renderTexture.bitmapData,i=this.width>0?this.width:e.width,r=this.height>0?this.height:e.height;for(var n in this.textures){var a=egret.$TextureScaleFactor,o=this.textures[n],s=o.region.width,l=o.region.height;null===o.renderTexture&&(o.renderTexture=new egret.Texture),o.renderTexture.bitmapData=e,o.rotated?o.renderTexture.$initData(o.region.x*a,o.region.y*a,l*a,s*a,0,0,l*a,s*a,i,r,o.rotated):o.renderTexture.$initData(o.region.x*a,o.region.y*a,s*a,l*a,0,0,s*a,l*a,i,r)}}else for(var n in this.textures){var o=this.textures[n];o.renderTexture=null}},enumerable:!0,configurable:!0}),r.prototype.dispose=function(){console.warn("已废弃。"),this.returnToPool()},Object.defineProperty(r.prototype,"texture",{get:function(){return console.warn("已废弃。"),this.renderTexture},enumerable:!0,configurable:!0}),r}(t.TextureAtlasData);t.EgretTextureAtlasData=e;var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.renderTexture=null,e}return __extends(e,t),e.toString=function(){return"[class dragonBones.EgretTextureData]"},e.prototype._onClear=function(){t.prototype._onClear.call(this),null!==this.renderTexture,this.renderTexture=null},e}(t.TextureData);t.EgretTextureData=i}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return __extends(i,e),Object.defineProperty(i.prototype,"eventObject",{get:function(){return this.data},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"animationName",{get:function(){var t=this.eventObject.animationState;return null!==t?t.name:""},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"armature",{get:function(){return this.eventObject.armature},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"bone",{get:function(){return this.eventObject.bone},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"slot",{get:function(){return this.eventObject.slot},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"animationState",{get:function(){return this.eventObject.animationState},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"frameLabel",{get:function(){return this.eventObject.name},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"sound",{get:function(){return this.eventObject.name},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"movementID",{get:function(){return this.animationName},enumerable:!0,configurable:!0}),i.START=t.EventObject.START,i.LOOP_COMPLETE=t.EventObject.LOOP_COMPLETE,i.COMPLETE=t.EventObject.COMPLETE,i.FADE_IN=t.EventObject.FADE_IN,i.FADE_IN_COMPLETE=t.EventObject.FADE_IN_COMPLETE,i.FADE_OUT=t.EventObject.FADE_OUT,i.FADE_OUT_COMPLETE=t.EventObject.FADE_OUT_COMPLETE,i.FRAME_EVENT=t.EventObject.FRAME_EVENT,i.SOUND_EVENT=t.EventObject.SOUND_EVENT,i.ANIMATION_FRAME_EVENT=t.EventObject.FRAME_EVENT,i.BONE_FRAME_EVENT=t.EventObject.FRAME_EVENT,i.MOVEMENT_FRAME_EVENT=t.EventObject.FRAME_EVENT,i.SOUND=t.EventObject.SOUND_EVENT,i}(egret.Event);t.EgretEvent=e;var i=function(i){function r(){var t=null!==i&&i.apply(this,arguments)||this;return t.debugDraw=!1,t._batchEnabled=!(global.nativeRender||global.bricks),t._childDirty=!0,t._debugDraw=!1,t._armature=null,t._bounds=null,t._debugDrawer=null,t}return __extends(r,i),r._cleanBeforeRender=function(){},r.prototype.dbInit=function(t){this._armature=t,this._batchEnabled&&(this.$renderNode=new egret.sys.GroupNode,this.$renderNode.cleanBeforeRender=r._cleanBeforeRender)},r.prototype.dbClear=function(){this._armature=null,this._bounds=null,this._debugDrawer=null},r.prototype.dbUpdate=function(){var e=t.DragonBones.debugDraw||this.debugDraw;if(e||this._debugDraw)if(this._debugDraw=e,this._debugDraw){null===this._debugDrawer&&(this._debugDrawer=new egret.Sprite),this._debugDrawer.parent!==this&&this.addChild(this._debugDrawer);var i=2,r=this._debugDrawer.graphics;r.clear();for(var n=0,a=this._armature.getBones();n<a.length;n++){var o=a[n];if(0===o.boneData.type){var s=Math.max(o.boneData.length,i),l=o.globalTransformMatrix.tx,h=o.globalTransformMatrix.ty,c=l-o.globalTransformMatrix.a*i,u=h-o.globalTransformMatrix.b*i,p=l+o.globalTransformMatrix.a*s,d=h+o.globalTransformMatrix.b*s,f=l+u-h,g=h+c-l,m=l-u+h,y=h-c+l;r.lineStyle(2,65535,.7),r.moveTo(c,u),r.lineTo(p,d),r.moveTo(f,g),r.lineTo(m,y)}else{var v=o,_=v._boneData,b=_.segmentX,x=_.segmentY,T=v._vertices;r.lineStyle(2,16776960,.7);for(var E=0;x>E;++E)for(var S=0;b>S;++S){var C=2*(S+E*(b+1)),w=T[C],P=T[C+1];r.moveTo(w,P),r.lineTo(T[C+2],T[C+3]),r.moveTo(w,P),r.lineTo(T[C+2*(b+1)],T[C+2*(b+1)+1]),S===b-1&&(r.moveTo(T[C+2],T[C+3]),r.lineTo(T[C+2*(b+2)],T[C+2*(b+2)+1])),E===x-1&&(r.moveTo(T[C+2*(b+1)],T[C+2*(b+1)+1]),r.lineTo(T[C+2*(b+2)],T[C+2*(b+2)+1]))}}}for(var D=0,A=this._armature.getSlots();D<A.length;D++){var I=A[D],M=I.boundingBoxData;if(null!==M){var $=this._debugDrawer.getChildByName(I.name);switch(null===$&&($=new egret.Shape,$.name=I.name,this._debugDrawer.addChild($)),$.graphics.clear(),$.graphics.lineStyle(2,16711935,.7),M.type){case 0:$.graphics.drawRect(.5*-M.width,.5*-M.height,M.width,M.height);break;case 1:$.graphics.drawEllipse(.5*-M.width,.5*-M.height,M.width,M.height);break;case 2:for(var T=M.vertices,O=0;O<T.length;O+=2){var w=T[O],P=T[O+1];0===O?$.graphics.moveTo(w,P):$.graphics.lineTo(w,P)}$.graphics.lineTo(T[0],T[1])}I.updateTransformAndMatrix(),I.updateGlobalTransform(),$.$setMatrix(I.globalTransformMatrix,!1)}else{var $=this._debugDrawer.getChildByName(I.name);null!==$&&this._debugDrawer.removeChild($)}}}else null!==this._debugDrawer&&this._debugDrawer.parent===this&&this.removeChild(this._debugDrawer);!t.isV5&&this._batchEnabled&&this._childDirty&&this.$invalidateContentBounds()},r.prototype.dispose=function(t){void 0===t&&(t=!0),null!==this._armature&&(this._armature.dispose(),this._armature=null)},r.prototype.dispatchDBEvent=function(t,r){var n=egret.Event.create(e,t);n.data=r,i.prototype.dispatchEvent.call(this,n),egret.Event.release(n)},r.prototype.hasDBEventListener=function(t){return this.hasEventListener(t)},r.prototype.addDBEventListener=function(t,e,i){this.addEventListener(t,e,i)},r.prototype.removeDBEventListener=function(t,e,i){this.removeEventListener(t,e,i)},r.prototype.disableBatch=function(){if(this._batchEnabled&&this._armature){for(var t=0,e=this._armature.getSlots();t<e.length;t++){var i=e[t],r=i._deformVertices&&i._deformVertices.verticesData?i.meshDisplay:i.rawDisplay;i.display||r!==i.meshDisplay||(r=i.rawDisplay);var n=r.$renderNode;n.matrix&&r.$setMatrix(i.globalTransformMatrix,!1),this.addChild(r)}this._batchEnabled=!1,this.$renderNode.cleanBeforeRender=null,this.$renderNode=null,this.armature.invalidUpdate(null,!0)}},Object.defineProperty(r.prototype,"armature",{get:function(){return this._armature},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"animation",{get:function(){return this._armature.animation},enumerable:!0,configurable:!0}),r.prototype.$measureContentBounds=function(e){if(this._batchEnabled&&this._armature){if(this._childDirty){this._childDirty=!1;for(var r=!0,n=new egret.Rectangle,a=0,o=this._armature.getSlots();a<o.length;a++){var s=o[a],l=s.display;if(l&&l.$renderNode&&l.$renderNode.image){var h=l.$renderNode.matrix;if(l===s.meshDisplay){var c=l.$renderNode.vertices;if(!(c&&c.length>0))continue;n.setTo(999999,999999,-999999,-999999);for(var u=0,p=c.length;p>u;u+=2){var d=c[u],f=c[u+1];n.x>d&&(n.x=d),n.width<d&&(n.width=d),n.y>f&&(n.y=f),n.height<f&&(n.height=f)}n.width-=n.x,n.height-=n.y}else{var g=s.displayData;if(!(g&&g instanceof t.ImageDisplayData&&g.texture))continue;var m=g.texture.parent.scale;n.x=0,n.y=0,n.width=g.texture.region.width*m,n.height=g.texture.region.height*m}h.$transformBounds(n);var y=n.x,v=n.y,_=n.x+n.width,b=n.y+n.height;r?(r=!1,e.x=y,e.y=v,e.width=_,e.height=b):(y<e.x&&(e.x=y),v<e.y&&(e.y=v),_>e.width&&(e.width=_),b>e.height&&(e.height=b))}}e.width-=e.x,e.height-=e.y,t.isV5&&(null===this._bounds&&(this._bounds=new egret.Rectangle),this._bounds.copyFrom(e))}else t.isV5&&(null===this._bounds&&(this._bounds=new egret.Rectangle),e.copyFrom(this._bounds));return e}return i.prototype.$measureContentBounds.call(this,e)},r.prototype.hasEvent=function(t){return this.hasDBEventListener(t)},r.prototype.addEvent=function(t,e,i){this.addDBEventListener(t,e,i)},r.prototype.removeEvent=function(t,e,i){this.removeDBEventListener(t,e,i)},r.prototype.advanceTimeBySelf=function(e){e?this._armature.clock=t.EgretFactory.factory.clock:this._armature.clock=null},r}(egret.DisplayObjectContainer);t.EgretArmatureDisplay=i;var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(e);t.Event=r;var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(e);t.ArmatureEvent=n;var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(e);t.AnimationEvent=a;var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(e);t.FrameEvent=o;var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(e);t.SoundEvent=s;var l=function(e){function i(i,r,n){void 0===n&&(n=1);var a=e.call(this)||this;return console.warn("已废弃"),a._onClear(),t.ObjectDataParser.getInstance().parseTextureAtlasData(r,a,n),a.renderTexture=i,a}return __extends(i,e),i.toString=function(){return"[class dragonBones.EgretTextureAtlas]"},i}(t.EgretTextureAtlasData);t.EgretTextureAtlas=l;var h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(l);t.EgretSheetAtlas=h;var c=function(){function e(){}return e.getInstance=function(){return console.warn("已废弃"),t.EgretFactory.factory.soundEventManager},e}();t.SoundEventManager=c;var u=function(){function t(){console.warn("已废弃")}return t}();t.AnimationCacheManager=u}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.transformUpdateEnabled=!1,t._armatureDisplay=null,t._renderDisplay=null,t._colorFilter=null,t}return __extends(i,e),i.toString=function(){return"[class dragonBones.EgretSlot]"},i.prototype.init=function(i,r,n,a){e.prototype.init.call(this,i,r,n,a),t.isV5?this._updateTransform=this._updateTransformV5:this._updateTransform=this._updateTransformV4},i.prototype._onClear=function(){e.prototype._onClear.call(this),this._armatureDisplay=null,this._renderDisplay=null,this._colorFilter=null},i.prototype._initDisplay=function(t,e){},i.prototype._disposeDisplay=function(t,e){},i.prototype._onUpdateDisplay=function(){if(this._armatureDisplay=this._armature.display,this._renderDisplay=null!==this._display?this._display:this._rawDisplay,t.isV5&&this._armatureDisplay._batchEnabled&&(this._renderDisplay!==this._rawDisplay||this._renderDisplay.$renderNode instanceof egret.sys.BitmapNode||(this._renderDisplay.$renderNode=new egret.sys.BitmapNode)),this._armatureDisplay._batchEnabled)if(this._renderDisplay!==this._rawDisplay&&this._renderDisplay!==this._meshDisplay)this._armatureDisplay.disableBatch();else{var e=this._renderDisplay.$renderNode;e.matrix||(e.matrix=new egret.Matrix)}},i.prototype._addDisplay=function(){this._armatureDisplay._batchEnabled?this._armatureDisplay.$renderNode.addNode(this._renderDisplay.$renderNode):this._armatureDisplay.addChild(this._renderDisplay)},i.prototype._replaceDisplay=function(t){var e=t;if(this._armatureDisplay._batchEnabled){var i=this._armatureDisplay.$renderNode.drawData;i[i.indexOf(e.$renderNode)]=this._renderDisplay.$renderNode}else this._armatureDisplay.addChild(this._renderDisplay),this._armatureDisplay.swapChildren(this._renderDisplay,e),this._armatureDisplay.removeChild(e)},i.prototype._removeDisplay=function(){if(this._armatureDisplay._batchEnabled){var t=this._armatureDisplay.$renderNode.drawData;t.splice(t.indexOf(this._renderDisplay.$renderNode),1)}else this._renderDisplay.parent.removeChild(this._renderDisplay)},i.prototype._updateZOrder=function(){if(this._armatureDisplay._batchEnabled){var t=this._armatureDisplay.$renderNode.drawData;t[this._zOrder]=this._renderDisplay.$renderNode}else{var e=this._armatureDisplay.getChildIndex(this._renderDisplay);if(e===this._zOrder)return;this._armatureDisplay.addChildAt(this._renderDisplay,this._zOrder)}},i.prototype._updateVisible=function(){var t=this._parent.visible&&this._visible;if(this._armatureDisplay._batchEnabled){var e=this._renderDisplay.$renderNode;e.alpha=t?1:0}else this._renderDisplay.visible=t},i.prototype._updateBlendMode=function(){switch(this._blendMode){case 0:this._renderDisplay.blendMode=egret.BlendMode.NORMAL;break;case 1:this._renderDisplay.blendMode=egret.BlendMode.ADD;break;case 5:this._renderDisplay.blendMode=egret.BlendMode.ERASE}if(this._armatureDisplay._batchEnabled){var t=this._renderDisplay.$renderNode;t.blendMode=egret.sys.blendModeToNumber(this._renderDisplay.blendMode)}},i.prototype._updateColor=function(){if(1!==this._colorTransform.redMultiplier||1!==this._colorTransform.greenMultiplier||1!==this._colorTransform.blueMultiplier||0!==this._colorTransform.redOffset||0!==this._colorTransform.greenOffset||0!==this._colorTransform.blueOffset||0!==this._colorTransform.alphaOffset){null===this._colorFilter&&(this._colorFilter=new egret.ColorMatrixFilter);var t=this._colorFilter.matrix;if(t[0]=this._colorTransform.redMultiplier,t[6]=this._colorTransform.greenMultiplier,t[12]=this._colorTransform.blueMultiplier,t[18]=this._colorTransform.alphaMultiplier,t[4]=this._colorTransform.redOffset,t[9]=this._colorTransform.greenOffset,t[14]=this._colorTransform.blueOffset,t[19]=this._colorTransform.alphaOffset,this._colorFilter.matrix=t,this._armatureDisplay._batchEnabled){var e=this._renderDisplay.$renderNode;e.filter=this._colorFilter,e.alpha=1}var i=this._renderDisplay.filters;i||(i=[]),i.indexOf(this._colorFilter)<0&&i.push(this._colorFilter),this._renderDisplay.filters=i,this._renderDisplay.alpha=1}else{if(this._armatureDisplay._batchEnabled){var e=this._renderDisplay.$renderNode;e.filter=null,e.alpha=this._colorTransform.alphaMultiplier}this._renderDisplay.filters=null,this._renderDisplay.alpha=this._colorTransform.alphaMultiplier}},i.prototype._updateFrame=function(){var e=null!==this._deformVertices&&this._display===this._meshDisplay?this._deformVertices.verticesData:null,i=this._textureData;if(this._displayIndex>=0&&null!==this._display&&null!==i){if(null!==this._armature.replacedTexture&&null!==this._rawDisplayDatas&&this._rawDisplayDatas.indexOf(this._displayData)>=0){var r=i.parent;null===this._armature._replaceTextureAtlasData?(r=t.BaseObject.borrowObject(t.EgretTextureAtlasData),r.copyFrom(i.parent),r.renderTexture=this._armature.replacedTexture,this._armature._replaceTextureAtlasData=r):r=this._armature._replaceTextureAtlasData,i=r.getTexture(i.name)}if(null!==i.renderTexture){if(null!==e){var n=e.data,a=n.intArray,o=n.floatArray,s=a[e.offset+0],l=a[e.offset+1],h=a[e.offset+2];0>h&&(h+=65536);var c=h+2*s,u=this._armature._armatureData.scale,p=this._renderDisplay,d=p.$renderNode;d.uvs.length=2*s,d.vertices.length=2*s,d.indices.length=3*l;for(var f=0,g=2*s;g>f;++f)d.vertices[f]=o[h+f]*u,d.uvs[f]=o[c+f];for(var f=0;3*l>f;++f)d.indices[f]=a[e.offset+4+f];if(this._armatureDisplay._batchEnabled){var m=i.renderTexture,y=this._renderDisplay.$renderNode;if(egret.sys.RenderNode.prototype.cleanBeforeRender.call(y),y.image=m.bitmapData,t.isV5)y.drawMesh(m.$bitmapX,m.$bitmapY,m.$bitmapWidth,m.$bitmapHeight,m.$offsetX,m.$offsetY,m.textureWidth,m.textureHeight),y.imageWidth=m.$sourceWidth,y.imageHeight=m.$sourceHeight;else{var v=m;y.drawMesh(v._bitmapX,v._bitmapY,v._bitmapWidth,v._bitmapHeight,v._offsetX,v._offsetY,v.textureWidth,v.textureHeight),y.imageWidth=v._sourceWidth,y.imageHeight=v._sourceHeight}this._blendModeDirty=!0,this._colorDirty=!0}p.texture=i.renderTexture,p.anchorOffsetX=this._pivotX,p.anchorOffsetY=this._pivotY,p.$updateVertices(),t.isV5||p.$invalidateTransform();var _=null!==e.weight,b=0!==this._parent._boneData.type;(_||b)&&this._identityTransform()}else{var u=i.parent.scale*this._armature._armatureData.scale,x=(i.rotated?i.region.height:i.region.width)*u,T=(i.rotated?i.region.width:i.region.height)*u,E=this._renderDisplay,m=i.renderTexture;if(E.texture=m,this._armatureDisplay._batchEnabled){var y=this._renderDisplay.$renderNode;if(egret.sys.RenderNode.prototype.cleanBeforeRender.call(y),y.image=m.bitmapData,t.isV5)y.drawImage(m.$bitmapX,m.$bitmapY,m.$bitmapWidth,m.$bitmapHeight,m.$offsetX,m.$offsetY,x,T),y.imageWidth=m.$sourceWidth,y.imageHeight=m.$sourceHeight;else{var v=m;y.drawImage(v._bitmapX,v._bitmapY,v._bitmapWidth,v._bitmapHeight,v._offsetX,v._offsetY,x,T),y.imageWidth=v._sourceWidth,y.imageHeight=v._sourceHeight}this._blendModeDirty=!0,this._colorDirty=!0}else E.width=x,E.height=T;E.anchorOffsetX=this._pivotX,E.anchorOffsetY=this._pivotY}return void(this._visibleDirty=!0)}}this._armatureDisplay._batchEnabled&&(this._renderDisplay.$renderNode.image=null);var S=this._renderDisplay;S.texture=null,S.x=0,S.y=0,S.visible=!1},i.prototype._updateMesh=function(){var e=this._armature._armatureData.scale,i=this._deformVertices.vertices,r=this._deformVertices.bones,n=this._deformVertices.verticesData,a=n.weight,o=i.length>0&&n.inheritDeform,s=this._renderDisplay,l=s.$renderNode;if(null!==a){var h=n.data,c=h.intArray,u=h.floatArray,p=c[n.offset+0],d=c[a.offset+1];0>d&&(d+=65536);for(var f=0,g=0,m=a.offset+2+r.length,y=d,v=0;p>f;++f){for(var _=c[m++],b=0,x=0,T=0;_>T;++T){var E=c[m++],S=r[E];if(null!==S){var C=S.globalTransformMatrix,w=u[y++],P=u[y++]*e,D=u[y++]*e;o&&(P+=i[v++],D+=i[v++]),b+=(C.a*P+C.c*D+C.tx)*w,x+=(C.b*P+C.d*D+C.ty)*w}}l.vertices[g++]=b,l.vertices[g++]=x}s.$updateVertices(),t.isV5||s.$invalidateTransform()}else if(o){var A=0!==this._parent._boneData.type,h=n.data,c=h.intArray,u=h.floatArray,p=c[n.offset+0],I=c[n.offset+2];0>I&&(I+=65536);for(var f=0,M=2*p;M>f;f+=2){var $=u[I+f]*e+i[f],O=u[I+f+1]*e+i[f+1];if(A){var C=this._parent._getGlobalTransformMatrix($,O);l.vertices[f]=C.a*$+C.c*O+C.tx,l.vertices[f+1]=C.b*$+C.d*O+C.ty}else l.vertices[f]=$,l.vertices[f+1]=O}s.$updateVertices(),t.isV5||s.$invalidateTransform()}this._armatureDisplay._batchEnabled&&(this._armatureDisplay._childDirty=!0)},i.prototype._updateGlueMesh=function(){},i.prototype._updateTransform=function(){throw new Error},i.prototype._identityTransform=function(){if(this._armatureDisplay._batchEnabled){this._armatureDisplay._childDirty=!0;var t=this._renderDisplay.$renderNode.matrix;t.a=1,t.b=0,t.c=0,t.d=1,t.tx=0,t.ty=0}else egret.$TempMatrix.identity(),this._renderDisplay.$setMatrix(egret.$TempMatrix,this.transformUpdateEnabled)},i.prototype._updateTransformV4=function(){var t=this.globalTransformMatrix;if(this._armatureDisplay._batchEnabled){this._armatureDisplay._childDirty=!0;var e=this._renderDisplay.$renderNode.matrix;e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e.tx=this.globalTransformMatrix.tx-(this.globalTransformMatrix.a*this._pivotX+this.globalTransformMatrix.c*this._pivotY),e.ty=this.globalTransformMatrix.ty-(this.globalTransformMatrix.b*this._pivotX+this.globalTransformMatrix.d*this._pivotY)}else if(this.transformUpdateEnabled)this._renderDisplay.$setMatrix(t,!0);else{var i=this._renderDisplay.$DisplayObject,e=i[6];e.a=this.globalTransformMatrix.a,e.b=this.globalTransformMatrix.b,e.c=this.globalTransformMatrix.c,e.d=this.globalTransformMatrix.d,e.tx=this.globalTransformMatrix.tx,e.ty=this.globalTransformMatrix.ty,this._renderDisplay.$removeFlags(8),this._renderDisplay.$invalidatePosition()}},i.prototype._updateTransformV5=function(){var t=this.globalTransformMatrix;if(this._armatureDisplay._batchEnabled){this._armatureDisplay._childDirty=!0;var e=this._renderDisplay.$renderNode.matrix;e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e.tx=this.globalTransformMatrix.tx-(this.globalTransformMatrix.a*this._pivotX+this.globalTransformMatrix.c*this._pivotY),e.ty=this.globalTransformMatrix.ty-(this.globalTransformMatrix.b*this._pivotX+this.globalTransformMatrix.d*this._pivotY)}else this._renderDisplay.$setMatrix(t,this.transformUpdateEnabled)},i}(t.Slot);t.EgretSlot=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){t.isV5=Number(egret.Capabilities.engineVersion.substr(0,3))>=5.1;var e=function(e){function i(r){void 0===r&&(r=null);var n=e.call(this,r)||this;if(null===i._dragonBonesInstance){var a=new t.EgretArmatureDisplay;i._dragonBonesInstance=new t.DragonBones(a),i._time=.001*egret.getTimer(),egret.startTick(i._clockHandler,i)}return n._dragonBones=i._dragonBonesInstance,n}return __extends(i,e),i._clockHandler=function(t){t*=.001;var e=t-this._time;return i._dragonBonesInstance.advanceTime(e),this._time=t,!1},Object.defineProperty(i,"factory",{get:function(){return null===i._factory&&(i._factory=new i),i._factory},enumerable:!0,configurable:!0}),i.prototype._isSupportMesh=function(){return"webgl"===egret.Capabilities.renderMode||egret.Capabilities.runtimeType===egret.RuntimeType.NATIVE?!0:(console.warn("Canvas can not support mesh, please change renderMode to webgl."),!1)},i.prototype._buildTextureAtlasData=function(e,i){if(null!==e)if(i instanceof egret.Texture)e.renderTexture=i;else{var r=new egret.Texture;r.bitmapData=new egret.BitmapData(i),e.disposeEnabled=!0,e.renderTexture=r}else e=t.BaseObject.borrowObject(t.EgretTextureAtlasData);return e},i.prototype._buildArmature=function(e){var i=t.BaseObject.borrowObject(t.Armature),r=new t.EgretArmatureDisplay;return i.init(e.armature,r,r,this._dragonBones),i},i.prototype._buildSlot=function(e,i,r){var n=t.BaseObject.borrowObject(t.EgretSlot);return n.init(i,r,new egret.Bitmap,new egret.Mesh),n},i.prototype.buildArmatureDisplay=function(t,e,i,r){void 0===e&&(e=""),void 0===i&&(i=""),void 0===r&&(r="");var n=this.buildArmature(t,e||"",i||"",r||"");return null!==n?(this._dragonBones.clock.add(n),n.display):null},i.prototype.getTextureDisplay=function(t,e){void 0===e&&(e=null);var i=this._getTextureData(null!==e?e:"",t);if(null!==i&&null!==i.renderTexture){var r=i.renderTexture,n=new egret.Bitmap(r);return n.width=r.textureWidth*i.parent.scale,n.height=r.textureHeight*i.parent.scale,n}return null},Object.defineProperty(i.prototype,"soundEventManager",{get:function(){return this._dragonBones.eventManager},enumerable:!0,configurable:!0}),Object.defineProperty(i,"clock",{get:function(){return i.factory.clock},enumerable:!0,configurable:!0}),i.prototype.addSkeletonData=function(t,e){void 0===e&&(e=null),console.warn("已废弃"),this.addDragonBonesData(t,e)},i.prototype.getSkeletonData=function(t){return console.warn("已废弃"),this.getDragonBonesData(t)},i.prototype.removeSkeletonData=function(t){console.warn("已废弃"),this.removeDragonBonesData(t)},i.prototype.addTextureAtlas=function(t,e){void 0===e&&(e=null),console.warn("已废弃"),this.addTextureAtlasData(t,e)},i.prototype.getTextureAtlas=function(t){return console.warn("已废弃"),this.getTextureAtlasData(t)},i.prototype.removeTextureAtlas=function(t){console.warn("已废弃"),this.removeTextureAtlasData(t)},i.prototype.buildFastArmature=function(t,e,i){return void 0===e&&(e=""),void 0===i&&(i=""),console.warn("已废弃"),this.buildArmature(t,e||"",i||"")},i.prototype.dispose=function(){console.warn("已废弃"),this.clear()},i._time=0,i._dragonBonesInstance=null,i._factory=null,i}(t.BaseFactory);t.EgretFactory=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){function e(t,e){for(var i=0,r=t.length;r>i;++i){var n=t[i];if(n.name===e)return n}return null}function i(t){if(t.groupName){var i=u[t.groupName];if(i){var r=e(i.movie||i.animation,t.movieName);if(r)return t.groupConfig=i,t.movieConfig=r,!0}}if(!t.groupName)for(var n in u){var i=u[n];if(!t.groupName){var r=e(i.movie||i.animation,t.movieName);if(r)return t.groupName=n,t.groupConfig=i,t.movieConfig=r,!0}}return!1}function r(t){return t in u}function n(t,e,i){if(void 0===i&&(i=null),!t)throw new Error;var r=new egret.ByteArray(t);r.endian=egret.Endian.LITTLE_ENDIAN,r.position=8;var n=JSON.parse(r.readUTF());n.offset=r.position,n.arrayBuffer=t,n.textures=[];var a=n.offset%4;a&&(n.offset+=4-a);for(var o=0,s=n.position.length;s>o;o+=3)switch(o/3){case 1:n.displayFrameArray=new Int16Array(n.arrayBuffer,n.offset+n.position[o],n.position[o+1]/n.position[o+2]);break;case 2:n.rectangleArray=new Float32Array(n.arrayBuffer,n.offset+n.position[o],n.position[o+1]/n.position[o+2]);break;case 3:n.transformArray=new Float32Array(n.arrayBuffer,n.offset+n.position[o],n.position[o+1]/n.position[o+2]);break;case 4:n.colorArray=new Int16Array(n.arrayBuffer,n.offset+n.position[o],n.position[o+1]/n.position[o+2])}if(i=i||n.name,u[i]&&console.warn("Replace group: "+i),u[i]=n,e instanceof Array)for(var o=0,s=e.length;s>o;++o){var l=e[o];n.textures.push(l)}else n.textures.push(e)}function a(t){var e=u[t];e&&delete u[t]}function o(){for(var t in u)delete u[t]
}function s(e,r){void 0===r&&(r=null);var n={movieName:e,groupName:r};if(i(n)){var a=new f(n);return a.clock=t.EgretFactory.factory.clock,a}return console.warn("No movie named: "+e),null}function l(t){var e=u[t];if(e){for(var i=[],r=e.movie||e.animation,n=0,a=r.length;a>n;++n)i.push(r[n].name);return i}return console.warn("No group named: "+t),null}var h=new egret.Rectangle,c=new egret.Matrix,u={};t.hasMovieGroup=r,t.addMovieGroup=n,t.removeMovieGroup=a,t.removeAllMovieGroup=o,t.buildMovie=s,t.getMovieNames=l;var p=function(t){function e(e){var i=t.call(this,e)||this;return i.name="",i.slotName="",i.clipName="",i}return __extends(e,t),Object.defineProperty(e.prototype,"armature",{get:function(){return this.movie},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bone",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"animationState",{get:function(){return{name:this.clipName}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"frameLabel",{get:function(){return this.name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"movementID",{get:function(){return this.clipName},enumerable:!0,configurable:!0}),e.START="start",e.LOOP_COMPLETE="loopComplete",e.COMPLETE="complete",e.FRAME_EVENT="frameEvent",e.SOUND_EVENT="soundEvent",e}(egret.Event);t.MovieEvent=p;var d=function(t){function e(e){var i=t.call(this)||this;return i.displayIndex=-1,i.colorIndex=-1,i.transformIndex=-1,i.rawDisplay=new egret.Bitmap,i.childMovies={},i.displayConfig=null,i.childMovie=null,i.colorFilter=null,i.display=i.rawDisplay,i.config=e,i.rawDisplay.name=i.config.name,i.config.blendMode||(i.config.blendMode=0),i}return __extends(e,t),e.prototype.dispose=function(){this.rawDisplay=null,this.childMovies=null,this.config=null,this.displayConfig=null,this.display=null,this.childMovie=null,this.colorFilter=null},e}(egret.HashObject),f=function(e){function i(t){var r=e.call(this)||this;r.timeScale=1,r.clipTimeScale=1,r._batchEnabled=!0,r._isLockDispose=!1,r._isDelayDispose=!1,r._isStarted=!1,r._isPlaying=!1,r._isReversing=!1,r._isCompleted=!1,r._playTimes=0,r._time=0,r._currentTime=0,r._currentPlayTimes=0,r._cacheFrameIndex=0,r._frameSize=0,r._cacheRectangle=null,r._clock=null,r._currentFrameConfig=null,r._clipNames=[],r._slots=[],r._childMovies=[],r._groupConfig=t.groupConfig,r._config=t.movieConfig,r._batchEnabled=!(r._config.isNested||r._config.hasChildAnimation),r._batchEnabled&&(r.$renderNode=new egret.sys.GroupNode,r.$renderNode.cleanBeforeRender=i._cleanBeforeRender),r._clipNames.length=0;for(var n=0,a=r._config.clip.length;a>n;++n)r._clipNames.push(r._config.clip[n].name);for(var n=0,a=r._config.slot.length;a>n;++n){var o=new d(r._config.slot[n]);r._updateSlotBlendMode(o),r._slots.push(o),r._batchEnabled?r.$renderNode.addNode(o.rawDisplay.$renderNode):r.addChild(o.rawDisplay)}return r._frameSize=2*r._slots.length,r.name=r._config.name,r.play(),r.advanceTime(1e-6),r.stop(),r}return __extends(i,e),i._cleanBeforeRender=function(){},i.prototype._configToEvent=function(t,e){e.movie=this,e.clipName=this._clipConfig.name,e.name=t.name,e.slotName=t.slot||""},i.prototype._onCrossFrame=function(e){for(var i=0,r=e.actionAndEvent.length;r>i;++i){var n=e.actionAndEvent[i];if(n)switch(n.type){case 11:if(t.EgretFactory.factory.soundEventManager.hasEventListener(p.SOUND_EVENT)){var a=egret.Event.create(p,p.SOUND_EVENT);this._configToEvent(n,a),t.EgretFactory.factory.soundEventManager.dispatchEvent(a),egret.Event.release(a)}break;case 10:if(this.hasEventListener(p.FRAME_EVENT)){var o=egret.Event.create(p,p.FRAME_EVENT);this._configToEvent(n,o),this.dispatchEvent(o),egret.Event.release(o)}break;case 0:if(n.slot){var s=this._getSlot(n.slot);s&&s.childMovie&&s.childMovie.play(n.name)}else this.play(n.name)}}},i.prototype._updateSlotBlendMode=function(t){var e="";switch(t.config.blendMode){case 0:e=egret.BlendMode.NORMAL;break;case 1:e=egret.BlendMode.ADD;break;case 5:e=egret.BlendMode.ERASE}e&&(this._batchEnabled?t.display.$renderNode.blendMode=egret.sys.blendModeToNumber(e):t.display.blendMode=e)},i.prototype._updateSlotColor=function(t,e,i,r,n,a,o,s,l){if(1!==i||1!==r||1!==n||0!==o||0!==s||0!==l||0!==a){t.colorFilter||(t.colorFilter=new egret.ColorMatrixFilter);var h=t.colorFilter.matrix;if(h[0]=i,h[6]=r,h[12]=n,h[18]=e,h[4]=o,h[9]=s,h[14]=l,h[19]=a,t.colorFilter.matrix=h,this._batchEnabled)t.display.$renderNode.filter=t.colorFilter,t.display.$renderNode.alpha=1;else{var c=t.display.filters;c||(c=[]),c.indexOf(t.colorFilter)<0&&c.push(t.colorFilter),t.display.filters=c,t.display.$setAlpha(1)}}else t.colorFilter&&(t.colorFilter=null),this._batchEnabled?(t.display.$renderNode.filter=null,t.display.$renderNode.alpha=e):(t.display.filters=null,t.display.$setAlpha(e))},i.prototype._updateSlotDisplay=function(e){var i=e.display||e.rawDisplay,r=e.childMovie;if(e.displayIndex>=0)if(e.displayConfig=this._groupConfig.display[e.displayIndex],1===e.displayConfig.type){var n=e.displayConfig.name in e.childMovies?e.childMovies[e.displayConfig.name]:null;n||(n=s(e.displayConfig.name,this._groupConfig.name),n&&(e.childMovies[e.displayConfig.name]=n)),n?(e.display=n,e.childMovie=n):(e.display=e.rawDisplay,e.childMovie=null)}else e.display=e.rawDisplay,e.childMovie=null;else e.displayConfig=null,e.display=e.rawDisplay,e.childMovie=null;if(e.display!==i&&(i&&(this.addChild(e.display),this.swapChildren(e.display,i),this.removeChild(i)),this._updateSlotBlendMode(e)),e.display===e.rawDisplay)if(e.displayConfig&&null!==e.displayConfig.regionIndex&&void 0!==e.displayConfig.regionIndex){if(!e.displayConfig.texture){var a=this._groupConfig.textures[e.displayConfig.textureIndex||0],o=4*e.displayConfig.regionIndex,l=this._groupConfig.rectangleArray[o],h=this._groupConfig.rectangleArray[o+1],c=this._groupConfig.rectangleArray[o+2],u=this._groupConfig.rectangleArray[o+3];e.displayConfig.texture=new egret.Texture,e.displayConfig.texture.bitmapData=a.bitmapData,e.displayConfig.texture.$initData(l,h,Math.min(c,a.textureWidth-l),Math.min(u,a.textureHeight-h),0,0,Math.min(c,a.textureWidth-l),Math.min(u,a.textureHeight-h),a.textureWidth,a.textureHeight)}if(this._batchEnabled){var p=e.displayConfig.texture,d=e.rawDisplay.$renderNode;if(egret.sys.RenderNode.prototype.cleanBeforeRender.call(e.rawDisplay.$renderNode),d.image=p.bitmapData,t.isV5)d.drawImage(p.$bitmapX,p.$bitmapY,p.$bitmapWidth,p.$bitmapHeight,p.$offsetX,p.$offsetY,p.textureWidth,p.textureHeight),d.imageWidth=p._sourceWidth,d.imageHeight=p._sourceHeight;else{var f=p;d.drawImage(f._bitmapX,f._bitmapY,f._bitmapWidth,f._bitmapHeight,f._offsetX,f._offsetY,p.textureWidth,p.textureHeight),d.imageWidth=f._sourceWidth,d.imageHeight=f._sourceHeight}}else e.rawDisplay.visible=!0,e.rawDisplay.$setBitmapData(e.displayConfig.texture)}else this._batchEnabled?e.rawDisplay.$renderNode.image=null:(e.rawDisplay.visible=!1,e.rawDisplay.$setBitmapData(null));e.childMovie!==r&&(r&&(r.stop(),this._childMovies.slice(this._childMovies.indexOf(r),1)),e.childMovie&&(this._childMovies.indexOf(e.childMovie)<0&&this._childMovies.push(e.childMovie),e.config.action?e.childMovie.play(e.config.action):e.childMovie.play(e.childMovie._config.action)))},i.prototype._getSlot=function(t){for(var e=0,i=this._slots.length;i>e;++e){var r=this._slots[e];if(r.config.name===t)return r}return null},i.prototype.$render=function(){this._batchEnabled||e.prototype.$render.call(this)},i.prototype.$updateRenderNode=function(){this._batchEnabled||e.prototype.$updateRenderNode.call(this)},i.prototype.$measureContentBounds=function(t){this._batchEnabled&&this._cacheRectangle?t.setTo(this._cacheRectangle.x,this._cacheRectangle.y,this._cacheRectangle.width-this._cacheRectangle.x,this._cacheRectangle.height-this._cacheRectangle.y):e.prototype.$measureContentBounds.call(this,t)},i.prototype.$doAddChild=function(t,i,r){return this._batchEnabled?(console.warn("Can not add child."),null):e.prototype.$doAddChild.call(this,t,i,r)},i.prototype.$doRemoveChild=function(t,i){return this._batchEnabled?(console.warn("Can not remove child."),null):e.prototype.$doRemoveChild.call(this,t,i)},i.prototype.dispose=function(){if(this._isLockDispose)this._isDelayDispose=!0;else{if(this._clock&&this._clock.remove(this),this._slots)for(var t=0,e=this._slots.length;e>t;++t)this._slots[t].dispose();this._isPlaying=!1,this._cacheRectangle=null,this._clock=null,this._groupConfig=null,this._config=null,this._clipConfig=null,this._currentFrameConfig=null,this._clipArray=null,this._clipNames=null,this._slots=null,this._childMovies=null}},i.prototype.advanceTime=function(e){if(this._isPlaying){this._isLockDispose=!0,0>e&&(e=-e),e*=this.timeScale,this._time+=e*this.clipTimeScale;var i=this._clipConfig.duration,r=i*this._playTimes,n=this._time,a=this._currentPlayTimes;if(this._playTimes>0&&(n>=r||-r>=n)?(this._isCompleted=!0,a=this._playTimes,n=0>n?0:i):(this._isCompleted=!1,0>n?(a=Math.floor(-n/i),n=i- -n%i):(a=Math.floor(n/i),n%=i),this._playTimes>0&&a>this._playTimes&&(a=this._playTimes)),this._currentTime===n)return;var o=Math.floor(n*this._clipConfig.cacheTimeToFrameScale);if(this._cacheFrameIndex!==o){this._cacheFrameIndex=o;var s=this._groupConfig.displayFrameArray,l=this._groupConfig.transformArray,u=this._groupConfig.colorArray,d=!0,f=!1,g=!1,m=this._cacheRectangle;this._cacheRectangle=this._clipConfig.cacheRectangles[this._cacheFrameIndex],this._batchEnabled&&!this._cacheRectangle&&(g=!0,this._cacheRectangle=new egret.Rectangle,this._clipConfig.cacheRectangles[this._cacheFrameIndex]=this._cacheRectangle);for(var y=0,v=this._slots.length;v>y;++y){var _=this._slots[y],b=this._frameSize*this._cacheFrameIndex+2*y;b>=this._clipArray.length&&(b=this._frameSize*(this._cacheFrameIndex-1)+2*y);var x=2*this._clipArray[b];if(x>=0){var T=s[x],E=8*s[x+1],S=6*this._clipArray[b+1],C=!1;if(_.displayIndex!==T&&(_.displayIndex=T,C=!0,this._updateSlotDisplay(_)),(_.colorIndex!==E||C)&&(_.colorIndex=E,_.colorIndex>=0?this._updateSlotColor(_,.01*u[E],.01*u[E+1],.01*u[E+2],.01*u[E+3],u[E+4],u[E+5],u[E+6],u[E+7]):this._updateSlotColor(_,1,1,1,1,0,0,0,0)),f=!0,_.transformIndex!==S)if(_.transformIndex=S,this._batchEnabled){var w=_.display.$renderNode.matrix;w||(w=_.display.$renderNode.matrix=new egret.Matrix),w.a=l[S],w.b=l[S+1],w.c=l[S+2],w.d=l[S+3],w.tx=l[S+4],w.ty=l[S+5]}else c.a=l[S],c.b=l[S+1],c.c=l[S+2],c.d=l[S+3],c.tx=l[S+4],c.ty=l[S+5],_.display.$setMatrix(c);if(this._batchEnabled&&g&&_.displayConfig){var w=_.display.$renderNode.matrix;h.x=0,h.y=0,h.width=_.displayConfig.texture.textureWidth,h.height=_.displayConfig.texture.textureHeight,w.$transformBounds(h),d?(d=!1,this._cacheRectangle.x=h.x,this._cacheRectangle.width=h.x+h.width,this._cacheRectangle.y=h.y,this._cacheRectangle.height=h.y+h.height):(this._cacheRectangle.x=Math.min(this._cacheRectangle.x,h.x),this._cacheRectangle.width=Math.max(this._cacheRectangle.width,h.x+h.width),this._cacheRectangle.y=Math.min(this._cacheRectangle.y,h.y),this._cacheRectangle.height=Math.max(this._cacheRectangle.height,h.y+h.height))}}else-1!==_.displayIndex&&(_.displayIndex=-1,this._updateSlotDisplay(_))}this._cacheRectangle&&(f&&g&&d&&m&&(this._cacheRectangle.x=m.x,this._cacheRectangle.y=m.y,this._cacheRectangle.width=m.width,this._cacheRectangle.height=m.height),t.isV5||this.$invalidateContentBounds())}if(this._isCompleted&&(this._isPlaying=!1),!this._isStarted&&(this._isStarted=!0,this.hasEventListener(p.START))){var P=egret.Event.create(p,p.START);P.movie=this,P.clipName=this._clipConfig.name,P.name="",P.slotName="",this.dispatchEvent(P)}this._isReversing=this._currentTime>n&&this._currentPlayTimes===a,this._currentTime=n;var D=this._clipConfig.frame?this._clipConfig.frame.length:0;if(D>0){var A=Math.floor(this._currentTime*this._config.frameRate),I=this._groupConfig.frame[this._clipConfig.frame[A]];if(this._currentFrameConfig!==I)if(D>1){var M=this._currentFrameConfig;if(this._currentFrameConfig=I,!M){var $=Math.floor(this._currentTime*this._config.frameRate);M=this._groupConfig.frame[this._clipConfig.frame[$]],this._isReversing||(this._currentTime<=M.position||this._currentPlayTimes!==a)&&(M=this._groupConfig.frame[M.prev])}if(this._isReversing)for(;M!==I;)this._onCrossFrame(M),M=this._groupConfig.frame[M.prev];else for(;M!==I;)M=this._groupConfig.frame[M.next],this._onCrossFrame(M)}else this._currentFrameConfig=I,this._currentFrameConfig&&this._onCrossFrame(this._currentFrameConfig)}if(this._currentPlayTimes!==a){if(this._currentPlayTimes=a,this.hasEventListener(p.LOOP_COMPLETE)){var O=egret.Event.create(p,p.LOOP_COMPLETE);O.movie=this,O.clipName=this._clipConfig.name,O.name="",O.slotName="",this.dispatchEvent(O),egret.Event.release(O)}if(this._isCompleted&&this.hasEventListener(p.COMPLETE)){var R=egret.Event.create(p,p.COMPLETE);R.movie=this,R.clipName=this._clipConfig.name,R.name="",R.slotName="",this.dispatchEvent(R),egret.Event.release(R)}}}this._isLockDispose=!1,this._isDelayDispose&&this.dispose()},i.prototype.play=function(t,e){if(void 0===t&&(t=null),void 0===e&&(e=-1),t){for(var i=null,r=0,n=this._config.clip.length;n>r;++r){var a=this._config.clip[r];a.name===t&&(i=a)}i?(this._clipConfig=i,this._clipArray=new Int16Array(this._groupConfig.arrayBuffer,this._groupConfig.offset+this._groupConfig.position[0]+this._clipConfig.p,this._clipConfig.s/this._groupConfig.position[2]),this._clipConfig.cacheRectangles||(this._clipConfig.cacheRectangles=[]),this._isPlaying=!0,this._isStarted=!1,this._isCompleted=!1,0>e||e!==e?this._playTimes=this._clipConfig.playTimes:this._playTimes=e,this._time=0,this._currentTime=0,this._currentPlayTimes=0,this._cacheFrameIndex=-1,this._currentFrameConfig=null,this._cacheRectangle=null,this.clipTimeScale=1/this._clipConfig.scale):console.warn("No clip in movie.",this._config.name,t)}else this._clipConfig?this._isPlaying||this._isCompleted?this.play(this._clipConfig.name,this._playTimes):this._isPlaying=!0:this._config.action&&this.play(this._config.action,e)},i.prototype.stop=function(){this._isPlaying=!1},i.prototype.gotoAndPlay=function(t,e,i){void 0===t&&(t=null),void 0===i&&(i=-1),e%=this._clipConfig.duration,0>e&&(e+=this._clipConfig.duration),this.play(t,i),this._time=e,this._currentTime=e},i.prototype.gotoAndStop=function(t,e){void 0===t&&(t=null),e%=this._clipConfig.duration,0>e&&(e+=this._clipConfig.duration),this.play(t,1),this._time=e,this._currentTime=e,this.advanceTime(.001),this.stop()},i.prototype.hasClip=function(t){for(var e=0,i=this._config.clip.length;i>e;++e){var r=this._config.clip[e];if(r.name===t)return!0}return!1},Object.defineProperty(i.prototype,"isPlaying",{get:function(){return this._isPlaying&&!this._isCompleted},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isComplete",{get:function(){return this._isCompleted},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"currentTime",{get:function(){return this._currentTime},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"totalTime",{get:function(){return this._clipConfig?this._clipConfig.duration:0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"currentPlayTimes",{get:function(){return this._currentPlayTimes},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"playTimes",{get:function(){return this._playTimes},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"groupName",{get:function(){return this._groupConfig.name},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"clipName",{get:function(){return this._clipConfig?this._clipConfig.name:""},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"clipNames",{get:function(){return this._clipNames},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"clock",{get:function(){return this._clock},set:function(t){if(this._clock!==t){var e=this._clock;e&&e.remove(this),this._clock=t,this._clock&&this._clock.add(this)}},enumerable:!0,configurable:!0}),i.prototype.advanceTimeBySelf=function(e){e?this.clock=t.EgretFactory.clock:this.clock=null},Object.defineProperty(i.prototype,"display",{get:function(){return this},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"animation",{get:function(){return this},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"armature",{get:function(){return this},enumerable:!0,configurable:!0}),i.prototype.getAnimation=function(){return this},i.prototype.getArmature=function(){return this},i.prototype.getDisplay=function(){return this},i.prototype.hasAnimation=function(t){return this.hasClip(t)},i.prototype.invalidUpdate=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},Object.defineProperty(i.prototype,"lastAnimationName",{get:function(){return this.clipName},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"animationNames",{get:function(){return this.clipNames},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"animationList",{get:function(){return this.clipNames},enumerable:!0,configurable:!0}),i}(egret.DisplayObjectContainer);t.Movie=f}(dragonBones||(dragonBones={}));var egret=window.egret;!function(t){"object"==typeof exports&&"undefined"!=typeof module?(module.exports=t(),window.Matter=t()):"function"==typeof define&&define.amd?define([],t):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Matter=t()}(function(){return function t(e,i,r){function n(o,s){if(!i[o]){if(!e[o]){var l="function"==typeof require&&require;if(!s&&l)return l(o,!0);if(a)return a(o,!0);throw l=Error("Cannot find module '"+o+"'"),l.code="MODULE_NOT_FOUND",l}l=i[o]={exports:{}},e[o][0].call(l.exports,function(t){var i=e[o][1][t];return n(i?i:t)},l,l.exports,t,e,i,r)}return i[o].exports}for(var a="function"==typeof require&&require,o=0;o<r.length;o++)n(r[o]);return n}({1:[function(t,e,i){var r={};e.exports=r;var n=t("../geometry/Vertices"),a=t("../geometry/Vector"),o=t("../core/Sleeping");t("../render/Render");var s=t("../core/Common"),l=t("../geometry/Bounds"),h=t("../geometry/Axes");!function(){r._inertiaScale=4,r._nextCollidingGroupId=1,r._nextNonCollidingGroupId=-1,r._nextCategory=1,r.create=function(t){var e={id:s.nextId(),type:"body",label:"Body",parts:[],plugin:{},angle:0,vertices:n.fromPath("L 0 0 L 40 0 L 40 40 L 0 40"),position:{x:0,y:0},force:{x:0,y:0},torque:0,positionImpulse:{x:0,y:0},constraintImpulse:{x:0,y:0,angle:0},totalContacts:0,speed:0,angularSpeed:0,velocity:{x:0,y:0},angularVelocity:0,isSensor:!1,isStatic:!1,isSleeping:!1,motion:0,sleepThreshold:60,density:.001,restitution:0,friction:.1,frictionStatic:.5,frictionAir:.01,collisionFilter:{category:1,mask:4294967295,group:0},slop:.05,timeScale:1,render:{visible:!0,opacity:1,sprite:{xScale:1,yScale:1,xOffset:0,yOffset:0},lineWidth:0}},e=s.extend(e,t);return t=t||{},r.set(e,{bounds:e.bounds||l.create(e.vertices),positionPrev:e.positionPrev||a.clone(e.position),anglePrev:e.anglePrev||e.angle,vertices:e.vertices,parts:e.parts||[e],isStatic:e.isStatic,isSleeping:e.isSleeping,parent:e.parent||e}),n.rotate(e.vertices,e.angle,e.position),h.rotate(e.axes,e.angle),l.update(e.bounds,e.vertices,e.velocity),r.set(e,{axes:t.axes||e.axes,area:t.area||e.area,mass:t.mass||e.mass,inertia:t.inertia||e.inertia}),t=e.isStatic?"#2e2b44":s.choose(["#006BA6","#0496FF","#FFBC42","#D81159","#8F2D56"]),e.render.fillStyle=e.render.fillStyle||t,e.render.strokeStyle=e.render.strokeStyle||"#000",e.render.sprite.xOffset+=-(e.bounds.min.x-e.position.x)/(e.bounds.max.x-e.bounds.min.x),e.render.sprite.yOffset+=-(e.bounds.min.y-e.position.y)/(e.bounds.max.y-e.bounds.min.y),e},r.nextGroup=function(t){return t?r._nextNonCollidingGroupId--:r._nextCollidingGroupId++},r.nextCategory=function(){return r._nextCategory<<=1,r._nextCategory},r.set=function(t,e,i){var n;"string"==typeof e&&(n=e,e={},e[n]=i);for(n in e)if(i=e[n],e.hasOwnProperty(n))switch(n){case"isStatic":r.setStatic(t,i);break;case"isSleeping":o.set(t,i);break;case"mass":r.setMass(t,i);break;case"density":r.setDensity(t,i);break;case"inertia":r.setInertia(t,i);break;case"vertices":r.setVertices(t,i);break;case"position":r.setPosition(t,i);break;case"angle":r.setAngle(t,i);break;case"velocity":r.setVelocity(t,i);break;case"angularVelocity":r.setAngularVelocity(t,i);break;case"parts":r.setParts(t,i);break;default:t[n]=i}},r.setStatic=function(t,e){for(var i=0;i<t.parts.length;i++){var r=t.parts[i];(r.isStatic=e)?(r._original={restitution:r.restitution,friction:r.friction,mass:r.mass,inertia:r.inertia,density:r.density,inverseMass:r.inverseMass,inverseInertia:r.inverseInertia},r.restitution=0,r.friction=1,r.mass=r.inertia=r.density=1/0,r.inverseMass=r.inverseInertia=0,r.positionPrev.x=r.position.x,r.positionPrev.y=r.position.y,r.anglePrev=r.angle,r.angularVelocity=0,r.speed=0,r.angularSpeed=0,r.motion=0):r._original&&(r.restitution=r._original.restitution,r.friction=r._original.friction,r.mass=r._original.mass,r.inertia=r._original.inertia,r.density=r._original.density,r.inverseMass=r._original.inverseMass,r.inverseInertia=r._original.inverseInertia,delete r._original)}},r.setMass=function(t,e){t.inertia=t.inertia/(t.mass/6)*(e/6),t.inverseInertia=1/t.inertia,t.mass=e,t.inverseMass=1/t.mass,t.density=t.mass/t.area},r.setDensity=function(t,e){r.setMass(t,e*t.area),t.density=e},r.setInertia=function(t,e){t.inertia=e,t.inverseInertia=1/t.inertia},r.setVertices=function(t,e){t.vertices=e[0].body===t?e:n.create(e,t),t.axes=h.fromVertices(t.vertices),t.area=n.area(t.vertices),r.setMass(t,t.density*t.area);var i=n.centre(t.vertices);n.translate(t.vertices,i,-1),r.setInertia(t,r._inertiaScale*n.inertia(t.vertices,t.mass)),n.translate(t.vertices,t.position),l.update(t.bounds,t.vertices,t.velocity)},r.setParts=function(t,e,i){var a;for(e=e.slice(0),t.parts.length=0,t.parts.push(t),t.parent=t,a=0;a<e.length;a++){var o=e[a];o!==t&&(o.parent=t,t.parts.push(o))}if(1!==t.parts.length){if("undefined"!=typeof i?i:1){for(i=[],a=0;a<e.length;a++)i=i.concat(e[a].vertices);n.clockwiseSort(i),e=n.hull(i),a=n.centre(e),r.setVertices(t,e),n.translate(t.vertices,a)}e=r._totalProperties(t),t.area=e.area,t.parent=t,t.position.x=e.centre.x,t.position.y=e.centre.y,t.positionPrev.x=e.centre.x,t.positionPrev.y=e.centre.y,r.setMass(t,e.mass),r.setInertia(t,e.inertia),r.setPosition(t,e.centre)}},r.setPosition=function(t,e){var i=a.sub(e,t.position);t.positionPrev.x+=i.x,t.positionPrev.y+=i.y;for(var r=0;r<t.parts.length;r++){var o=t.parts[r];o.position.x+=i.x,o.position.y+=i.y,n.translate(o.vertices,i),l.update(o.bounds,o.vertices,t.velocity)}},r.setAngle=function(t,e){var i=e-t.angle;t.anglePrev+=i;for(var r=0;r<t.parts.length;r++){var o=t.parts[r];o.angle+=i,n.rotate(o.vertices,i,t.position),h.rotate(o.axes,i),l.update(o.bounds,o.vertices,t.velocity),r>0&&a.rotateAbout(o.position,i,t.position,o.position)}},r.setVelocity=function(t,e){t.positionPrev.x=t.position.x-e.x,t.positionPrev.y=t.position.y-e.y,t.velocity.x=e.x,t.velocity.y=e.y,t.speed=a.magnitude(t.velocity)},r.setAngularVelocity=function(t,e){t.anglePrev=t.angle-e,t.angularVelocity=e,t.angularSpeed=Math.abs(t.angularVelocity)},r.translate=function(t,e){r.setPosition(t,a.add(t.position,e))},r.rotate=function(t,e,i){if(i){var n=Math.cos(e),a=Math.sin(e),o=t.position.x-i.x,s=t.position.y-i.y;r.setPosition(t,{x:i.x+(o*n-s*a),y:i.y+(o*a+s*n)})}r.setAngle(t,t.angle+e)},r.scale=function(t,e,i,a){var o=0,s=0;a=a||t.position;for(var c=0;c<t.parts.length;c++){var u=t.parts[c];n.scale(u.vertices,e,i,a),u.axes=h.fromVertices(u.vertices),u.area=n.area(u.vertices),r.setMass(u,t.density*u.area),n.translate(u.vertices,{x:-u.position.x,y:-u.position.y}),r.setInertia(u,r._inertiaScale*n.inertia(u.vertices,u.mass)),n.translate(u.vertices,{x:u.position.x,y:u.position.y}),c>0&&(o+=u.area,s+=u.inertia),u.position.x=a.x+(u.position.x-a.x)*e,u.position.y=a.y+(u.position.y-a.y)*i,l.update(u.bounds,u.vertices,t.velocity)}1<t.parts.length&&(t.area=o,t.isStatic||(r.setMass(t,t.density*o),r.setInertia(t,s))),t.circleRadius&&(t.circleRadius=e===i?t.circleRadius*e:null)},r.update=function(t,e,i,r){e=Math.pow(e*i*t.timeScale,2),i=1-t.frictionAir*i*t.timeScale;var o=t.position.y-t.positionPrev.y;for(t.velocity.x=(t.position.x-t.positionPrev.x)*i*r+t.force.x/t.mass*e,t.velocity.y=o*i*r+t.force.y/t.mass*e,t.positionPrev.x=t.position.x,t.positionPrev.y=t.position.y,t.position.x+=t.velocity.x,t.position.y+=t.velocity.y,t.angularVelocity=(t.angle-t.anglePrev)*i*r+t.torque/t.inertia*e,t.anglePrev=t.angle,t.angle+=t.angularVelocity,t.speed=a.magnitude(t.velocity),t.angularSpeed=Math.abs(t.angularVelocity),r=0;r<t.parts.length;r++)e=t.parts[r],n.translate(e.vertices,t.velocity),r>0&&(e.position.x+=t.velocity.x,e.position.y+=t.velocity.y),0!==t.angularVelocity&&(n.rotate(e.vertices,t.angularVelocity,t.position),h.rotate(e.axes,t.angularVelocity),r>0&&a.rotateAbout(e.position,t.angularVelocity,t.position,e.position)),l.update(e.bounds,e.vertices,t.velocity)},r.applyForce=function(t,e,i){t.force.x+=i.x,t.force.y+=i.y,t.torque+=(e.x-t.position.x)*i.y-(e.y-t.position.y)*i.x},r._totalProperties=function(t){for(var e={mass:0,area:0,inertia:0,centre:{x:0,y:0}},i=1===t.parts.length?0:1;i<t.parts.length;i++){var r=t.parts[i],n=1/0!==r.mass?r.mass:1;e.mass+=n,e.area+=r.area,e.inertia+=r.inertia,e.centre=a.add(e.centre,a.mult(r.position,n))}return e.centre=a.div(e.centre,e.mass),e}}()},{"../core/Common":14,"../core/Sleeping":22,"../geometry/Axes":25,"../geometry/Bounds":26,"../geometry/Vector":28,"../geometry/Vertices":29,"../render/Render":31}],2:[function(t,e,i){var r={};e.exports=r;var n=t("../core/Events"),a=t("../core/Common"),o=t("./Body");!function(){r.create=function(t){return a.extend({id:a.nextId(),type:"composite",parent:null,isModified:!1,bodies:[],constraints:[],composites:[],label:"Composite",plugin:{}},t)},r.setModified=function(t,e,i,n){if(t.isModified=e,i&&t.parent&&r.setModified(t.parent,e,i,n),n)for(var a=0;a<t.composites.length;a++)r.setModified(t.composites[a],e,i,n)},r.add=function(t,e){var i=[].concat(e);n.trigger(t,"beforeAdd",{object:e});for(var o=0;o<i.length;o++){var s=i[o];switch(s.type){case"body":if(s.parent!==s){a.warn("Composite.add: skipped adding a compound body part (you must add its parent instead)");break}r.addBody(t,s);break;case"constraint":r.addConstraint(t,s);break;case"composite":r.addComposite(t,s);break;case"mouseConstraint":r.addConstraint(t,s.constraint)}}return n.trigger(t,"afterAdd",{object:e}),t},r.remove=function(t,e,i){var a=[].concat(e);n.trigger(t,"beforeRemove",{object:e});for(var o=0;o<a.length;o++){var s=a[o];switch(s.type){case"body":r.removeBody(t,s,i);break;case"constraint":r.removeConstraint(t,s,i);break;case"composite":r.removeComposite(t,s,i);break;case"mouseConstraint":r.removeConstraint(t,s.constraint)}}return n.trigger(t,"afterRemove",{object:e}),t},r.addComposite=function(t,e){return t.composites.push(e),e.parent=t,r.setModified(t,!0,!0,!1),t},r.removeComposite=function(t,e,i){var n=a.indexOf(t.composites,e);if(-1!==n&&(r.removeCompositeAt(t,n),r.setModified(t,!0,!0,!1)),i)for(i=0;i<t.composites.length;i++)r.removeComposite(t.composites[i],e,!0);return t},r.removeCompositeAt=function(t,e){return t.composites.splice(e,1),r.setModified(t,!0,!0,!1),t},r.addBody=function(t,e){return t.bodies.push(e),r.setModified(t,!0,!0,!1),t},r.removeBody=function(t,e,i){var n=a.indexOf(t.bodies,e);if(-1!==n&&(r.removeBodyAt(t,n),r.setModified(t,!0,!0,!1)),i)for(i=0;i<t.composites.length;i++)r.removeBody(t.composites[i],e,!0);return t},r.removeBodyAt=function(t,e){return t.bodies.splice(e,1),r.setModified(t,!0,!0,!1),t},r.addConstraint=function(t,e){return t.constraints.push(e),r.setModified(t,!0,!0,!1),t},r.removeConstraint=function(t,e,i){var n=a.indexOf(t.constraints,e);if(-1!==n&&r.removeConstraintAt(t,n),i)for(i=0;i<t.composites.length;i++)r.removeConstraint(t.composites[i],e,!0);return t},r.removeConstraintAt=function(t,e){return t.constraints.splice(e,1),r.setModified(t,!0,!0,!1),t},r.clear=function(t,e,i){if(i)for(i=0;i<t.composites.length;i++)r.clear(t.composites[i],e,!0);return e?t.bodies=t.bodies.filter(function(t){return t.isStatic}):t.bodies.length=0,t.constraints.length=0,t.composites.length=0,r.setModified(t,!0,!0,!1),t},r.allBodies=function(t){for(var e=[].concat(t.bodies),i=0;i<t.composites.length;i++)e=e.concat(r.allBodies(t.composites[i]));return e},r.allConstraints=function(t){for(var e=[].concat(t.constraints),i=0;i<t.composites.length;i++)e=e.concat(r.allConstraints(t.composites[i]));return e},r.allComposites=function(t){for(var e=[].concat(t.composites),i=0;i<t.composites.length;i++)e=e.concat(r.allComposites(t.composites[i]));return e},r.get=function(t,e,i){var n;switch(i){case"body":n=r.allBodies(t);break;case"constraint":n=r.allConstraints(t);break;case"composite":n=r.allComposites(t).concat(t)}return n?(t=n.filter(function(t){return t.id.toString()===e.toString()}),0===t.length?null:t[0]):null},r.move=function(t,e,i){return r.remove(t,e),r.add(i,e),t},r.rebase=function(t){for(var e=r.allBodies(t).concat(r.allConstraints(t)).concat(r.allComposites(t)),i=0;i<e.length;i++)e[i].id=a.nextId();return r.setModified(t,!0,!0,!1),t},r.translate=function(t,e,i){i=i?r.allBodies(t):t.bodies;for(var n=0;n<i.length;n++)o.translate(i[n],e);return r.setModified(t,!0,!0,!1),t},r.rotate=function(t,e,i,n){var a=Math.cos(e),s=Math.sin(e);n=n?r.allBodies(t):t.bodies;for(var l=0;l<n.length;l++){var h=n[l],c=h.position.x-i.x,u=h.position.y-i.y;o.setPosition(h,{x:i.x+(c*a-u*s),y:i.y+(c*s+u*a)}),o.rotate(h,e)}return r.setModified(t,!0,!0,!1),t},r.scale=function(t,e,i,n,a){a=a?r.allBodies(t):t.bodies;for(var s=0;s<a.length;s++){var l=a[s];o.setPosition(l,{x:n.x+(l.position.x-n.x)*e,y:n.y+(l.position.y-n.y)*i}),o.scale(l,e,i)}return r.setModified(t,!0,!0,!1),t},r.bounds=function(t){t=Matter.Composite.allBodies(t);for(var e=[],i=0;i<t.length;i+=1){var r=t[i];e.push(r.bounds.min,r.bounds.max)}return Matter.Bounds.create(e)}}()},{"../core/Common":14,"../core/Events":16,"./Body":1}],3:[function(t,e,i){var r={};e.exports=r;var n=t("./Composite");t("../constraint/Constraint");var a=t("../core/Common");!function(){r.create=function(t){var e=n.create();return a.extend(e,{label:"World",gravity:{x:0,y:1,scale:.001},bounds:{min:{x:-(1/0),y:-(1/0)},max:{x:1/0,y:1/0}}},t)}}()},{"../constraint/Constraint":12,"../core/Common":14,"./Composite":2}],4:[function(t,e,i){var r={};e.exports=r,function(){r.create=function(t){return{id:r.id(t),vertex:t,normalImpulse:0,tangentImpulse:0}},r.id=function(t){return t.body.id+"_"+t.index}}()},{}],5:[function(t,e,i){var r={};e.exports=r;var n=t("./SAT"),a=t("./Pair"),o=t("../geometry/Bounds");!function(){r.collisions=function(t,e){for(var i=[],s=e.pairs.table,l=0;l<t.length;l++){var h=t[l][0],c=t[l][1];if((!h.isStatic&&!h.isSleeping||!c.isStatic&&!c.isSleeping)&&r.canCollide(h.collisionFilter,c.collisionFilter)&&o.overlaps(h.bounds,c.bounds))for(var u=1<h.parts.length?1:0;u<h.parts.length;u++)for(var p=h.parts[u],d=1<c.parts.length?1:0;d<c.parts.length;d++){var f=c.parts[d];if(p===h&&f===c||o.overlaps(p.bounds,f.bounds)){var g=a.id(p,f),g=s[g],f=n.collides(p,f,g&&g.isActive?g.collision:null);f.collided&&i.push(f)}}}return i},r.canCollide=function(t,e){return t.group===e.group&&0!==t.group?0<t.group:0!==(t.mask&e.category)&&0!==(e.mask&t.category)}}()},{"../geometry/Bounds":26,"./Pair":7,"./SAT":11}],6:[function(t,e,i){var r={};e.exports=r;var n=t("./Pair"),a=t("./Detector"),o=t("../core/Common");!function(){r.create=function(t){return o.extend({controller:r,detector:a.collisions,buckets:{},pairs:{},pairsList:[],bucketWidth:48,bucketHeight:48},t)},r.update=function(t,e,i,n){var a,o,s,l,h=i.world,c=t.buckets;for(a=!1,i=0;i<e.length;i++){var u=e[i];if(!(u.isSleeping&&!n||u.bounds.max.x<h.bounds.min.x||u.bounds.min.x>h.bounds.max.x||u.bounds.max.y<h.bounds.min.y||u.bounds.min.y>h.bounds.max.y)){var p=r._getRegion(t,u);if(!u.region||p.id!==u.region.id||n){(!u.region||n)&&(u.region=p);var d=r._regionUnion(p,u.region);
for(a=d.startCol;a<=d.endCol;a++)for(o=d.startRow;o<=d.endRow;o++){l=r._getBucketId(a,o),s=c[l];var f=a>=p.startCol&&a<=p.endCol&&o>=p.startRow&&o<=p.endRow,g=a>=u.region.startCol&&a<=u.region.endCol&&o>=u.region.startRow&&o<=u.region.endRow;!f&&g&&g&&s&&r._bucketRemoveBody(t,s,u),(u.region===p||f&&!g||n)&&(s||(s=r._createBucket(c,l)),r._bucketAddBody(t,s,u))}u.region=p,a=!0}}}a&&(t.pairsList=r._createActivePairsList(t))},r.clear=function(t){t.buckets={},t.pairs={},t.pairsList=[]},r._regionUnion=function(t,e){return r._createRegion(Math.min(t.startCol,e.startCol),Math.max(t.endCol,e.endCol),Math.min(t.startRow,e.startRow),Math.max(t.endRow,e.endRow))},r._getRegion=function(t,e){var i=e.bounds;return r._createRegion(Math.floor(i.min.x/t.bucketWidth),Math.floor(i.max.x/t.bucketWidth),Math.floor(i.min.y/t.bucketHeight),Math.floor(i.max.y/t.bucketHeight))},r._createRegion=function(t,e,i,r){return{id:t+","+e+","+i+","+r,startCol:t,endCol:e,startRow:i,endRow:r}},r._getBucketId=function(t,e){return"C"+t+"R"+e},r._createBucket=function(t,e){return t[e]=[]},r._bucketAddBody=function(t,e,i){for(var r=0;r<e.length;r++){var a=e[r];if(!(i.id===a.id||i.isStatic&&a.isStatic)){var o=n.id(i,a),s=t.pairs[o];s?s[2]+=1:t.pairs[o]=[i,a,1]}}e.push(i)},r._bucketRemoveBody=function(t,e,i){e.splice(o.indexOf(e,i),1);for(var r=0;r<e.length;r++){var a=n.id(i,e[r]);(a=t.pairs[a])&&--a[2]}},r._createActivePairsList=function(t){var e,i,r=[];e=o.keys(t.pairs);for(var n=0;n<e.length;n++)i=t.pairs[e[n]],0<i[2]?r.push(i):delete t.pairs[e[n]];return r}}()},{"../core/Common":14,"./Detector":5,"./Pair":7}],7:[function(t,e,i){var r={};e.exports=r;var n=t("./Contact");!function(){r.create=function(t,e){var i=t.bodyA,n=t.bodyB,a=t.parentA,o=t.parentB,i={id:r.id(i,n),bodyA:i,bodyB:n,contacts:{},activeContacts:[],separation:0,isActive:!0,isSensor:i.isSensor||n.isSensor,timeCreated:e,timeUpdated:e,inverseMass:a.inverseMass+o.inverseMass,friction:Math.min(a.friction,o.friction),frictionStatic:Math.max(a.frictionStatic,o.frictionStatic),restitution:Math.max(a.restitution,o.restitution),slop:Math.max(a.slop,o.slop)};return r.update(i,t,e),i},r.update=function(t,e,i){var a=t.contacts,o=e.supports,s=t.activeContacts,l=e.parentA,h=e.parentB;if(t.collision=e,t.inverseMass=l.inverseMass+h.inverseMass,t.friction=Math.min(l.friction,h.friction),t.frictionStatic=Math.max(l.frictionStatic,h.frictionStatic),t.restitution=Math.max(l.restitution,h.restitution),t.slop=Math.max(l.slop,h.slop),s.length=0,e.collided){for(l=0;l<o.length;l++){var h=o[l],c=n.id(h),u=a[c];u?s.push(u):s.push(a[c]=n.create(h))}t.separation=e.depth,r.setActive(t,!0,i)}else!0===t.isActive&&r.setActive(t,!1,i)},r.setActive=function(t,e,i){e?(t.isActive=!0,t.timeUpdated=i):(t.isActive=!1,t.activeContacts.length=0)},r.id=function(t,e){return t.id<e.id?"A"+t.id+"B"+e.id:"A"+e.id+"B"+t.id}}()},{"./Contact":4}],8:[function(t,e,i){var r={};e.exports=r;var n=t("./Pair"),a=t("../core/Common");!function(){r._pairMaxIdleLife=1e3,r.create=function(t){return a.extend({table:{},list:[],collisionStart:[],collisionActive:[],collisionEnd:[]},t)},r.update=function(t,e,i){var r=t.list,o=t.table,s=t.collisionStart,l=t.collisionEnd;t=t.collisionActive;var h,c,u,p,d=[];for(s.length=0,l.length=0,p=t.length=0;p<e.length;p++)h=e[p],h.collided&&(c=n.id(h.bodyA,h.bodyB),d.push(c),(u=o[c])?(u.isActive?t.push(u):s.push(u),n.update(u,h,i)):(u=n.create(h,i),o[c]=u,s.push(u),r.push(u)));for(p=0;p<r.length;p++)u=r[p],u.isActive&&-1===a.indexOf(d,u.id)&&(n.setActive(u,!1,i),l.push(u))},r.removeOld=function(t,e){var i,n,a,o=t.list,s=t.table,l=[];for(a=0;a<o.length;a++)i=o[a],n=i.collision,n.bodyA.isSleeping||n.bodyB.isSleeping?i.timeUpdated=e:e-i.timeUpdated>r._pairMaxIdleLife&&l.push(a);for(a=0;a<l.length;a++)n=l[a]-a,i=o[n],delete s[i.id],o.splice(n,1)},r.clear=function(t){return t.table={},t.list.length=0,t.collisionStart.length=0,t.collisionActive.length=0,t.collisionEnd.length=0,t}}()},{"../core/Common":14,"./Pair":7}],9:[function(t,e,i){var r={};e.exports=r;var n=t("../geometry/Vector"),a=t("./SAT"),o=t("../geometry/Bounds"),s=t("../factory/Bodies"),l=t("../geometry/Vertices");!function(){r.collides=function(t,e){for(var i=[],r=0;r<e.length;r++){var n=e[r];if(o.overlaps(n.bounds,t.bounds))for(var s=1===n.parts.length?0:1;s<n.parts.length;s++){var l=n.parts[s];if(o.overlaps(l.bounds,t.bounds)&&(l=a.collides(l,t),l.collided)){i.push(l);break}}}return i},r.ray=function(t,e,i,a){a=a||1e-100;var o=n.angle(e,i),l=n.magnitude(n.sub(e,i));for(e=s.rectangle(.5*(i.x+e.x),.5*(i.y+e.y),l,a,{angle:o}),t=r.collides(e,t),e=0;e<t.length;e+=1)i=t[e],i.body=i.bodyB=i.bodyA;return t},r.region=function(t,e,i){for(var r=[],n=0;n<t.length;n++){var a=t[n],s=o.overlaps(a.bounds,e);(s&&!i||!s&&i)&&r.push(a)}return r},r.point=function(t,e){for(var i=[],r=0;r<t.length;r++){var n=t[r];if(o.contains(n.bounds,e))for(var a=1===n.parts.length?0:1;a<n.parts.length;a++){var s=n.parts[a];if(o.contains(s.bounds,e)&&l.contains(s.vertices,e)){i.push(n);break}}}return i}}()},{"../factory/Bodies":23,"../geometry/Bounds":26,"../geometry/Vector":28,"../geometry/Vertices":29,"./SAT":11}],10:[function(t,e,i){var r={};e.exports=r;var n=t("../geometry/Vertices"),a=t("../geometry/Vector"),o=t("../core/Common"),s=t("../geometry/Bounds");!function(){r._restingThresh=4,r._restingThreshTangent=6,r._positionDampen=.9,r._positionWarming=.8,r._frictionNormalMultiplier=5,r.preSolvePosition=function(t){var e,i,r;for(e=0;e<t.length;e++)i=t[e],i.isActive&&(r=i.activeContacts.length,i.collision.parentA.totalContacts+=r,i.collision.parentB.totalContacts+=r)},r.solvePosition=function(t,e){var i,n,o,s,l,h,c;c=a._temp[0];var u=a._temp[1],p=a._temp[2],d=a._temp[3];for(i=0;i<t.length;i++)n=t[i],n.isActive&&!n.isSensor&&(o=n.collision,s=o.parentA,l=o.parentB,h=o.normal,s=a.sub(a.add(l.positionImpulse,l.position,c),a.add(s.positionImpulse,a.sub(l.position,o.penetration,u),p),d),n.separation=a.dot(h,s));for(i=0;i<t.length;i++)n=t[i],n.isActive&&!n.isSensor&&(o=n.collision,s=o.parentA,l=o.parentB,h=o.normal,c=(n.separation-n.slop)*e,(s.isStatic||l.isStatic)&&(c*=2),s.isStatic||s.isSleeping||(n=r._positionDampen/s.totalContacts,s.positionImpulse.x+=h.x*c*n,s.positionImpulse.y+=h.y*c*n),l.isStatic||l.isSleeping||(n=r._positionDampen/l.totalContacts,l.positionImpulse.x-=h.x*c*n,l.positionImpulse.y-=h.y*c*n))},r.postSolvePosition=function(t){for(var e=0;e<t.length;e++){var i=t[e];if(i.totalContacts=0,0!==i.positionImpulse.x||0!==i.positionImpulse.y){for(var o=0;o<i.parts.length;o++){var l=i.parts[o];n.translate(l.vertices,i.positionImpulse),s.update(l.bounds,l.vertices,i.velocity),l.position.x+=i.positionImpulse.x,l.position.y+=i.positionImpulse.y}i.positionPrev.x+=i.positionImpulse.x,i.positionPrev.y+=i.positionImpulse.y,0>a.dot(i.positionImpulse,i.velocity)?(i.positionImpulse.x=0,i.positionImpulse.y=0):(i.positionImpulse.x*=r._positionWarming,i.positionImpulse.y*=r._positionWarming)}}},r.preSolveVelocity=function(t){var e,i,r,n,o,s,l,h,c,u,p=a._temp[0],d=a._temp[1];for(e=0;e<t.length;e++)if(r=t[e],r.isActive&&!r.isSensor)for(n=r.activeContacts,i=r.collision,r=i.parentA,o=i.parentB,s=i.normal,l=i.tangent,i=0;i<n.length;i++)h=n[i],c=h.vertex,u=h.normalImpulse,h=h.tangentImpulse,(0!==u||0!==h)&&(p.x=s.x*u+l.x*h,p.y=s.y*u+l.y*h,r.isStatic||r.isSleeping||(u=a.sub(c,r.position,d),r.positionPrev.x+=p.x*r.inverseMass,r.positionPrev.y+=p.y*r.inverseMass,r.anglePrev+=a.cross(u,p)*r.inverseInertia),o.isStatic||o.isSleeping||(u=a.sub(c,o.position,d),o.positionPrev.x-=p.x*o.inverseMass,o.positionPrev.y-=p.y*o.inverseMass,o.anglePrev-=a.cross(u,p)*o.inverseInertia))},r.solveVelocity=function(t,e){for(var i=e*e,n=a._temp[0],s=a._temp[1],l=a._temp[2],h=a._temp[3],c=a._temp[4],u=a._temp[5],p=0;p<t.length;p++){var d=t[p];if(d.isActive&&!d.isSensor){var f=d.collision,g=f.parentA,m=f.parentB,y=f.normal,f=f.tangent,v=d.activeContacts,_=1/v.length;g.velocity.x=g.position.x-g.positionPrev.x,g.velocity.y=g.position.y-g.positionPrev.y,m.velocity.x=m.position.x-m.positionPrev.x,m.velocity.y=m.position.y-m.positionPrev.y,g.angularVelocity=g.angle-g.anglePrev,m.angularVelocity=m.angle-m.anglePrev;for(var b=0;b<v.length;b++){var x=v[b],T=x.vertex,E=a.sub(T,g.position,s),T=a.sub(T,m.position,l),S=a.add(g.velocity,a.mult(a.perp(E),g.angularVelocity),h),C=a.add(m.velocity,a.mult(a.perp(T),m.angularVelocity),c),S=a.sub(S,C,u),w=a.dot(y,S),P=a.dot(f,S),D=Math.abs(P),A=o.sign(P),S=(1+d.restitution)*w,I=o.clamp(d.separation+w,0,1)*r._frictionNormalMultiplier,C=P,M=1/0;D>d.friction*d.frictionStatic*I*i&&(M=D,C=o.clamp(d.friction*A*i,-M,M)),D=a.cross(E,y),A=a.cross(T,y),D=_/(g.inverseMass+m.inverseMass+g.inverseInertia*D*D+m.inverseInertia*A*A),S*=D,C*=D,0>w&&w*w>r._restingThresh*i?x.normalImpulse=0:(w=x.normalImpulse,x.normalImpulse=Math.min(x.normalImpulse+S,0),S=x.normalImpulse-w),P*P>r._restingThreshTangent*i?x.tangentImpulse=0:(w=x.tangentImpulse,x.tangentImpulse=o.clamp(x.tangentImpulse+C,-M,M),C=x.tangentImpulse-w),n.x=y.x*S+f.x*C,n.y=y.y*S+f.y*C,g.isStatic||g.isSleeping||(g.positionPrev.x+=n.x*g.inverseMass,g.positionPrev.y+=n.y*g.inverseMass,g.anglePrev+=a.cross(E,n)*g.inverseInertia),m.isStatic||m.isSleeping||(m.positionPrev.x-=n.x*m.inverseMass,m.positionPrev.y-=n.y*m.inverseMass,m.anglePrev-=a.cross(T,n)*m.inverseInertia)}}}}}()},{"../core/Common":14,"../geometry/Bounds":26,"../geometry/Vector":28,"../geometry/Vertices":29}],11:[function(t,e,i){var r={};e.exports=r;var n=t("../geometry/Vertices"),a=t("../geometry/Vector");!function(){r.collides=function(t,e,i){var o,s;if(o=!1,i?(s=t.parent,o=e.parent,s=s.speed*s.speed+s.angularSpeed*s.angularSpeed+o.speed*o.speed+o.angularSpeed*o.angularSpeed,o=i&&i.collided&&.2>s,s=i):s={collided:!1,bodyA:t,bodyB:e},i&&o){if(o=s.axisBody,i=r._overlapAxes(o.vertices,(o===t?e:t).vertices,[o.axes[i.axisNumber]]),s.reused=!0,0>=i.overlap)return s.collided=!1,s}else{if(i=r._overlapAxes(t.vertices,e.vertices,t.axes),0>=i.overlap)return s.collided=!1,s;if(o=r._overlapAxes(e.vertices,t.vertices,e.axes),0>=o.overlap)return s.collided=!1,s;i.overlap<o.overlap?s.axisBody=t:(i=o,s.axisBody=e),s.axisNumber=i.axisNumber}return s.bodyA=t.id<e.id?t:e,s.bodyB=t.id<e.id?e:t,s.collided=!0,s.depth=i.overlap,s.parentA=s.bodyA.parent,s.parentB=s.bodyB.parent,t=s.bodyA,e=s.bodyB,0>a.dot(i.axis,a.sub(e.position,t.position))?s.normal={x:i.axis.x,y:i.axis.y}:s.normal={x:-i.axis.x,y:-i.axis.y},s.tangent=a.perp(s.normal),s.penetration=s.penetration||{},s.penetration.x=s.normal.x*s.depth,s.penetration.y=s.normal.y*s.depth,i=r._findSupports(t,e,s.normal),o=[],n.contains(t.vertices,i[0])&&o.push(i[0]),n.contains(t.vertices,i[1])&&o.push(i[1]),2>o.length&&(t=r._findSupports(e,t,a.neg(s.normal)),n.contains(e.vertices,t[0])&&o.push(t[0]),2>o.length&&n.contains(e.vertices,t[1])&&o.push(t[1])),1>o.length&&(o=[i[0]]),s.supports=o,s},r._overlapAxes=function(t,e,i){for(var n,o,s=a._temp[0],l=a._temp[1],h={overlap:Number.MAX_VALUE},c=0;c<i.length;c++){if(o=i[c],r._projectToAxis(s,t,o),r._projectToAxis(l,e,o),n=Math.min(s.max-l.min,l.max-s.min),0>=n){h.overlap=n;break}n<h.overlap&&(h.overlap=n,h.axis=o,h.axisNumber=c)}return h},r._projectToAxis=function(t,e,i){for(var r=a.dot(e[0],i),n=r,o=1;o<e.length;o+=1){var s=a.dot(e[o],i);s>n?n=s:r>s&&(r=s)}t.min=r,t.max=n},r._findSupports=function(t,e,i){var r=Number.MAX_VALUE,n=a._temp[0];e=e.vertices,t=t.position;var o,s,l,h;for(h=0;h<e.length;h++)s=e[h],n.x=s.x-t.x,n.y=s.y-t.y,o=-a.dot(i,n),r>o&&(r=o,l=s);return s=e[0<=l.index-1?l.index-1:e.length-1],n.x=s.x-t.x,n.y=s.y-t.y,r=-a.dot(i,n),h=s,s=e[(l.index+1)%e.length],n.x=s.x-t.x,n.y=s.y-t.y,o=-a.dot(i,n),r>o&&(h=s),[l,h]}}()},{"../geometry/Vector":28,"../geometry/Vertices":29}],12:[function(t,e,i){var r={};e.exports=r;var n=t("../geometry/Vertices"),a=t("../geometry/Vector"),o=t("../core/Sleeping"),s=t("../geometry/Bounds"),l=t("../geometry/Axes"),h=t("../core/Common");!function(){r._warming=.4,r._torqueDampen=1,r._minLength=1e-6,r.create=function(t){t.bodyA&&!t.pointA&&(t.pointA={x:0,y:0}),t.bodyB&&!t.pointB&&(t.pointB={x:0,y:0});var e=t.bodyA?a.add(t.bodyA.position,t.pointA):t.pointA,i=t.bodyB?a.add(t.bodyB.position,t.pointB):t.pointB,e=a.magnitude(a.sub(e,i));return t.length="undefined"!=typeof t.length?t.length:e,t.id=t.id||h.nextId(),t.label=t.label||"Constraint",t.type="constraint",t.stiffness=t.stiffness||(0<t.length?1:.7),t.damping=t.damping||0,t.angularStiffness=t.angularStiffness||0,t.angleA=t.bodyA?t.bodyA.angle:t.angleA,t.angleB=t.bodyB?t.bodyB.angle:t.angleB,t.plugin={},e={visible:!0,lineWidth:2,strokeStyle:"#ffffff",type:"line",anchors:!0},0===t.length&&.1<t.stiffness?(e.type="pin",e.anchors=!1):.9>t.stiffness&&(e.type="spring"),t.render=h.extend(e,t.render),t},r.preSolveAll=function(t){for(var e=0;e<t.length;e+=1){var i=t[e],r=i.constraintImpulse;i.isStatic||0===r.x&&0===r.y&&0===r.angle||(i.position.x+=r.x,i.position.y+=r.y,i.angle+=r.angle)}},r.solveAll=function(t,e){for(var i=0;i<t.length;i+=1){var n=t[i],a=!n.bodyA||n.bodyA&&n.bodyA.isStatic,n=!n.bodyB||n.bodyB&&n.bodyB.isStatic;(a||n)&&r.solve(t[i],e)}for(i=0;i<t.length;i+=1)n=t[i],a=!n.bodyA||n.bodyA&&n.bodyA.isStatic,n=!n.bodyB||n.bodyB&&n.bodyB.isStatic,a||n||r.solve(t[i],e)},r.solve=function(t,e){var i=t.bodyA,n=t.bodyB,o=t.pointA,s=t.pointB;if(i||n){i&&!i.isStatic&&(a.rotate(o,i.angle-t.angleA,o),t.angleA=i.angle),n&&!n.isStatic&&(a.rotate(s,n.angle-t.angleB,s),t.angleB=n.angle);var l=o,h=s;if(i&&(l=a.add(i.position,o)),n&&(h=a.add(n.position,s)),l&&h){var c=a.sub(l,h),u=a.magnitude(c);u<r._minLength&&(u=r._minLength);var p,d,l=a.mult(c,(u-t.length)/u*(1>t.stiffness?t.stiffness*e:t.stiffness)),h=(i?i.inverseMass:0)+(n?n.inverseMass:0),f=h+((i?i.inverseInertia:0)+(n?n.inverseInertia:0));t.damping&&(d=a.create(),p=a.div(c,u),d=a.sub(n&&a.sub(n.position,n.positionPrev)||d,i&&a.sub(i.position,i.positionPrev)||d),d=a.dot(p,d)),i&&!i.isStatic&&(c=i.inverseMass/h,i.constraintImpulse.x-=l.x*c,i.constraintImpulse.y-=l.y*c,i.position.x-=l.x*c,i.position.y-=l.y*c,t.damping&&(i.positionPrev.x-=t.damping*p.x*d*c,i.positionPrev.y-=t.damping*p.y*d*c),o=a.cross(o,l)/f*r._torqueDampen*i.inverseInertia*(1-t.angularStiffness),i.constraintImpulse.angle-=o,i.angle-=o),n&&!n.isStatic&&(c=n.inverseMass/h,n.constraintImpulse.x+=l.x*c,n.constraintImpulse.y+=l.y*c,n.position.x+=l.x*c,n.position.y+=l.y*c,t.damping&&(n.positionPrev.x+=t.damping*p.x*d*c,n.positionPrev.y+=t.damping*p.y*d*c),o=a.cross(s,l)/f*r._torqueDampen*n.inverseInertia*(1-t.angularStiffness),n.constraintImpulse.angle+=o,n.angle+=o)}}},r.postSolveAll=function(t){for(var e=0;e<t.length;e++){var i=t[e],h=i.constraintImpulse;if(!(i.isStatic||0===h.x&&0===h.y&&0===h.angle)){o.set(i,!1);for(var c=0;c<i.parts.length;c++){var u=i.parts[c];n.translate(u.vertices,h),c>0&&(u.position.x+=h.x,u.position.y+=h.y),0!==h.angle&&(n.rotate(u.vertices,h.angle,i.position),l.rotate(u.axes,h.angle),c>0&&a.rotateAbout(u.position,h.angle,i.position,u.position)),s.update(u.bounds,u.vertices,i.velocity)}h.angle*=r._warming,h.x*=r._warming,h.y*=r._warming}}}}()},{"../core/Common":14,"../core/Sleeping":22,"../geometry/Axes":25,"../geometry/Bounds":26,"../geometry/Vector":28,"../geometry/Vertices":29}],13:[function(t,e,i){var r={};e.exports=r;var n=t("../geometry/Vertices"),a=t("../core/Sleeping"),o=t("../core/Mouse"),s=t("../core/Events"),l=t("../collision/Detector"),h=t("./Constraint"),c=t("../body/Composite"),u=t("../core/Common"),p=t("../geometry/Bounds");!function(){r.create=function(t,e){var i=(t?t.mouse:null)||(e?e.mouse:null);i||(t&&t.render&&t.render.canvas?i=o.create(t.render.canvas):e&&e.element?i=o.create(e.element):(i=o.create(),u.warn("MouseConstraint.create: options.mouse was undefined, options.element was undefined, may not function as expected")));var n=h.create({label:"Mouse Constraint",pointA:i.position,pointB:{x:0,y:0},length:.01,stiffness:.1,angularStiffness:1,render:{strokeStyle:"#90EE90",lineWidth:3}}),a=u.extend({type:"mouseConstraint",mouse:i,element:null,body:null,constraint:n,collisionFilter:{category:1,mask:4294967295,group:0}},e);return s.on(t,"beforeUpdate",function(){var e=c.allBodies(t.world);r.update(a,e),r._triggerEvents(a)}),a},r.update=function(t,e){var i=t.mouse,r=t.constraint,o=t.body;if(0===i.button){if(r.bodyB)a.set(r.bodyB,!1),r.pointA=i.position;else for(var h=0;h<e.length;h++)if(o=e[h],p.contains(o.bounds,i.position)&&l.canCollide(o.collisionFilter,t.collisionFilter))for(var c=1<o.parts.length?1:0;c<o.parts.length;c++)if(n.contains(o.parts[c].vertices,i.position)){r.pointA=i.position,r.bodyB=t.body=o,r.pointB={x:i.position.x-o.position.x,y:i.position.y-o.position.y},r.angleB=o.angle,a.set(o,!1),s.trigger(t,"startdrag",{mouse:i,body:o});break}}else r.bodyB=t.body=null,r.pointB=null,o&&s.trigger(t,"enddrag",{mouse:i,body:o})},r._triggerEvents=function(t){var e=t.mouse,i=e.sourceEvents;i.mousemove&&s.trigger(t,"mousemove",{mouse:e}),i.mousedown&&s.trigger(t,"mousedown",{mouse:e}),i.mouseup&&s.trigger(t,"mouseup",{mouse:e}),o.clearSourceEvents(e)}}()},{"../body/Composite":2,"../collision/Detector":5,"../core/Common":14,"../core/Events":16,"../core/Mouse":19,"../core/Sleeping":22,"../geometry/Bounds":26,"../geometry/Vertices":29,"./Constraint":12}],14:[function(t,e,i){var r={};e.exports=r,function(){r._nextId=0,r._seed=0,r._nowStartTime=+new Date,r.extend=function(t,e){var i,n;for("boolean"==typeof e?(i=2,n=e):(i=1,n=!0);i<arguments.length;i++){var a=arguments[i];if(a)for(var o in a)n&&a[o]&&a[o].constructor===Object?t[o]&&t[o].constructor!==Object?t[o]=a[o]:(t[o]=t[o]||{},r.extend(t[o],n,a[o])):t[o]=a[o]}return t},r.clone=function(t,e){return r.extend({},e,t)},r.keys=function(t){if(Object.keys)return Object.keys(t);var e,i=[];for(e in t)i.push(e);return i},r.values=function(t){var e=[];if(Object.keys){for(var i=Object.keys(t),r=0;r<i.length;r++)e.push(t[i[r]]);return e}for(i in t)e.push(t[i]);return e},r.get=function(t,e,i,r){for(e=e.split(".").slice(i,r),i=0;i<e.length;i+=1)t=t[e[i]];return t},r.set=function(t,e,i,n,a){return n=e.split(".").slice(n,a),r.get(t,e,0,-1)[n[n.length-1]]=i},r.shuffle=function(t){for(var e=t.length-1;e>0;e--){var i=Math.floor(r.random()*(e+1)),n=t[e];t[e]=t[i],t[i]=n}return t},r.choose=function(t){return t[Math.floor(r.random()*t.length)]},r.isElement=function(t){return"undefined"!=typeof HTMLElement?t instanceof HTMLElement:!!(t&&t.nodeType&&t.nodeName)},r.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)},r.isFunction=function(t){return"function"==typeof t},r.isPlainObject=function(t){return"object"==typeof t&&t.constructor===Object},r.isString=function(t){return"[object String]"===toString.call(t)},r.clamp=function(t,e,i){return e>t?e:t>i?i:t},r.sign=function(t){return 0>t?-1:1},r.now=function(){if(window.performance){if(window.performance.now)return window.performance.now();if(window.performance.webkitNow)return window.performance.webkitNow()}return new Date-r._nowStartTime},r.random=function(t,e){return t="undefined"!=typeof t?t:0,r._seed=(9301*r._seed+49297)%233280,t+r._seed/233280*(("undefined"!=typeof e?e:1)-t)},r.colorToNumber=function(t){return t=t.replace("#",""),3==t.length&&(t=t.charAt(0)+t.charAt(0)+t.charAt(1)+t.charAt(1)+t.charAt(2)+t.charAt(2)),parseInt(t,16)},r.logLevel=1,r.log=function(){console&&0<r.logLevel&&3>=r.logLevel&&console.log.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},r.info=function(){console&&0<r.logLevel&&2>=r.logLevel&&console.info.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},r.warn=function(){console&&0<r.logLevel&&3>=r.logLevel&&console.warn.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},r.nextId=function(){return r._nextId++},r.indexOf=function(t,e){if(t.indexOf)return t.indexOf(e);for(var i=0;i<t.length;i++)if(t[i]===e)return i;return-1},r.map=function(t,e){if(t.map)return t.map(e);for(var i=[],r=0;r<t.length;r+=1)i.push(e(t[r]));return i},r.topologicalSort=function(t){var e,i=[],n=[],a=[];for(e in t)n[e]||a[e]||r._topologicalSort(e,n,a,t,i);return i},r._topologicalSort=function(t,e,i,n,a){var o=n[t]||[];i[t]=!0;for(var s=0;s<o.length;s+=1){var l=o[s];i[l]||e[l]||r._topologicalSort(l,e,i,n,a)}i[t]=!1,e[t]=!0,a.push(t)},r.chain=function(){for(var t=[],e=0;e<arguments.length;e+=1){var i=arguments[e];i._chained?t.push.apply(t,i._chained):t.push(i)}return e=function(){for(var e,i=Array(arguments.length),r=0,n=arguments.length;n>r;r++)i[r]=arguments[r];for(r=0;r<t.length;r+=1)n=t[r].apply(e,i),"undefined"!=typeof n&&(e=n);return e},e._chained=t,e},r.chainPathBefore=function(t,e,i){return r.set(t,e,r.chain(i,r.get(t,e)))},r.chainPathAfter=function(t,e,i){return r.set(t,e,r.chain(r.get(t,e),i))}}()},{}],15:[function(t,e,i){var r={};e.exports=r;var n=t("../body/World"),a=t("./Sleeping"),o=t("../collision/Resolver"),s=t("../render/Render"),l=t("../collision/Pairs");t("./Metrics");var h=t("../collision/Grid"),c=t("./Events"),u=t("../body/Composite"),p=t("../constraint/Constraint"),d=t("./Common"),f=t("../body/Body");!function(){r.create=function(t,e){e=d.isElement(t)?e:t,t=d.isElement(t)?t:null,e=e||{},(t||e.render)&&d.warn("Engine.create: engine.render is deprecated (see docs)");var i=d.extend({positionIterations:6,velocityIterations:4,constraintIterations:2,enableSleeping:!1,events:[],plugin:{},timing:{timestamp:0,timeScale:1},broadphase:{controller:h}},e);return(t||i.render)&&(i.render=d.extend({element:t,controller:s},i.render)),i.render&&i.render.controller&&(i.render=i.render.controller.create(i.render)),i.render&&(i.render.engine=i),i.world=e.world||n.create(i.world),i.pairs=l.create(),i.broadphase=i.broadphase.controller.create(i.broadphase),i.metrics=i.metrics||{extended:!1},i},r.update=function(t,e,i){e=e||1e3/60,i=i||1;var n=t.world,s=t.timing,h=t.broadphase;s.timestamp+=e*s.timeScale;var d={timestamp:s.timestamp};c.trigger(t,"beforeUpdate",d);var f=u.allBodies(n),g=u.allConstraints(n);for(t.enableSleeping&&a.update(f,s.timeScale),r._bodiesApplyGravity(f,n.gravity),r._bodiesUpdate(f,e,s.timeScale,i,n.bounds),p.preSolveAll(f),e=0;e<t.constraintIterations;e++)p.solveAll(g,s.timeScale);for(p.postSolveAll(f),h.controller?(n.isModified&&h.controller.clear(h),h.controller.update(h,f,t,n.isModified),e=h.pairsList):e=f,n.isModified&&u.setModified(n,!1,!1,!0),h=h.detector(e,t),n=t.pairs,e=s.timestamp,l.update(n,h,e),l.removeOld(n,e),t.enableSleeping&&a.afterCollisions(n.list,s.timeScale),0<n.collisionStart.length&&c.trigger(t,"collisionStart",{pairs:n.collisionStart}),o.preSolvePosition(n.list),e=0;e<t.positionIterations;e++)o.solvePosition(n.list,s.timeScale);for(o.postSolvePosition(f),p.preSolveAll(f),e=0;e<t.constraintIterations;e++)p.solveAll(g,s.timeScale);for(p.postSolveAll(f),o.preSolveVelocity(n.list),e=0;e<t.velocityIterations;e++)o.solveVelocity(n.list,s.timeScale);return 0<n.collisionActive.length&&c.trigger(t,"collisionActive",{pairs:n.collisionActive}),0<n.collisionEnd.length&&c.trigger(t,"collisionEnd",{pairs:n.collisionEnd}),r._bodiesClearForces(f),c.trigger(t,"afterUpdate",d),t},r.merge=function(t,e){if(d.extend(t,e),e.world){t.world=e.world,r.clear(t);for(var i=u.allBodies(t.world),n=0;n<i.length;n++){var o=i[n];a.set(o,!1),o.id=d.nextId()}}},r.clear=function(t){var e=t.world;l.clear(t.pairs);var i=t.broadphase;i.controller&&(e=u.allBodies(e),i.controller.clear(i),i.controller.update(i,e,t,!0))},r._bodiesClearForces=function(t){for(var e=0;e<t.length;e++){var i=t[e];i.force.x=0,i.force.y=0,i.torque=0}},r._bodiesApplyGravity=function(t,e){var i="undefined"!=typeof e.scale?e.scale:.001;if((0!==e.x||0!==e.y)&&0!==i)for(var r=0;r<t.length;r++){var n=t[r];n.isStatic||n.isSleeping||(n.force.y+=n.mass*e.y*i,n.force.x+=n.mass*e.x*i)}},r._bodiesUpdate=function(t,e,i,r,n){for(n=0;n<t.length;n++){var a=t[n];a.isStatic||a.isSleeping||f.update(a,e,i,r)}}}()},{"../body/Body":1,"../body/Composite":2,"../body/World":3,"../collision/Grid":6,"../collision/Pairs":8,"../collision/Resolver":10,"../constraint/Constraint":12,"../render/Render":31,"./Common":14,"./Events":16,"./Metrics":18,"./Sleeping":22}],16:[function(t,e,i){var r={};e.exports=r;var n=t("./Common");!function(){r.on=function(t,e,i){e=e.split(" ");for(var r,n=0;n<e.length;n++)r=e[n],t.events=t.events||{},t.events[r]=t.events[r]||[],t.events[r].push(i);return i},r.off=function(t,e,i){if(e){"function"==typeof e&&(i=e,e=n.keys(t.events).join(" ")),e=e.split(" ");for(var r=0;r<e.length;r++){var a=t.events[e[r]],o=[];if(i&&a)for(var s=0;s<a.length;s++)a[s]!==i&&o.push(a[s]);t.events[e[r]]=o}}else t.events={}},r.trigger=function(t,e,i){var r,a,o;if(t.events){i||(i={}),e=e.split(" ");for(var s=0;s<e.length;s++)if(r=e[s],a=t.events[r])for(o=n.clone(i,!1),o.name=r,o.source=t,r=0;r<a.length;r++)a[r].apply(t,[o])}}}()},{"./Common":14}],17:[function(t,e,i){var r={};e.exports=r;var n=t("./Plugin"),a=t("./Common");!function(){r.name="matter-js",r.version="0.14.1",r.uses=[],r.used=[],r.use=function(){n.use(r,Array.prototype.slice.call(arguments))},r.before=function(t,e){return t=t.replace(/^Matter./,""),a.chainPathBefore(r,t,e)},r.after=function(t,e){return t=t.replace(/^Matter./,""),a.chainPathAfter(r,t,e)}}()},{"./Common":14,"./Plugin":20}],18:[function(t,e,i){},{"../body/Composite":2,"./Common":14}],19:[function(t,e,i){var r={};e.exports=r;var n=t("../core/Common");!function(){r.create=function(t){var e={};return t||n.log("Mouse.create: element was undefined, defaulting to document.body","warn"),e.element=t||document.body,e.absolute={x:0,y:0},e.position={x:0,y:0},e.mousedownPosition={x:0,y:0},e.mouseupPosition={x:0,y:0},e.offset={x:0,y:0},e.scale={x:1,y:1},e.wheelDelta=0,e.button=-1,e.pixelRatio=e.element.getAttribute("data-pixel-ratio")||1,e.sourceEvents={mousemove:null,mousedown:null,mouseup:null,mousewheel:null},e.mousemove=function(t){var i=r._getRelativeMousePosition(t,e.element,e.pixelRatio);t.changedTouches&&(e.button=0,t.preventDefault()),e.absolute.x=i.x,e.absolute.y=i.y,e.position.x=e.absolute.x*e.scale.x+e.offset.x,e.position.y=e.absolute.y*e.scale.y+e.offset.y,e.sourceEvents.mousemove=t},e.mousedown=function(t){var i=r._getRelativeMousePosition(t,e.element,e.pixelRatio);t.changedTouches?(e.button=0,t.preventDefault()):e.button=t.button,e.absolute.x=i.x,e.absolute.y=i.y,e.position.x=e.absolute.x*e.scale.x+e.offset.x,e.position.y=e.absolute.y*e.scale.y+e.offset.y,e.mousedownPosition.x=e.position.x,e.mousedownPosition.y=e.position.y,e.sourceEvents.mousedown=t},e.mouseup=function(t){var i=r._getRelativeMousePosition(t,e.element,e.pixelRatio);t.changedTouches&&t.preventDefault(),e.button=-1,e.absolute.x=i.x,e.absolute.y=i.y,e.position.x=e.absolute.x*e.scale.x+e.offset.x,e.position.y=e.absolute.y*e.scale.y+e.offset.y,e.mouseupPosition.x=e.position.x,e.mouseupPosition.y=e.position.y,e.sourceEvents.mouseup=t},e.mousewheel=function(t){e.wheelDelta=Math.max(-1,Math.min(1,t.wheelDelta||-t.detail)),t.preventDefault()},r.setElement(e,e.element),e},r.setElement=function(t,e){t.element=e,e.addEventListener("mousemove",t.mousemove),e.addEventListener("mousedown",t.mousedown),e.addEventListener("mouseup",t.mouseup),e.addEventListener("mousewheel",t.mousewheel),e.addEventListener("DOMMouseScroll",t.mousewheel),e.addEventListener("touchmove",t.mousemove),e.addEventListener("touchstart",t.mousedown),e.addEventListener("touchend",t.mouseup)},r.clearSourceEvents=function(t){t.sourceEvents.mousemove=null,t.sourceEvents.mousedown=null,t.sourceEvents.mouseup=null,t.sourceEvents.mousewheel=null,t.wheelDelta=0},r.setOffset=function(t,e){t.offset.x=e.x,t.offset.y=e.y,t.position.x=t.absolute.x*t.scale.x+t.offset.x,t.position.y=t.absolute.y*t.scale.y+t.offset.y},r.setScale=function(t,e){t.scale.x=e.x,t.scale.y=e.y,t.position.x=t.absolute.x*t.scale.x+t.offset.x,t.position.y=t.absolute.y*t.scale.y+t.offset.y},r._getRelativeMousePosition=function(t,e,i){var r=e.getBoundingClientRect(),n=document.documentElement||document.body.parentNode||document.body,a=void 0!==window.pageXOffset?window.pageXOffset:n.scrollLeft,n=void 0!==window.pageYOffset?window.pageYOffset:n.scrollTop,o=t.changedTouches;return o?(a=o[0].pageX-r.left-a,t=o[0].pageY-r.top-n):(a=t.pageX-r.left-a,t=t.pageY-r.top-n),{x:a/(e.clientWidth/(e.width||e.clientWidth)*i),y:t/(e.clientHeight/(e.height||e.clientHeight)*i)}}}()},{"../core/Common":14}],20:[function(t,e,i){var r={};e.exports=r;var n=t("./Common");!function(){r._registry={},r.register=function(t){if(r.isPlugin(t)||n.warn("Plugin.register:",r.toString(t),"does not implement all required fields."),t.name in r._registry){var e=r._registry[t.name],i=r.versionParse(t.version).number,a=r.versionParse(e.version).number;i>a?(n.warn("Plugin.register:",r.toString(e),"was upgraded to",r.toString(t)),r._registry[t.name]=t):a>i?n.warn("Plugin.register:",r.toString(e),"can not be downgraded to",r.toString(t)):t!==e&&n.warn("Plugin.register:",r.toString(t),"is already registered to different plugin object")}else r._registry[t.name]=t;return t},r.resolve=function(t){return r._registry[r.dependencyParse(t).name]},r.toString=function(t){return"string"==typeof t?t:(t.name||"anonymous")+"@"+(t.version||t.range||"0.0.0")},r.isPlugin=function(t){return t&&t.name&&t.version&&t.install},r.isUsed=function(t,e){return-1<t.used.indexOf(e)},r.isFor=function(t,e){var i=t["for"]&&r.dependencyParse(t["for"]);return!t["for"]||e.name===i.name&&r.versionSatisfies(e.version,i.range)},r.use=function(t,e){if(t.uses=(t.uses||[]).concat(e||[]),0===t.uses.length)n.warn("Plugin.use:",r.toString(t),"does not specify any dependencies to install.");else{for(var i=r.dependencies(t),i=n.topologicalSort(i),a=[],o=0;o<i.length;o+=1)if(i[o]!==t.name){var s=r.resolve(i[o]);s?r.isUsed(t,s.name)||(r.isFor(s,t)||(n.warn("Plugin.use:",r.toString(s),"is for",s["for"],"but installed on",r.toString(t)+"."),s._warned=!0),s.install?s.install(t):(n.warn("Plugin.use:",r.toString(s),"does not specify an install function."),s._warned=!0),s._warned?(a.push("🔶 "+r.toString(s)),delete s._warned):a.push("✅ "+r.toString(s)),t.used.push(s.name)):a.push("❌ "+i[o])}0<a.length&&n.info(a.join("  "))}},r.dependencies=function(t,e){var i=r.dependencyParse(t),a=i.name;if(e=e||{},!(a in e)){t=r.resolve(t)||t,e[a]=n.map(t.uses||[],function(e){r.isPlugin(e)&&r.register(e);var a=r.dependencyParse(e),o=r.resolve(e);return o&&!r.versionSatisfies(o.version,a.range)?(n.warn("Plugin.dependencies:",r.toString(o),"does not satisfy",r.toString(a),"used by",r.toString(i)+"."),o._warned=!0,t._warned=!0):o||(n.warn("Plugin.dependencies:",r.toString(e),"used by",r.toString(i),"could not be resolved."),t._warned=!0),a.name});for(var o=0;o<e[a].length;o+=1)r.dependencies(e[a][o],e);return e}},r.dependencyParse=function(t){return n.isString(t)?(/^[\w-]+(@(\*|[\^~]?\d+\.\d+\.\d+(-[0-9A-Za-z-]+)?))?$/.test(t)||n.warn("Plugin.dependencyParse:",t,"is not a valid dependency string."),{name:t.split("@")[0],range:t.split("@")[1]||"*"}):{name:t.name,range:t.range||t.version}},r.versionParse=function(t){/^\*|[\^~]?\d+\.\d+\.\d+(-[0-9A-Za-z-]+)?$/.test(t)||n.warn("Plugin.versionParse:",t,"is not a valid version or range.");var e=t.split("-");t=e[0];var i=isNaN(Number(t[0])),r=i?t.substr(1):t,a=n.map(r.split("."),function(t){return Number(t)});return{isRange:i,version:r,range:t,operator:i?t[0]:"",parts:a,prerelease:e[1],number:1e8*a[0]+1e4*a[1]+a[2]}},r.versionSatisfies=function(t,e){e=e||"*";var i=r.versionParse(e),n=i.parts,a=r.versionParse(t),o=a.parts;if(i.isRange){if("*"===i.operator||"*"===t)return!0;if("~"===i.operator)return o[0]===n[0]&&o[1]===n[1]&&o[2]>=n[2];if("^"===i.operator)return 0<n[0]?o[0]===n[0]&&a.number>=i.number:0<n[1]?o[1]===n[1]&&o[2]>=n[2]:o[2]===n[2]}return t===e||"*"===t}}()},{"./Common":14}],21:[function(t,e,i){var r={};e.exports=r;var n=t("./Events"),a=t("./Engine"),o=t("./Common");!function(){var t,e;if("undefined"!=typeof window&&(t=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame,e=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),!t){var i;
t=function(t){i=setTimeout(function(){t(o.now())},1e3/60)},e=function(){clearTimeout(i)}}r.create=function(t){return t=o.extend({fps:60,correction:1,deltaSampleSize:60,counterTimestamp:0,frameCounter:0,deltaHistory:[],timePrev:null,timeScalePrev:1,frameRequestId:null,isFixed:!1,enabled:!0},t),t.delta=t.delta||1e3/t.fps,t.deltaMin=t.deltaMin||1e3/t.fps,t.deltaMax=t.deltaMax||1e3/(.5*t.fps),t.fps=1e3/t.delta,t},r.run=function(e,i){return"undefined"!=typeof e.positionIterations&&(i=e,e=r.create()),function n(a){e.frameRequestId=t(n),a&&e.enabled&&r.tick(e,i,a)}(),e},r.tick=function(t,e,i){var r,o=e.timing,s=1,l={timestamp:o.timestamp};n.trigger(t,"beforeTick",l),n.trigger(e,"beforeTick",l),t.isFixed?r=t.delta:(r=i-t.timePrev||t.delta,t.timePrev=i,t.deltaHistory.push(r),t.deltaHistory=t.deltaHistory.slice(-t.deltaSampleSize),r=Math.min.apply(null,t.deltaHistory),r=r<t.deltaMin?t.deltaMin:r,r=r>t.deltaMax?t.deltaMax:r,s=r/t.delta,t.delta=r),0!==t.timeScalePrev&&(s*=o.timeScale/t.timeScalePrev),0===o.timeScale&&(s=0),t.timeScalePrev=o.timeScale,t.correction=s,t.frameCounter+=1,1e3<=i-t.counterTimestamp&&(t.fps=(i-t.counterTimestamp)/1e3*t.frameCounter,t.counterTimestamp=i,t.frameCounter=0),n.trigger(t,"tick",l),n.trigger(e,"tick",l),e.world.isModified&&e.render&&e.render.controller&&e.render.controller.clear&&e.render.controller.clear(e.render),n.trigger(t,"beforeUpdate",l),a.update(e,r,s),n.trigger(t,"afterUpdate",l),e.render&&e.render.controller&&(n.trigger(t,"beforeRender",l),n.trigger(e,"beforeRender",l),e.render.controller.world(e.render),n.trigger(t,"afterRender",l),n.trigger(e,"afterRender",l)),n.trigger(t,"afterTick",l),n.trigger(e,"afterTick",l)},r.stop=function(t){e(t.frameRequestId)},r.start=function(t,e){r.run(t,e)}}()},{"./Common":14,"./Engine":15,"./Events":16}],22:[function(t,e,i){var r={};e.exports=r;var n=t("./Events");!function(){r._motionWakeThreshold=.18,r._motionSleepThreshold=.08,r._minBias=.9,r.update=function(t,e){for(var i=e*e*e,n=0;n<t.length;n++){var a=t[n],o=a.speed*a.speed+a.angularSpeed*a.angularSpeed;0!==a.force.x||0!==a.force.y?r.set(a,!1):(a.motion=r._minBias*Math.min(a.motion,o)+(1-r._minBias)*Math.max(a.motion,o),0<a.sleepThreshold&&a.motion<r._motionSleepThreshold*i?(a.sleepCounter+=1,a.sleepCounter>=a.sleepThreshold&&r.set(a,!0)):0<a.sleepCounter&&--a.sleepCounter)}},r.afterCollisions=function(t,e){for(var i=e*e*e,n=0;n<t.length;n++){var a=t[n];if(a.isActive){var o=a.collision,a=o.bodyA.parent,s=o.bodyB.parent;a.isSleeping&&s.isSleeping||a.isStatic||s.isStatic||!a.isSleeping&&!s.isSleeping||(o=a.isSleeping&&!a.isStatic?a:s,a=o===a?s:a,!o.isStatic&&a.motion>r._motionWakeThreshold*i&&r.set(o,!1))}}},r.set=function(t,e){var i=t.isSleeping;e?(t.isSleeping=!0,t.sleepCounter=t.sleepThreshold,t.positionImpulse.x=0,t.positionImpulse.y=0,t.positionPrev.x=t.position.x,t.positionPrev.y=t.position.y,t.anglePrev=t.angle,t.speed=0,t.angularSpeed=0,t.motion=0,i||n.trigger(t,"sleepStart")):(t.isSleeping=!1,t.sleepCounter=0,i&&n.trigger(t,"sleepEnd"))}}()},{"./Events":16}],23:[function(t,e,i){(function(i){var r={};e.exports=r;var n=t("../geometry/Vertices"),a=t("../core/Common"),o=t("../body/Body"),s=t("../geometry/Bounds"),l=t("../geometry/Vector"),h="undefined"!=typeof window?window.decomp:"undefined"!=typeof i?i.decomp:null;!function(){r.rectangle=function(t,e,i,r,s){return s=s||{},t={label:"Rectangle Body",position:{x:t,y:e},vertices:n.fromPath("L 0 0 L "+i+" 0 L "+i+" "+r+" L 0 "+r)},s.chamfer&&(e=s.chamfer,t.vertices=n.chamfer(t.vertices,e.radius,e.quality,e.qualityMin,e.qualityMax),delete s.chamfer),o.create(a.extend({},t,s))},r.trapezoid=function(t,e,i,r,s,l){l=l||{},s*=.5;var h=i*s;i=h+(1-2*s)*i;var c=i+h;return t={label:"Trapezoid Body",position:{x:t,y:e},vertices:n.fromPath(.5>s?"L 0 0 L "+h+" "+-r+" L "+i+" "+-r+" L "+c+" 0":"L 0 0 L "+i+" "+-r+" L "+c+" 0")},l.chamfer&&(e=l.chamfer,t.vertices=n.chamfer(t.vertices,e.radius,e.quality,e.qualityMin,e.qualityMax),delete l.chamfer),o.create(a.extend({},t,l))},r.circle=function(t,e,i,n,o){n=n||{};var s={label:"Circle Body",circleRadius:i};return o=Math.ceil(Math.max(10,Math.min(o||25,i))),1===o%2&&(o+=1),r.polygon(t,e,o,i,a.extend({},s,n))},r.polygon=function(t,e,i,s,l){if(l=l||{},3>i)return r.circle(t,e,s,l);for(var h=2*Math.PI/i,c="",u=.5*h,p=0;i>p;p+=1)var d=u+p*h,f=Math.sin(d)*s,c=c+("L "+(Math.cos(d)*s).toFixed(3)+" "+f.toFixed(3)+" ");return t={label:"Polygon Body",position:{x:t,y:e},vertices:n.fromPath(c)},l.chamfer&&(e=l.chamfer,t.vertices=n.chamfer(t.vertices,e.radius,e.quality,e.qualityMin,e.qualityMax),delete l.chamfer),o.create(a.extend({},t,l))},r.fromVertices=function(t,e,i,r,c,u,p){var d,f,g,m;for(r=r||{},d=[],c="undefined"!=typeof c?c:!1,u="undefined"!=typeof u?u:.01,p="undefined"!=typeof p?p:10,h||a.warn("Bodies.fromVertices: poly-decomp.js required. Could not decompose vertices. Fallback to convex hull."),a.isArray(i[0])||(i=[i]),m=0;m<i.length;m+=1)if(g=i[m],(f=n.isConvex(g))||!h)g=f?n.clockwiseSort(g):n.hull(g),d.push({position:{x:t,y:e},vertices:g});else for(f=g.map(function(t){return[t.x,t.y]}),h.makeCCW(f),!1!==u&&h.removeCollinearPoints(f,u),g=h.quickDecomp(f),f=0;f<g.length;f++){var y=g[f].map(function(t){return{x:t[0],y:t[1]}});p>0&&n.area(y)<p||d.push({position:n.centre(y),vertices:y})}for(f=0;f<d.length;f++)d[f]=o.create(a.extend(d[f],r));if(c)for(f=0;f<d.length;f++)for(p=d[f],i=f+1;i<d.length;i++)if(m=d[i],s.overlaps(p.bounds,m.bounds))for(g=p.vertices,y=m.vertices,c=0;c<p.vertices.length;c++)for(u=0;u<m.vertices.length;u++){var v=l.magnitudeSquared(l.sub(g[(c+1)%g.length],y[u])),_=l.magnitudeSquared(l.sub(g[c],y[(u+1)%y.length]));5>v&&5>_&&(g[c].isInternal=!0,y[u].isInternal=!0)}return 1<d.length?(r=o.create(a.extend({parts:d.slice(0)},r)),o.setPosition(r,{x:t,y:e}),r):d[0]}}()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../body/Body":1,"../core/Common":14,"../geometry/Bounds":26,"../geometry/Vector":28,"../geometry/Vertices":29}],24:[function(t,e,i){var r={};e.exports=r;var n=t("../body/Composite"),a=t("../constraint/Constraint"),o=t("../core/Common"),s=t("../body/Body"),l=t("./Bodies");!function(){r.stack=function(t,e,i,r,a,o,l){for(var h,c=n.create({label:"Stack"}),u=t,p=0,d=0;r>d;d++){for(var f=0,g=0;i>g;g++){var m=l(u,e,g,d,h,p);m?(u=m.bounds.max.y-m.bounds.min.y,h=m.bounds.max.x-m.bounds.min.x,u>f&&(f=u),s.translate(m,{x:.5*h,y:.5*u}),u=m.bounds.max.x+a,n.addBody(c,m),h=m,p+=1):u+=a}e+=f+o,u=t}return c},r.chain=function(t,e,i,r,s,l){for(var h=t.bodies,c=1;c<h.length;c++){var u=h[c-1],p=h[c],u=o.extend({bodyA:u,pointA:{x:(u.bounds.max.x-u.bounds.min.x)*e,y:(u.bounds.max.y-u.bounds.min.y)*i},bodyB:p,pointB:{x:(p.bounds.max.x-p.bounds.min.x)*r,y:(p.bounds.max.y-p.bounds.min.y)*s}},l);n.addConstraint(t,a.create(u))}return t.label+=" Chain",t},r.mesh=function(t,e,i,r,s){var l,h,c,u,p=t.bodies;for(l=0;i>l;l++){for(h=1;e>h;h++)c=p[h-1+l*e],u=p[h+l*e],n.addConstraint(t,a.create(o.extend({bodyA:c,bodyB:u},s)));if(l>0)for(h=0;e>h;h++)c=p[h+(l-1)*e],u=p[h+l*e],n.addConstraint(t,a.create(o.extend({bodyA:c,bodyB:u},s))),r&&h>0&&(c=p[h-1+(l-1)*e],n.addConstraint(t,a.create(o.extend({bodyA:c,bodyB:u},s)))),r&&e-1>h&&(c=p[h+1+(l-1)*e],n.addConstraint(t,a.create(o.extend({bodyA:c,bodyB:u},s))))}return t.label+=" Mesh",t},r.pyramid=function(t,e,i,n,a,o,l){return r.stack(t,e,i,n,a,o,function(e,r,o,h,c,u){var p=Math.min(n,Math.ceil(i/2));return e=c?c.bounds.max.x-c.bounds.min.x:0,h>p||(h=p-h,p=i-1-h,h>o||o>p)?void 0:(1===u&&s.translate(c,{x:(o+(1===i%2?1:-1))*e,y:0}),l(t+(c?o*e:0)+o*a,r,o,h,c,u))})},r.newtonsCradle=function(t,e,i,r,o){for(var s=n.create({label:"Newtons Cradle"}),h=0;i>h;h++){var c=l.circle(t+1.9*h*r,e+o,r,{inertia:1/0,restitution:1,friction:0,frictionAir:1e-4,slop:1}),u=a.create({pointA:{x:t+1.9*h*r,y:e},bodyB:c});n.addBody(s,c),n.addConstraint(s,u)}return s},r.car=function(t,e,i,r,o){var h=s.nextGroup(!0),c=.5*-i+20,u=.5*i-20,p=n.create({label:"Car"});return i=l.rectangle(t,e,i,r,{collisionFilter:{group:h},chamfer:{radius:.5*r},density:2e-4}),r=l.circle(t+c,e+0,o,{collisionFilter:{group:h},friction:.8}),t=l.circle(t+u,e+0,o,{collisionFilter:{group:h},friction:.8}),c=a.create({bodyB:i,pointB:{x:c,y:0},bodyA:r,stiffness:1,length:0}),u=a.create({bodyB:i,pointB:{x:u,y:0},bodyA:t,stiffness:1,length:0}),n.addBody(p,i),n.addBody(p,r),n.addBody(p,t),n.addConstraint(p,c),n.addConstraint(p,u),p},r.softBody=function(t,e,i,n,a,s,h,c,u,p){return u=o.extend({inertia:1/0},u),p=o.extend({stiffness:.2,render:{type:"line",anchors:!1}},p),t=r.stack(t,e,i,n,a,s,function(t,e){return l.circle(t,e,c,u)}),r.mesh(t,i,n,h,p),t.label="Soft Body",t}}()},{"../body/Body":1,"../body/Composite":2,"../constraint/Constraint":12,"../core/Common":14,"./Bodies":23}],25:[function(t,e,i){var r={};e.exports=r;var n=t("../geometry/Vector"),a=t("../core/Common");!function(){r.fromVertices=function(t){for(var e={},i=0;i<t.length;i++){var r=(i+1)%t.length,r=n.normalise({x:t[r].y-t[i].y,y:t[i].x-t[r].x}),o=0===r.y?1/0:r.x/r.y,o=o.toFixed(3).toString();e[o]=r}return a.values(e)},r.rotate=function(t,e){if(0!==e)for(var i=Math.cos(e),r=Math.sin(e),n=0;n<t.length;n++){var a,o=t[n];a=o.x*i-o.y*r,o.y=o.x*r+o.y*i,o.x=a}}}()},{"../core/Common":14,"../geometry/Vector":28}],26:[function(t,e,i){var r={};e.exports=r,function(){r.create=function(t){var e={min:{x:0,y:0},max:{x:0,y:0}};return t&&r.update(e,t),e},r.update=function(t,e,i){t.min.x=1/0,t.max.x=-(1/0),t.min.y=1/0,t.max.y=-(1/0);for(var r=0;r<e.length;r++){var n=e[r];n.x>t.max.x&&(t.max.x=n.x),n.x<t.min.x&&(t.min.x=n.x),n.y>t.max.y&&(t.max.y=n.y),n.y<t.min.y&&(t.min.y=n.y)}i&&(0<i.x?t.max.x+=i.x:t.min.x+=i.x,0<i.y?t.max.y+=i.y:t.min.y+=i.y)},r.contains=function(t,e){return e.x>=t.min.x&&e.x<=t.max.x&&e.y>=t.min.y&&e.y<=t.max.y},r.overlaps=function(t,e){return t.min.x<=e.max.x&&t.max.x>=e.min.x&&t.max.y>=e.min.y&&t.min.y<=e.max.y},r.translate=function(t,e){t.min.x+=e.x,t.max.x+=e.x,t.min.y+=e.y,t.max.y+=e.y},r.shift=function(t,e){var i=t.max.x-t.min.x,r=t.max.y-t.min.y;t.min.x=e.x,t.max.x=e.x+i,t.min.y=e.y,t.max.y=e.y+r}}()},{}],27:[function(t,e,i){var r={};e.exports=r,t("../geometry/Bounds"),function(){r.pathToVertices=function(t,e){var i,n,a,o,s,l,h,c,u=[],p=0,d=0,f=0;e=e||15;var g=function(t,e,i){if(i=1===i%2&&i>1,!l||t!=l.x||e!=l.y){l&&i?(h=l.x,c=l.y):c=h=0;var r={x:h+t,y:c+e};(i||!l)&&(l=r),u.push(r),d=h+t,f=c+e}},m=function(t){var e=t.pathSegTypeAsLetter.toUpperCase();if("Z"!==e){switch(e){case"M":case"L":case"T":case"C":case"S":case"Q":d=t.x,f=t.y;break;case"H":d=t.x;break;case"V":f=t.y}g(d,f,t.pathSegType)}};for(r._svgPathToAbsolute(t),n=t.getTotalLength(),a=[],i=0;i<t.pathSegList.numberOfItems;i+=1)a.push(t.pathSegList.getItem(i));for(o=a.concat();n>p;){if(i=t.getPathSegAtLength(p),i=a[i],i!=s){for(;o.length&&o[0]!=i;)m(o.shift());s=i}switch(i.pathSegTypeAsLetter.toUpperCase()){case"C":case"T":case"S":case"Q":case"A":i=t.getPointAtLength(p),g(i.x,i.y,0)}p+=e}for(i=0,n=o.length;n>i;++i)m(o[i]);return u},r._svgPathToAbsolute=function(t){for(var e,i,r,n,a,o,s=t.pathSegList,l=0,h=0,c=s.numberOfItems,u=0;c>u;++u){var p=s.getItem(u),d=p.pathSegTypeAsLetter;if(/[MLHVCSQTA]/.test(d))"x"in p&&(l=p.x),"y"in p&&(h=p.y);else switch("x1"in p&&(r=l+p.x1),"x2"in p&&(a=l+p.x2),"y1"in p&&(n=h+p.y1),"y2"in p&&(o=h+p.y2),"x"in p&&(l+=p.x),"y"in p&&(h+=p.y),d){case"m":s.replaceItem(t.createSVGPathSegMovetoAbs(l,h),u);break;case"l":s.replaceItem(t.createSVGPathSegLinetoAbs(l,h),u);break;case"h":s.replaceItem(t.createSVGPathSegLinetoHorizontalAbs(l),u);break;case"v":s.replaceItem(t.createSVGPathSegLinetoVerticalAbs(h),u);break;case"c":s.replaceItem(t.createSVGPathSegCurvetoCubicAbs(l,h,r,n,a,o),u);break;case"s":s.replaceItem(t.createSVGPathSegCurvetoCubicSmoothAbs(l,h,a,o),u);break;case"q":s.replaceItem(t.createSVGPathSegCurvetoQuadraticAbs(l,h,r,n),u);break;case"t":s.replaceItem(t.createSVGPathSegCurvetoQuadraticSmoothAbs(l,h),u);break;case"a":s.replaceItem(t.createSVGPathSegArcAbs(l,h,p.r1,p.r2,p.angle,p.largeArcFlag,p.sweepFlag),u);break;case"z":case"Z":l=e,h=i}("M"==d||"m"==d)&&(e=l,i=h)}}}()},{"../geometry/Bounds":26}],28:[function(t,e,i){var r={};e.exports=r,function(){r.create=function(t,e){return{x:t||0,y:e||0}},r.clone=function(t){return{x:t.x,y:t.y}},r.magnitude=function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},r.magnitudeSquared=function(t){return t.x*t.x+t.y*t.y},r.rotate=function(t,e,i){var r=Math.cos(e);e=Math.sin(e),i||(i={});var n=t.x*r-t.y*e;return i.y=t.x*e+t.y*r,i.x=n,i},r.rotateAbout=function(t,e,i,r){var n=Math.cos(e);e=Math.sin(e),r||(r={});var a=i.x+((t.x-i.x)*n-(t.y-i.y)*e);return r.y=i.y+((t.x-i.x)*e+(t.y-i.y)*n),r.x=a,r},r.normalise=function(t){var e=r.magnitude(t);return 0===e?{x:0,y:0}:{x:t.x/e,y:t.y/e}},r.dot=function(t,e){return t.x*e.x+t.y*e.y},r.cross=function(t,e){return t.x*e.y-t.y*e.x},r.cross3=function(t,e,i){return(e.x-t.x)*(i.y-t.y)-(e.y-t.y)*(i.x-t.x)},r.add=function(t,e,i){return i||(i={}),i.x=t.x+e.x,i.y=t.y+e.y,i},r.sub=function(t,e,i){return i||(i={}),i.x=t.x-e.x,i.y=t.y-e.y,i},r.mult=function(t,e){return{x:t.x*e,y:t.y*e}},r.div=function(t,e){return{x:t.x/e,y:t.y/e}},r.perp=function(t,e){return e=!0===e?-1:1,{x:e*-t.y,y:e*t.x}},r.neg=function(t){return{x:-t.x,y:-t.y}},r.angle=function(t,e){return Math.atan2(e.y-t.y,e.x-t.x)},r._temp=[r.create(),r.create(),r.create(),r.create(),r.create(),r.create()]}()},{}],29:[function(t,e,i){var r={};e.exports=r;var n=t("../geometry/Vector"),a=t("../core/Common");!function(){r.create=function(t,e){for(var i=[],r=0;r<t.length;r++){var n=t[r];i.push({x:n.x,y:n.y,index:r,body:e,isInternal:!1})}return i},r.fromPath=function(t,e){var i=[];return t.replace(/L?\s*([\-\d\.e]+)[\s,]*([\-\d\.e]+)*/gi,function(t,e,r){i.push({x:parseFloat(e),y:parseFloat(r)})}),r.create(i,e)},r.centre=function(t){for(var e,i,a=r.area(t,!0),o={x:0,y:0},s=0;s<t.length;s++)i=(s+1)%t.length,e=n.cross(t[s],t[i]),e=n.mult(n.add(t[s],t[i]),e),o=n.add(o,e);return n.div(o,6*a)},r.mean=function(t){for(var e={x:0,y:0},i=0;i<t.length;i++)e.x+=t[i].x,e.y+=t[i].y;return n.div(e,t.length)},r.area=function(t,e){for(var i=0,r=t.length-1,n=0;n<t.length;n++)i+=(t[r].x-t[n].x)*(t[r].y+t[n].y),r=n;return e?i/2:Math.abs(i)/2},r.inertia=function(t,e){for(var i,r,a=0,o=0,s=0;s<t.length;s++)r=(s+1)%t.length,i=Math.abs(n.cross(t[r],t[s])),a+=i*(n.dot(t[r],t[r])+n.dot(t[r],t[s])+n.dot(t[s],t[s])),o+=i;return e/6*(a/o)},r.translate=function(t,e,i){var r;if(i)for(r=0;r<t.length;r++)t[r].x+=e.x*i,t[r].y+=e.y*i;else for(r=0;r<t.length;r++)t[r].x+=e.x,t[r].y+=e.y;return t},r.rotate=function(t,e,i){if(0!==e){var r=Math.cos(e);e=Math.sin(e);for(var n=0;n<t.length;n++){var a=t[n],o=a.x-i.x,s=a.y-i.y;a.x=i.x+(o*r-s*e),a.y=i.y+(o*e+s*r)}return t}},r.contains=function(t,e){for(var i=0;i<t.length;i++){var r=t[i],n=t[(i+1)%t.length];if(0<(e.x-r.x)*(n.y-r.y)+(e.y-r.y)*(r.x-n.x))return!1}return!0},r.scale=function(t,e,i,a){if(1===e&&1===i)return t;a=a||r.centre(t);for(var o,s=0;s<t.length;s++)o=t[s],o=n.sub(o,a),t[s].x=a.x+o.x*e,t[s].y=a.y+o.y*i;return t},r.chamfer=function(t,e,i,r,o){e="number"==typeof e?[e]:e||[8],i="undefined"!=typeof i?i:-1,r=r||2,o=o||14;for(var s=[],l=0;l<t.length;l++){var h=t[l-1>=0?l-1:t.length-1],c=t[l],u=t[(l+1)%t.length],p=e[l<e.length?l:e.length-1];if(0===p)s.push(c);else{var h=n.normalise({x:c.y-h.y,y:h.x-c.x}),d=n.normalise({x:u.y-c.y,y:c.x-u.x}),f=Math.sqrt(2*Math.pow(p,2)),u=n.mult(a.clone(h),p),g=n.normalise(n.mult(n.add(h,d),.5)),c=n.sub(c,n.mult(g,f)),f=i;for(-1===i&&(f=1.75*Math.pow(p,.32)),f=a.clamp(f,r,o),1===f%2&&(f+=1),p=Math.acos(n.dot(h,d))/f,h=0;f>h;h++)s.push(n.add(n.rotate(u,p*h),c))}}return s},r.clockwiseSort=function(t){var e=r.mean(t);return t.sort(function(t,i){return n.angle(e,t)-n.angle(e,i)}),t},r.isConvex=function(t){var e,i,r,n,a=0,o=t.length;if(3>o)return null;for(e=0;o>e;e++)if(i=(e+1)%o,r=(e+2)%o,n=(t[i].x-t[e].x)*(t[r].y-t[i].y),n-=(t[i].y-t[e].y)*(t[r].x-t[i].x),0>n?a|=1:n>0&&(a|=2),3===a)return!1;return 0!==a?!0:null},r.hull=function(t){var e,i,r=[],a=[];for(t=t.slice(0),t.sort(function(t,e){var i=t.x-e.x;return 0!==i?i:t.y-e.y}),i=0;i<t.length;i+=1){for(e=t[i];2<=a.length&&0>=n.cross3(a[a.length-2],a[a.length-1],e);)a.pop();a.push(e)}for(i=t.length-1;i>=0;--i){for(e=t[i];2<=r.length&&0>=n.cross3(r[r.length-2],r[r.length-1],e);)r.pop();r.push(e)}return r.pop(),a.pop(),r.concat(a)}}()},{"../core/Common":14,"../geometry/Vector":28}],30:[function(t,e,i){e=e.exports=t("../core/Matter"),e.Body=t("../body/Body"),e.Composite=t("../body/Composite"),e.World=t("../body/World"),e.Contact=t("../collision/Contact"),e.Detector=t("../collision/Detector"),e.Grid=t("../collision/Grid"),e.Pairs=t("../collision/Pairs"),e.Pair=t("../collision/Pair"),e.Query=t("../collision/Query"),e.Resolver=t("../collision/Resolver"),e.SAT=t("../collision/SAT"),e.Constraint=t("../constraint/Constraint"),e.MouseConstraint=t("../constraint/MouseConstraint"),e.Common=t("../core/Common"),e.Engine=t("../core/Engine"),e.Events=t("../core/Events"),e.Mouse=t("../core/Mouse"),e.Runner=t("../core/Runner"),e.Sleeping=t("../core/Sleeping"),e.Plugin=t("../core/Plugin"),e.Bodies=t("../factory/Bodies"),e.Composites=t("../factory/Composites"),e.Axes=t("../geometry/Axes"),e.Bounds=t("../geometry/Bounds"),e.Svg=t("../geometry/Svg"),e.Vector=t("../geometry/Vector"),e.Vertices=t("../geometry/Vertices"),e.Render=t("../render/Render"),e.RenderPixi=t("../render/RenderPixi"),e.World.add=e.Composite.add,e.World.remove=e.Composite.remove,e.World.addComposite=e.Composite.addComposite,e.World.addBody=e.Composite.addBody,e.World.addConstraint=e.Composite.addConstraint,e.World.clear=e.Composite.clear,e.Engine.run=e.Runner.run},{"../body/Body":1,"../body/Composite":2,"../body/World":3,"../collision/Contact":4,"../collision/Detector":5,"../collision/Grid":6,"../collision/Pair":7,"../collision/Pairs":8,"../collision/Query":9,"../collision/Resolver":10,"../collision/SAT":11,"../constraint/Constraint":12,"../constraint/MouseConstraint":13,"../core/Common":14,"../core/Engine":15,"../core/Events":16,"../core/Matter":17,"../core/Metrics":18,"../core/Mouse":19,"../core/Plugin":20,"../core/Runner":21,"../core/Sleeping":22,"../factory/Bodies":23,"../factory/Composites":24,"../geometry/Axes":25,"../geometry/Bounds":26,"../geometry/Svg":27,"../geometry/Vector":28,"../geometry/Vertices":29,"../render/Render":31,"../render/RenderPixi":32}],31:[function(t,e,i){var r={};e.exports=r;var n=t("../core/Common"),a=t("../body/Composite"),o=t("../geometry/Bounds"),s=t("../core/Events"),l=t("../collision/Grid"),h=t("../geometry/Vector"),c=t("../core/Mouse");!function(){var t,e;"undefined"!=typeof window&&(t=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(function(){t(n.now())},1e3/60)},e=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),r.create=function(t){var e=n.extend({controller:r,engine:null,element:null,canvas:null,mouse:null,frameRequestId:null,options:{width:800,height:600,pixelRatio:1,background:"#18181d",wireframeBackground:"#0f0f13",hasBounds:!!t.bounds,enabled:!0,wireframes:!0,showSleeping:!0,showDebug:!1,showBroadphase:!1,showBounds:!1,showVelocity:!1,showCollisions:!1,showSeparations:!1,showAxes:!1,showPositions:!1,showAngleIndicator:!1,showIds:!1,showShadows:!1,showVertexNumbers:!1,showConvexHulls:!1,showInternalEdges:!1,showMousePosition:!1}},t);return e.canvas&&(e.canvas.width=e.options.width||e.canvas.width,e.canvas.height=e.options.height||e.canvas.height),e.mouse=t.mouse,e.engine=t.engine,e.canvas=e.canvas||i(e.options.width,e.options.height),e.context=e.canvas.getContext("2d"),e.textures={},e.bounds=e.bounds||{min:{x:0,y:0},max:{x:e.canvas.width,y:e.canvas.height}},1!==e.options.pixelRatio&&r.setPixelRatio(e,e.options.pixelRatio),n.isElement(e.element)?e.element.appendChild(e.canvas):e.canvas.parentNode||n.log("Render.create: options.element was undefined, render.canvas was created but not appended","warn"),e},r.run=function(e){!function i(n){e.frameRequestId=t(i),r.world(e)}()},r.stop=function(t){e(t.frameRequestId)},r.setPixelRatio=function(t,e){var i=t.options,r=t.canvas;if("auto"===e){var n=r.getContext("2d");e=(window.devicePixelRatio||1)/(n.webkitBackingStorePixelRatio||n.mozBackingStorePixelRatio||n.msBackingStorePixelRatio||n.oBackingStorePixelRatio||n.backingStorePixelRatio||1)}i.pixelRatio=e,r.setAttribute("data-pixel-ratio",e),r.width=i.width*e,r.height=i.height*e,r.style.width=i.width+"px",r.style.height=i.height+"px",t.context.scale(e,e)},r.lookAt=function(t,e,i,r){r="undefined"!=typeof r?r:!0,e=n.isArray(e)?e:[e],i=i||{x:0,y:0};for(var a=1/0,o=1/0,s=-(1/0),l=-(1/0),h=0;h<e.length;h+=1){var u=e[h],p=u.bounds?u.bounds.min:u.min||u.position||u,u=u.bounds?u.bounds.max:u.max||u.position||u;p&&u&&(p.x<a&&(a=p.x),u.x>s&&(s=u.x),p.y<o&&(o=p.y),u.y>l&&(l=u.y))}e=s-a+2*i.x,l=l-o+2*i.y,s=t.canvas.width/t.canvas.height,h=e/l,u=p=1,h>s?u=h/s:p=s/h,t.options.hasBounds=!0,t.bounds.min.x=a,t.bounds.max.x=a+e*p,t.bounds.min.y=o,t.bounds.max.y=o+l*u,r&&(t.bounds.min.x+=.5*e-e*p*.5,t.bounds.max.x+=.5*e-e*p*.5,t.bounds.min.y+=.5*l-l*u*.5,t.bounds.max.y+=.5*l-l*u*.5),t.bounds.min.x-=i.x,t.bounds.max.x-=i.x,t.bounds.min.y-=i.y,t.bounds.max.y-=i.y,t.mouse&&(c.setScale(t.mouse,{x:(t.bounds.max.x-t.bounds.min.x)/t.canvas.width,y:(t.bounds.max.y-t.bounds.min.y)/t.canvas.height}),c.setOffset(t.mouse,t.bounds.min))},r.startViewTransform=function(t){t.context.scale(1/((t.bounds.max.x-t.bounds.min.x)/t.options.width),1/((t.bounds.max.y-t.bounds.min.y)/t.options.height)),t.context.translate(-t.bounds.min.x,-t.bounds.min.y)},r.endViewTransform=function(t){t.context.setTransform(t.options.pixelRatio,0,0,t.options.pixelRatio,0,0)},r.world=function(t){var e=t.engine,i=e.world,n=t.canvas,u=t.context,p=t.options,d=a.allBodies(i),i=a.allConstraints(i),f=p.wireframes?p.wireframeBackground:p.background,g=[],m=[],y={timestamp:e.timing.timestamp};if(s.trigger(t,"beforeRender",y),t.currentBackground!==f){var v=f;/(jpg|gif|png)$/.test(f)&&(v="url("+f+")"),t.canvas.style.background=v,t.canvas.style.backgroundSize="contain",t.currentBackground=f}if(u.globalCompositeOperation="source-in",u.fillStyle="transparent",u.fillRect(0,0,n.width,n.height),u.globalCompositeOperation="source-over",p.hasBounds){for(n=0;n<d.length;n++)f=d[n],o.overlaps(f.bounds,t.bounds)&&g.push(f);for(n=0;n<i.length;n++){var d=i[n],f=d.bodyA,v=d.bodyB,_=d.pointA,b=d.pointB;f&&(_=h.add(f.position,d.pointA)),v&&(b=h.add(v.position,d.pointB)),_&&b&&(o.contains(t.bounds,_)||o.contains(t.bounds,b))&&m.push(d)}r.startViewTransform(t),t.mouse&&(c.setScale(t.mouse,{x:(t.bounds.max.x-t.bounds.min.x)/t.canvas.width,y:(t.bounds.max.y-t.bounds.min.y)/t.canvas.height}),c.setOffset(t.mouse,t.bounds.min))}else m=i,g=d;!p.wireframes||e.enableSleeping&&p.showSleeping?r.bodies(t,g,u):(p.showConvexHulls&&r.bodyConvexHulls(t,g,u),r.bodyWireframes(t,g,u)),p.showBounds&&r.bodyBounds(t,g,u),(p.showAxes||p.showAngleIndicator)&&r.bodyAxes(t,g,u),p.showPositions&&r.bodyPositions(t,g,u),p.showVelocity&&r.bodyVelocity(t,g,u),p.showIds&&r.bodyIds(t,g,u),p.showSeparations&&r.separations(t,e.pairs.list,u),p.showCollisions&&r.collisions(t,e.pairs.list,u),p.showVertexNumbers&&r.vertexNumbers(t,g,u),p.showMousePosition&&r.mousePosition(t,t.mouse,u),r.constraints(m,u),p.showBroadphase&&e.broadphase.controller===l&&r.grid(t,e.broadphase,u),p.showDebug&&r.debug(t,u),p.hasBounds&&r.endViewTransform(t),s.trigger(t,"afterRender",y)},r.debug=function(t,e){var i=t.engine,r=i.metrics,n=t.options;if(a.allBodies(i.world),500<=i.timing.timestamp-(t.debugTimestamp||0)){var o="";r.timing&&(o+="fps: "+Math.round(r.timing.fps)+"    "),t.debugString=o,t.debugTimestamp=i.timing.timestamp}if(t.debugString)for(e.font="12px Arial",e.fillStyle=n.wireframes?"rgba(255,255,255,0.5)":"rgba(0,0,0,0.5)",i=t.debugString.split("\n"),r=0;r<i.length;r++)e.fillText(i[r],50,50+18*r)},r.constraints=function(t,e){for(var i=0;i<t.length;i++){var r=t[i];if(r.render.visible&&r.pointA&&r.pointB){var a,o=r.bodyA,s=r.bodyB,o=o?h.add(o.position,r.pointA):r.pointA;if("pin"===r.render.type)e.beginPath(),e.arc(o.x,o.y,3,0,2*Math.PI),e.closePath();else{if(a=s?h.add(s.position,r.pointB):r.pointB,e.beginPath(),e.moveTo(o.x,o.y),"spring"===r.render.type)for(var l,s=h.sub(a,o),c=h.perp(h.normalise(s)),u=Math.ceil(n.clamp(r.length/5,12,20)),p=1;u>p;p+=1)l=0===p%2?1:-1,e.lineTo(o.x+p/u*s.x+c.x*l*4,o.y+p/u*s.y+c.y*l*4);e.lineTo(a.x,a.y)}r.render.lineWidth&&(e.lineWidth=r.render.lineWidth,e.strokeStyle=r.render.strokeStyle,e.stroke()),r.render.anchors&&(e.fillStyle=r.render.strokeStyle,e.beginPath(),e.arc(o.x,o.y,3,0,2*Math.PI),e.arc(a.x,a.y,3,0,2*Math.PI),e.closePath(),e.fill())}}},r.bodyShadows=function(t,e,i){for(var r=0;r<e.length;r++){var n=e[r];if(n.render.visible){if(n.circleRadius)i.beginPath(),i.arc(n.position.x,n.position.y,n.circleRadius,0,2*Math.PI);else{i.beginPath(),i.moveTo(n.vertices[0].x,n.vertices[0].y);for(var a=1;a<n.vertices.length;a++)i.lineTo(n.vertices[a].x,n.vertices[a].y)}i.closePath();var a=n.position.x-.5*t.options.width,n=n.position.y-.2*t.options.height,o=Math.abs(a)+Math.abs(n);i.shadowColor="rgba(0,0,0,0.15)",i.shadowOffsetX=.05*a,i.shadowOffsetY=.05*n,i.shadowBlur=1+12*Math.min(1,o/1e3),i.fill(),i.shadowColor=null,i.shadowOffsetX=null,i.shadowOffsetY=null,i.shadowBlur=null}}},r.bodies=function(t,e,i){var r,n,a,o,s=t.options,l=s.showInternalEdges||!s.wireframes;for(a=0;a<e.length;a++)if(r=e[a],r.render.visible)for(o=1<r.parts.length?1:0;o<r.parts.length;o++)if(n=r.parts[o],n.render.visible){if(s.showSleeping&&r.isSleeping?i.globalAlpha=.5*n.render.opacity:1!==n.render.opacity&&(i.globalAlpha=n.render.opacity),n.render.sprite&&n.render.sprite.texture&&!s.wireframes){var h,c=n.render.sprite;h=c.texture;var u=t.textures[h];u||(u=t.textures[h]=new Image,u.src=h),h=u,i.translate(n.position.x,n.position.y),i.rotate(n.angle),i.drawImage(h,h.width*-c.xOffset*c.xScale,h.height*-c.yOffset*c.yScale,h.width*c.xScale,h.height*c.yScale),i.rotate(-n.angle),i.translate(-n.position.x,-n.position.y)}else{if(n.circleRadius)i.beginPath(),i.arc(n.position.x,n.position.y,n.circleRadius,0,2*Math.PI);else{for(i.beginPath(),i.moveTo(n.vertices[0].x,n.vertices[0].y),c=1;c<n.vertices.length;c++)!n.vertices[c-1].isInternal||l?i.lineTo(n.vertices[c].x,n.vertices[c].y):i.moveTo(n.vertices[c].x,n.vertices[c].y),n.vertices[c].isInternal&&!l&&i.moveTo(n.vertices[(c+1)%n.vertices.length].x,n.vertices[(c+1)%n.vertices.length].y);i.lineTo(n.vertices[0].x,n.vertices[0].y),i.closePath()}s.wireframes?(i.lineWidth=1,i.strokeStyle="#bbb",i.stroke()):(i.fillStyle=n.render.fillStyle,n.render.lineWidth&&(i.lineWidth=n.render.lineWidth,i.strokeStyle=n.render.strokeStyle,i.stroke()),i.fill())}i.globalAlpha=1}},r.bodyWireframes=function(t,e,i){t=t.options.showInternalEdges;var r,n,a,o,s;for(i.beginPath(),a=0;a<e.length;a++)if(r=e[a],r.render.visible)for(s=1<r.parts.length?1:0;s<r.parts.length;s++){for(n=r.parts[s],i.moveTo(n.vertices[0].x,n.vertices[0].y),o=1;o<n.vertices.length;o++)!n.vertices[o-1].isInternal||t?i.lineTo(n.vertices[o].x,n.vertices[o].y):i.moveTo(n.vertices[o].x,n.vertices[o].y),n.vertices[o].isInternal&&!t&&i.moveTo(n.vertices[(o+1)%n.vertices.length].x,n.vertices[(o+1)%n.vertices.length].y);i.lineTo(n.vertices[0].x,n.vertices[0].y)}i.lineWidth=1,i.strokeStyle="#bbb",i.stroke()},r.bodyConvexHulls=function(t,e,i){var r,n;for(i.beginPath(),r=0;r<e.length;r++)if(t=e[r],t.render.visible&&1!==t.parts.length){for(i.moveTo(t.vertices[0].x,t.vertices[0].y),n=1;n<t.vertices.length;n++)i.lineTo(t.vertices[n].x,t.vertices[n].y);i.lineTo(t.vertices[0].x,t.vertices[0].y)}i.lineWidth=1,i.strokeStyle="rgba(255,255,255,0.2)",i.stroke()},r.vertexNumbers=function(t,e,i){var r,n;for(t=0;t<e.length;t++){var a=e[t].parts;for(n=1<a.length?1:0;n<a.length;n++){var o=a[n];for(r=0;r<o.vertices.length;r++)i.fillStyle="rgba(255,255,255,0.2)",i.fillText(t+"_"+r,o.position.x+.8*(o.vertices[r].x-o.position.x),o.position.y+.8*(o.vertices[r].y-o.position.y))}}},r.mousePosition=function(t,e,i){i.fillStyle="rgba(255,255,255,0.8)",i.fillText(e.position.x+"  "+e.position.y,e.position.x+5,e.position.y-5)},r.bodyBounds=function(t,e,i){t=t.options,i.beginPath();for(var r=0;r<e.length;r++)if(e[r].render.visible)for(var n=e[r].parts,a=1<n.length?1:0;a<n.length;a++){var o=n[a];i.rect(o.bounds.min.x,o.bounds.min.y,o.bounds.max.x-o.bounds.min.x,o.bounds.max.y-o.bounds.min.y)}i.strokeStyle=t.wireframes?"rgba(255,255,255,0.08)":"rgba(0,0,0,0.1)",i.lineWidth=1,i.stroke()},r.bodyAxes=function(t,e,i){t=t.options;var r,n,a,o;for(i.beginPath(),n=0;n<e.length;n++){r=e[n];var s=r.parts;if(r.render.visible)if(t.showAxes)for(a=1<s.length?1:0;a<s.length;a++)for(r=s[a],o=0;o<r.axes.length;o++){var l=r.axes[o];i.moveTo(r.position.x,r.position.y),i.lineTo(r.position.x+20*l.x,r.position.y+20*l.y)}else for(a=1<s.length?1:0;a<s.length;a++)for(r=s[a],o=0;o<r.axes.length;o++)i.moveTo(r.position.x,r.position.y),i.lineTo((r.vertices[0].x+r.vertices[r.vertices.length-1].x)/2,(r.vertices[0].y+r.vertices[r.vertices.length-1].y)/2)}t.wireframes?(i.strokeStyle="indianred",i.lineWidth=1):(i.strokeStyle="rgba(255, 255, 255, 0.4)",i.globalCompositeOperation="overlay",i.lineWidth=2),i.stroke(),i.globalCompositeOperation="source-over"},r.bodyPositions=function(t,e,i){t=t.options;var r,n,a,o;for(i.beginPath(),a=0;a<e.length;a++)if(r=e[a],r.render.visible)for(o=0;o<r.parts.length;o++)n=r.parts[o],i.arc(n.position.x,n.position.y,3,0,2*Math.PI,!1),i.closePath();for(i.fillStyle=t.wireframes?"indianred":"rgba(0,0,0,0.5)",i.fill(),i.beginPath(),a=0;a<e.length;a++)r=e[a],r.render.visible&&(i.arc(r.positionPrev.x,r.positionPrev.y,2,0,2*Math.PI,!1),i.closePath());i.fillStyle="rgba(255,165,0,0.8)",i.fill()},r.bodyVelocity=function(t,e,i){for(i.beginPath(),t=0;t<e.length;t++){var r=e[t];r.render.visible&&(i.moveTo(r.position.x,r.position.y),i.lineTo(r.position.x+2*(r.position.x-r.positionPrev.x),r.position.y+2*(r.position.y-r.positionPrev.y)))}i.lineWidth=3,i.strokeStyle="cornflowerblue",i.stroke()},r.bodyIds=function(t,e,i){var r;for(t=0;t<e.length;t++)if(e[t].render.visible){var n=e[t].parts;for(r=1<n.length?1:0;r<n.length;r++){var a=n[r];i.font="12px Arial",i.fillStyle="rgba(255,255,255,0.5)",i.fillText(a.id,a.position.x+10,a.position.y-10)}}},r.collisions=function(t,e,i){t=t.options;var r,n,a;for(i.beginPath(),a=0;a<e.length;a++)if(r=e[a],r.isActive)for(n=0;n<r.activeContacts.length;n++){var o=r.activeContacts[n].vertex;i.rect(o.x-1.5,o.y-1.5,3.5,3.5)}for(i.fillStyle=t.wireframes?"rgba(255,255,255,0.7)":"orange",i.fill(),i.beginPath(),a=0;a<e.length;a++)if(r=e[a],r.isActive&&(n=r.collision,0<r.activeContacts.length)){var o=r.activeContacts[0].vertex.x,s=r.activeContacts[0].vertex.y;2===r.activeContacts.length&&(o=(r.activeContacts[0].vertex.x+r.activeContacts[1].vertex.x)/2,s=(r.activeContacts[0].vertex.y+r.activeContacts[1].vertex.y)/2),n.bodyB===n.supports[0].body||!0===n.bodyA.isStatic?i.moveTo(o-8*n.normal.x,s-8*n.normal.y):i.moveTo(o+8*n.normal.x,s+8*n.normal.y),i.lineTo(o,s)}i.strokeStyle=t.wireframes?"rgba(255,165,0,0.7)":"orange",i.lineWidth=1,i.stroke()},r.separations=function(t,e,i){t=t.options;var r,n,a,o;for(i.beginPath(),o=0;o<e.length;o++)if(r=e[o],r.isActive){r=r.collision,n=r.bodyA,a=r.bodyB;var s=1;a.isStatic||n.isStatic||(s=.5),a.isStatic&&(s=0),i.moveTo(a.position.x,a.position.y),i.lineTo(a.position.x-r.penetration.x*s,a.position.y-r.penetration.y*s),s=1,a.isStatic||n.isStatic||(s=.5),n.isStatic&&(s=0),i.moveTo(n.position.x,n.position.y),i.lineTo(n.position.x+r.penetration.x*s,n.position.y+r.penetration.y*s)}i.strokeStyle=t.wireframes?"rgba(255,165,0,0.5)":"orange",i.stroke()},r.grid=function(t,e,i){i.strokeStyle=t.options.wireframes?"rgba(255,180,0,0.1)":"rgba(255,180,0,0.5)",i.beginPath(),t=n.keys(e.buckets);for(var r=0;r<t.length;r++){var a=t[r];2>e.buckets[a].length||(a=a.split(/C|R/),i.rect(.5+parseInt(a[1],10)*e.bucketWidth,.5+parseInt(a[2],10)*e.bucketHeight,e.bucketWidth,e.bucketHeight))
}i.lineWidth=1,i.stroke()},r.inspector=function(t,e){var i,r=t.selected,n=t.render,a=n.options;for(a.hasBounds&&(e.scale(1/((n.bounds.max.x-n.bounds.min.x)/n.options.width),1/((n.bounds.max.y-n.bounds.min.y)/n.options.height)),e.translate(-n.bounds.min.x,-n.bounds.min.y)),n=0;n<r.length;n++){switch(i=r[n].data,e.translate(.5,.5),e.lineWidth=1,e.strokeStyle="rgba(255,165,0,0.9)",e.setLineDash([1,2]),i.type){case"body":i=i.bounds,e.beginPath(),e.rect(Math.floor(i.min.x-3),Math.floor(i.min.y-3),Math.floor(i.max.x-i.min.x+6),Math.floor(i.max.y-i.min.y+6)),e.closePath(),e.stroke();break;case"constraint":var o=i.pointA;i.bodyA&&(o=i.pointB),e.beginPath(),e.arc(o.x,o.y,10,0,2*Math.PI),e.closePath(),e.stroke()}e.setLineDash([]),e.translate(-.5,-.5)}null!==t.selectStart&&(e.translate(.5,.5),e.lineWidth=1,e.strokeStyle="rgba(255,165,0,0.6)",e.fillStyle="rgba(255,165,0,0.1)",i=t.selectBounds,e.beginPath(),e.rect(Math.floor(i.min.x),Math.floor(i.min.y),Math.floor(i.max.x-i.min.x),Math.floor(i.max.y-i.min.y)),e.closePath(),e.stroke(),e.fill(),e.translate(-.5,-.5)),a.hasBounds&&e.setTransform(1,0,0,1,0,0)};var i=function(t,e){var i=document.createElement("canvas");return i.width=t,i.height=e,i.oncontextmenu=function(){return!1},i.onselectstart=function(){return!1},i}}()},{"../body/Composite":2,"../collision/Grid":6,"../core/Common":14,"../core/Events":16,"../core/Mouse":19,"../geometry/Bounds":26,"../geometry/Vector":28}],32:[function(t,e,i){var r={};e.exports=r;var n=t("../geometry/Bounds"),a=t("../body/Composite"),o=t("../core/Common"),s=t("../core/Events"),l=t("../geometry/Vector");!function(){var t,e;"undefined"!=typeof window&&(t=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(function(){t(o.now())},1e3/60)},e=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),r.create=function(t){o.warn("RenderPixi.create: Matter.RenderPixi is deprecated (see docs)");var e=o.extend({controller:r,engine:null,element:null,frameRequestId:null,canvas:null,renderer:null,container:null,spriteContainer:null,pixiOptions:null,options:{width:800,height:600,background:"#fafafa",wireframeBackground:"#222",hasBounds:!1,enabled:!0,wireframes:!0,showSleeping:!0,showDebug:!1,showBroadphase:!1,showBounds:!1,showVelocity:!1,showCollisions:!1,showAxes:!1,showPositions:!1,showAngleIndicator:!1,showIds:!1,showShadows:!1}},t),i=!e.options.wireframes&&"transparent"===e.options.background;return e.pixiOptions=e.pixiOptions||{view:e.canvas,transparent:i,antialias:!0,backgroundColor:t.background},e.mouse=t.mouse,e.engine=t.engine,e.renderer=e.renderer||new PIXI.WebGLRenderer(e.options.width,e.options.height,e.pixiOptions),e.container=e.container||new PIXI.Container,e.spriteContainer=e.spriteContainer||new PIXI.Container,e.canvas=e.canvas||e.renderer.view,e.bounds=e.bounds||{min:{x:0,y:0},max:{x:e.options.width,y:e.options.height}},s.on(e.engine,"beforeUpdate",function(){r.clear(e)}),e.textures={},e.sprites={},e.primitives={},e.container.addChild(e.spriteContainer),o.isElement(e.element)?e.element.appendChild(e.canvas):o.warn('No "render.element" passed, "render.canvas" was not inserted into document.'),e.canvas.oncontextmenu=function(){return!1},e.canvas.onselectstart=function(){return!1},e},r.run=function(e){!function i(n){e.frameRequestId=t(i),r.world(e)}()},r.stop=function(t){e(t.frameRequestId)},r.clear=function(t){for(var e=t.container,i=t.spriteContainer;e.children[0];)e.removeChild(e.children[0]);for(;i.children[0];)i.removeChild(i.children[0]);i=t.sprites["bg-0"],t.textures={},t.sprites={},t.primitives={},(t.sprites["bg-0"]=i)&&e.addChildAt(i,0),t.container.addChild(t.spriteContainer),t.currentBackground=null,e.scale.set(1,1),e.position.set(0,0)},r.setBackground=function(t,e){if(t.currentBackground!==e){var r=e.indexOf&&-1!==e.indexOf("#"),n=t.sprites["bg-0"];r?(r=o.colorToNumber(e),t.renderer.backgroundColor=r,n&&t.container.removeChild(n)):n||(n=i(t,e),n=t.sprites["bg-0"]=new PIXI.Sprite(n),n.position.x=0,n.position.y=0,t.container.addChildAt(n,0)),t.currentBackground=e}},r.world=function(t){var e=t.engine.world,i=t.renderer,o=t.container,s=t.options,h=a.allBodies(e),e=a.allConstraints(e),c=[];s.wireframes?r.setBackground(t,s.wireframeBackground):r.setBackground(t,s.background);var u=(t.bounds.max.x-t.bounds.min.x)/t.options.width,p=(t.bounds.max.y-t.bounds.min.y)/t.options.height;if(s.hasBounds){for(s=0;s<h.length;s++){var d=h[s];d.render.sprite.visible=n.overlaps(d.bounds,t.bounds)}for(s=0;s<e.length;s++){var d=e[s],f=d.bodyA,g=d.bodyB,m=d.pointA,y=d.pointB;f&&(m=l.add(f.position,d.pointA)),g&&(y=l.add(g.position,d.pointB)),m&&y&&(n.contains(t.bounds,m)||n.contains(t.bounds,y))&&c.push(d)}o.scale.set(1/u,1/p),o.position.set(1/u*-t.bounds.min.x,1/p*-t.bounds.min.y)}else c=e;for(s=0;s<h.length;s++)r.body(t,h[s]);for(s=0;s<c.length;s++)r.constraint(t,c[s]);i.render(o)},r.constraint=function(t,e){var i=e.bodyA,r=e.bodyB,n=e.pointA,a=e.pointB,s=t.container,l=e.render,h="c-"+e.id,c=t.primitives[h];c||(c=t.primitives[h]=new PIXI.Graphics),l.visible&&e.pointA&&e.pointB?(-1===o.indexOf(s.children,c)&&s.addChild(c),c.clear(),c.beginFill(0,0),c.lineStyle(l.lineWidth,o.colorToNumber(l.strokeStyle),1),i?c.moveTo(i.position.x+n.x,i.position.y+n.y):c.moveTo(n.x,n.y),r?c.lineTo(r.position.x+a.x,r.position.y+a.y):c.lineTo(a.x,a.y),c.endFill()):c.clear()},r.body=function(t,e){var r=e.render;if(r.visible)if(r.sprite&&r.sprite.texture){var n="b-"+e.id,a=t.sprites[n],s=t.spriteContainer;if(!a){var a=t.sprites,l=i(t,e.render.sprite.texture),l=new PIXI.Sprite(l);l.anchor.x=e.render.sprite.xOffset,l.anchor.y=e.render.sprite.yOffset,a=a[n]=l}-1===o.indexOf(s.children,a)&&s.addChild(a),a.position.x=e.position.x,a.position.y=e.position.y,a.rotation=e.angle,a.scale.x=r.sprite.xScale||1,a.scale.y=r.sprite.yScale||1}else{if(r="b-"+e.id,s=t.primitives[r],n=t.container,!s){var h,s=t.primitives,a=e.render,l=t.options,c=new PIXI.Graphics,u=o.colorToNumber(a.fillStyle),p=o.colorToNumber(a.strokeStyle),d=o.colorToNumber(a.strokeStyle),f=o.colorToNumber("#bbb"),g=o.colorToNumber("#CD5C5C");c.clear();for(var m=1<e.parts.length?1:0;m<e.parts.length;m++){h=e.parts[m],l.wireframes?(c.beginFill(0,0),c.lineStyle(1,f,1)):(c.beginFill(u,1),c.lineStyle(a.lineWidth,p,1)),c.moveTo(h.vertices[0].x-e.position.x,h.vertices[0].y-e.position.y);for(var y=1;y<h.vertices.length;y++)c.lineTo(h.vertices[y].x-e.position.x,h.vertices[y].y-e.position.y);c.lineTo(h.vertices[0].x-e.position.x,h.vertices[0].y-e.position.y),c.endFill(),(l.showAngleIndicator||l.showAxes)&&(c.beginFill(0,0),l.wireframes?c.lineStyle(1,g,1):c.lineStyle(1,d),c.moveTo(h.position.x-e.position.x,h.position.y-e.position.y),c.lineTo((h.vertices[0].x+h.vertices[h.vertices.length-1].x)/2-e.position.x,(h.vertices[0].y+h.vertices[h.vertices.length-1].y)/2-e.position.y),c.endFill())}s=s[r]=c,s.initialAngle=e.angle}-1===o.indexOf(n.children,s)&&n.addChild(s),s.position.x=e.position.x,s.position.y=e.position.y,s.rotation=e.angle-s.initialAngle}};var i=function(t,e){var i=t.textures[e];return i||(i=t.textures[e]=PIXI.Texture.fromImage(e)),i}}()},{"../body/Composite":2,"../core/Common":14,"../core/Events":16,"../geometry/Bounds":26,"../geometry/Vector":28}]},{},[30])(30)}),!function(t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Matter=t()}(function(){return function t(e,i,r){function n(o,s){if(!i[o]){if(!e[o]){var l="function"==typeof require&&require;if(!s&&l)return l(o,!0);if(a)return a(o,!0);throw l=Error("Cannot find module '"+o+"'"),l.code="MODULE_NOT_FOUND",l}l=i[o]={exports:{}},e[o][0].call(l.exports,function(t){var i=e[o][1][t];return n(i?i:t)},l,l.exports,t,e,i,r)}return i[o].exports}for(var a="function"==typeof require&&require,o=0;o<r.length;o++)n(r[o]);return n}({1:[function(t,e,i){var r={};e.exports=r;var n=t("../geometry/Vertices"),a=t("../geometry/Vector"),o=t("../core/Sleeping"),s=(t("../render/Render"),t("../core/Common")),l=t("../geometry/Bounds"),h=t("../geometry/Axes");!function(){r._inertiaScale=4,r._nextCollidingGroupId=1,r._nextNonCollidingGroupId=-1,r._nextCategory=1,r.create=function(t){var e={id:s.nextId(),type:"body",label:"Body",parts:[],plugin:{},angle:0,vertices:n.fromPath("L 0 0 L 40 0 L 40 40 L 0 40"),position:{x:0,y:0},force:{x:0,y:0},torque:0,positionImpulse:{x:0,y:0},constraintImpulse:{x:0,y:0,angle:0},totalContacts:0,speed:0,angularSpeed:0,velocity:{x:0,y:0},angularVelocity:0,isSensor:!1,isStatic:!1,isSleeping:!1,motion:0,sleepThreshold:60,density:.001,restitution:0,friction:.1,frictionStatic:.5,frictionAir:.01,collisionFilter:{category:1,mask:4294967295,group:0},slop:.05,timeScale:1,render:{visible:!0,opacity:1,sprite:{xScale:1,yScale:1,xOffset:0,yOffset:0},lineWidth:0}},e=s.extend(e,t);return t=t||{},r.set(e,{bounds:e.bounds||l.create(e.vertices),positionPrev:e.positionPrev||a.clone(e.position),anglePrev:e.anglePrev||e.angle,vertices:e.vertices,parts:e.parts||[e],isStatic:e.isStatic,isSleeping:e.isSleeping,parent:e.parent||e}),n.rotate(e.vertices,e.angle,e.position),h.rotate(e.axes,e.angle),l.update(e.bounds,e.vertices,e.velocity),r.set(e,{axes:t.axes||e.axes,area:t.area||e.area,mass:t.mass||e.mass,inertia:t.inertia||e.inertia}),t=e.isStatic?"#2e2b44":s.choose(["#006BA6","#0496FF","#FFBC42","#D81159","#8F2D56"]),e.render.fillStyle=e.render.fillStyle||t,e.render.strokeStyle=e.render.strokeStyle||"#000",e.render.sprite.xOffset+=-(e.bounds.min.x-e.position.x)/(e.bounds.max.x-e.bounds.min.x),e.render.sprite.yOffset+=-(e.bounds.min.y-e.position.y)/(e.bounds.max.y-e.bounds.min.y),e},r.nextGroup=function(t){return t?r._nextNonCollidingGroupId--:r._nextCollidingGroupId++},r.nextCategory=function(){return r._nextCategory<<=1,r._nextCategory},r.set=function(t,e,i){var n;"string"==typeof e&&(n=e,e={},e[n]=i);for(n in e)if(i=e[n],e.hasOwnProperty(n))switch(n){case"isStatic":r.setStatic(t,i);break;case"isSleeping":o.set(t,i);break;case"mass":r.setMass(t,i);break;case"density":r.setDensity(t,i);break;case"inertia":r.setInertia(t,i);break;case"vertices":r.setVertices(t,i);break;case"position":r.setPosition(t,i);break;case"angle":r.setAngle(t,i);break;case"velocity":r.setVelocity(t,i);break;case"angularVelocity":r.setAngularVelocity(t,i);break;case"parts":r.setParts(t,i);break;default:t[n]=i}},r.setStatic=function(t,e){for(var i=0;i<t.parts.length;i++){var r=t.parts[i];(r.isStatic=e)?(r._original={restitution:r.restitution,friction:r.friction,mass:r.mass,inertia:r.inertia,density:r.density,inverseMass:r.inverseMass,inverseInertia:r.inverseInertia},r.restitution=0,r.friction=1,r.mass=r.inertia=r.density=1/0,r.inverseMass=r.inverseInertia=0,r.positionPrev.x=r.position.x,r.positionPrev.y=r.position.y,r.anglePrev=r.angle,r.angularVelocity=0,r.speed=0,r.angularSpeed=0,r.motion=0):r._original&&(r.restitution=r._original.restitution,r.friction=r._original.friction,r.mass=r._original.mass,r.inertia=r._original.inertia,r.density=r._original.density,r.inverseMass=r._original.inverseMass,r.inverseInertia=r._original.inverseInertia,delete r._original)}},r.setMass=function(t,e){t.inertia=t.inertia/(t.mass/6)*(e/6),t.inverseInertia=1/t.inertia,t.mass=e,t.inverseMass=1/t.mass,t.density=t.mass/t.area},r.setDensity=function(t,e){r.setMass(t,e*t.area),t.density=e},r.setInertia=function(t,e){t.inertia=e,t.inverseInertia=1/t.inertia},r.setVertices=function(t,e){e[0].body===t?t.vertices=e:t.vertices=n.create(e,t),t.axes=h.fromVertices(t.vertices),t.area=n.area(t.vertices),r.setMass(t,t.density*t.area);var i=n.centre(t.vertices);n.translate(t.vertices,i,-1),r.setInertia(t,r._inertiaScale*n.inertia(t.vertices,t.mass)),n.translate(t.vertices,t.position),l.update(t.bounds,t.vertices,t.velocity)},r.setParts=function(t,e,i){var a;for(e=e.slice(0),t.parts.length=0,t.parts.push(t),t.parent=t,a=0;a<e.length;a++){var o=e[a];o!==t&&(o.parent=t,t.parts.push(o))}if(1!==t.parts.length){if("undefined"==typeof i||i){for(i=[],a=0;a<e.length;a++)i=i.concat(e[a].vertices);n.clockwiseSort(i),e=n.hull(i),a=n.centre(e),r.setVertices(t,e),n.translate(t.vertices,a)}e=r._totalProperties(t),t.area=e.area,t.parent=t,t.position.x=e.centre.x,t.position.y=e.centre.y,t.positionPrev.x=e.centre.x,t.positionPrev.y=e.centre.y,r.setMass(t,e.mass),r.setInertia(t,e.inertia),r.setPosition(t,e.centre)}},r.setPosition=function(t,e){var i=a.sub(e,t.position);t.positionPrev.x+=i.x,t.positionPrev.y+=i.y;for(var r=0;r<t.parts.length;r++){var o=t.parts[r];o.position.x+=i.x,o.position.y+=i.y,n.translate(o.vertices,i),l.update(o.bounds,o.vertices,t.velocity)}},r.setAngle=function(t,e){var i=e-t.angle;t.anglePrev+=i;for(var r=0;r<t.parts.length;r++){var o=t.parts[r];o.angle+=i,n.rotate(o.vertices,i,t.position),h.rotate(o.axes,i),l.update(o.bounds,o.vertices,t.velocity),r>0&&a.rotateAbout(o.position,i,t.position,o.position)}},r.setVelocity=function(t,e){t.positionPrev.x=t.position.x-e.x,t.positionPrev.y=t.position.y-e.y,t.velocity.x=e.x,t.velocity.y=e.y,t.speed=a.magnitude(t.velocity)},r.setAngularVelocity=function(t,e){t.anglePrev=t.angle-e,t.angularVelocity=e,t.angularSpeed=Math.abs(t.angularVelocity)},r.translate=function(t,e){r.setPosition(t,a.add(t.position,e))},r.rotate=function(t,e,i){if(i){var n=Math.cos(e),a=Math.sin(e),o=t.position.x-i.x,s=t.position.y-i.y;r.setPosition(t,{x:i.x+(o*n-s*a),y:i.y+(o*a+s*n)})}r.setAngle(t,t.angle+e)},r.scale=function(t,e,i,a){var o=0,s=0;a=a||t.position;for(var c=0;c<t.parts.length;c++){var u=t.parts[c];n.scale(u.vertices,e,i,a),u.axes=h.fromVertices(u.vertices),u.area=n.area(u.vertices),r.setMass(u,t.density*u.area),n.translate(u.vertices,{x:-u.position.x,y:-u.position.y}),r.setInertia(u,r._inertiaScale*n.inertia(u.vertices,u.mass)),n.translate(u.vertices,{x:u.position.x,y:u.position.y}),c>0&&(o+=u.area,s+=u.inertia),u.position.x=a.x+(u.position.x-a.x)*e,u.position.y=a.y+(u.position.y-a.y)*i,l.update(u.bounds,u.vertices,t.velocity)}1<t.parts.length&&(t.area=o,t.isStatic||(r.setMass(t,t.density*o),r.setInertia(t,s))),t.circleRadius&&(e===i?t.circleRadius*=e:t.circleRadius=null)},r.update=function(t,e,i,r){e=Math.pow(e*i*t.timeScale,2),i=1-t.frictionAir*i*t.timeScale;var o=t.position.y-t.positionPrev.y;for(t.velocity.x=(t.position.x-t.positionPrev.x)*i*r+t.force.x/t.mass*e,t.velocity.y=o*i*r+t.force.y/t.mass*e,t.positionPrev.x=t.position.x,t.positionPrev.y=t.position.y,t.position.x+=t.velocity.x,t.position.y+=t.velocity.y,t.angularVelocity=(t.angle-t.anglePrev)*i*r+t.torque/t.inertia*e,t.anglePrev=t.angle,t.angle+=t.angularVelocity,t.speed=a.magnitude(t.velocity),t.angularSpeed=Math.abs(t.angularVelocity),r=0;r<t.parts.length;r++)e=t.parts[r],n.translate(e.vertices,t.velocity),r>0&&(e.position.x+=t.velocity.x,e.position.y+=t.velocity.y),0!==t.angularVelocity&&(n.rotate(e.vertices,t.angularVelocity,t.position),h.rotate(e.axes,t.angularVelocity),r>0&&a.rotateAbout(e.position,t.angularVelocity,t.position,e.position)),l.update(e.bounds,e.vertices,t.velocity)},r.applyForce=function(t,e,i){t.force.x+=i.x,t.force.y+=i.y,t.torque+=(e.x-t.position.x)*i.y-(e.y-t.position.y)*i.x},r._totalProperties=function(t){for(var e={mass:0,area:0,inertia:0,centre:{x:0,y:0}},i=1===t.parts.length?0:1;i<t.parts.length;i++){var r=t.parts[i],n=r.mass!==1/0?r.mass:1;e.mass+=n,e.area+=r.area,e.inertia+=r.inertia,e.centre=a.add(e.centre,a.mult(r.position,n))}return e.centre=a.div(e.centre,e.mass),e}}()},{"../core/Common":14,"../core/Sleeping":22,"../geometry/Axes":25,"../geometry/Bounds":26,"../geometry/Vector":28,"../geometry/Vertices":29,"../render/Render":31}],2:[function(t,e,i){var r={};e.exports=r;var n=t("../core/Events"),a=t("../core/Common"),o=t("./Body");!function(){r.create=function(t){return a.extend({id:a.nextId(),type:"composite",parent:null,isModified:!1,bodies:[],constraints:[],composites:[],label:"Composite",plugin:{}},t)},r.setModified=function(t,e,i,n){if(t.isModified=e,i&&t.parent&&r.setModified(t.parent,e,i,n),n)for(var a=0;a<t.composites.length;a++)r.setModified(t.composites[a],e,i,n)},r.add=function(t,e){var i=[].concat(e);n.trigger(t,"beforeAdd",{object:e});for(var o=0;o<i.length;o++){var s=i[o];switch(s.type){case"body":if(s.parent!==s){a.warn("Composite.add: skipped adding a compound body part (you must add its parent instead)");break}r.addBody(t,s);break;case"constraint":r.addConstraint(t,s);break;case"composite":r.addComposite(t,s);break;case"mouseConstraint":r.addConstraint(t,s.constraint)}}return n.trigger(t,"afterAdd",{object:e}),t},r.remove=function(t,e,i){var a=[].concat(e);n.trigger(t,"beforeRemove",{object:e});for(var o=0;o<a.length;o++){var s=a[o];switch(s.type){case"body":r.removeBody(t,s,i);break;case"constraint":r.removeConstraint(t,s,i);break;case"composite":r.removeComposite(t,s,i);break;case"mouseConstraint":r.removeConstraint(t,s.constraint)}}return n.trigger(t,"afterRemove",{object:e}),t},r.addComposite=function(t,e){return t.composites.push(e),e.parent=t,r.setModified(t,!0,!0,!1),t},r.removeComposite=function(t,e,i){var n=a.indexOf(t.composites,e);if(-1!==n&&(r.removeCompositeAt(t,n),r.setModified(t,!0,!0,!1)),i)for(i=0;i<t.composites.length;i++)r.removeComposite(t.composites[i],e,!0);return t},r.removeCompositeAt=function(t,e){return t.composites.splice(e,1),r.setModified(t,!0,!0,!1),t},r.addBody=function(t,e){return t.bodies.push(e),r.setModified(t,!0,!0,!1),t},r.removeBody=function(t,e,i){var n=a.indexOf(t.bodies,e);if(-1!==n&&(r.removeBodyAt(t,n),r.setModified(t,!0,!0,!1)),i)for(i=0;i<t.composites.length;i++)r.removeBody(t.composites[i],e,!0);return t},r.removeBodyAt=function(t,e){return t.bodies.splice(e,1),r.setModified(t,!0,!0,!1),t},r.addConstraint=function(t,e){return t.constraints.push(e),r.setModified(t,!0,!0,!1),t},r.removeConstraint=function(t,e,i){var n=a.indexOf(t.constraints,e);if(-1!==n&&r.removeConstraintAt(t,n),i)for(i=0;i<t.composites.length;i++)r.removeConstraint(t.composites[i],e,!0);return t},r.removeConstraintAt=function(t,e){return t.constraints.splice(e,1),r.setModified(t,!0,!0,!1),t},r.clear=function(t,e,i){if(i)for(i=0;i<t.composites.length;i++)r.clear(t.composites[i],e,!0);return e?t.bodies=t.bodies.filter(function(t){return t.isStatic}):t.bodies.length=0,t.constraints.length=0,t.composites.length=0,r.setModified(t,!0,!0,!1),t},r.allBodies=function(t){for(var e=[].concat(t.bodies),i=0;i<t.composites.length;i++)e=e.concat(r.allBodies(t.composites[i]));return e},r.allConstraints=function(t){for(var e=[].concat(t.constraints),i=0;i<t.composites.length;i++)e=e.concat(r.allConstraints(t.composites[i]));return e},r.allComposites=function(t){for(var e=[].concat(t.composites),i=0;i<t.composites.length;i++)e=e.concat(r.allComposites(t.composites[i]));return e},r.get=function(t,e,i){var n,a;switch(i){case"body":n=r.allBodies(t);break;case"constraint":n=r.allConstraints(t);break;case"composite":n=r.allComposites(t).concat(t)}return n?(a=n.filter(function(t){return t.id.toString()===e.toString()}),0===a.length?null:a[0]):null},r.move=function(t,e,i){return r.remove(t,e),r.add(i,e),t},r.rebase=function(t){for(var e=r.allBodies(t).concat(r.allConstraints(t)).concat(r.allComposites(t)),i=0;i<e.length;i++)e[i].id=a.nextId();return r.setModified(t,!0,!0,!1),t},r.translate=function(t,e,i){i=i?r.allBodies(t):t.bodies;for(var n=0;n<i.length;n++)o.translate(i[n],e);return r.setModified(t,!0,!0,!1),t},r.rotate=function(t,e,i,n){var a=Math.cos(e),s=Math.sin(e);n=n?r.allBodies(t):t.bodies;for(var l=0;l<n.length;l++){var h=n[l],c=h.position.x-i.x,u=h.position.y-i.y;o.setPosition(h,{x:i.x+(c*a-u*s),y:i.y+(c*s+u*a)}),o.rotate(h,e)}return r.setModified(t,!0,!0,!1),t},r.scale=function(t,e,i,n,a){a=a?r.allBodies(t):t.bodies;for(var s=0;s<a.length;s++){var l=a[s];o.setPosition(l,{x:n.x+(l.position.x-n.x)*e,y:n.y+(l.position.y-n.y)*i}),o.scale(l,e,i)}return r.setModified(t,!0,!0,!1),t},r.bounds=function(t){t=Matter.Composite.allBodies(t);for(var e=[],i=0;i<t.length;i+=1){var r=t[i];e.push(r.bounds.min,r.bounds.max)}return Matter.Bounds.create(e)}}()},{"../core/Common":14,"../core/Events":16,"./Body":1}],3:[function(t,e,i){var r={};e.exports=r;var n=t("./Composite"),a=(t("../constraint/Constraint"),t("../core/Common"));!function(){r.create=function(t){var e=n.create();return a.extend(e,{label:"World",gravity:{x:0,y:1,scale:.001},bounds:{min:{x:-(1/0),y:-(1/0)},max:{x:1/0,y:1/0}}},t)}}()},{"../constraint/Constraint":12,"../core/Common":14,"./Composite":2}],4:[function(t,e,i){var r={};e.exports=r,function(){r.create=function(t){return{id:r.id(t),vertex:t,normalImpulse:0,tangentImpulse:0}},r.id=function(t){return t.body.id+"_"+t.index}}()},{}],5:[function(t,e,i){var r={};e.exports=r;var n=t("./SAT"),a=t("./Pair"),o=t("../geometry/Bounds");!function(){r.collisions=function(t,e){for(var i=[],s=e.pairs.table,l=0;l<t.length;l++){var h=t[l][0],c=t[l][1];if((!h.isStatic&&!h.isSleeping||!c.isStatic&&!c.isSleeping)&&r.canCollide(h.collisionFilter,c.collisionFilter)&&o.overlaps(h.bounds,c.bounds))for(var u=1<h.parts.length?1:0;u<h.parts.length;u++)for(var p=h.parts[u],d=1<c.parts.length?1:0;d<c.parts.length;d++){var f=c.parts[d];if(p===h&&f===c||o.overlaps(p.bounds,f.bounds)){var g=a.id(p,f),g=s[g],f=n.collides(p,f,g&&g.isActive?g.collision:null);f.collided&&i.push(f)}}}return i},r.canCollide=function(t,e){return t.group===e.group&&0!==t.group?0<t.group:0!==(t.mask&e.category)&&0!==(e.mask&t.category)}}()},{"../geometry/Bounds":26,"./Pair":7,"./SAT":11}],6:[function(t,e,i){var r={};e.exports=r;var n=t("./Pair"),a=t("./Detector"),o=t("../core/Common");!function(){r.create=function(t){return o.extend({controller:r,detector:a.collisions,buckets:{},pairs:{},pairsList:[],bucketWidth:48,bucketHeight:48},t)},r.update=function(t,e,i,n){var a,o,s,l,h=i.world,c=t.buckets;for(a=!1,i=0;i<e.length;i++){var u=e[i];if(!(u.isSleeping&&!n||u.bounds.max.x<h.bounds.min.x||u.bounds.min.x>h.bounds.max.x||u.bounds.max.y<h.bounds.min.y||u.bounds.min.y>h.bounds.max.y)){var p=r._getRegion(t,u);if(!u.region||p.id!==u.region.id||n){u.region&&!n||(u.region=p);var d=r._regionUnion(p,u.region);for(a=d.startCol;a<=d.endCol;a++)for(o=d.startRow;o<=d.endRow;o++){l=r._getBucketId(a,o),s=c[l];var f=a>=p.startCol&&a<=p.endCol&&o>=p.startRow&&o<=p.endRow,g=a>=u.region.startCol&&a<=u.region.endCol&&o>=u.region.startRow&&o<=u.region.endRow;!f&&g&&g&&s&&r._bucketRemoveBody(t,s,u),(u.region===p||f&&!g||n)&&(s||(s=r._createBucket(c,l)),r._bucketAddBody(t,s,u))}u.region=p,a=!0}}}a&&(t.pairsList=r._createActivePairsList(t))},r.clear=function(t){t.buckets={},t.pairs={},t.pairsList=[]},r._regionUnion=function(t,e){return r._createRegion(Math.min(t.startCol,e.startCol),Math.max(t.endCol,e.endCol),Math.min(t.startRow,e.startRow),Math.max(t.endRow,e.endRow))},r._getRegion=function(t,e){var i=e.bounds;return r._createRegion(Math.floor(i.min.x/t.bucketWidth),Math.floor(i.max.x/t.bucketWidth),Math.floor(i.min.y/t.bucketHeight),Math.floor(i.max.y/t.bucketHeight))},r._createRegion=function(t,e,i,r){return{id:t+","+e+","+i+","+r,startCol:t,endCol:e,startRow:i,endRow:r}},r._getBucketId=function(t,e){return"C"+t+"R"+e},r._createBucket=function(t,e){return t[e]=[]},r._bucketAddBody=function(t,e,i){for(var r=0;r<e.length;r++){var a=e[r];if(!(i.id===a.id||i.isStatic&&a.isStatic)){var o=n.id(i,a),s=t.pairs[o];s?s[2]+=1:t.pairs[o]=[i,a,1]}}e.push(i)},r._bucketRemoveBody=function(t,e,i){e.splice(o.indexOf(e,i),1);for(var r=0;r<e.length;r++){var a=n.id(i,e[r]);(a=t.pairs[a])&&--a[2]}},r._createActivePairsList=function(t){var e,i,r=[];e=o.keys(t.pairs);for(var n=0;n<e.length;n++)i=t.pairs[e[n]],0<i[2]?r.push(i):delete t.pairs[e[n]];return r}}()},{"../core/Common":14,"./Detector":5,"./Pair":7}],7:[function(t,e,i){var r={};e.exports=r;var n=t("./Contact");!function(){r.create=function(t,e){var i=t.bodyA,n=t.bodyB,a=t.parentA,o=t.parentB,i={id:r.id(i,n),bodyA:i,bodyB:n,contacts:{},activeContacts:[],separation:0,isActive:!0,isSensor:i.isSensor||n.isSensor,timeCreated:e,timeUpdated:e,inverseMass:a.inverseMass+o.inverseMass,friction:Math.min(a.friction,o.friction),frictionStatic:Math.max(a.frictionStatic,o.frictionStatic),restitution:Math.max(a.restitution,o.restitution),slop:Math.max(a.slop,o.slop)};return r.update(i,t,e),i},r.update=function(t,e,i){var a=t.contacts,o=e.supports,s=t.activeContacts,l=e.parentA,h=e.parentB;if(t.collision=e,t.inverseMass=l.inverseMass+h.inverseMass,t.friction=Math.min(l.friction,h.friction),t.frictionStatic=Math.max(l.frictionStatic,h.frictionStatic),t.restitution=Math.max(l.restitution,h.restitution),t.slop=Math.max(l.slop,h.slop),s.length=0,e.collided){for(l=0;l<o.length;l++){var h=o[l],c=n.id(h),u=a[c];u?s.push(u):s.push(a[c]=n.create(h))}t.separation=e.depth,r.setActive(t,!0,i)}else!0===t.isActive&&r.setActive(t,!1,i)},r.setActive=function(t,e,i){e?(t.isActive=!0,t.timeUpdated=i):(t.isActive=!1,t.activeContacts.length=0)},r.id=function(t,e){return t.id<e.id?"A"+t.id+"B"+e.id:"A"+e.id+"B"+t.id}}()},{"./Contact":4}],8:[function(t,e,i){var r={};e.exports=r;var n=t("./Pair"),a=t("../core/Common");!function(){r._pairMaxIdleLife=1e3,r.create=function(t){return a.extend({table:{},list:[],collisionStart:[],collisionActive:[],collisionEnd:[]},t)},r.update=function(t,e,i){var r,o,s,l=t.list,h=t.table,c=t.collisionStart,u=t.collisionEnd,p=t.collisionActive,d=[];for(c.length=0,u.length=0,s=p.length=0;s<e.length;s++)t=e[s],t.collided&&(r=n.id(t.bodyA,t.bodyB),d.push(r),o=h[r],o?(o.isActive?p.push(o):c.push(o),n.update(o,t,i)):(o=n.create(t,i),h[r]=o,c.push(o),l.push(o)));for(s=0;s<l.length;s++)o=l[s],o.isActive&&-1===a.indexOf(d,o.id)&&(n.setActive(o,!1,i),u.push(o))},r.removeOld=function(t,e){var i,n,a,o=t.list,s=t.table,l=[];for(a=0;a<o.length;a++)i=o[a],n=i.collision,n.bodyA.isSleeping||n.bodyB.isSleeping?i.timeUpdated=e:e-i.timeUpdated>r._pairMaxIdleLife&&l.push(a);for(a=0;a<l.length;a++)n=l[a]-a,i=o[n],delete s[i.id],o.splice(n,1)},r.clear=function(t){return t.table={},t.list.length=0,t.collisionStart.length=0,t.collisionActive.length=0,t.collisionEnd.length=0,t}}()},{"../core/Common":14,"./Pair":7}],9:[function(t,e,i){var r={};e.exports=r;var n=t("../geometry/Vector"),a=t("./SAT"),o=t("../geometry/Bounds"),s=t("../factory/Bodies"),l=t("../geometry/Vertices");!function(){r.collides=function(t,e){for(var i=[],r=0;r<e.length;r++){var n=e[r];if(o.overlaps(n.bounds,t.bounds))for(var s=1===n.parts.length?0:1;s<n.parts.length;s++){var l=n.parts[s];if(o.overlaps(l.bounds,t.bounds)&&(l=a.collides(l,t),l.collided)){i.push(l);break}}}return i},r.ray=function(t,e,i,a){a=a||1e-100;var o=n.angle(e,i),l=n.magnitude(n.sub(e,i));for(e=s.rectangle(.5*(i.x+e.x),.5*(i.y+e.y),l,a,{angle:o}),t=r.collides(e,t),e=0;e<t.length;e+=1)i=t[e],i.body=i.bodyB=i.bodyA;return t},r.region=function(t,e,i){for(var r=[],n=0;n<t.length;n++){var a=t[n],s=o.overlaps(a.bounds,e);(s&&!i||!s&&i)&&r.push(a)}return r},r.point=function(t,e){for(var i=[],r=0;r<t.length;r++){var n=t[r];if(o.contains(n.bounds,e))for(var a=1===n.parts.length?0:1;a<n.parts.length;a++){var s=n.parts[a];if(o.contains(s.bounds,e)&&l.contains(s.vertices,e)){i.push(n);break}}}return i}}()},{"../factory/Bodies":23,"../geometry/Bounds":26,"../geometry/Vector":28,"../geometry/Vertices":29,"./SAT":11}],10:[function(t,e,i){var r={};e.exports=r;var n=t("../geometry/Vertices"),a=t("../geometry/Vector"),o=t("../core/Common"),s=t("../geometry/Bounds");!function(){r._restingThresh=4,r._restingThreshTangent=6,r._positionDampen=.9,r._positionWarming=.8,r._frictionNormalMultiplier=5,r.preSolvePosition=function(t){var e,i,r;for(e=0;e<t.length;e++)i=t[e],i.isActive&&(r=i.activeContacts.length,i.collision.parentA.totalContacts+=r,i.collision.parentB.totalContacts+=r)},r.solvePosition=function(t,e){var i,n,o,s,l,h,c,u,p,d=a._temp[0],f=a._temp[1],g=a._temp[2],m=a._temp[3];for(i=0;i<t.length;i++)n=t[i],n.isActive&&!n.isSensor&&(o=n.collision,s=o.parentA,l=o.parentB,h=o.normal,c=a.sub(a.add(l.positionImpulse,l.position,d),a.add(s.positionImpulse,a.sub(l.position,o.penetration,f),g),m),n.separation=a.dot(h,c));for(i=0;i<t.length;i++)n=t[i],n.isActive&&!n.isSensor&&(o=n.collision,s=o.parentA,l=o.parentB,h=o.normal,p=(n.separation-n.slop)*e,(s.isStatic||l.isStatic)&&(p*=2),s.isStatic||s.isSleeping||(u=r._positionDampen/s.totalContacts,s.positionImpulse.x+=h.x*p*u,s.positionImpulse.y+=h.y*p*u),l.isStatic||l.isSleeping||(u=r._positionDampen/l.totalContacts,l.positionImpulse.x-=h.x*p*u,l.positionImpulse.y-=h.y*p*u))},r.postSolvePosition=function(t){for(var e=0;e<t.length;e++){var i=t[e];if(i.totalContacts=0,0!==i.positionImpulse.x||0!==i.positionImpulse.y){for(var o=0;o<i.parts.length;o++){var l=i.parts[o];n.translate(l.vertices,i.positionImpulse),s.update(l.bounds,l.vertices,i.velocity),l.position.x+=i.positionImpulse.x,l.position.y+=i.positionImpulse.y}i.positionPrev.x+=i.positionImpulse.x,i.positionPrev.y+=i.positionImpulse.y,0>a.dot(i.positionImpulse,i.velocity)?(i.positionImpulse.x=0,i.positionImpulse.y=0):(i.positionImpulse.x*=r._positionWarming,i.positionImpulse.y*=r._positionWarming)}}},r.preSolveVelocity=function(t){var e,i,r,n,o,s,l,h,c,u,p,d,f=a._temp[0],g=a._temp[1];for(e=0;e<t.length;e++)if(r=t[e],r.isActive&&!r.isSensor)for(n=r.activeContacts,i=r.collision,o=i.parentA,s=i.parentB,l=i.normal,h=i.tangent,i=0;i<n.length;i++)c=n[i],u=c.vertex,p=c.normalImpulse,c=c.tangentImpulse,0===p&&0===c||(f.x=l.x*p+h.x*c,f.y=l.y*p+h.y*c,o.isStatic||o.isSleeping||(d=a.sub(u,o.position,g),o.positionPrev.x+=f.x*o.inverseMass,o.positionPrev.y+=f.y*o.inverseMass,o.anglePrev+=a.cross(d,f)*o.inverseInertia),s.isStatic||s.isSleeping||(d=a.sub(u,s.position,g),s.positionPrev.x-=f.x*s.inverseMass,s.positionPrev.y-=f.y*s.inverseMass,s.anglePrev-=a.cross(d,f)*s.inverseInertia))},r.solveVelocity=function(t,e){for(var i=e*e,n=a._temp[0],s=a._temp[1],l=a._temp[2],h=a._temp[3],c=a._temp[4],u=a._temp[5],p=0;p<t.length;p++){var d=t[p];if(d.isActive&&!d.isSensor){var f=d.collision,g=f.parentA,m=f.parentB,y=f.normal,f=f.tangent,v=d.activeContacts,_=1/v.length;g.velocity.x=g.position.x-g.positionPrev.x,g.velocity.y=g.position.y-g.positionPrev.y,m.velocity.x=m.position.x-m.positionPrev.x,m.velocity.y=m.position.y-m.positionPrev.y,g.angularVelocity=g.angle-g.anglePrev,m.angularVelocity=m.angle-m.anglePrev;for(var b=0;b<v.length;b++){var x=v[b],T=x.vertex,E=a.sub(T,g.position,s),T=a.sub(T,m.position,l),S=a.add(g.velocity,a.mult(a.perp(E),g.angularVelocity),h),C=a.add(m.velocity,a.mult(a.perp(T),m.angularVelocity),c),S=a.sub(S,C,u),w=a.dot(y,S),P=a.dot(f,S),D=Math.abs(P),A=o.sign(P),S=(1+d.restitution)*w,I=o.clamp(d.separation+w,0,1)*r._frictionNormalMultiplier,C=P,M=1/0;D>d.friction*d.frictionStatic*I*i&&(M=D,C=o.clamp(d.friction*A*i,-M,M)),D=a.cross(E,y),A=a.cross(T,y),D=_/(g.inverseMass+m.inverseMass+g.inverseInertia*D*D+m.inverseInertia*A*A),S*=D,C*=D,0>w&&w*w>r._restingThresh*i?x.normalImpulse=0:(w=x.normalImpulse,x.normalImpulse=Math.min(x.normalImpulse+S,0),S=x.normalImpulse-w),P*P>r._restingThreshTangent*i?x.tangentImpulse=0:(w=x.tangentImpulse,x.tangentImpulse=o.clamp(x.tangentImpulse+C,-M,M),C=x.tangentImpulse-w),n.x=y.x*S+f.x*C,n.y=y.y*S+f.y*C,g.isStatic||g.isSleeping||(g.positionPrev.x+=n.x*g.inverseMass,g.positionPrev.y+=n.y*g.inverseMass,g.anglePrev+=a.cross(E,n)*g.inverseInertia),m.isStatic||m.isSleeping||(m.positionPrev.x-=n.x*m.inverseMass,m.positionPrev.y-=n.y*m.inverseMass,m.anglePrev-=a.cross(T,n)*m.inverseInertia)}}}}}()},{"../core/Common":14,"../geometry/Bounds":26,"../geometry/Vector":28,"../geometry/Vertices":29}],11:[function(t,e,i){var r={};e.exports=r;var n=t("../geometry/Vertices"),a=t("../geometry/Vector");!function(){r.collides=function(t,e,i){var o,s,l,h,c=!1;if(i?(h=t.parent,c=e.parent,h=h.speed*h.speed+h.angularSpeed*h.angularSpeed+c.speed*c.speed+c.angularSpeed*c.angularSpeed,c=i&&i.collided&&.2>h,h=i):h={collided:!1,bodyA:t,bodyB:e},i&&c){if(o=h.axisBody,l=r._overlapAxes(o.vertices,(o===t?e:t).vertices,[o.axes[i.axisNumber]]),h.reused=!0,0>=l.overlap)return h.collided=!1,h
}else{if(o=r._overlapAxes(t.vertices,e.vertices,t.axes),0>=o.overlap||(s=r._overlapAxes(e.vertices,t.vertices,e.axes),0>=s.overlap))return h.collided=!1,h;o.overlap<s.overlap?(l=o,h.axisBody=t):(l=s,h.axisBody=e),h.axisNumber=l.axisNumber}return h.bodyA=t.id<e.id?t:e,h.bodyB=t.id<e.id?e:t,h.collided=!0,h.depth=l.overlap,h.parentA=h.bodyA.parent,h.parentB=h.bodyB.parent,t=h.bodyA,e=h.bodyB,0>a.dot(l.axis,a.sub(e.position,t.position))?h.normal={x:l.axis.x,y:l.axis.y}:h.normal={x:-l.axis.x,y:-l.axis.y},h.tangent=a.perp(h.normal),h.penetration=h.penetration||{},h.penetration.x=h.normal.x*h.depth,h.penetration.y=h.normal.y*h.depth,i=r._findSupports(t,e,h.normal),l=[],n.contains(t.vertices,i[0])&&l.push(i[0]),n.contains(t.vertices,i[1])&&l.push(i[1]),2>l.length&&(t=r._findSupports(e,t,a.neg(h.normal)),n.contains(e.vertices,t[0])&&l.push(t[0]),2>l.length&&n.contains(e.vertices,t[1])&&l.push(t[1])),1>l.length&&(l=[i[0]]),h.supports=l,h},r._overlapAxes=function(t,e,i){for(var n,o,s=a._temp[0],l=a._temp[1],h={overlap:Number.MAX_VALUE},c=0;c<i.length;c++){if(o=i[c],r._projectToAxis(s,t,o),r._projectToAxis(l,e,o),n=Math.min(s.max-l.min,l.max-s.min),0>=n)return h.overlap=n,h;n<h.overlap&&(h.overlap=n,h.axis=o,h.axisNumber=c)}return h},r._projectToAxis=function(t,e,i){for(var r=a.dot(e[0],i),n=r,o=1;o<e.length;o+=1){var s=a.dot(e[o],i);s>n?n=s:r>s&&(r=s)}t.min=r,t.max=n},r._findSupports=function(t,e,i){var r,n,o,s=Number.MAX_VALUE,l=a._temp[0];e=e.vertices;var h=t.position;for(o=0;o<e.length;o++)t=e[o],l.x=t.x-h.x,l.y=t.y-h.y,r=-a.dot(i,l),s>r&&(s=r,n=t);return t=e[0<=n.index-1?n.index-1:e.length-1],l.x=t.x-h.x,l.y=t.y-h.y,s=-a.dot(i,l),o=t,t=e[(n.index+1)%e.length],l.x=t.x-h.x,l.y=t.y-h.y,r=-a.dot(i,l),s>r&&(o=t),[n,o]}}()},{"../geometry/Vector":28,"../geometry/Vertices":29}],12:[function(t,e,i){var r={};e.exports=r;var n=t("../geometry/Vertices"),a=t("../geometry/Vector"),o=t("../core/Sleeping"),s=t("../geometry/Bounds"),l=t("../geometry/Axes"),h=t("../core/Common");!function(){r._warming=.4,r._torqueDampen=1,r._minLength=1e-6,r.create=function(t){t.bodyA&&!t.pointA&&(t.pointA={x:0,y:0}),t.bodyB&&!t.pointB&&(t.pointB={x:0,y:0});var e=t.bodyA?a.add(t.bodyA.position,t.pointA):t.pointA,i=t.bodyB?a.add(t.bodyB.position,t.pointB):t.pointB,e=a.magnitude(a.sub(e,i));return t.length="undefined"!=typeof t.length?t.length:e,t.id=t.id||h.nextId(),t.label=t.label||"Constraint",t.type="constraint",t.stiffness=t.stiffness||(0<t.length?1:.7),t.damping=t.damping||0,t.angularStiffness=t.angularStiffness||0,t.angleA=t.bodyA?t.bodyA.angle:t.angleA,t.angleB=t.bodyB?t.bodyB.angle:t.angleB,t.plugin={},e={visible:!0,lineWidth:2,strokeStyle:"#ffffff",type:"line",anchors:!0},0===t.length&&.1<t.stiffness?(e.type="pin",e.anchors=!1):.9>t.stiffness&&(e.type="spring"),t.render=h.extend(e,t.render),t},r.preSolveAll=function(t){for(var e=0;e<t.length;e+=1){var i=t[e],r=i.constraintImpulse;i.isStatic||0===r.x&&0===r.y&&0===r.angle||(i.position.x+=r.x,i.position.y+=r.y,i.angle+=r.angle)}},r.solveAll=function(t,e){for(var i=0;i<t.length;i+=1){var n=t[i],a=!n.bodyA||n.bodyA&&n.bodyA.isStatic,n=!n.bodyB||n.bodyB&&n.bodyB.isStatic;(a||n)&&r.solve(t[i],e)}for(i=0;i<t.length;i+=1)n=t[i],a=!n.bodyA||n.bodyA&&n.bodyA.isStatic,n=!n.bodyB||n.bodyB&&n.bodyB.isStatic,a||n||r.solve(t[i],e)},r.solve=function(t,e){var i=t.bodyA,n=t.bodyB,o=t.pointA,s=t.pointB;if(i||n){i&&!i.isStatic&&(a.rotate(o,i.angle-t.angleA,o),t.angleA=i.angle),n&&!n.isStatic&&(a.rotate(s,n.angle-t.angleB,s),t.angleB=n.angle);var l=o,h=s;if(i&&(l=a.add(i.position,o)),n&&(h=a.add(n.position,s)),l&&h){var c=a.sub(l,h),u=a.magnitude(c);u<r._minLength&&(u=r._minLength);var p,d,f,g,l=a.mult(c,(u-t.length)/u*(1>t.stiffness?t.stiffness*e:t.stiffness)),h=(i?i.inverseMass:0)+(n?n.inverseMass:0),m=h+((i?i.inverseInertia:0)+(n?n.inverseInertia:0));t.damping&&(g=a.create(),f=a.div(c,u),g=a.sub(n&&a.sub(n.position,n.positionPrev)||g,i&&a.sub(i.position,i.positionPrev)||g),g=a.dot(f,g)),i&&!i.isStatic&&(d=i.inverseMass/h,i.constraintImpulse.x-=l.x*d,i.constraintImpulse.y-=l.y*d,i.position.x-=l.x*d,i.position.y-=l.y*d,t.damping&&(i.positionPrev.x-=t.damping*f.x*g*d,i.positionPrev.y-=t.damping*f.y*g*d),p=a.cross(o,l)/m*r._torqueDampen*i.inverseInertia*(1-t.angularStiffness),i.constraintImpulse.angle-=p,i.angle-=p),n&&!n.isStatic&&(d=n.inverseMass/h,n.constraintImpulse.x+=l.x*d,n.constraintImpulse.y+=l.y*d,n.position.x+=l.x*d,n.position.y+=l.y*d,t.damping&&(n.positionPrev.x+=t.damping*f.x*g*d,n.positionPrev.y+=t.damping*f.y*g*d),p=a.cross(s,l)/m*r._torqueDampen*n.inverseInertia*(1-t.angularStiffness),n.constraintImpulse.angle+=p,n.angle+=p)}}},r.postSolveAll=function(t){for(var e=0;e<t.length;e++){var i=t[e],h=i.constraintImpulse;if(!(i.isStatic||0===h.x&&0===h.y&&0===h.angle)){o.set(i,!1);for(var c=0;c<i.parts.length;c++){var u=i.parts[c];n.translate(u.vertices,h),c>0&&(u.position.x+=h.x,u.position.y+=h.y),0!==h.angle&&(n.rotate(u.vertices,h.angle,i.position),l.rotate(u.axes,h.angle),c>0&&a.rotateAbout(u.position,h.angle,i.position,u.position)),s.update(u.bounds,u.vertices,i.velocity)}h.angle*=r._warming,h.x*=r._warming,h.y*=r._warming}}}}()},{"../core/Common":14,"../core/Sleeping":22,"../geometry/Axes":25,"../geometry/Bounds":26,"../geometry/Vector":28,"../geometry/Vertices":29}],13:[function(t,e,i){var r={};e.exports=r;var n=t("../geometry/Vertices"),a=t("../core/Sleeping"),o=t("../core/Mouse"),s=t("../core/Events"),l=t("../collision/Detector"),h=t("./Constraint"),c=t("../body/Composite"),u=t("../core/Common"),p=t("../geometry/Bounds");!function(){r.create=function(t,e){var i=(t?t.mouse:null)||(e?e.mouse:null);i||(t&&t.render&&t.render.canvas?i=o.create(t.render.canvas):e&&e.element?i=o.create(e.element):(i=o.create(),u.warn("MouseConstraint.create: options.mouse was undefined, options.element was undefined, may not function as expected")));var n=h.create({label:"Mouse Constraint",pointA:i.position,pointB:{x:0,y:0},length:.01,stiffness:.1,angularStiffness:1,render:{strokeStyle:"#90EE90",lineWidth:3}}),a=u.extend({type:"mouseConstraint",mouse:i,element:null,body:null,constraint:n,collisionFilter:{category:1,mask:4294967295,group:0}},e);return s.on(t,"beforeUpdate",function(){var e=c.allBodies(t.world);r.update(a,e),r._triggerEvents(a)}),a},r.update=function(t,e){var i=t.mouse,r=t.constraint,o=t.body;if(0===i.button){if(r.bodyB)a.set(r.bodyB,!1),r.pointA=i.position;else for(var h=0;h<e.length;h++)if(o=e[h],p.contains(o.bounds,i.position)&&l.canCollide(o.collisionFilter,t.collisionFilter))for(var c=1<o.parts.length?1:0;c<o.parts.length;c++)if(n.contains(o.parts[c].vertices,i.position)){r.pointA=i.position,r.bodyB=t.body=o,r.pointB={x:i.position.x-o.position.x,y:i.position.y-o.position.y},r.angleB=o.angle,a.set(o,!1),s.trigger(t,"startdrag",{mouse:i,body:o});break}}else r.bodyB=t.body=null,r.pointB=null,o&&s.trigger(t,"enddrag",{mouse:i,body:o})},r._triggerEvents=function(t){var e=t.mouse,i=e.sourceEvents;i.mousemove&&s.trigger(t,"mousemove",{mouse:e}),i.mousedown&&s.trigger(t,"mousedown",{mouse:e}),i.mouseup&&s.trigger(t,"mouseup",{mouse:e}),o.clearSourceEvents(e)}}()},{"../body/Composite":2,"../collision/Detector":5,"../core/Common":14,"../core/Events":16,"../core/Mouse":19,"../core/Sleeping":22,"../geometry/Bounds":26,"../geometry/Vertices":29,"./Constraint":12}],14:[function(t,e,i){var r={};e.exports=r,function(){r._nextId=0,r._seed=0,r._nowStartTime=+new Date,r.extend=function(t,e){var i,n;for("boolean"==typeof e?(i=2,n=e):(i=1,n=!0);i<arguments.length;i++){var a=arguments[i];if(a)for(var o in a)n&&a[o]&&a[o].constructor===Object?t[o]&&t[o].constructor!==Object?t[o]=a[o]:(t[o]=t[o]||{},r.extend(t[o],n,a[o])):t[o]=a[o]}return t},r.clone=function(t,e){return r.extend({},e,t)},r.keys=function(t){if(Object.keys)return Object.keys(t);var e,i=[];for(e in t)i.push(e);return i},r.values=function(t){var e=[];if(Object.keys){for(var i=Object.keys(t),r=0;r<i.length;r++)e.push(t[i[r]]);return e}for(i in t)e.push(t[i]);return e},r.get=function(t,e,i,r){for(e=e.split(".").slice(i,r),i=0;i<e.length;i+=1)t=t[e[i]];return t},r.set=function(t,e,i,n,a){return n=e.split(".").slice(n,a),r.get(t,e,0,-1)[n[n.length-1]]=i,i},r.shuffle=function(t){for(var e=t.length-1;e>0;e--){var i=Math.floor(r.random()*(e+1)),n=t[e];t[e]=t[i],t[i]=n}return t},r.choose=function(t){return t[Math.floor(r.random()*t.length)]},r.isElement=function(t){return"undefined"!=typeof HTMLElement?t instanceof HTMLElement:!!(t&&t.nodeType&&t.nodeName)},r.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)},r.isFunction=function(t){return"function"==typeof t},r.isPlainObject=function(t){return"object"==typeof t&&t.constructor===Object},r.isString=function(t){return"[object String]"===toString.call(t)},r.clamp=function(t,e,i){return e>t?e:t>i?i:t},r.sign=function(t){return 0>t?-1:1},r.now=function(){if(window.performance){if(window.performance.now)return window.performance.now();if(window.performance.webkitNow)return window.performance.webkitNow()}return new Date-r._nowStartTime},r.random=function(t,e){return t="undefined"!=typeof t?t:0,e="undefined"!=typeof e?e:1,t+(r._seed=(9301*r._seed+49297)%233280,r._seed/233280*(e-t))},r.colorToNumber=function(t){return t=t.replace("#",""),3==t.length&&(t=t.charAt(0)+t.charAt(0)+t.charAt(1)+t.charAt(1)+t.charAt(2)+t.charAt(2)),parseInt(t,16)},r.logLevel=1,r.log=function(){console&&0<r.logLevel&&3>=r.logLevel&&console.log.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},r.info=function(){console&&0<r.logLevel&&2>=r.logLevel&&console.info.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},r.warn=function(){console&&0<r.logLevel&&3>=r.logLevel&&console.warn.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},r.nextId=function(){return r._nextId++},r.indexOf=function(t,e){if(t.indexOf)return t.indexOf(e);for(var i=0;i<t.length;i++)if(t[i]===e)return i;return-1},r.map=function(t,e){if(t.map)return t.map(e);for(var i=[],r=0;r<t.length;r+=1)i.push(e(t[r]));return i},r.topologicalSort=function(t){var e,i=[],n=[],a=[];for(e in t)n[e]||a[e]||r._topologicalSort(e,n,a,t,i);return i},r._topologicalSort=function(t,e,i,n,a){var o=n[t]||[];i[t]=!0;for(var s=0;s<o.length;s+=1){var l=o[s];i[l]||e[l]||r._topologicalSort(l,e,i,n,a)}i[t]=!1,e[t]=!0,a.push(t)},r.chain=function(){for(var t=[],e=0;e<arguments.length;e+=1){var i=arguments[e];i._chained?t.push.apply(t,i._chained):t.push(i)}return e=function(){for(var e,i=Array(arguments.length),r=0,n=arguments.length;n>r;r++)i[r]=arguments[r];for(r=0;r<t.length;r+=1)n=t[r].apply(e,i),"undefined"!=typeof n&&(e=n);return e},e._chained=t,e},r.chainPathBefore=function(t,e,i){return r.set(t,e,r.chain(i,r.get(t,e)))},r.chainPathAfter=function(t,e,i){return r.set(t,e,r.chain(r.get(t,e),i))}}()},{}],15:[function(t,e,i){var r={};e.exports=r;var n=t("../body/World"),a=t("./Sleeping"),o=t("../collision/Resolver"),s=t("../render/Render"),l=t("../collision/Pairs"),h=(t("./Metrics"),t("../collision/Grid")),c=t("./Events"),u=t("../body/Composite"),p=t("../constraint/Constraint"),d=t("./Common"),f=t("../body/Body");!function(){r.create=function(t,e){e=d.isElement(t)?e:t,t=d.isElement(t)?t:null,e=e||{},(t||e.render)&&d.warn("Engine.create: engine.render is deprecated (see docs)");var i=d.extend({positionIterations:6,velocityIterations:4,constraintIterations:2,enableSleeping:!1,events:[],plugin:{},timing:{timestamp:0,timeScale:1},broadphase:{controller:h}},e);return(t||i.render)&&(i.render=d.extend({element:t,controller:s},i.render)),i.render&&i.render.controller&&(i.render=i.render.controller.create(i.render)),i.render&&(i.render.engine=i),i.world=e.world||n.create(i.world),i.pairs=l.create(),i.broadphase=i.broadphase.controller.create(i.broadphase),i.metrics=i.metrics||{extended:!1},i},r.update=function(t,e,i){e=e||1e3/60,i=i||1;var n=t.world,s=t.timing,h=t.broadphase,d=[];s.timestamp+=e*s.timeScale;var f={timestamp:s.timestamp};c.trigger(t,"beforeUpdate",f);var g=u.allBodies(n),m=u.allConstraints(n);for(t.enableSleeping&&a.update(g,s.timeScale),r._bodiesApplyGravity(g,n.gravity),r._bodiesUpdate(g,e,s.timeScale,i,n.bounds),p.preSolveAll(g),e=0;e<t.constraintIterations;e++)p.solveAll(m,s.timeScale);for(p.postSolveAll(g),h.controller?(n.isModified&&h.controller.clear(h),h.controller.update(h,g,t,n.isModified),d=h.pairsList):d=g,n.isModified&&u.setModified(n,!1,!1,!0),h=h.detector(d,t),n=t.pairs,d=s.timestamp,l.update(n,h,d),l.removeOld(n,d),t.enableSleeping&&a.afterCollisions(n.list,s.timeScale),0<n.collisionStart.length&&c.trigger(t,"collisionStart",{pairs:n.collisionStart}),o.preSolvePosition(n.list),e=0;e<t.positionIterations;e++)o.solvePosition(n.list,s.timeScale);for(o.postSolvePosition(g),p.preSolveAll(g),e=0;e<t.constraintIterations;e++)p.solveAll(m,s.timeScale);for(p.postSolveAll(g),o.preSolveVelocity(n.list),e=0;e<t.velocityIterations;e++)o.solveVelocity(n.list,s.timeScale);return 0<n.collisionActive.length&&c.trigger(t,"collisionActive",{pairs:n.collisionActive}),0<n.collisionEnd.length&&c.trigger(t,"collisionEnd",{pairs:n.collisionEnd}),r._bodiesClearForces(g),c.trigger(t,"afterUpdate",f),t},r.merge=function(t,e){if(d.extend(t,e),e.world){t.world=e.world,r.clear(t);for(var i=u.allBodies(t.world),n=0;n<i.length;n++){var o=i[n];a.set(o,!1),o.id=d.nextId()}}},r.clear=function(t){var e=t.world;l.clear(t.pairs);var i=t.broadphase;i.controller&&(e=u.allBodies(e),i.controller.clear(i),i.controller.update(i,e,t,!0))},r._bodiesClearForces=function(t){for(var e=0;e<t.length;e++){var i=t[e];i.force.x=0,i.force.y=0,i.torque=0}},r._bodiesApplyGravity=function(t,e){var i="undefined"!=typeof e.scale?e.scale:.001;if((0!==e.x||0!==e.y)&&0!==i)for(var r=0;r<t.length;r++){var n=t[r];n.isStatic||n.isSleeping||(n.force.y+=n.mass*e.y*i,n.force.x+=n.mass*e.x*i)}},r._bodiesUpdate=function(t,e,i,r,n){for(n=0;n<t.length;n++){var a=t[n];a.isStatic||a.isSleeping||f.update(a,e,i,r)}}}()},{"../body/Body":1,"../body/Composite":2,"../body/World":3,"../collision/Grid":6,"../collision/Pairs":8,"../collision/Resolver":10,"../constraint/Constraint":12,"../render/Render":31,"./Common":14,"./Events":16,"./Metrics":18,"./Sleeping":22}],16:[function(t,e,i){var r={};e.exports=r;var n=t("./Common");!function(){r.on=function(t,e,i){for(var r=e.split(" "),n=0;n<r.length;n++)e=r[n],t.events=t.events||{},t.events[e]=t.events[e]||[],t.events[e].push(i);return i},r.off=function(t,e,i){if(!e)return void(t.events={});"function"==typeof e&&(i=e,e=n.keys(t.events).join(" ")),e=e.split(" ");for(var r=0;r<e.length;r++){var a=t.events[e[r]],o=[];if(i&&a)for(var s=0;s<a.length;s++)a[s]!==i&&o.push(a[s]);t.events[e[r]]=o}},r.trigger=function(t,e,i){var r,a,o;if(t.events){i||(i={}),e=e.split(" ");for(var s=0;s<e.length;s++)if(r=e[s],a=t.events[r]){o=n.clone(i,!1),o.name=r,o.source=t;for(var l=0;l<a.length;l++)a[l].apply(t,[o])}}}}()},{"./Common":14}],17:[function(t,e,i){var r={};e.exports=r;var n=t("./Plugin"),a=t("./Common");!function(){r.name="matter-js",r.version="0.14.1",r.uses=[],r.used=[],r.use=function(){n.use(r,Array.prototype.slice.call(arguments))},r.before=function(t,e){return t=t.replace(/^Matter./,""),a.chainPathBefore(r,t,e)},r.after=function(t,e){return t=t.replace(/^Matter./,""),a.chainPathAfter(r,t,e)}}()},{"./Common":14,"./Plugin":20}],18:[function(t,e,i){},{"../body/Composite":2,"./Common":14}],19:[function(t,e,i){var r={};e.exports=r;var n=t("../core/Common");!function(){r.create=function(t){var e={};return t||n.log("Mouse.create: element was undefined, defaulting to document.body","warn"),e.element=t||document.body,e.absolute={x:0,y:0},e.position={x:0,y:0},e.mousedownPosition={x:0,y:0},e.mouseupPosition={x:0,y:0},e.offset={x:0,y:0},e.scale={x:1,y:1},e.wheelDelta=0,e.button=-1,e.pixelRatio=e.element.getAttribute("data-pixel-ratio")||1,e.sourceEvents={mousemove:null,mousedown:null,mouseup:null,mousewheel:null},e.mousemove=function(t){var i=r._getRelativeMousePosition(t,e.element,e.pixelRatio);t.changedTouches&&(e.button=0,t.preventDefault()),e.absolute.x=i.x,e.absolute.y=i.y,e.position.x=e.absolute.x*e.scale.x+e.offset.x,e.position.y=e.absolute.y*e.scale.y+e.offset.y,e.sourceEvents.mousemove=t},e.mousedown=function(t){var i=r._getRelativeMousePosition(t,e.element,e.pixelRatio);t.changedTouches?(e.button=0,t.preventDefault()):e.button=t.button,e.absolute.x=i.x,e.absolute.y=i.y,e.position.x=e.absolute.x*e.scale.x+e.offset.x,e.position.y=e.absolute.y*e.scale.y+e.offset.y,e.mousedownPosition.x=e.position.x,e.mousedownPosition.y=e.position.y,e.sourceEvents.mousedown=t},e.mouseup=function(t){var i=r._getRelativeMousePosition(t,e.element,e.pixelRatio);t.changedTouches&&t.preventDefault(),e.button=-1,e.absolute.x=i.x,e.absolute.y=i.y,e.position.x=e.absolute.x*e.scale.x+e.offset.x,e.position.y=e.absolute.y*e.scale.y+e.offset.y,e.mouseupPosition.x=e.position.x,e.mouseupPosition.y=e.position.y,e.sourceEvents.mouseup=t},e.mousewheel=function(t){e.wheelDelta=Math.max(-1,Math.min(1,t.wheelDelta||-t.detail)),t.preventDefault()},r.setElement(e,e.element),e},r.setElement=function(t,e){t.element=e,e.addEventListener("mousemove",t.mousemove),e.addEventListener("mousedown",t.mousedown),e.addEventListener("mouseup",t.mouseup),e.addEventListener("mousewheel",t.mousewheel),e.addEventListener("DOMMouseScroll",t.mousewheel),e.addEventListener("touchmove",t.mousemove),e.addEventListener("touchstart",t.mousedown),e.addEventListener("touchend",t.mouseup)},r.clearSourceEvents=function(t){t.sourceEvents.mousemove=null,t.sourceEvents.mousedown=null,t.sourceEvents.mouseup=null,t.sourceEvents.mousewheel=null,t.wheelDelta=0},r.setOffset=function(t,e){t.offset.x=e.x,t.offset.y=e.y,t.position.x=t.absolute.x*t.scale.x+t.offset.x,t.position.y=t.absolute.y*t.scale.y+t.offset.y},r.setScale=function(t,e){t.scale.x=e.x,t.scale.y=e.y,t.position.x=t.absolute.x*t.scale.x+t.offset.x,t.position.y=t.absolute.y*t.scale.y+t.offset.y},r._getRelativeMousePosition=function(t,e,i){var r,n,a=e.getBoundingClientRect(),o=document.documentElement||document.body.parentNode||document.body,s=void 0!==window.pageXOffset?window.pageXOffset:o.scrollLeft,o=void 0!==window.pageYOffset?window.pageYOffset:o.scrollTop,l=t.changedTouches;return l?(r=l[0].pageX-a.left-s,n=l[0].pageY-a.top-o):(r=t.pageX-a.left-s,n=t.pageY-a.top-o),{x:r/(e.clientWidth/(e.width||e.clientWidth)*i),y:n/(e.clientHeight/(e.height||e.clientHeight)*i)}}}()},{"../core/Common":14}],20:[function(t,e,i){var r={};e.exports=r;var n=t("./Common");!function(){r._registry={},r.register=function(t){if(r.isPlugin(t)||n.warn("Plugin.register:",r.toString(t),"does not implement all required fields."),t.name in r._registry){var e=r._registry[t.name],i=r.versionParse(t.version).number,a=r.versionParse(e.version).number;i>a?(n.warn("Plugin.register:",r.toString(e),"was upgraded to",r.toString(t)),r._registry[t.name]=t):a>i?n.warn("Plugin.register:",r.toString(e),"can not be downgraded to",r.toString(t)):t!==e&&n.warn("Plugin.register:",r.toString(t),"is already registered to different plugin object")}else r._registry[t.name]=t;return t},r.resolve=function(t){return r._registry[r.dependencyParse(t).name]},r.toString=function(t){return"string"==typeof t?t:(t.name||"anonymous")+"@"+(t.version||t.range||"0.0.0")},r.isPlugin=function(t){return t&&t.name&&t.version&&t.install},r.isUsed=function(t,e){return-1<t.used.indexOf(e)},r.isFor=function(t,e){var i=t["for"]&&r.dependencyParse(t["for"]);return!t["for"]||e.name===i.name&&r.versionSatisfies(e.version,i.range)},r.use=function(t,e){if(t.uses=(t.uses||[]).concat(e||[]),0===t.uses.length)return void n.warn("Plugin.use:",r.toString(t),"does not specify any dependencies to install.");for(var i=r.dependencies(t),i=n.topologicalSort(i),a=[],o=0;o<i.length;o+=1)if(i[o]!==t.name){var s=r.resolve(i[o]);s?r.isUsed(t,s.name)||(r.isFor(s,t)||(n.warn("Plugin.use:",r.toString(s),"is for",s["for"],"but installed on",r.toString(t)+"."),s._warned=!0),s.install?s.install(t):(n.warn("Plugin.use:",r.toString(s),"does not specify an install function."),s._warned=!0),s._warned?(a.push("🔶 "+r.toString(s)),delete s._warned):a.push("✅ "+r.toString(s)),t.used.push(s.name)):a.push("❌ "+i[o])}0<a.length&&n.info(a.join("  "))},r.dependencies=function(t,e){var i=r.dependencyParse(t),a=i.name;if(e=e||{},!(a in e)){t=r.resolve(t)||t,e[a]=n.map(t.uses||[],function(e){r.isPlugin(e)&&r.register(e);var a=r.dependencyParse(e),o=r.resolve(e);return o&&!r.versionSatisfies(o.version,a.range)?(n.warn("Plugin.dependencies:",r.toString(o),"does not satisfy",r.toString(a),"used by",r.toString(i)+"."),o._warned=!0,t._warned=!0):o||(n.warn("Plugin.dependencies:",r.toString(e),"used by",r.toString(i),"could not be resolved."),t._warned=!0),a.name});for(var o=0;o<e[a].length;o+=1)r.dependencies(e[a][o],e);return e}},r.dependencyParse=function(t){return n.isString(t)?(/^[\w-]+(@(\*|[\^~]?\d+\.\d+\.\d+(-[0-9A-Za-z-]+)?))?$/.test(t)||n.warn("Plugin.dependencyParse:",t,"is not a valid dependency string."),{name:t.split("@")[0],range:t.split("@")[1]||"*"}):{name:t.name,range:t.range||t.version}},r.versionParse=function(t){/^\*|[\^~]?\d+\.\d+\.\d+(-[0-9A-Za-z-]+)?$/.test(t)||n.warn("Plugin.versionParse:",t,"is not a valid version or range.");var e=t.split("-");t=e[0];var i=isNaN(Number(t[0])),r=i?t.substr(1):t,a=n.map(r.split("."),function(t){return Number(t)});return{isRange:i,version:r,range:t,operator:i?t[0]:"",parts:a,prerelease:e[1],number:1e8*a[0]+1e4*a[1]+a[2]}},r.versionSatisfies=function(t,e){e=e||"*";var i=r.versionParse(e),n=i.parts,a=r.versionParse(t),o=a.parts;if(i.isRange){if("*"===i.operator||"*"===t)return!0;if("~"===i.operator)return o[0]===n[0]&&o[1]===n[1]&&o[2]>=n[2];if("^"===i.operator)return 0<n[0]?o[0]===n[0]&&a.number>=i.number:0<n[1]?o[1]===n[1]&&o[2]>=n[2]:o[2]===n[2]}return t===e||"*"===t}}()},{"./Common":14}],21:[function(t,e,i){var r={};e.exports=r;var n=t("./Events"),a=t("./Engine"),o=t("./Common");!function(){var t,e;if("undefined"!=typeof window&&(t=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame,e=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),!t){var i;t=function(t){i=setTimeout(function(){t(o.now())},1e3/60)},e=function(){clearTimeout(i)}}r.create=function(t){return t=o.extend({fps:60,correction:1,deltaSampleSize:60,counterTimestamp:0,frameCounter:0,deltaHistory:[],timePrev:null,timeScalePrev:1,frameRequestId:null,isFixed:!1,enabled:!0},t),t.delta=t.delta||1e3/t.fps,t.deltaMin=t.deltaMin||1e3/t.fps,t.deltaMax=t.deltaMax||1e3/(.5*t.fps),t.fps=1e3/t.delta,t},r.run=function(e,i){return"undefined"!=typeof e.positionIterations&&(i=e,e=r.create()),function n(a){e.frameRequestId=t(n),a&&e.enabled&&r.tick(e,i,a)}(),e},r.tick=function(t,e,i){var r,o=e.timing,s=1,l={timestamp:o.timestamp};n.trigger(t,"beforeTick",l),n.trigger(e,"beforeTick",l),t.isFixed?r=t.delta:(r=i-t.timePrev||t.delta,t.timePrev=i,t.deltaHistory.push(r),t.deltaHistory=t.deltaHistory.slice(-t.deltaSampleSize),r=Math.min.apply(null,t.deltaHistory),r=r<t.deltaMin?t.deltaMin:r,r=r>t.deltaMax?t.deltaMax:r,s=r/t.delta,t.delta=r),0!==t.timeScalePrev&&(s*=o.timeScale/t.timeScalePrev),0===o.timeScale&&(s=0),t.timeScalePrev=o.timeScale,t.correction=s,t.frameCounter+=1,1e3<=i-t.counterTimestamp&&(t.fps=(i-t.counterTimestamp)/1e3*t.frameCounter,t.counterTimestamp=i,t.frameCounter=0),n.trigger(t,"tick",l),n.trigger(e,"tick",l),e.world.isModified&&e.render&&e.render.controller&&e.render.controller.clear&&e.render.controller.clear(e.render),n.trigger(t,"beforeUpdate",l),a.update(e,r,s),n.trigger(t,"afterUpdate",l),e.render&&e.render.controller&&(n.trigger(t,"beforeRender",l),n.trigger(e,"beforeRender",l),e.render.controller.world(e.render),n.trigger(t,"afterRender",l),n.trigger(e,"afterRender",l)),n.trigger(t,"afterTick",l),n.trigger(e,"afterTick",l)},r.stop=function(t){e(t.frameRequestId)},r.start=function(t,e){r.run(t,e)}}()},{"./Common":14,"./Engine":15,"./Events":16}],22:[function(t,e,i){var r={};e.exports=r;var n=t("./Events");!function(){r._motionWakeThreshold=.18,r._motionSleepThreshold=.08,r._minBias=.9,r.update=function(t,e){for(var i=e*e*e,n=0;n<t.length;n++){var a=t[n],o=a.speed*a.speed+a.angularSpeed*a.angularSpeed;0===a.force.x&&0===a.force.y?(a.motion=r._minBias*Math.min(a.motion,o)+(1-r._minBias)*Math.max(a.motion,o),0<a.sleepThreshold&&a.motion<r._motionSleepThreshold*i?(a.sleepCounter+=1,a.sleepCounter>=a.sleepThreshold&&r.set(a,!0)):0<a.sleepCounter&&--a.sleepCounter):r.set(a,!1)}},r.afterCollisions=function(t,e){for(var i=e*e*e,n=0;n<t.length;n++){var a=t[n];if(a.isActive){var o=a.collision,a=o.bodyA.parent,s=o.bodyB.parent;a.isSleeping&&s.isSleeping||a.isStatic||s.isStatic||!a.isSleeping&&!s.isSleeping||(o=a.isSleeping&&!a.isStatic?a:s,a=o===a?s:a,!o.isStatic&&a.motion>r._motionWakeThreshold*i&&r.set(o,!1))}}},r.set=function(t,e){var i=t.isSleeping;e?(t.isSleeping=!0,t.sleepCounter=t.sleepThreshold,t.positionImpulse.x=0,t.positionImpulse.y=0,t.positionPrev.x=t.position.x,t.positionPrev.y=t.position.y,t.anglePrev=t.angle,t.speed=0,t.angularSpeed=0,t.motion=0,i||n.trigger(t,"sleepStart")):(t.isSleeping=!1,t.sleepCounter=0,i&&n.trigger(t,"sleepEnd"))}}()},{"./Events":16}],23:[function(t,e,i){(function(i){var r={};e.exports=r;var n=t("../geometry/Vertices"),a=t("../core/Common"),o=t("../body/Body"),s=t("../geometry/Bounds"),l=t("../geometry/Vector"),h="undefined"!=typeof window?window.decomp:"undefined"!=typeof i?i.decomp:null;!function(){r.rectangle=function(t,e,i,r,s){return s=s||{},t={label:"Rectangle Body",position:{x:t,y:e},vertices:n.fromPath("L 0 0 L "+i+" 0 L "+i+" "+r+" L 0 "+r)},s.chamfer&&(e=s.chamfer,t.vertices=n.chamfer(t.vertices,e.radius,e.quality,e.qualityMin,e.qualityMax),delete s.chamfer),o.create(a.extend({},t,s))},r.trapezoid=function(t,e,i,r,s,l){l=l||{},s*=.5;var h=i*s;i=h+(1-2*s)*i;var c=i+h;return t={label:"Trapezoid Body",position:{x:t,y:e},vertices:n.fromPath(.5>s?"L 0 0 L "+h+" "+-r+" L "+i+" "+-r+" L "+c+" 0":"L 0 0 L "+i+" "+-r+" L "+c+" 0")},l.chamfer&&(e=l.chamfer,t.vertices=n.chamfer(t.vertices,e.radius,e.quality,e.qualityMin,e.qualityMax),delete l.chamfer),o.create(a.extend({},t,l))},r.circle=function(t,e,i,n,o){n=n||{};var s={label:"Circle Body",circleRadius:i};return o=Math.ceil(Math.max(10,Math.min(o||25,i))),1===o%2&&(o+=1),r.polygon(t,e,o,i,a.extend({},s,n))},r.polygon=function(t,e,i,s,l){if(l=l||{},3>i)return r.circle(t,e,s,l);for(var h=2*Math.PI/i,c="",u=.5*h,p=0;i>p;p+=1)var d=u+p*h,f=Math.sin(d)*s,c=c+("L "+(Math.cos(d)*s).toFixed(3)+" "+f.toFixed(3)+" ");return t={label:"Polygon Body",position:{x:t,y:e},vertices:n.fromPath(c)},l.chamfer&&(e=l.chamfer,t.vertices=n.chamfer(t.vertices,e.radius,e.quality,e.qualityMin,e.qualityMax),delete l.chamfer),o.create(a.extend({},t,l))},r.fromVertices=function(t,e,i,r,c,u,p){var d,f,g,m,y,v;for(r=r||{},f=[],c="undefined"!=typeof c&&c,u="undefined"!=typeof u?u:.01,p="undefined"!=typeof p?p:10,h||a.warn("Bodies.fromVertices: poly-decomp.js required. Could not decompose vertices. Fallback to convex hull."),a.isArray(i[0])||(i=[i]),v=0;v<i.length;v+=1)if(m=i[v],g=n.isConvex(m),g||!h)m=g?n.clockwiseSort(m):n.hull(m),f.push({position:{x:t,y:e},vertices:m});else{y=m.map(function(t){return[t.x,t.y]}),h.makeCCW(y),!1!==u&&h.removeCollinearPoints(y,u);var _=h.quickDecomp(y);for(y=0;y<_.length;y++){var b=_[y].map(function(t){return{x:t[0],y:t[1]}});p>0&&n.area(b)<p||f.push({position:n.centre(b),vertices:b})}}for(y=0;y<f.length;y++)f[y]=o.create(a.extend(f[y],r));if(c)for(y=0;y<f.length;y++)for(p=f[y],i=y+1;i<f.length;i++)if(g=f[i],s.overlaps(p.bounds,g.bounds))for(m=p.vertices,v=g.vertices,c=0;c<p.vertices.length;c++)for(u=0;u<g.vertices.length;u++)_=l.magnitudeSquared(l.sub(m[(c+1)%m.length],v[u])),b=l.magnitudeSquared(l.sub(m[c],v[(u+1)%v.length])),5>_&&5>b&&(m[c].isInternal=!0,v[u].isInternal=!0);return 1<f.length?(d=o.create(a.extend({parts:f.slice(0)},r)),o.setPosition(d,{x:t,y:e}),d):f[0]}}()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../body/Body":1,"../core/Common":14,"../geometry/Bounds":26,"../geometry/Vector":28,"../geometry/Vertices":29}],24:[function(t,e,i){var r={};e.exports=r;var n=t("../body/Composite"),a=t("../constraint/Constraint"),o=t("../core/Common"),s=t("../body/Body"),l=t("./Bodies");!function(){r.stack=function(t,e,i,r,a,o,l){for(var h,c=n.create({label:"Stack"}),u=t,p=0,d=0;r>d;d++){for(var f=0,g=0;i>g;g++){var m=l(u,e,g,d,h,p);m?(h=m.bounds.max.y-m.bounds.min.y,u=m.bounds.max.x-m.bounds.min.x,h>f&&(f=h),s.translate(m,{x:.5*u,y:.5*h}),u=m.bounds.max.x+a,n.addBody(c,m),h=m,p+=1):u+=a}e+=f+o,u=t}return c},r.chain=function(t,e,i,r,s,l){for(var h=t.bodies,c=1;c<h.length;c++){var u=h[c-1],p=h[c],u=o.extend({bodyA:u,pointA:{x:(u.bounds.max.x-u.bounds.min.x)*e,y:(u.bounds.max.y-u.bounds.min.y)*i},bodyB:p,pointB:{x:(p.bounds.max.x-p.bounds.min.x)*r,y:(p.bounds.max.y-p.bounds.min.y)*s}},l);n.addConstraint(t,a.create(u))}return t.label+=" Chain",t},r.mesh=function(t,e,i,r,s){var l,h,c,u,p,d=t.bodies;for(l=0;i>l;l++){for(h=1;e>h;h++)c=d[h-1+l*e],u=d[h+l*e],n.addConstraint(t,a.create(o.extend({bodyA:c,bodyB:u},s)));if(l>0)for(h=0;e>h;h++)c=d[h+(l-1)*e],u=d[h+l*e],n.addConstraint(t,a.create(o.extend({bodyA:c,bodyB:u},s))),r&&h>0&&(p=d[h-1+(l-1)*e],n.addConstraint(t,a.create(o.extend({bodyA:p,bodyB:u},s)))),r&&e-1>h&&(p=d[h+1+(l-1)*e],n.addConstraint(t,a.create(o.extend({bodyA:p,bodyB:u},s))))}return t.label+=" Mesh",t},r.pyramid=function(t,e,i,n,a,o,l){return r.stack(t,e,i,n,a,o,function(e,r,o,h,c,u){var p=Math.min(n,Math.ceil(i/2));return e=c?c.bounds.max.x-c.bounds.min.x:0,h>p||(h=p-h,p=i-1-h,h>o||o>p)?void 0:(1===u&&s.translate(c,{x:(o+(1===i%2?1:-1))*e,y:0}),l(t+(c?o*e:0)+o*a,r,o,h,c,u))})},r.newtonsCradle=function(t,e,i,r,o){for(var s=n.create({label:"Newtons Cradle"}),h=0;i>h;h++){var c=l.circle(t+1.9*h*r,e+o,r,{inertia:1/0,restitution:1,friction:0,frictionAir:1e-4,slop:1}),u=a.create({pointA:{x:t+1.9*h*r,y:e},bodyB:c});n.addBody(s,c),n.addConstraint(s,u)}return s},r.car=function(t,e,i,r,o){var h=s.nextGroup(!0),c=.5*-i+20,u=.5*i-20,p=n.create({label:"Car"});return i=l.rectangle(t,e,i,r,{collisionFilter:{group:h},chamfer:{radius:.5*r},density:2e-4}),r=l.circle(t+c,e+0,o,{collisionFilter:{group:h},friction:.8}),t=l.circle(t+u,e+0,o,{collisionFilter:{group:h},friction:.8}),c=a.create({bodyB:i,pointB:{x:c,y:0},bodyA:r,stiffness:1,length:0}),u=a.create({bodyB:i,pointB:{x:u,y:0},bodyA:t,stiffness:1,length:0}),n.addBody(p,i),n.addBody(p,r),n.addBody(p,t),n.addConstraint(p,c),n.addConstraint(p,u),p},r.softBody=function(t,e,i,n,a,s,h,c,u,p){return u=o.extend({inertia:1/0},u),p=o.extend({stiffness:.2,render:{type:"line",anchors:!1}},p),t=r.stack(t,e,i,n,a,s,function(t,e){return l.circle(t,e,c,u)}),r.mesh(t,i,n,h,p),t.label="Soft Body",t}}()},{"../body/Body":1,"../body/Composite":2,"../constraint/Constraint":12,"../core/Common":14,"./Bodies":23}],25:[function(t,e,i){var r={};e.exports=r;var n=t("../geometry/Vector"),a=t("../core/Common");!function(){r.fromVertices=function(t){for(var e={},i=0;i<t.length;i++){var r=(i+1)%t.length,r=n.normalise({x:t[r].y-t[i].y,y:t[i].x-t[r].x}),o=0===r.y?1/0:r.x/r.y,o=o.toFixed(3).toString();e[o]=r}return a.values(e)},r.rotate=function(t,e){if(0!==e)for(var i=Math.cos(e),r=Math.sin(e),n=0;n<t.length;n++){var a,o=t[n];a=o.x*i-o.y*r,o.y=o.x*r+o.y*i,o.x=a}}}()},{"../core/Common":14,"../geometry/Vector":28}],26:[function(t,e,i){var r={};e.exports=r,function(){r.create=function(t){var e={min:{x:0,y:0},max:{x:0,y:0}};return t&&r.update(e,t),e},r.update=function(t,e,i){t.min.x=1/0,t.max.x=-(1/0),t.min.y=1/0,t.max.y=-(1/0);for(var r=0;r<e.length;r++){var n=e[r];n.x>t.max.x&&(t.max.x=n.x),n.x<t.min.x&&(t.min.x=n.x),n.y>t.max.y&&(t.max.y=n.y),n.y<t.min.y&&(t.min.y=n.y)}i&&(0<i.x?t.max.x+=i.x:t.min.x+=i.x,0<i.y?t.max.y+=i.y:t.min.y+=i.y)},r.contains=function(t,e){return e.x>=t.min.x&&e.x<=t.max.x&&e.y>=t.min.y&&e.y<=t.max.y
},r.overlaps=function(t,e){return t.min.x<=e.max.x&&t.max.x>=e.min.x&&t.max.y>=e.min.y&&t.min.y<=e.max.y},r.translate=function(t,e){t.min.x+=e.x,t.max.x+=e.x,t.min.y+=e.y,t.max.y+=e.y},r.shift=function(t,e){var i=t.max.x-t.min.x,r=t.max.y-t.min.y;t.min.x=e.x,t.max.x=e.x+i,t.min.y=e.y,t.max.y=e.y+r}}()},{}],27:[function(t,e,i){var r={};e.exports=r,t("../geometry/Bounds"),!function(){r.pathToVertices=function(t,e){var i,n,a,o,s,l,h,c,u,p,d=[],f=0,g=0,m=0;e=e||15;var y=function(t,e,i){if(i=1===i%2&&i>1,!h||t!=h.x||e!=h.y){h&&i?(u=h.x,p=h.y):(u=0,p=0);var r={x:u+t,y:p+e};!i&&h||(h=r),d.push(r),g=u+t,m=p+e}},v=function(t){var e=t.pathSegTypeAsLetter.toUpperCase();if("Z"!==e){switch(e){case"M":case"L":case"T":case"C":case"S":case"Q":g=t.x,m=t.y;break;case"H":g=t.x;break;case"V":m=t.y}y(g,m,t.pathSegType)}};for(r._svgPathToAbsolute(t),n=t.getTotalLength(),o=[],i=0;i<t.pathSegList.numberOfItems;i+=1)o.push(t.pathSegList.getItem(i));for(s=o.concat();n>f;){if(c=t.getPathSegAtLength(f),a=o[c],a!=l){for(;s.length&&s[0]!=a;)v(s.shift());l=a}switch(a.pathSegTypeAsLetter.toUpperCase()){case"C":case"T":case"S":case"Q":case"A":i=t.getPointAtLength(f),y(i.x,i.y,0)}f+=e}for(i=0,n=s.length;n>i;++i)v(s[i]);return d},r._svgPathToAbsolute=function(t){for(var e,i,r,n,a,o,s=t.pathSegList,l=0,h=0,c=s.numberOfItems,u=0;c>u;++u){var p=s.getItem(u),d=p.pathSegTypeAsLetter;if(/[MLHVCSQTA]/.test(d))"x"in p&&(l=p.x),"y"in p&&(h=p.y);else switch("x1"in p&&(r=l+p.x1),"x2"in p&&(a=l+p.x2),"y1"in p&&(n=h+p.y1),"y2"in p&&(o=h+p.y2),"x"in p&&(l+=p.x),"y"in p&&(h+=p.y),d){case"m":s.replaceItem(t.createSVGPathSegMovetoAbs(l,h),u);break;case"l":s.replaceItem(t.createSVGPathSegLinetoAbs(l,h),u);break;case"h":s.replaceItem(t.createSVGPathSegLinetoHorizontalAbs(l),u);break;case"v":s.replaceItem(t.createSVGPathSegLinetoVerticalAbs(h),u);break;case"c":s.replaceItem(t.createSVGPathSegCurvetoCubicAbs(l,h,r,n,a,o),u);break;case"s":s.replaceItem(t.createSVGPathSegCurvetoCubicSmoothAbs(l,h,a,o),u);break;case"q":s.replaceItem(t.createSVGPathSegCurvetoQuadraticAbs(l,h,r,n),u);break;case"t":s.replaceItem(t.createSVGPathSegCurvetoQuadraticSmoothAbs(l,h),u);break;case"a":s.replaceItem(t.createSVGPathSegArcAbs(l,h,p.r1,p.r2,p.angle,p.largeArcFlag,p.sweepFlag),u);break;case"z":case"Z":l=e,h=i}"M"!=d&&"m"!=d||(e=l,i=h)}}}()},{"../geometry/Bounds":26}],28:[function(t,e,i){var r={};e.exports=r,function(){r.create=function(t,e){return{x:t||0,y:e||0}},r.clone=function(t){return{x:t.x,y:t.y}},r.magnitude=function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},r.magnitudeSquared=function(t){return t.x*t.x+t.y*t.y},r.rotate=function(t,e,i){var r=Math.cos(e);e=Math.sin(e),i||(i={});var n=t.x*r-t.y*e;return i.y=t.x*e+t.y*r,i.x=n,i},r.rotateAbout=function(t,e,i,r){var n=Math.cos(e);e=Math.sin(e),r||(r={});var a=i.x+((t.x-i.x)*n-(t.y-i.y)*e);return r.y=i.y+((t.x-i.x)*e+(t.y-i.y)*n),r.x=a,r},r.normalise=function(t){var e=r.magnitude(t);return 0===e?{x:0,y:0}:{x:t.x/e,y:t.y/e}},r.dot=function(t,e){return t.x*e.x+t.y*e.y},r.cross=function(t,e){return t.x*e.y-t.y*e.x},r.cross3=function(t,e,i){return(e.x-t.x)*(i.y-t.y)-(e.y-t.y)*(i.x-t.x)},r.add=function(t,e,i){return i||(i={}),i.x=t.x+e.x,i.y=t.y+e.y,i},r.sub=function(t,e,i){return i||(i={}),i.x=t.x-e.x,i.y=t.y-e.y,i},r.mult=function(t,e){return{x:t.x*e,y:t.y*e}},r.div=function(t,e){return{x:t.x/e,y:t.y/e}},r.perp=function(t,e){return e=!0===e?-1:1,{x:e*-t.y,y:e*t.x}},r.neg=function(t){return{x:-t.x,y:-t.y}},r.angle=function(t,e){return Math.atan2(e.y-t.y,e.x-t.x)},r._temp=[r.create(),r.create(),r.create(),r.create(),r.create(),r.create()]}()},{}],29:[function(t,e,i){var r={};e.exports=r;var n=t("../geometry/Vector"),a=t("../core/Common");!function(){r.create=function(t,e){for(var i=[],r=0;r<t.length;r++){var n=t[r];i.push({x:n.x,y:n.y,index:r,body:e,isInternal:!1})}return i},r.fromPath=function(t,e){var i=[];return t.replace(/L?\s*([\-\d\.e]+)[\s,]*([\-\d\.e]+)*/gi,function(t,e,r){i.push({x:parseFloat(e),y:parseFloat(r)})}),r.create(i,e)},r.centre=function(t){for(var e,i,a=r.area(t,!0),o={x:0,y:0},s=0;s<t.length;s++)i=(s+1)%t.length,e=n.cross(t[s],t[i]),e=n.mult(n.add(t[s],t[i]),e),o=n.add(o,e);return n.div(o,6*a)},r.mean=function(t){for(var e={x:0,y:0},i=0;i<t.length;i++)e.x+=t[i].x,e.y+=t[i].y;return n.div(e,t.length)},r.area=function(t,e){for(var i=0,r=t.length-1,n=0;n<t.length;n++)i+=(t[r].x-t[n].x)*(t[r].y+t[n].y),r=n;return e?i/2:Math.abs(i)/2},r.inertia=function(t,e){for(var i,r,a=0,o=0,s=0;s<t.length;s++)r=(s+1)%t.length,i=Math.abs(n.cross(t[r],t[s])),a+=i*(n.dot(t[r],t[r])+n.dot(t[r],t[s])+n.dot(t[s],t[s])),o+=i;return e/6*(a/o)},r.translate=function(t,e,i){var r;if(i)for(r=0;r<t.length;r++)t[r].x+=e.x*i,t[r].y+=e.y*i;else for(r=0;r<t.length;r++)t[r].x+=e.x,t[r].y+=e.y;return t},r.rotate=function(t,e,i){if(0!==e){var r=Math.cos(e);e=Math.sin(e);for(var n=0;n<t.length;n++){var a=t[n],o=a.x-i.x,s=a.y-i.y;a.x=i.x+(o*r-s*e),a.y=i.y+(o*e+s*r)}return t}},r.contains=function(t,e){for(var i=0;i<t.length;i++){var r=t[i],n=t[(i+1)%t.length];if(0<(e.x-r.x)*(n.y-r.y)+(e.y-r.y)*(r.x-n.x))return!1}return!0},r.scale=function(t,e,i,a){if(1===e&&1===i)return t;a=a||r.centre(t);for(var o,s=0;s<t.length;s++)o=t[s],o=n.sub(o,a),t[s].x=a.x+o.x*e,t[s].y=a.y+o.y*i;return t},r.chamfer=function(t,e,i,r,o){e="number"==typeof e?[e]:e||[8],i="undefined"!=typeof i?i:-1,r=r||2,o=o||14;for(var s=[],l=0;l<t.length;l++){var h=t[l-1>=0?l-1:t.length-1],c=t[l],u=t[(l+1)%t.length],p=e[l<e.length?l:e.length-1];if(0!==p){var h=n.normalise({x:c.y-h.y,y:h.x-c.x}),d=n.normalise({x:u.y-c.y,y:c.x-u.x}),f=Math.sqrt(2*Math.pow(p,2)),u=n.mult(a.clone(h),p),g=n.normalise(n.mult(n.add(h,d),.5)),c=n.sub(c,n.mult(g,f)),f=i;for(-1===i&&(f=1.75*Math.pow(p,.32)),f=a.clamp(f,r,o),1===f%2&&(f+=1),p=Math.acos(n.dot(h,d))/f,h=0;f>h;h++)s.push(n.add(n.rotate(u,p*h),c))}else s.push(c)}return s},r.clockwiseSort=function(t){var e=r.mean(t);return t.sort(function(t,i){return n.angle(e,t)-n.angle(e,i)}),t},r.isConvex=function(t){var e,i,r,n,a=0,o=t.length;if(3>o)return null;for(e=0;o>e;e++)if(i=(e+1)%o,r=(e+2)%o,n=(t[i].x-t[e].x)*(t[r].y-t[i].y),n-=(t[i].y-t[e].y)*(t[r].x-t[i].x),0>n?a|=1:n>0&&(a|=2),3===a)return!1;return 0!==a||null},r.hull=function(t){var e,i,r=[],a=[];for(t=t.slice(0),t.sort(function(t,e){var i=t.x-e.x;return 0!==i?i:t.y-e.y}),i=0;i<t.length;i+=1){for(e=t[i];2<=a.length&&0>=n.cross3(a[a.length-2],a[a.length-1],e);)a.pop();a.push(e)}for(i=t.length-1;i>=0;--i){for(e=t[i];2<=r.length&&0>=n.cross3(r[r.length-2],r[r.length-1],e);)r.pop();r.push(e)}return r.pop(),a.pop(),r.concat(a)}}()},{"../core/Common":14,"../geometry/Vector":28}],30:[function(t,e,i){e=e.exports=t("../core/Matter"),e.Body=t("../body/Body"),e.Composite=t("../body/Composite"),e.World=t("../body/World"),e.Contact=t("../collision/Contact"),e.Detector=t("../collision/Detector"),e.Grid=t("../collision/Grid"),e.Pairs=t("../collision/Pairs"),e.Pair=t("../collision/Pair"),e.Query=t("../collision/Query"),e.Resolver=t("../collision/Resolver"),e.SAT=t("../collision/SAT"),e.Constraint=t("../constraint/Constraint"),e.MouseConstraint=t("../constraint/MouseConstraint"),e.Common=t("../core/Common"),e.Engine=t("../core/Engine"),e.Events=t("../core/Events"),e.Mouse=t("../core/Mouse"),e.Runner=t("../core/Runner"),e.Sleeping=t("../core/Sleeping"),e.Plugin=t("../core/Plugin"),e.Bodies=t("../factory/Bodies"),e.Composites=t("../factory/Composites"),e.Axes=t("../geometry/Axes"),e.Bounds=t("../geometry/Bounds"),e.Svg=t("../geometry/Svg"),e.Vector=t("../geometry/Vector"),e.Vertices=t("../geometry/Vertices"),e.Render=t("../render/Render"),e.RenderPixi=t("../render/RenderPixi"),e.World.add=e.Composite.add,e.World.remove=e.Composite.remove,e.World.addComposite=e.Composite.addComposite,e.World.addBody=e.Composite.addBody,e.World.addConstraint=e.Composite.addConstraint,e.World.clear=e.Composite.clear,e.Engine.run=e.Runner.run},{"../body/Body":1,"../body/Composite":2,"../body/World":3,"../collision/Contact":4,"../collision/Detector":5,"../collision/Grid":6,"../collision/Pair":7,"../collision/Pairs":8,"../collision/Query":9,"../collision/Resolver":10,"../collision/SAT":11,"../constraint/Constraint":12,"../constraint/MouseConstraint":13,"../core/Common":14,"../core/Engine":15,"../core/Events":16,"../core/Matter":17,"../core/Metrics":18,"../core/Mouse":19,"../core/Plugin":20,"../core/Runner":21,"../core/Sleeping":22,"../factory/Bodies":23,"../factory/Composites":24,"../geometry/Axes":25,"../geometry/Bounds":26,"../geometry/Svg":27,"../geometry/Vector":28,"../geometry/Vertices":29,"../render/Render":31,"../render/RenderPixi":32}],31:[function(t,e,i){var r={};e.exports=r;var n=t("../core/Common"),a=t("../body/Composite"),o=t("../geometry/Bounds"),s=t("../core/Events"),l=t("../collision/Grid"),h=t("../geometry/Vector"),c=t("../core/Mouse");!function(){var t,e;"undefined"!=typeof window&&(t=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(function(){t(n.now())},1e3/60)},e=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),r.create=function(t){var e=n.extend({controller:r,engine:null,element:null,canvas:null,mouse:null,frameRequestId:null,options:{width:800,height:600,pixelRatio:1,background:"#18181d",wireframeBackground:"#0f0f13",hasBounds:!!t.bounds,enabled:!0,wireframes:!0,showSleeping:!0,showDebug:!1,showBroadphase:!1,showBounds:!1,showVelocity:!1,showCollisions:!1,showSeparations:!1,showAxes:!1,showPositions:!1,showAngleIndicator:!1,showIds:!1,showShadows:!1,showVertexNumbers:!1,showConvexHulls:!1,showInternalEdges:!1,showMousePosition:!1}},t);return e.canvas&&(e.canvas.width=e.options.width||e.canvas.width,e.canvas.height=e.options.height||e.canvas.height),e.mouse=t.mouse,e.engine=t.engine,e.canvas=e.canvas||i(e.options.width,e.options.height),e.context=e.canvas.getContext("2d"),e.textures={},e.bounds=e.bounds||{min:{x:0,y:0},max:{x:e.canvas.width,y:e.canvas.height}},1!==e.options.pixelRatio&&r.setPixelRatio(e,e.options.pixelRatio),n.isElement(e.element)?e.element.appendChild(e.canvas):e.canvas.parentNode||n.log("Render.create: options.element was undefined, render.canvas was created but not appended","warn"),e},r.run=function(e){!function i(n){e.frameRequestId=t(i),r.world(e)}()},r.stop=function(t){e(t.frameRequestId)},r.setPixelRatio=function(t,e){var i=t.options,r=t.canvas;if("auto"===e){var n=r.getContext("2d");e=(window.devicePixelRatio||1)/(n.webkitBackingStorePixelRatio||n.mozBackingStorePixelRatio||n.msBackingStorePixelRatio||n.oBackingStorePixelRatio||n.backingStorePixelRatio||1)}i.pixelRatio=e,r.setAttribute("data-pixel-ratio",e),r.width=i.width*e,r.height=i.height*e,r.style.width=i.width+"px",r.style.height=i.height+"px",t.context.scale(e,e)},r.lookAt=function(t,e,i,r){r="undefined"==typeof r||r,e=n.isArray(e)?e:[e],i=i||{x:0,y:0};for(var a=1/0,o=1/0,s=-(1/0),l=-(1/0),h=0;h<e.length;h+=1){var u=e[h],p=u.bounds?u.bounds.min:u.min||u.position||u,u=u.bounds?u.bounds.max:u.max||u.position||u;p&&u&&(p.x<a&&(a=p.x),u.x>s&&(s=u.x),p.y<o&&(o=p.y),u.y>l&&(l=u.y))}e=s-a+2*i.x,l=l-o+2*i.y,s=t.canvas.width/t.canvas.height,h=e/l,u=p=1,h>s?u=h/s:p=s/h,t.options.hasBounds=!0,t.bounds.min.x=a,t.bounds.max.x=a+e*p,t.bounds.min.y=o,t.bounds.max.y=o+l*u,r&&(t.bounds.min.x+=.5*e-e*p*.5,t.bounds.max.x+=.5*e-e*p*.5,t.bounds.min.y+=.5*l-l*u*.5,t.bounds.max.y+=.5*l-l*u*.5),t.bounds.min.x-=i.x,t.bounds.max.x-=i.x,t.bounds.min.y-=i.y,t.bounds.max.y-=i.y,t.mouse&&(c.setScale(t.mouse,{x:(t.bounds.max.x-t.bounds.min.x)/t.canvas.width,y:(t.bounds.max.y-t.bounds.min.y)/t.canvas.height}),c.setOffset(t.mouse,t.bounds.min))},r.startViewTransform=function(t){t.context.scale(1/((t.bounds.max.x-t.bounds.min.x)/t.options.width),1/((t.bounds.max.y-t.bounds.min.y)/t.options.height)),t.context.translate(-t.bounds.min.x,-t.bounds.min.y)},r.endViewTransform=function(t){t.context.setTransform(t.options.pixelRatio,0,0,t.options.pixelRatio,0,0)},r.world=function(t){var e,i=t.engine,n=i.world;e=t.canvas;var u=t.context,p=t.options,d=a.allBodies(n),n=a.allConstraints(n),f=p.wireframes?p.wireframeBackground:p.background,g=[],m=[],y={timestamp:i.timing.timestamp};if(s.trigger(t,"beforeRender",y),t.currentBackground!==f){var v=f;/(jpg|gif|png)$/.test(f)&&(v="url("+f+")"),t.canvas.style.background=v,t.canvas.style.backgroundSize="contain",t.currentBackground=f}if(u.globalCompositeOperation="source-in",u.fillStyle="transparent",u.fillRect(0,0,e.width,e.height),u.globalCompositeOperation="source-over",p.hasBounds){for(e=0;e<d.length;e++)f=d[e],o.overlaps(f.bounds,t.bounds)&&g.push(f);for(e=0;e<n.length;e++){var d=n[e],f=d.bodyA,v=d.bodyB,_=d.pointA,b=d.pointB;f&&(_=h.add(f.position,d.pointA)),v&&(b=h.add(v.position,d.pointB)),_&&b&&(o.contains(t.bounds,_)||o.contains(t.bounds,b))&&m.push(d)}r.startViewTransform(t),t.mouse&&(c.setScale(t.mouse,{x:(t.bounds.max.x-t.bounds.min.x)/t.canvas.width,y:(t.bounds.max.y-t.bounds.min.y)/t.canvas.height}),c.setOffset(t.mouse,t.bounds.min))}else m=n,g=d;!p.wireframes||i.enableSleeping&&p.showSleeping?r.bodies(t,g,u):(p.showConvexHulls&&r.bodyConvexHulls(t,g,u),r.bodyWireframes(t,g,u)),p.showBounds&&r.bodyBounds(t,g,u),(p.showAxes||p.showAngleIndicator)&&r.bodyAxes(t,g,u),p.showPositions&&r.bodyPositions(t,g,u),p.showVelocity&&r.bodyVelocity(t,g,u),p.showIds&&r.bodyIds(t,g,u),p.showSeparations&&r.separations(t,i.pairs.list,u),p.showCollisions&&r.collisions(t,i.pairs.list,u),p.showVertexNumbers&&r.vertexNumbers(t,g,u),p.showMousePosition&&r.mousePosition(t,t.mouse,u),r.constraints(m,u),p.showBroadphase&&i.broadphase.controller===l&&r.grid(t,i.broadphase,u),p.showDebug&&r.debug(t,u),p.hasBounds&&r.endViewTransform(t),s.trigger(t,"afterRender",y)},r.debug=function(t,e){var i=t.engine,r=i.metrics,n=t.options,o=(a.allBodies(i.world),"    ");if(500<=i.timing.timestamp-(t.debugTimestamp||0)){var s="";r.timing&&(s+="fps: "+Math.round(r.timing.fps)+o),t.debugString=s,t.debugTimestamp=i.timing.timestamp}if(t.debugString)for(e.font="12px Arial",n.wireframes?e.fillStyle="rgba(255,255,255,0.5)":e.fillStyle="rgba(0,0,0,0.5)",i=t.debugString.split("\n"),r=0;r<i.length;r++)e.fillText(i[r],50,50+18*r)},r.constraints=function(t,e){for(var i=0;i<t.length;i++){var r=t[i];if(r.render.visible&&r.pointA&&r.pointB){var a,o;a=r.bodyA;var s=r.bodyB;if(a=a?h.add(a.position,r.pointA):r.pointA,"pin"===r.render.type)e.beginPath(),e.arc(a.x,a.y,3,0,2*Math.PI),e.closePath();else{if(o=s?h.add(s.position,r.pointB):r.pointB,e.beginPath(),e.moveTo(a.x,a.y),"spring"===r.render.type)for(var l=h.sub(o,a),c=h.perp(h.normalise(l)),u=Math.ceil(n.clamp(r.length/5,12,20)),p=1;u>p;p+=1)s=0===p%2?1:-1,e.lineTo(a.x+p/u*l.x+c.x*s*4,a.y+p/u*l.y+c.y*s*4);e.lineTo(o.x,o.y)}r.render.lineWidth&&(e.lineWidth=r.render.lineWidth,e.strokeStyle=r.render.strokeStyle,e.stroke()),r.render.anchors&&(e.fillStyle=r.render.strokeStyle,e.beginPath(),e.arc(a.x,a.y,3,0,2*Math.PI),e.arc(o.x,o.y,3,0,2*Math.PI),e.closePath(),e.fill())}}},r.bodyShadows=function(t,e,i){for(var r=(t.engine,0);r<e.length;r++){var n=e[r];if(n.render.visible){if(n.circleRadius)i.beginPath(),i.arc(n.position.x,n.position.y,n.circleRadius,0,2*Math.PI);else{i.beginPath(),i.moveTo(n.vertices[0].x,n.vertices[0].y);for(var a=1;a<n.vertices.length;a++)i.lineTo(n.vertices[a].x,n.vertices[a].y)}i.closePath();var a=n.position.x-.5*t.options.width,n=n.position.y-.2*t.options.height,o=Math.abs(a)+Math.abs(n);i.shadowColor="rgba(0,0,0,0.15)",i.shadowOffsetX=.05*a,i.shadowOffsetY=.05*n,i.shadowBlur=1+12*Math.min(1,o/1e3),i.fill(),i.shadowColor=null,i.shadowOffsetX=null,i.shadowOffsetY=null,i.shadowBlur=null}}},r.bodies=function(t,e,i){var r,n,a,o,s=(t.engine,t.options),l=s.showInternalEdges||!s.wireframes;for(a=0;a<e.length;a++)if(r=e[a],r.render.visible)for(o=1<r.parts.length?1:0;o<r.parts.length;o++)if(n=r.parts[o],n.render.visible){if(s.showSleeping&&r.isSleeping?i.globalAlpha=.5*n.render.opacity:1!==n.render.opacity&&(i.globalAlpha=n.render.opacity),n.render.sprite&&n.render.sprite.texture&&!s.wireframes){var h,c=n.render.sprite;h=c.texture;var u=t.textures[h];h=u?u:(u=t.textures[h]=new Image,u.src=h,u),i.translate(n.position.x,n.position.y),i.rotate(n.angle),i.drawImage(h,h.width*-c.xOffset*c.xScale,h.height*-c.yOffset*c.yScale,h.width*c.xScale,h.height*c.yScale),i.rotate(-n.angle),i.translate(-n.position.x,-n.position.y)}else{if(n.circleRadius)i.beginPath(),i.arc(n.position.x,n.position.y,n.circleRadius,0,2*Math.PI);else{for(i.beginPath(),i.moveTo(n.vertices[0].x,n.vertices[0].y),c=1;c<n.vertices.length;c++)!n.vertices[c-1].isInternal||l?i.lineTo(n.vertices[c].x,n.vertices[c].y):i.moveTo(n.vertices[c].x,n.vertices[c].y),n.vertices[c].isInternal&&!l&&i.moveTo(n.vertices[(c+1)%n.vertices.length].x,n.vertices[(c+1)%n.vertices.length].y);i.lineTo(n.vertices[0].x,n.vertices[0].y),i.closePath()}s.wireframes?(i.lineWidth=1,i.strokeStyle="#bbb",i.stroke()):(i.fillStyle=n.render.fillStyle,n.render.lineWidth&&(i.lineWidth=n.render.lineWidth,i.strokeStyle=n.render.strokeStyle,i.stroke()),i.fill())}i.globalAlpha=1}},r.bodyWireframes=function(t,e,i){var r,n,a,o,s=t.options.showInternalEdges;for(i.beginPath(),n=0;n<e.length;n++)if(r=e[n],r.render.visible)for(o=1<r.parts.length?1:0;o<r.parts.length;o++){for(t=r.parts[o],i.moveTo(t.vertices[0].x,t.vertices[0].y),a=1;a<t.vertices.length;a++)!t.vertices[a-1].isInternal||s?i.lineTo(t.vertices[a].x,t.vertices[a].y):i.moveTo(t.vertices[a].x,t.vertices[a].y),t.vertices[a].isInternal&&!s&&i.moveTo(t.vertices[(a+1)%t.vertices.length].x,t.vertices[(a+1)%t.vertices.length].y);i.lineTo(t.vertices[0].x,t.vertices[0].y)}i.lineWidth=1,i.strokeStyle="#bbb",i.stroke()},r.bodyConvexHulls=function(t,e,i){var r,n;for(i.beginPath(),t=0;t<e.length;t++)if(r=e[t],r.render.visible&&1!==r.parts.length){for(i.moveTo(r.vertices[0].x,r.vertices[0].y),n=1;n<r.vertices.length;n++)i.lineTo(r.vertices[n].x,r.vertices[n].y);i.lineTo(r.vertices[0].x,r.vertices[0].y)}i.lineWidth=1,i.strokeStyle="rgba(255,255,255,0.2)",i.stroke()},r.vertexNumbers=function(t,e,i){var r,n;for(t=0;t<e.length;t++){var a=e[t].parts;for(n=1<a.length?1:0;n<a.length;n++){var o=a[n];for(r=0;r<o.vertices.length;r++)i.fillStyle="rgba(255,255,255,0.2)",i.fillText(t+"_"+r,o.position.x+.8*(o.vertices[r].x-o.position.x),o.position.y+.8*(o.vertices[r].y-o.position.y))}}},r.mousePosition=function(t,e,i){i.fillStyle="rgba(255,255,255,0.8)",i.fillText(e.position.x+"  "+e.position.y,e.position.x+5,e.position.y-5)},r.bodyBounds=function(t,e,i){t.engine,t=t.options,i.beginPath();for(var r=0;r<e.length;r++)if(e[r].render.visible)for(var n=e[r].parts,a=1<n.length?1:0;a<n.length;a++){var o=n[a];i.rect(o.bounds.min.x,o.bounds.min.y,o.bounds.max.x-o.bounds.min.x,o.bounds.max.y-o.bounds.min.y)}t.wireframes?i.strokeStyle="rgba(255,255,255,0.08)":i.strokeStyle="rgba(0,0,0,0.1)",i.lineWidth=1,i.stroke()},r.bodyAxes=function(t,e,i){var r,n,a,o=(t.engine,t.options);for(i.beginPath(),t=0;t<e.length;t++){r=e[t];var s=r.parts;if(r.render.visible)if(o.showAxes)for(n=1<s.length?1:0;n<s.length;n++)for(r=s[n],a=0;a<r.axes.length;a++){var l=r.axes[a];i.moveTo(r.position.x,r.position.y),i.lineTo(r.position.x+20*l.x,r.position.y+20*l.y)}else for(n=1<s.length?1:0;n<s.length;n++)for(r=s[n],a=0;a<r.axes.length;a++)i.moveTo(r.position.x,r.position.y),i.lineTo((r.vertices[0].x+r.vertices[r.vertices.length-1].x)/2,(r.vertices[0].y+r.vertices[r.vertices.length-1].y)/2)}o.wireframes?(i.strokeStyle="indianred",i.lineWidth=1):(i.strokeStyle="rgba(255, 255, 255, 0.4)",i.globalCompositeOperation="overlay",i.lineWidth=2),i.stroke(),i.globalCompositeOperation="source-over"},r.bodyPositions=function(t,e,i){var r,n,a,o=(t.engine,t.options);for(i.beginPath(),n=0;n<e.length;n++)if(r=e[n],r.render.visible)for(a=0;a<r.parts.length;a++)t=r.parts[a],i.arc(t.position.x,t.position.y,3,0,2*Math.PI,!1),i.closePath();for(o.wireframes?i.fillStyle="indianred":i.fillStyle="rgba(0,0,0,0.5)",i.fill(),i.beginPath(),n=0;n<e.length;n++)r=e[n],r.render.visible&&(i.arc(r.positionPrev.x,r.positionPrev.y,2,0,2*Math.PI,!1),i.closePath());i.fillStyle="rgba(255,165,0,0.8)",i.fill()},r.bodyVelocity=function(t,e,i){for(i.beginPath(),t=0;t<e.length;t++){var r=e[t];r.render.visible&&(i.moveTo(r.position.x,r.position.y),i.lineTo(r.position.x+2*(r.position.x-r.positionPrev.x),r.position.y+2*(r.position.y-r.positionPrev.y)))}i.lineWidth=3,i.strokeStyle="cornflowerblue",i.stroke()},r.bodyIds=function(t,e,i){var r;for(t=0;t<e.length;t++)if(e[t].render.visible){var n=e[t].parts;for(r=1<n.length?1:0;r<n.length;r++){var a=n[r];i.font="12px Arial",i.fillStyle="rgba(255,255,255,0.5)",i.fillText(a.id,a.position.x+10,a.position.y-10)}}},r.collisions=function(t,e,i){var r,n,a,o=t.options;for(i.beginPath(),t=0;t<e.length;t++)if(r=e[t],r.isActive)for(n=r.collision,a=0;a<r.activeContacts.length;a++){var s=r.activeContacts[a].vertex;i.rect(s.x-1.5,s.y-1.5,3.5,3.5)}for(o.wireframes?i.fillStyle="rgba(255,255,255,0.7)":i.fillStyle="orange",i.fill(),i.beginPath(),t=0;t<e.length;t++)r=e[t],r.isActive&&(n=r.collision,0<r.activeContacts.length)&&(a=r.activeContacts[0].vertex.x,s=r.activeContacts[0].vertex.y,2===r.activeContacts.length&&(a=(r.activeContacts[0].vertex.x+r.activeContacts[1].vertex.x)/2,s=(r.activeContacts[0].vertex.y+r.activeContacts[1].vertex.y)/2),n.bodyB===n.supports[0].body||!0===n.bodyA.isStatic?i.moveTo(a-8*n.normal.x,s-8*n.normal.y):i.moveTo(a+8*n.normal.x,s+8*n.normal.y),i.lineTo(a,s));o.wireframes?i.strokeStyle="rgba(255,165,0,0.7)":i.strokeStyle="orange",i.lineWidth=1,i.stroke()},r.separations=function(t,e,i){var r,n,a,o,s=t.options;for(i.beginPath(),o=0;o<e.length;o++)if(r=e[o],r.isActive){t=r.collision,n=t.bodyA,a=t.bodyB;var l=1;a.isStatic||n.isStatic||(l=.5),a.isStatic&&(l=0),i.moveTo(a.position.x,a.position.y),i.lineTo(a.position.x-t.penetration.x*l,a.position.y-t.penetration.y*l),l=1,a.isStatic||n.isStatic||(l=.5),n.isStatic&&(l=0),i.moveTo(n.position.x,n.position.y),i.lineTo(n.position.x+t.penetration.x*l,n.position.y+t.penetration.y*l)}s.wireframes?i.strokeStyle="rgba(255,165,0,0.5)":i.strokeStyle="orange",i.stroke()},r.grid=function(t,e,i){t.options.wireframes?i.strokeStyle="rgba(255,180,0,0.1)":i.strokeStyle="rgba(255,180,0,0.5)",i.beginPath(),t=n.keys(e.buckets);for(var r=0;r<t.length;r++){var a=t[r];2>e.buckets[a].length||(a=a.split(/C|R/),i.rect(.5+parseInt(a[1],10)*e.bucketWidth,.5+parseInt(a[2],10)*e.bucketHeight,e.bucketWidth,e.bucketHeight))}i.lineWidth=1,i.stroke()},r.inspector=function(t,e){var i,r=(t.engine,t.selected),n=t.render,a=n.options;for(a.hasBounds&&(e.scale(1/((n.bounds.max.x-n.bounds.min.x)/n.options.width),1/((n.bounds.max.y-n.bounds.min.y)/n.options.height)),e.translate(-n.bounds.min.x,-n.bounds.min.y)),n=0;n<r.length;n++){var o=r[n].data;switch(e.translate(.5,.5),e.lineWidth=1,e.strokeStyle="rgba(255,165,0,0.9)",e.setLineDash([1,2]),o.type){case"body":i=o.bounds,e.beginPath(),e.rect(Math.floor(i.min.x-3),Math.floor(i.min.y-3),Math.floor(i.max.x-i.min.x+6),Math.floor(i.max.y-i.min.y+6)),e.closePath(),e.stroke();break;case"constraint":var s=o.pointA;o.bodyA&&(s=o.pointB),e.beginPath(),e.arc(s.x,s.y,10,0,2*Math.PI),e.closePath(),e.stroke()}e.setLineDash([]),e.translate(-.5,-.5)}null!==t.selectStart&&(e.translate(.5,.5),e.lineWidth=1,e.strokeStyle="rgba(255,165,0,0.6)",e.fillStyle="rgba(255,165,0,0.1)",i=t.selectBounds,e.beginPath(),e.rect(Math.floor(i.min.x),Math.floor(i.min.y),Math.floor(i.max.x-i.min.x),Math.floor(i.max.y-i.min.y)),e.closePath(),e.stroke(),e.fill(),e.translate(-.5,-.5)),a.hasBounds&&e.setTransform(1,0,0,1,0,0)};var i=function(t,e){var i=document.createElement("canvas");return i.width=t,i.height=e,i.oncontextmenu=function(){return!1},i.onselectstart=function(){return!1},i}}()},{"../body/Composite":2,"../collision/Grid":6,"../core/Common":14,"../core/Events":16,"../core/Mouse":19,"../geometry/Bounds":26,"../geometry/Vector":28}],32:[function(t,e,i){var r={};e.exports=r;var n=t("../geometry/Bounds"),a=t("../body/Composite"),o=t("../core/Common"),s=t("../core/Events"),l=t("../geometry/Vector");!function(){var t,e;"undefined"!=typeof window&&(t=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(function(){t(o.now())},1e3/60)},e=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),r.create=function(t){o.warn("RenderPixi.create: Matter.RenderPixi is deprecated (see docs)");var e=o.extend({controller:r,engine:null,element:null,frameRequestId:null,canvas:null,renderer:null,container:null,spriteContainer:null,pixiOptions:null,options:{width:800,height:600,background:"#fafafa",wireframeBackground:"#222",hasBounds:!1,enabled:!0,wireframes:!0,showSleeping:!0,showDebug:!1,showBroadphase:!1,showBounds:!1,showVelocity:!1,showCollisions:!1,showAxes:!1,showPositions:!1,showAngleIndicator:!1,showIds:!1,showShadows:!1}},t),i=!e.options.wireframes&&"transparent"===e.options.background;return e.pixiOptions=e.pixiOptions||{view:e.canvas,transparent:i,antialias:!0,backgroundColor:t.background},e.mouse=t.mouse,e.engine=t.engine,e.renderer=e.renderer||new PIXI.WebGLRenderer(e.options.width,e.options.height,e.pixiOptions),e.container=e.container||new PIXI.Container,e.spriteContainer=e.spriteContainer||new PIXI.Container,e.canvas=e.canvas||e.renderer.view,e.bounds=e.bounds||{min:{x:0,y:0},max:{x:e.options.width,y:e.options.height}},s.on(e.engine,"beforeUpdate",function(){r.clear(e)}),e.textures={},e.sprites={},e.primitives={},e.container.addChild(e.spriteContainer),o.isElement(e.element)?e.element.appendChild(e.canvas):o.warn('No "render.element" passed, "render.canvas" was not inserted into document.'),e.canvas.oncontextmenu=function(){return!1},e.canvas.onselectstart=function(){return!1},e},r.run=function(e){!function i(n){e.frameRequestId=t(i),r.world(e)}()},r.stop=function(t){e(t.frameRequestId)},r.clear=function(t){for(var e=t.container,i=t.spriteContainer;e.children[0];)e.removeChild(e.children[0]);for(;i.children[0];)i.removeChild(i.children[0]);i=t.sprites["bg-0"],t.textures={},t.sprites={},t.primitives={},(t.sprites["bg-0"]=i)&&e.addChildAt(i,0),t.container.addChild(t.spriteContainer),t.currentBackground=null,e.scale.set(1,1),e.position.set(0,0)},r.setBackground=function(t,e){if(t.currentBackground!==e){var r=e.indexOf&&-1!==e.indexOf("#"),n=t.sprites["bg-0"];r?(r=o.colorToNumber(e),t.renderer.backgroundColor=r,n&&t.container.removeChild(n)):n||(n=i(t,e),n=t.sprites["bg-0"]=new PIXI.Sprite(n),n.position.x=0,n.position.y=0,t.container.addChildAt(n,0)),t.currentBackground=e}},r.world=function(t){var e,i=t.engine.world,o=t.renderer,s=t.container;e=t.options;var h=a.allBodies(i),i=a.allConstraints(i),c=[];e.wireframes?r.setBackground(t,e.wireframeBackground):r.setBackground(t,e.background);var u=(t.bounds.max.x-t.bounds.min.x)/t.options.width,p=(t.bounds.max.y-t.bounds.min.y)/t.options.height;if(e.hasBounds){for(e=0;e<h.length;e++){var d=h[e];d.render.sprite.visible=n.overlaps(d.bounds,t.bounds)}for(e=0;e<i.length;e++){var d=i[e],f=d.bodyA,g=d.bodyB,m=d.pointA,y=d.pointB;f&&(m=l.add(f.position,d.pointA)),g&&(y=l.add(g.position,d.pointB)),m&&y&&(n.contains(t.bounds,m)||n.contains(t.bounds,y))&&c.push(d)}s.scale.set(1/u,1/p),s.position.set(1/u*-t.bounds.min.x,1/p*-t.bounds.min.y)}else c=i;for(e=0;e<h.length;e++)r.body(t,h[e]);for(e=0;e<c.length;e++)r.constraint(t,c[e]);o.render(s)},r.constraint=function(t,e){var i=(t.engine,e.bodyA),r=e.bodyB,n=e.pointA,a=e.pointB,s=t.container,l=e.render,h="c-"+e.id,c=t.primitives[h];return c||(c=t.primitives[h]=new PIXI.Graphics),l.visible&&e.pointA&&e.pointB?(-1===o.indexOf(s.children,c)&&s.addChild(c),c.clear(),c.beginFill(0,0),c.lineStyle(l.lineWidth,o.colorToNumber(l.strokeStyle),1),i?c.moveTo(i.position.x+n.x,i.position.y+n.y):c.moveTo(n.x,n.y),r?c.lineTo(r.position.x+a.x,r.position.y+a.y):c.lineTo(a.x,a.y),void c.endFill()):void c.clear()},r.body=function(t,e){var r=(t.engine,e.render);if(r.visible)if(r.sprite&&r.sprite.texture){var n="b-"+e.id,a=t.sprites[n],s=t.spriteContainer;if(!a){var l,a=t.sprites;l=i(t,e.render.sprite.texture),l=new PIXI.Sprite(l),l.anchor.x=e.render.sprite.xOffset,l.anchor.y=e.render.sprite.yOffset,l=l,a=a[n]=l}-1===o.indexOf(s.children,a)&&s.addChild(a),a.position.x=e.position.x,a.position.y=e.position.y,a.rotation=e.angle,a.scale.x=r.sprite.xScale||1,a.scale.y=r.sprite.yScale||1}else{if(r="b-"+e.id,s=t.primitives[r],n=t.container,!s){s=t.primitives,l=e.render;var h=t.options,c=new PIXI.Graphics,u=o.colorToNumber(l.fillStyle),p=o.colorToNumber(l.strokeStyle),d=o.colorToNumber(l.strokeStyle),f=o.colorToNumber("#bbb"),g=o.colorToNumber("#CD5C5C");c.clear();for(var m=1<e.parts.length?1:0;m<e.parts.length;m++){a=e.parts[m],h.wireframes?(c.beginFill(0,0),c.lineStyle(1,f,1)):(c.beginFill(u,1),c.lineStyle(l.lineWidth,p,1)),c.moveTo(a.vertices[0].x-e.position.x,a.vertices[0].y-e.position.y);for(var y=1;y<a.vertices.length;y++)c.lineTo(a.vertices[y].x-e.position.x,a.vertices[y].y-e.position.y);c.lineTo(a.vertices[0].x-e.position.x,a.vertices[0].y-e.position.y),c.endFill(),(h.showAngleIndicator||h.showAxes)&&(c.beginFill(0,0),h.wireframes?c.lineStyle(1,g,1):c.lineStyle(1,d),c.moveTo(a.position.x-e.position.x,a.position.y-e.position.y),c.lineTo((a.vertices[0].x+a.vertices[a.vertices.length-1].x)/2-e.position.x,(a.vertices[0].y+a.vertices[a.vertices.length-1].y)/2-e.position.y),c.endFill())}s=s[r]=c,s.initialAngle=e.angle}-1===o.indexOf(n.children,s)&&n.addChild(s),s.position.x=e.position.x,s.position.y=e.position.y,s.rotation=e.angle-s.initialAngle}};var i=function(t,e){var i=t.textures[e];return i||(i=t.textures[e]=PIXI.Texture.fromImage(e)),i}}()},{"../body/Composite":2,"../core/Common":14,"../core/Events":16,"../geometry/Bounds":26,"../geometry/Vector":28}]},{},[30])(30)});var egret=window.egret,__reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);i.prototype=e.prototype,t.prototype=new i},particle;!function(t){var e=function(){function t(){this.matrix=new egret.Matrix,this.reset()}return t.prototype.reset=function(){this.x=0,this.y=0,this.scale=1,this.rotation=0,this.alpha=1,this.currentTime=0,this.totalTime=1e3},t.prototype.$getMatrix=function(t,e){var i=this.matrix;if(i.identity(),this.rotation%360)var r=this.rotation,n=egret.NumberUtils.cos(r),a=egret.NumberUtils.sin(r);else n=1,a=0;return i.append(n*this.scale,a*this.scale,-a*this.scale,n*this.scale,this.x,this.y),(t||e)&&(i.tx-=t*i.a+e*i.c,i.ty-=t*i.b+e*i.d),i},t}();t.Particle=e,__reflect(e.prototype,"particle.Particle")}(particle||(particle={}));var particle;!function(t){var e=function(e){function i(t,i){var r=e.call(this)||this;return r._pool=[],r.frameTime=0,r.particles=[],r._emitterX=0,r._emitterY=0,r.emissionTime=-1,r.maxParticles=200,r.numParticles=0,r.particleClass=null,r.$particleConfig=null,r.particleMeasureRect=new egret.Rectangle,r.transformForMeasure=new egret.Matrix,r.bitmapNodeList=[],egret.nativeRender?(r.initConfig(i,0,0),r.changeTexture(t)):(r.emissionRate=i,r.texture=t,r.$renderNode=new egret.sys.GroupNode,r.$renderNode.cleanBeforeRender=function(){}),r}return __extends(i,e),i.prototype.createNativeDisplayObject=function(){this.$nativeDisplayObject=new egret_native.NativeDisplayObject(10)},i.prototype.initConfig=function(t,e,i){this.$particleConfig=[t,e,i,0,200],this.emissionRate=t,this._emitterX=e,this._emitterY=i},i.prototype.getParticle=function(){var e;return e=this._pool.length?this._pool.pop():this.particleClass?new this.particleClass:new t.Particle},i.prototype.removeParticle=function(t){var e=this.particles.indexOf(t);return-1!=e?(t.reset(),this.particles.splice(e,1),this._pool.push(t),this.numParticles--,this.bitmapNodeList.length>this.numParticles&&(this.bitmapNodeList.length=this.numParticles,this.$renderNode.drawData.length=this.numParticles),!0):!1
},i.prototype.initParticle=function(t){t.x=this.emitterX,t.y=this.emitterY,t.currentTime=0,t.totalTime=1e3},i.prototype.updateRelativeBounds=function(t){t?(null==this.relativeContentBounds&&(this.relativeContentBounds=new egret.Rectangle),this.relativeContentBounds.copyFrom(t),this.relativeContentBounds.x+=this.emitterX,this.relativeContentBounds.y+=this.emitterY):this.relativeContentBounds=null,this.mask=this.relativeContentBounds},Object.defineProperty(i.prototype,"emitterBounds",{get:function(){return this._emitterBounds},set:function(t){this._emitterBounds=t,this.updateRelativeBounds(t),egret.nativeRender&&this.onPropertyChanges()},enumerable:!0,configurable:!0}),i.prototype.onPropertyChanges=function(){this.$nativeDisplayObject.setCustomData(this.$particleConfig)},Object.defineProperty(i.prototype,"emitterX",{get:function(){return this._emitterX},set:function(t){this._emitterX=t,this.updateRelativeBounds(this.emitterBounds),egret.nativeRender&&this.onPropertyChanges()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"emitterY",{get:function(){return this._emitterY},set:function(t){this._emitterY=t,this.updateRelativeBounds(this.emitterBounds),egret.nativeRender&&this.onPropertyChanges()},enumerable:!0,configurable:!0}),i.prototype.start=function(t){void 0===t&&(t=-1),0!=this.emissionRate&&(this.emissionTime=t,egret.nativeRender?(this.$particleConfig[3]=t,this.$nativeDisplayObject.setCustomData(this.$particleConfig)):(this.timeStamp=egret.getTimer(),egret.startTick(this.update,this)))},i.prototype.stop=function(t){return void 0===t&&(t=!1),egret.nativeRender?void this.$nativeDisplayObject.setStopToParticle(t):(this.emissionTime=0,void(t&&(this.clear(),egret.stopTick(this.update,this))))},i.prototype.update=function(t){var e=t-this.timeStamp;if(this.timeStamp=t,-1==this.emissionTime||this.emissionTime>0){for(this.frameTime+=e;this.frameTime>0;)this.numParticles<this.maxParticles&&this.addOneParticle(),this.frameTime-=this.emissionRate;-1!=this.emissionTime&&(this.emissionTime-=e,this.emissionTime<0&&(this.emissionTime=0))}for(var i,r=0;r<this.numParticles;)i=this.particles[r],i.currentTime<i.totalTime?(this.advanceParticle(i,e),i.currentTime+=e,r++):this.removeParticle(i);return this.$renderDirty=!0,0==this.numParticles&&0==this.emissionTime&&(egret.stopTick(this.update,this),this.dispatchEventWith(egret.Event.COMPLETE)),!1},i.prototype.$measureContentBounds=function(t){if(this.relativeContentBounds)return void t.copyFrom(this.relativeContentBounds);if(this.numParticles>0){for(var e,i=this.texture,r=Math.round(i.$getScaleBitmapWidth()),n=Math.round(i.$getScaleBitmapHeight()),a=egret.Rectangle.create(),o=0;o<this.numParticles;o++){e=this.particles[o],this.transformForMeasure.identity(),this.appendTransform(this.transformForMeasure,e.x,e.y,e.scale,e.scale,e.rotation,0,0,r/2,n/2),this.particleMeasureRect.setEmpty(),this.particleMeasureRect.width=r,this.particleMeasureRect.height=n;var s=Region.create();if(s.updateRegion(this.particleMeasureRect,this.transformForMeasure),0==o)a.setTo(s.minX,s.minY,s.maxX-s.minX,s.maxY-s.minY);else{var l=Math.min(a.x,s.minX),h=Math.min(a.y,s.minY),c=Math.max(a.right,s.maxX),u=Math.max(a.bottom,s.maxY);a.setTo(l,h,c-l,u-h)}Region.release(s)}this.lastRect=a,t.setTo(a.x,a.y,a.width,a.height),egret.Rectangle.release(a)}else this.lastRect&&(a=this.lastRect,t.setTo(a.x,a.y,a.width,a.height),egret.Rectangle.release(a),this.lastRect=null)},i.prototype.setCurrentParticles=function(t){if(!egret.nativeRender)for(var e=this.numParticles;t>e&&this.numParticles<this.maxParticles;e++)this.addOneParticle()},i.prototype.changeTexture=function(t){this.texture!=t&&(this.texture=t,egret.nativeRender?this.$nativeDisplayObject.setBitmapDataToParticle(t):(this.bitmapNodeList.length=0,this.$renderNode.drawData.length=0))},i.prototype.clear=function(){for(;this.particles.length;)this.removeParticle(this.particles[0]);this.numParticles=0,this.$renderNode.drawData.length=0,this.bitmapNodeList.length=0,this.$renderDirty=!0},i.prototype.addOneParticle=function(){var t=this.getParticle();this.initParticle(t),t.totalTime>0&&(this.particles.push(t),this.numParticles++)},i.prototype.advanceParticle=function(t,e){t.y-=e/6},i.prototype.$updateRenderNode=function(){if(!egret.nativeRender&&this.numParticles>0)for(var t,e=this.texture,i=Math.round(e.$getScaleBitmapWidth()),r=Math.round(e.$getScaleBitmapHeight()),n=e.$offsetX,a=e.$offsetY,o=e.$bitmapX,s=e.$bitmapY,l=e.$bitmapWidth,h=e.$bitmapHeight,c=0;c<this.numParticles;c++){t=this.particles[c];var u;this.bitmapNodeList[c]||(u=new egret.sys.BitmapNode,this.bitmapNodeList[c]=u,this.$renderNode.addNode(this.bitmapNodeList[c]),u.image=e.$bitmapData,u.imageWidth=e.$sourceWidth,u.imageHeight=e.$sourceHeight,u.drawImage(o,s,l,h,n,a,i,r)),u=this.bitmapNodeList[c],u.matrix=t.$getMatrix(i/2,r/2),u.blendMode=t.blendMode,u.alpha=t.alpha}},i.prototype.appendTransform=function(t,e,i,r,n,a,o,s,l,h){if(a%360)var c=a,u=egret.NumberUtils.cos(c),p=egret.NumberUtils.sin(c);else u=1,p=0;return o||s?(t.append(egret.NumberUtils.cos(s),egret.NumberUtils.sin(s),-egret.NumberUtils.sin(o),egret.NumberUtils.cos(o),e,i),t.append(u*r,p*r,-p*n,u*n,0,0)):t.append(u*r,p*r,-p*n,u*n,e,i),(l||h)&&(t.tx-=l*t.a+h*t.c,t.ty-=l*t.b+h*t.d),t},i}(egret.DisplayObject);t.ParticleSystem=e,__reflect(e.prototype,"particle.ParticleSystem")}(particle||(particle={}));var regionPool=[],Region=function(){function t(){this.minX=0,this.minY=0,this.maxX=0,this.maxY=0,this.width=0,this.height=0,this.area=0}return t.release=function(t){regionPool.push(t)},t.create=function(){var e=regionPool.pop();return e||(e=new t),e},t.prototype.setEmpty=function(){this.minX=0,this.minY=0,this.maxX=0,this.maxY=0,this.width=0,this.height=0,this.area=0},t.prototype.updateRegion=function(t,e){if(0==t.width||0==t.height)return void this.setEmpty();var i,r,n,a,o=e,s=o.a,l=o.b,h=o.c,c=o.d,u=o.tx,p=o.ty,d=t.x,f=t.y,g=d+t.width,m=f+t.height;if(1==s&&0==l&&0==h&&1==c)i=d+u-1,r=f+p-1,n=g+u+1,a=m+p+1;else{var y=s*d+h*f+u,v=l*d+c*f+p,_=s*g+h*f+u,b=l*g+c*f+p,x=s*g+h*m+u,T=l*g+c*m+p,E=s*d+h*m+u,S=l*d+c*m+p,C=0;y>_&&(C=y,y=_,_=C),x>E&&(C=x,x=E,E=C),i=(x>y?y:x)-1,n=(_>E?_:E)+1,v>b&&(C=v,v=b,b=C),T>S&&(C=T,T=S,S=C),r=(T>v?v:T)-1,a=(b>S?b:S)+1}this.minX=i,this.minY=r,this.maxX=n,this.maxY=a,this.width=n-i,this.height=a-r,this.area=this.width*this.height},t}();__reflect(Region.prototype,"Region");var particle;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.reset=function(){t.prototype.reset.call(this),this.startX=0,this.startY=0,this.velocityX=0,this.velocityY=0,this.radialAcceleration=0,this.tangentialAcceleration=0,this.rotationDelta=0,this.scaleDelta=0},e}(t.Particle);t.GravityParticle=e,__reflect(e.prototype,"particle.GravityParticle")}(particle||(particle={}));var particle;!function(t){var e=function(e){function i(i,r){var n=e.call(this,i,200)||this;return n.$init=!1,n.parseConfig(r),n.emissionRate=n.lifespan/n.maxParticles,n.particleClass=t.GravityParticle,n.$init=!0,n}return __extends(i,e),i.prototype.start=function(t){if(void 0===t&&(t=-1),egret.nativeRender){0!=this.emissionRate&&(this.emissionTime=t),this.$particleConfig[2]=t;var i=[],r=0;for(var n in this.$particleConfig)i.push(r++),i.push(this.$particleConfig[n]);this.$nativeDisplayObject.setCustomData(i)}else e.prototype.start.call(this,t)},i.prototype.setCurrentParticles=function(t){if(!(t>this.maxParticles)){var e=[];e.push(35),e.push(t),this.$nativeDisplayObject.setCustomData(e)}},i.prototype.onPropertyChanges=function(){if(0!=this.$init){var t=[];t.push(0),this.$particleConfig[0]=this._emitterX,t.push(this._emitterX),t.push(1),this.$particleConfig[1]=this._emitterY,t.push(this._emitterY),this.relativeContentBounds&&(t.push(31),this.$particleConfig[31]=this.relativeContentBounds.x,t.push(this.relativeContentBounds.x),t.push(32),this.$particleConfig[32]=this.relativeContentBounds.y,t.push(this.relativeContentBounds.y),t.push(33),this.$particleConfig[33]=this.relativeContentBounds.width,t.push(this.relativeContentBounds.width),t.push(34),this.$particleConfig[34]=this.relativeContentBounds.height,t.push(this.relativeContentBounds.height)),this.$nativeDisplayObject.setCustomData(t)}},i.prototype.parseConfig=function(t){function e(t){return"undefined"==typeof t?0:t}if(egret.nativeRender?(this._emitterX=e(t.emitter.x),this._emitterY=e(t.emitter.y)):(this.emitterX=e(t.emitter.x),this.emitterY=e(t.emitter.y)),this.emitterXVariance=e(t.emitterVariance.x),this.emitterYVariance=e(t.emitterVariance.y),this.gravityX=e(t.gravity.x),this.gravityY=e(t.gravity.y),1==t.useEmitterRect){var i=new egret.Rectangle;i.x=e(t.emitterRect.x),i.y=e(t.emitterRect.y),i.width=e(t.emitterRect.width),i.height=e(t.emitterRect.height),this.emitterBounds=i}this.maxParticles=e(t.maxParticles),this.speed=e(t.speed),this.speedVariance=e(t.speedVariance),this.lifespan=Math.max(.01,e(t.lifespan)),this.lifespanVariance=e(t.lifespanVariance),this.emitAngle=e(t.emitAngle),this.emitAngleVariance=e(t.emitAngleVariance),this.startSize=e(t.startSize),this.startSizeVariance=e(t.startSizeVariance),this.endSize=e(t.endSize),this.endSizeVariance=e(t.endSizeVariance),this.startRotation=e(t.startRotation),this.startRotationVariance=e(t.startRotationVariance),this.endRotation=e(t.endRotation),this.endRotationVariance=e(t.endRotationVariance),this.radialAcceleration=e(t.radialAcceleration),this.radialAccelerationVariance=e(t.radialAccelerationVariance),this.tangentialAcceleration=e(t.tangentialAcceleration),this.tangentialAccelerationVariance=e(t.tangentialAccelerationVariance),this.startAlpha=e(t.startAlpha),this.startAlphaVariance=e(t.startAlphaVariance),this.endAlpha=e(t.endAlpha),this.endAlphaVariance=e(t.endAlphaVariance),egret.nativeRender?t.blendMode&&(this.particleBlendMode=t.blendMode):this.particleBlendMode=t.blendMode,this.$particleConfig={0:this.emitterX,1:this.emitterY,2:-1,3:this.maxParticles,4:this.emitterXVariance,5:this.emitterYVariance,6:this.gravityX,7:this.gravityY,8:this.speed,9:this.speedVariance,10:this.lifespan,11:this.lifespanVariance,12:this.emitAngle,13:this.emitAngleVariance,14:this.startSize,15:this.startSizeVariance,16:this.endSize,17:this.endSizeVariance,18:this.startRotation,19:this.startRotationVariance,20:this.endRotation,21:this.endRotationVariance,22:this.radialAcceleration,23:this.radialAccelerationVariance,24:this.tangentialAcceleration,25:this.tangentialAccelerationVariance,26:this.startAlpha,27:this.startAlphaVariance,28:this.endAlpha,29:this.endAlphaVariance,30:this.particleBlendMode,31:t.useEmitterRect?this.relativeContentBounds.x:0,32:t.useEmitterRect?this.relativeContentBounds.y:0,33:t.useEmitterRect?this.relativeContentBounds.width:0,34:t.useEmitterRect?this.relativeContentBounds.height:0,35:0}},i.prototype.initParticle=function(t){var e=t,r=i.getValue(this.lifespan,this.lifespanVariance);if(e.currentTime=0,e.totalTime=r>0?r:0,!(0>=r)){e.x=i.getValue(this.emitterX,this.emitterXVariance),e.y=i.getValue(this.emitterY,this.emitterYVariance),e.startX=this.emitterX,e.startY=this.emitterY;var n=i.getValue(this.emitAngle,this.emitAngleVariance),a=i.getValue(this.speed,this.speedVariance);e.velocityX=a*egret.NumberUtils.cos(n),e.velocityY=a*egret.NumberUtils.sin(n),e.radialAcceleration=i.getValue(this.radialAcceleration,this.radialAccelerationVariance),e.tangentialAcceleration=i.getValue(this.tangentialAcceleration,this.tangentialAccelerationVariance);var o=i.getValue(this.startSize,this.startSizeVariance);.1>o&&(o=.1);var s=i.getValue(this.endSize,this.endSizeVariance);.1>s&&(s=.1);var l=this.texture.textureWidth;e.scale=o/l,e.scaleDelta=(s-o)/r/l;var h=i.getValue(this.startRotation,this.startRotationVariance),c=i.getValue(this.endRotation,this.endRotationVariance);e.rotation=h,e.rotationDelta=(c-h)/r;var u=i.getValue(this.startAlpha,this.startAlphaVariance),p=i.getValue(this.endAlpha,this.endAlphaVariance);e.alpha=u,e.alphaDelta=(p-u)/r,e.blendMode=this.particleBlendMode}},i.getValue=function(t,e){return t+e*(2*Math.random()-1)},i.prototype.advanceParticle=function(t,e){var i=t;e/=1e3;var r=i.totalTime-i.currentTime;e=r>e?e:r,i.currentTime+=e;var n=i.x-i.startX,a=i.y-i.startY,o=Math.sqrt(n*n+a*a);.01>o&&(o=.01);var s=n/o,l=a/o,h=s,c=l;s*=i.radialAcceleration,l*=i.radialAcceleration;var u=h;h=-c*i.tangentialAcceleration,c=u*i.tangentialAcceleration,i.velocityX+=e*(this.gravityX+s+h),i.velocityY+=e*(this.gravityY+l+c),i.x+=i.velocityX*e,i.y+=i.velocityY*e,i.scale+=i.scaleDelta*e*1e3,i.scale<0&&(i.scale=0),i.rotation+=i.rotationDelta*e*1e3,i.alpha+=i.alphaDelta*e*1e3},i}(t.ParticleSystem);t.GravityParticleSystem=e,__reflect(e.prototype,"particle.GravityParticleSystem")}(particle||(particle={})),window.particle=particle;var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);i.prototype=e.prototype,t.prototype=new i},JSONParseClass=function(){function t(){this.skinClass={},this.euiNormalizeNames={$eBL:"eui.BitmapLabel",$eB:"eui.Button",$eCB:"eui.CheckBox",$eC:"eui.Component",$eDG:"eui.DataGroup",$eET:"eui.EditableText",$eG:"eui.Group",$eHL:"eui.HorizontalLayout",$eHSB:"eui.HScrollBar",$eHS:"eui.HSlider",$eI:"eui.Image",$eL:"eui.Label",$eLs:"eui.List",$eP:"eui.Panel",$ePB:"eui.ProgressBar",$eRB:"eui.RadioButton",$eRBG:"eui.RadioButtonGroup",$eRa:"eui.Range",$eR:"eui.Rect",$eRAl:"eui.RowAlign",$eS:"eui.Scroller",$eT:"eui.TabBar",$eTI:"eui.TextInput",$eTL:"eui.TileLayout",$eTB:"eui.ToggleButton",$eTS:"eui.ToggleSwitch",$eVL:"eui.VerticalLayout",$eV:"eui.ViewStack",$eVSB:"eui.VScrollBar",$eVS:"eui.VSlider",$eSk:"eui.Skin"}}return t.prototype.setData=function(t){if(this.json){this.parseSkinMap(t);for(var e in t)this.json[e]=t[e]}else this.json=t,this.parseSkinMap(this.json)},t.prototype.generateSkinClass=function(t,e,i){function r(){a.call(this),window.JSONParseClass.create(e,this)}if(!t)return null;for(var n=i.split("."),a=window,o=0,s=n;o<s.length;o++){var l=s[o];a=a[l]}return __extends(r,a),__reflect(r,e,[i]),r},t.prototype.parseSkinMap=function(t){var e={};for(var i in t){var r=t[i];if(r){for(var n=i.split("."),a=window,o=0,s=n;o<s.length;o++){var l=s[o],h=a;l!==n[n.length-1]&&(a=a[l],void 0==a&&(a={},h[l]=a))}var c=void 0==this.euiNormalizeNames[r.$sC]?r.$sC:this.euiNormalizeNames[r.$sC];e[i]=a[n[n.length-1]]=this.generateSkinClass(r,i,c),t[i].$path&&(generateEUI2.paths[t[i].$path]=e[i])}}return e},t.prototype.create=function(t,e){return this.json?(this.target=e,this.skinName=t,this.skinClass=this.json[t],this.applyBase(),this.applySkinParts(),this.applyState(),this.applyBinding(),void(void 0==this.skinClass.$sP?this.target.skinParts=[]:this.target.skinParts=this.skinClass.$sP)):(console.log("Missing json defined by eui resource, please modify the theme adapter"),void console.log("缺少eui资源定义的json，请修改主题适配器"))},t.prototype.applySkinParts=function(){if(void 0!=this.skinClass.$sP)for(var t=0,e=this.skinClass.$sP;t<e.length;t++){var i=e[t];void 0==this.target[i]&&this.createElementContentOrViewport(i)}},t.prototype.applyBase=function(){void 0!=this.skinClass.$bs&&this.addCommonProperty("$bs",this.target)},t.prototype.createElementContentOrViewport=function(t){var e,i=this.getNormalizeEuiName(this.skinClass[t].$t);if("egret.tween.TweenGroup"==i)e=this.creatsEgretTweenGroup(t);else{var r=egret.getDefinitionByName(i);this.$createNewObject(function(){e=new r}),this.addCommonProperty(t,e)}return this.target[t]=e,e},t.prototype.$createNewObject=function(t){var e=this.skinName,i=this.target;t(),this.skinName=e,this.skinClass=this.json[this.skinName],this.target=i},t.prototype.creatsEgretTweenGroup=function(t){for(var e=this.createTypeObject(t),i=[],r=0,n=this.skinClass[t].items;r<n.length;r++){var a=n[r];i.push(this.createEgretTweenItem(a))}return e.items=i,e},t.prototype.createEgretTweenItem=function(t){var e=this,i=this.createTypeObject(t),r=[],n=function(n){var o=a.skinClass[t][n];if("$t"==n||"target"==n);else if("paths"==n)for(var s=0,l=o;s<l.length;s++){var h=l[s];r.push(a.createSetOrTo(h))}else"target"==n?a.$createNewObject(function(){i[n]=e.createElementContentOrViewport(o),e.target[o]=i[n]}):i[n]=o},a=this;for(var o in this.skinClass[t])n(o);return i.paths=r,this.target[t]=i,i},t.prototype.createSetOrTo=function(t){var e=this.createTypeObject(t);for(var i in this.skinClass[t]){var r=this.skinClass[t][i];"$t"==i||"target"==i||("props"==i?(e[i]=this.createObject(r),this.target[r]=e[i]):e[i]=r)}return e},t.prototype.createObject=function(t){var e={};for(var i in this.skinClass[t])"$t"==i||"target"==i||(e[i]=this.skinClass[t][i]);return e},t.prototype.addCommonProperty=function(t,e){var i,r,n=function(n){var o=a.skinClass[t][n];"$t"==n||("layout"==n?e[n]=a.createLayout(o):"$eleC"==n?i=o:"$sId"==n?r=o:"scale9Grid"==n?e[n]=a.getScale9Grid(o):"skinName"==n?a.$createNewObject(function(){e[n]=o}):"itemRendererSkinName"==n?a.$createNewObject(function(){for(var t=o.split("."),i=window,r=0,a=t;r<a.length;r++){var s=a[r];i=i[s]}e[n]=i}):"itemRenderer"==n?e[n]=egret.getDefinitionByName(o):"dataProvider"==n?e[n]=a.createDataProvider(o):"viewport"==n?e[n]=a.createElementContentOrViewport(o):e[n]=o)},a=this;for(var o in this.skinClass[t])n(o);var s=[];if(i&&i.length>0)for(var l=0,h=i;l<h.length;l++){var c=h[l],u=this.createElementContentOrViewport(c);s.push(u)}if(e.elementsContent=s,r&&r.length>0)for(var p=0,d=r;p<d.length;p++){var c=d[p];this.createElementContentOrViewport(c)}return e},t.prototype.createLayout=function(t){var e=this.createTypeObject(t),i=this.skinClass[t];for(var r in i)"$t"!==r&&(e[r]=i[r]);return this.target[t]=e,e},t.prototype.applyState=function(){if(void 0!=this.skinClass.$s){var t=[];for(var e in this.skinClass.$s){var i=[],r=this.skinClass.$s[e];if(r.$saI)for(var n=0,a=r.$saI;n<a.length;n++){var o=a[n];i.push(new eui.AddItems(o.target,o.property,o.position,o.relativeTo))}if(r.$ssP)for(var s=0,l=r.$ssP;s<l.length;s++){var o=l[s];if(o.name){var h=o.value;"scale9Grid"==o.name&&(h=this.getScale9Grid(o.value)),i.push(new eui.SetProperty(o.target,o.name,h))}else i.push(new eui.SetStateProperty(this.target,o.templates,o.chainIndex,this.target[o.target],o.property))}t.push(new eui.State(e,i))}this.target.states=t}},t.prototype.applyBinding=function(){if(void 0!=this.skinClass.$b)for(var t=0,e=this.skinClass.$b;t<e.length;t++){var i=e[t];void 0!==i.$bc?eui.Binding.$bindProperties(this.target,i.$bd,i.$bc,this.target[i.$bt],i.$bp):eui.Binding.bindProperty(this.target,i.$bd[0].split("."),this.target[i.$bt],i.$bp)}},t.prototype.createDataProvider=function(t){if(""!=t){for(var e=this.createTypeObject(t),i=[],r=0,n=this.skinClass[t].source;r<n.length;r++){var a=n[r];i.push(this.createItemRender(a))}return e.source=i,e}},t.prototype.createItemRender=function(t){var e=this.createTypeObject(t);for(var i in this.skinClass[t])"$t"!=i&&(e[i]=this.skinClass[t][i]);return e},t.prototype.getNormalizeEuiName=function(t){return this.euiNormalizeNames[t]?this.euiNormalizeNames[t]:t},t.prototype.createTypeObject=function(t){var e=this.getNormalizeEuiName(this.skinClass[t].$t),i=egret.getDefinitionByName(e);return new i},t.prototype.getScale9Grid=function(t){var e=t.split(",");return new egret.Rectangle(parseFloat(e[0]),parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3]))},t}();window.JSONParseClass=new JSONParseClass,window.generateEUI2=window.generateEUI2||{},generateEUI2.paths=generateEUI2.paths||{},generateEUI2.styles=void 0,generateEUI2.skins={};var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);i.prototype=e.prototype,t.prototype=new i},__awaiter=this&&this.__awaiter||function(t,e,i,r){return new(i||(i=Promise))(function(n,a){function o(t){try{l(r.next(t))}catch(e){a(e)}}function s(t){try{l(r["throw"](t))}catch(e){a(e)}}function l(t){t.done?n(t.value):new i(function(e){e(t.value)}).then(o,s)}l((r=r.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function i(t){return function(e){return r([t,e])}}function r(i){if(n)throw new TypeError("Generator is already executing.");for(;l;)try{if(n=1,a&&(o=a[2&i[0]?"return":i[0]?"throw":"next"])&&!(o=o.call(a,i[1])).done)return o;switch(a=0,o&&(i=[0,o.value]),i[0]){case 0:case 1:o=i;break;case 4:return l.label++,{value:i[1],done:!1};case 5:l.label++,a=i[1],i=[0];continue;case 7:i=l.ops.pop(),l.trys.pop();continue;default:if(o=l.trys,!(o=o.length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){l=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){l.label=i[1];break}if(6===i[0]&&l.label<o[1]){l.label=o[1],o=i;break}if(o&&l.label<o[2]){l.label=o[2],l.ops.push(i);break}o[2]&&l.ops.pop(),l.trys.pop();continue}i=e.call(t,l)}catch(r){i=[6,r],a=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var n,a,o,s,l={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},core;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onShow,e),e.addEventListener(egret.Event.REMOVED_FROM_STAGE,e.onHide,e),e}return __extends(e,t),e.prototype.onShow=function(t){this.addListener()},e.prototype.onHide=function(t){this.removeListener(),this.release()},e.prototype.addListener=function(){},e.prototype.removeListener=function(){},e.prototype.release=function(){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onShow,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onHide,this),this.parent&&this.parent.removeChild(this)},e}(eui.Component);t.EUIComponent=e,__reflect(e.prototype,"core.EUIComponent",["core.IComponent"])}(core||(core={}));var core;!function(t){var e=function(){function e(t){this.p_moduleName=t,this.init()}return e.prototype.init=function(){t.EventCenter.getInstance().addEventListener(t.EventID.MODULE_SHOW,this.onModuleShow,this),t.EventCenter.getInstance().addEventListener(t.EventID.MODULE_HIDE,this.onModuleHide,this)},e.prototype.preload=function(){var e=this.getLoadGroup(this.p_data);if(console.log("========预加载==========",e),e&&e.length>0){var i=t.LoadingManager.getCurLoading();i&&i.show(),t.ResUtils.loadGroups(e,this.onLoadProgress,this.onLoadFaild,this.onLoadComplete,this)}else this.preShow(this.p_data),this.show(this.p_data)},e.prototype.onModuleShow=function(t){this.p_moduleName===t.moduleEnum&&(this.p_data=t.messageData,this.preload())},e.prototype.onModuleHide=function(t){this.p_moduleName===t.moduleEnum&&this.hide()},e.prototype.onLoadProgress=function(e){var i=t.LoadingManager.getCurLoading();i&&i.setProgress(e)},e.prototype.onLoadFaild=function(t){egret.log("资源组"+t.curGroup+"加载失败, 失败URL："+t.curResItem.url)},e.prototype.onLoadComplete=function(e){this.preShow(this.p_data);var i=t.LoadingManager.getCurLoading();i&&i.hide(),this.show(this.p_data)},e.prototype.preShow=function(t){},e.prototype.release=function(){t.EventCenter.getInstance().removeEventListener(t.EventID.MODULE_SHOW,this.onModuleShow,this),t.EventCenter.getInstance().removeEventListener(t.EventID.MODULE_HIDE,this.onModuleHide,this)},e}();t.Control=e,__reflect(e.prototype,"core.Control")}(core||(core={}));var DialogBaseView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.onShow=function(e){t.prototype.onShow.call(this),this.left=this.right=this.top=this.bottom=0},e.prototype.addListener=function(){var e=this;t.prototype.addListener.call(this),this.m_close&&this.m_close.addEventListener(egret.TouchEvent.TOUCH_TAP,function(t){e.removeFromParent(0)},this)},e.prototype.removeListener=function(){var e=this;t.prototype.removeListener.call(this),this.m_close&&this.m_close.removeEventListener(egret.TouchEvent.TOUCH_TAP,function(t){e.removeFromParent(0)},this)},e.prototype.release=function(){t.prototype.release.call(this)},e.prototype.popUp=function(t,e,i,r,n,a,o){var s=this;void 0===t&&(t=!1),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),void 0===n&&(n=0),void 0===a&&(a=!1),void 0===o&&(o=.7);var l=this;if(!core.LayerCenter.getInstance().getLayer(LayerEnum.POPUP).contains(l)){l.scaleX=1,l.scaleY=1,l.left=0,l.top=0,l.alpha=1,t&&(this.darkSprite=new egret.Sprite,this.darkSprite.graphics.clear(),this.darkSprite.graphics.beginFill(0,o),this.darkSprite.graphics.drawRect(0,0,GameConfig.curWidth(),GameConfig.curHeight()),this.darkSprite.graphics.endFill(),this.darkSprite.width=GameConfig.curWidth(),this.darkSprite.height=GameConfig.curHeight(),core.LayerCenter.getInstance().getLayer(LayerEnum.POPUP).contains(this.darkSprite)||core.LayerCenter.getInstance().getLayer(LayerEnum.POPUP).addChild(this.darkSprite),this.darkSprite.touchEnabled=this.touchDarkEnable(),this.darkSprite.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){s.removeFromParent(n)},this),egret.Tween.get(this.darkSprite).to({alpha:1},150),this.darkSprite.visible=!0),core.LayerCenter.getInstance().getLayer(LayerEnum.POPUP).addChild(l),GameConfig.curPanel=l,0!=e?(l.left=GameConfig.curWidth()/2-e/2,l.top=GameConfig.curHeight()/2-i/2):(e=l.width,i=l.height);var h=GameConfig.curWidth()/2-e/2,c=GameConfig.curHeight()/2-i/2;switch(r){case 0:break;case 1:l.alpha=0,l.scaleX=.5,l.scaleY=.5,l.left=l.left+e/4,l.top=l.top+i/4,egret.Tween.get(l).to({alpha:1,scaleX:1,scaleY:1,left:l.left-e/4,top:l.top-i/4},300,egret.Ease.backOut);break;case 2:l.alpha=0,l.scaleX=.5,l.scaleY=.5,l.left=l.left+e/4,l.top=l.top+i/4,egret.Tween.get(l).to({alpha:1,scaleX:1,scaleY:1,left:l.left-e/4,top:l.top-i/4},600,egret.Ease.elasticOut);break;case 3:a?(l.left=-e,egret.Tween.get(l).to({left:h},500,egret.Ease.cubicOut)):(l.left=-e,egret.Tween.get(l).to({left:0},500,egret.Ease.cubicOut));break;case 4:a?(l.right=e,egret.Tween.get(l).to({left:h},500,egret.Ease.cubicOut)):(l.right=-e,egret.Tween.get(l).to({right:0},500,egret.Ease.cubicOut));break;case 5:a?(l.top=-i,egret.Tween.get(l).to({top:c},500,egret.Ease.cubicOut)):(l.top=-i,egret.Tween.get(l).to({top:0},500,egret.Ease.cubicOut));break;case 6:a?(l.top=GameConfig.curHeight(),egret.Tween.get(l).to({top:c},500,egret.Ease.cubicOut)):(l.top=i,egret.Tween.get(l).to({top:0},500,egret.Ease.cubicOut))}}},e.prototype.removeFromParent=function(t){void 0===t&&(t=0);var e=this;switch(this.darkSprite&&core.LayerCenter.getInstance().getLayer(LayerEnum.POPUP).contains(this.darkSprite)&&core.LayerCenter.getInstance().getLayer(LayerEnum.POPUP).removeChild(this.darkSprite),t){case 0:break;case 1:egret.Tween.get(e).to({alpha:0,scaleX:0,scaleY:0},300,egret.Ease.backIn);break;case 2:break;case 3:egret.Tween.get(e).to({right:-e.width},200);break;case 4:egret.Tween.get(e).to({left:-e.width},200);break;case 5:egret.Tween.get(e).to({top:e.height},200);break;case 6:egret.Tween.get(e).to({top:-e.height},200)}var i=500;0==t&&(i=0);var r=this;egret.setTimeout(function(){core.LayerCenter.getInstance().getLayer(LayerEnum.POPUP).contains(e)&&(core.LayerCenter.getInstance().getLayer(LayerEnum.POPUP).removeChild(e),r.release())},this,i)},e.prototype.touchDarkEnable=function(){return!0},e}(core.EUIComponent);__reflect(DialogBaseView.prototype,"DialogBaseView");var Dictionary=function(){function t(){this.m_keys=[],this.m_values=[]}return Object.defineProperty(t.prototype,"length",{get:function(){return this.m_keys.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"values",{get:function(){return this.m_values.concat()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"keys",{get:function(){return this.m_keys.concat()},enumerable:!0,configurable:!0}),t.prototype.indexOf=function(t){return this.m_keys.indexOf(t)},t.prototype.add=function(t,e){var i=this.indexOf(t);i>=0?this.m_values[i]=e:(this.m_keys.push(t),this.m_values.push(e))},t.prototype.get=function(t){var e=this.indexOf(t);return e>=0?this.m_values[e]:null},t.prototype.remove=function(t){var e=this.indexOf(t);return e>=0?(this.m_keys.splice(e,1),this.m_values.splice(e,1)[0]):null},t.prototype.clear=function(){this.m_keys.length=0,this.m_values.length=0},t.prototype.getRandomData=function(){var t=Math.random()*this.keys.length<<0;return this.m_values[t]},t}();__reflect(Dictionary.prototype,"Dictionary");var core;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.touchEnabled=!1,e.touchChildren=!0,e}return __extends(e,t),e.prototype.release=function(){},e}(eui.UILayer);t.EUILayer=e,__reflect(e.prototype,"core.EUILayer")}(core||(core={}));var core;!function(t){var e=function(){function t(t,e){this.callback=t,this.thisObj=e}return t}();t.Callback=e,__reflect(e.prototype,"core.Callback")}(core||(core={}));var core;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(egret.DisplayObjectContainer);t.Component=e,__reflect(e.prototype,"core.Component",["core.IComponent"])}(core||(core={}));var core;!function(t){var e=function(t){function e(e,i){var r=t.call(this)||this;return r.messageID=e,r.messageData=i,r}return __extends(e,t),e}(egret.HashObject);t.EventData=e,__reflect(e.prototype,"core.EventData",["core.IMessage"])}(core||(core={}));var core;!function(t){var e=function(){function t(){}return t}();t.Progress=e,__reflect(e.prototype,"core.Progress")}(core||(core={}));var GameControllerBase=function(t){function e(e){var i=t.call(this,e)||this;return i.m_gameManager=GameManager.getInstance(),i}return __extends(e,t),e.prototype.getLoadGroup=function(t){return[]},e.prototype.preShow=function(t){},e.prototype.show=function(t){if(core.EventCenter.getInstance().addEventListener(core.EventID.SOCKET_CONNECT,this.sockectConnectHandler,this),core.EventCenter.getInstance().addEventListener(core.EventID.SOCKET_DATA,this.roomSockectDataHandler,this),!this.m_pMainLayer){var e=new MainLayer;this.m_pMainLayer=e}core.LayerCenter.getInstance().getLayer(LayerEnum.UI).addChild(this.m_pMainLayer)},e.prototype.hide=function(){core.EventCenter.getInstance().removeEventListener(core.EventID.SOCKET_CONNECT,this.sockectConnectHandler,this),core.EventCenter.getInstance().removeEventListener(core.EventID.SOCKET_DATA,this.roomSockectDataHandler,this),this.m_pMainLayer&&this.m_pMainLayer.parent&&(this.m_pMainLayer.release(),this.m_pMainLayer.parent.removeChild(this.m_pMainLayer),this.m_pMainLayer=null)},e.prototype.release=function(){},e.prototype.sockectConnectHandler=function(t){},e.prototype.roomSockectDataHandler=function(t){},e}(core.Control);__reflect(GameControllerBase.prototype,"GameControllerBase");var BaseSound=function(){function t(){this._cache={},this._loadingCache=new Array,core.TimerManager.instance.addTick(6e4,-1,this.dealSoundTimer,this)}return t.prototype.dealSoundTimer=function(){for(var t=egret.getTimer(),e=Object.keys(this._cache),i=0,r=e.length;r>i;i++){var n=e[i];this.checkCanClear(n)&&t-this._cache[n]>=SoundManager.CLEAR_TIME&&(delete this._cache[n],RES.destroyRes(n))}},t.prototype.getSound=function(t){var e=RES.getRes(t);if(e)this._cache[t]&&(this._cache[t]=egret.getTimer());else{if(-1!=this._loadingCache.indexOf(t))return null;this._loadingCache.push(t),RES.getResByUrl(t,this.onResourceLoadComplete,this,RES.ResourceItem.TYPE_SOUND)}return e},t.prototype.onResourceLoadComplete=function(t,e){var i=this._loadingCache.indexOf(e);-1!=i&&(this._loadingCache.splice(i,1),this._cache[e]=egret.getTimer(),this.loadedPlay(e))},t.prototype.loadedPlay=function(t){},t.prototype.checkCanClear=function(t){return!0},t}();__reflect(BaseSound.prototype,"BaseSound");var RebornBaseView=function(t){function e(){var e=t.call(this)||this;return e._isEnable=!0,e.skinName="resource/assets/exml/RebornViewExml.exml",e}return __extends(e,t),e.prototype.onShow=function(e){t.prototype.onShow.call(this,e),this.m_content.text=LanguageManager.instance.getLangeuage(24),this._isEnable=!0
},e.prototype.onHide=function(e){t.prototype.onHide.call(this,e)},e.prototype.addListener=function(){t.prototype.addListener.call(this),this.m_reborn_btn&&this.m_reborn_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.rebornHandler,this),this.m_pass_btn&&this.m_pass_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.passHandler,this)},e.prototype.removeListener=function(){t.prototype.removeListener.call(this),this.m_reborn_btn&&this.m_reborn_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.rebornHandler,this),this.m_pass_btn&&this.m_pass_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.passHandler,this)},e.prototype.rebornHandler=function(t){var e=this;if(this._isEnable){this._isEnable=!1,EventUtils.logEvent("click_reborn");var i=function(){GameManager.getInstance().rebornCount-=1,egret.setTimeout(function(){e.removeFromParent(),GameManager.getInstance().baskectBallManager.reborn()},e,300),SoundMgr.getInstance().playBGM()},r=function(){e._isEnable=!0,SoundMgr.getInstance().playBGM()};AdManager.showRewardedVideoAd(i,r),SoundMgr.getInstance().stopBGM()}},e.prototype.passHandler=function(t){EventUtils.logEvent("click_skipReborn"),this.removeFromParent(),core.ResUtils.loadGroups(["result"],function(t){},function(t){},function(t){var e=new ResultDialog;e.popUp()},this)},e.prototype.touchDarkEnable=function(){return!1},e}(DialogBaseView);__reflect(RebornBaseView.prototype,"RebornBaseView");var ToastPanel=function(t){function e(e){void 0===e&&(e="");var i=t.call(this)||this;return i.descStr="",i.group=new eui.Group,i.descStr=e,i.initUI(),i.touchEnabled=!1,i.touchChildren=!1,i}return __extends(e,t),e.prototype.onShow=function(e){t.prototype.onShow.call(this)},e.prototype.initUI=function(){this.addChild(this.group),this.bg=new eui.Image("prompt_bg1_png"),this.bg.verticalCenter=this.bg.horizontalCenter=0,this.bg.scale9Grid=new egret.Rectangle(30,10,10,40),this.group.addChild(this.bg),this.descTF=new eui.Label,this.group.addChild(this.descTF),this.descTF.textColor=16777215,this.descTF.size=25,this.descTF.lineSpacing=18,this.descTF.verticalCenter=this.descTF.horizontalCenter=0,this.descTF.textAlign="center",this.descTF.textFlow=(new egret.HtmlTextParser).parser(this.descStr),this.group.verticalCenter=this.group.horizontalCenter=0,this.bg.width=this.descTF.width+50},Object.defineProperty(e.prototype,"height",{get:function(){return this.bg.height+100},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this.bg.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"groupX",{set:function(t){this.group.anchorOffsetX=0,this.group.horizontalCenter=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"groupY",{set:function(t){this.group.anchorOffsetY=0,this.group.verticalCenter=t},enumerable:!0,configurable:!0}),e.prototype.release=function(){this.removeChildren()},e}(core.EUIComponent);__reflect(ToastPanel.prototype,"ToastPanel");var core;!function(t){var e=function(){function t(){}return t.getLoading=function(e){var i=t.s_loading.get(e);return i||e&&(i=new e,t.s_loading.add(e,i)),i},t.getCurLoading=function(){return t.s_curLoading},t.setCurLoading=function(e){var i=t.s_loading.get(e);return i||e&&(i=new e,t.s_loading.add(e,i)),t.s_curLoading=i,i},t.s_loading=new Dictionary,t}();t.LoadingManager=e,__reflect(e.prototype,"core.LoadingManager")}(core||(core={}));var core;!function(t){var e=function(){function t(){if(t.s_instance)throw new Error("单例类不可实例化");egret.startTick(this.onTick,this),this.m_tickList=[]}return t.prototype.onTick=function(t){for(var e=this.m_tickList,i=e.length;i>0;i--){var r=e[i-1];r.isValid||e.splice(i-1,1)}for(var i=0,n=e.length;n>i;i++){var r=e[i];if(t-r.timestamp>r.delay){if(r.timestamp=t,r.count++,r.callback){egret.getTimer();r.callback.call(r.thisObj,r.clone());egret.getTimer()}r.count==r.maxCount&&(r.isValid=!1)}}return!1},t.prototype.addTick=function(t,e,r,n){for(var a=[],o=4;o<arguments.length;o++)a[o-4]=arguments[o];var s=this.m_tickList;if(s)for(var l=0,h=s.length;h>l;l++){var c=s[l];if(c.callback==r&&c.thisObj==n&&c.delay==t&&c.maxCount==e&&!c.isValid)return c.isValid=!0,c.delay=t,c.count=0,c.maxCount=0>=e?Number.MAX_VALUE:e,c.callback=r,c.thisObj=n,c.args=a,void(c.timestamp=egret.getTimer())}else s=[],this.m_tickList=s;var u=new i;u.delay=t,u.count=0,u.maxCount=0>=e?Number.MAX_VALUE:e,u.callback=r,u.thisObj=n,u.args=a,u.timestamp=egret.getTimer(),u.isValid=!0,s.push(u)},t.prototype.removeTick=function(t,e){var i=this.m_tickList;if(i)for(var r=0,n=i.length;n>r;r++){var a=i[r];if(a.callback==t&&a.thisObj==e)return void(a.isValid=!1)}},t.prototype.removeTicks=function(t){var e=this.m_tickList;if(e)for(var i=0,r=e.length;r>i;i++){var n=e[i];n.thisObj==t&&(n.isValid=!1)}},t.prototype.removeAllTicks=function(){this.m_tickList.length=0},Object.defineProperty(t,"instance",{get:function(){return null==t.s_instance&&(t.s_instance=new t),t.s_instance},enumerable:!0,configurable:!0}),t}();t.TimerManager=e,__reflect(e.prototype,"core.TimerManager");var i=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.clone=function(){var t=new e;return t.delay=this.delay,t.count=this.count,t.maxCount=this.maxCount,t.callback=this.callback,t.thisObj=this.thisObj,t.args=this.args,t.isValid=this.isValid,t},e}(egret.HashObject);t.TickData=i,__reflect(i.prototype,"core.TickData")}(core||(core={}));var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.width=480,this.textField.height=100,this.textField.y=650,this.textField.x=110,this.textField.textAlign="center"},e.prototype.onProgress=function(t,e){var i=t/e;i=Math.floor(100*i)},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var Main=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isThemeLoadEnd=!1,e.isResourceLoadEnd=!1,e.isGoGame=!1,e}return __extends(e,t),e.prototype.startGameAsync=function(){FBInstant.startGameAsync().then(function(){FBInstant.context.getID(),FBInstant.context.getType(),FBInstant.player.getName(),FBInstant.player.getPhoto(),FBInstant.player.getID();FacebookRank.getInstance().getGlobalRank(),FacebookRank.getInstance().getEndlessRank()})["catch"](function(t){console.log("startgame error",t)})},e.prototype.initializeAsync=function(){Facebook.isFBInit()&&FBInstant.initializeAsync().then(function(){})},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.initializeAsync(),egret.Logger.logLevel=egret.Logger.ALL,egret.ImageLoader.crossOrigin="anonymous",core.Core.run(this.stage),core.LayerCenter.getInstance().addLayer(LayerEnum.UI,new core.EUILayer),core.LayerCenter.getInstance().addLayer(LayerEnum.POPUP,new core.EUILayer),core.LayerCenter.getInstance().addLayer(LayerEnum.MENU,new core.Layer),core.LayerCenter.getInstance().addLayer(LayerEnum.LOADING,new core.EUILayer),core.LayerCenter.getInstance().addLayer(LayerEnum.HINT,new core.Layer),core.LayerCenter.getInstance().addLayer(LayerEnum.HINTSEC,new core.Layer),core.LayerCenter.getInstance().addLayer(LayerEnum.TOP,new core.EUILayer),core.LoadingManager.getLoading(PreLoadingUI).show(),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},e.prototype.onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this);var e=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",e),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter);var i=new eui.Theme(window.resourceRoot+"resource/default.thm.json?_gameid=2574",this.stage);i.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this),core.ResUtils.loadGroups(["preload"],this.onResourceProgress,this.onResourceLoadError,this.onResourceLoadComplete,this)},e.prototype.loadSubgameConfig=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return[4,RES.getResAsync("description_json")];case 1:return t=e.sent(),GameConfig.injectConfig(t),[2]}})})},e.prototype.onThemeLoadComplete=function(){this.isThemeLoadEnd=!0},e.prototype.createScene=function(){var t=this,e=egret.setTimeout(function(){egret.clearTimeout(e),t.isGoGame||(t.isGoGame=!0,core.LoadingManager.setCurLoading(MainLoadingUI),t.initController(),GlobalManager.getInstance().goLogin())},this,1500);this.isThemeLoadEnd&&this.isResourceLoadEnd&&(this.isGoGame=!0,core.LoadingManager.setCurLoading(MainLoadingUI),this.initController(),GlobalManager.getInstance().goLogin())},e.prototype.onResourceProgress=function(t){if(Facebook.isFBInit()){var e=t.curGroupLoaded/t.curGroupTotal*100;FBInstant.setLoadingProgress(e)}core.LoadingManager.getLoading(PreLoadingUI).setProgress(t)},e.prototype.onResourceLoadError=function(t){egret.log("Group:"+t.curGroup+" has failed to load")},e.prototype.onResourceLoadComplete=function(t){"preload"==t.curGroup&&(Facebook.isFBInit()&&this.startGameAsync(),this.isResourceLoadEnd=!0,this.createScene(),LanguageManager.instance.initTable())},e.prototype.initController=function(){new LoginController,new LobbyController,new GameController},e}(core.EUILayer);__reflect(Main.prototype,"Main");var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,i,r){function n(t){e.call(r,t)}function a(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,a,null),i.call(r))}var o=this;if("undefined"!=typeof generateEUI)egret.callLater(function(){e.call(r,generateEUI)},this);else if("undefined"!=typeof generateEUI2)RES.getResByUrl("resource/gameEui.json",function(t,i){window.JSONParseClass.setData(t),egret.callLater(function(){e.call(r,generateEUI2)},o)},this,RES.ResourceItem.TYPE_JSON);else if("undefined"!=typeof generateJSON)if(t.indexOf(".exml")>-1){var s=t.split("/");s.pop();var l=s.join("/")+"_EUI.json";generateJSON.paths[t]?egret.callLater(function(){e.call(r,generateJSON.paths[t])},this):RES.getResByUrl(l,function(i){window.JSONParseClass.setData(i),egret.callLater(function(){e.call(r,generateJSON.paths[t])},o)},this,RES.ResourceItem.TYPE_JSON)}else egret.callLater(function(){e.call(r,generateJSON)},this);else RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,a,null),RES.getResByUrl(t,n,this,RES.ResourceItem.TYPE_TEXT)},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var core;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.touchEnabled=!1,e.touchChildren=!0,e}return __extends(e,t),e}(egret.DisplayObjectContainer);t.Layer=e,__reflect(e.prototype,"core.Layer")}(core||(core={}));var core;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.gui=new dat.GUI,e}return __extends(e,t),e.getInstance=function(){return null==e.s_instance&&(e.s_instance=new e),e.s_instance},e.prototype.addItem=function(t,i){this[t]=Number(i);var r=this.gui.add(this,t).min(-20).max(20).step(.1),n=this;r.onChange(function(i){n.dispatchEventWith(e.DAT_GUI_CHANGE,!1,{name:t,val:i})}),r.onFinishChange(function(i){n.dispatchEventWith(e.DAT_GUI_FINISH_CHANGE,!1,{name:t,val:i})})},e.DAT_GUI_CHANGE="dat.gui_change",e.DAT_GUI_FINISH_CHANGE="dat.gui_finish_change",e}(egret.EventDispatcher);t.DatGuiUtil=e,__reflect(e.prototype,"core.DatGuiUtil")}(core||(core={}));var GameConfig;!function(t){function e(){return egret.MainContext.instance.stage}function i(){return egret.MainContext.instance.stage.stageWidth}function r(){return egret.MainContext.instance.stage.stageHeight}function n(){var t=(this.stage.stageHeight-1280)/2;return 0>t&&(t=0),t}function a(t){"test"==t.http_type?this.httpServerBaseURL="https://wedev.openpoker.cn":"online"==t.http_type?this.httpServerBaseURL="https://wechat.openpoker.cn":"local"==t.http_type&&(this.httpServerBaseURL="http://192.168.3.248:9118"),"test"==t.sockect_type?this.socketBaseURL="wss://wsballtest.openpoker.cn":"online"==t.http_type?this.socketBaseURL="wss://wsball.openpoker.cn":"local"==t.http_type&&(this.socketBaseURL="ws://192.168.3.248:8888"),this.channelId=t.channel_id,this.appid=t.appid,this.wxAppId=t.wxAppId,this.gameVer=t.version,this.gameType=t.gameType,this.gameName=t.desc,this.appKey=t.appKey,t.adId&&(this.adId=t.adId),t.bannerAdId&&(this.bannerAdId=t.bannerAdId),0==t.lobby&&(this.openLobby=!1),t.testUid&&(this.testUid=t.testUid),c=t.shareInfo}function o(){return this.key}function s(){return this.appCode}function l(){var t=core.MathUtils.random(0,3);return{title:c[t].title,image:c[t].url,iconId:t}}t.curStage=e,t.curWidth=i,t.curHeight=r,t.stageOffsetY=n,t.injectConfig=a,t.openLobby=!1,t.httpServerBaseURL="",t.socketBaseURL="",t.channelId="",t.appid=0,t.testUid="",t.gameName="",t.gameVer=1,t.soundSwitch=!0,t.vibrateSwitch=!0,t.languageType="en",t.showTips=!0;var h;!function(t){t[t.TIME=1]="TIME",t[t.ENDLESS=2]="ENDLESS",t[t.CLIMB=3]="CLIMB"}(h=t.GameMode||(t.GameMode={})),t.gameMode=h.TIME,t.adId="",t.bannerAdId="",t.wxAppId="",t.appKey="",t.gameType="",t.key="",t.appCode=1;var c=[];t.getKey=o,t.getAppCode=s,t.getShareInfo=l,t.openGUI=!1,t.openMatterDebugger=!1,window.game_config={},window.game_config.logoBase64="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAATkAAAFWCAMAAAAlnRpMAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAMmaVRYdFhNTDpjb20uYWRvYmUueG1wAAAAAAA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzEzOCA3OS4xNTk4MjQsIDIwMTYvMDkvMTQtMDE6MDk6MDEgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE3IChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpGREJDMTcxRTg1N0IxMUU4OUFGQ0ZCRDc3MzBGRTQ2RSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpGREJDMTcxRjg1N0IxMUU4OUFGQ0ZCRDc3MzBGRTQ2RSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZEQkMxNzFDODU3QjExRTg5QUZDRkJENzczMEZFNDZFIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkZEQkMxNzFEODU3QjExRTg5QUZDRkJENzczMEZFNDZFIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+mBH6TQAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAMAUExURUxpcUZCQuXDVvTWYkdBQeeyRmhKI9aFDYtvPd6qLEdCQdq2f0ZCQuq6R0ZCQk1DP0ZCQv3MQunPof7WSv3YXv7QPvzOS7WGM7GGPbidV/7QO82cO///st+VE66NTsOMLb2ia1YZAsmvePm5KtqJCeCRDZ1lI/K3J5NaHNCJGUZCQv/xxv/TO9egJ8wzP/i4L//iceqhJP3flatUAP7SPP3gmP/xxf3PPfztwfq7L/OvK/vpvf7HNXABAP7OOv7Yaf7wxfe0LuukKPm2LPayLI03Avnjtv3vw/jgtPq/M/nlufvLSPKsKfi8MvnDNvrHOPvYi/3dkuqgG/fdsfrMT/7CM/TTpcBsA/7bbbxoA+ecHPrnu/zLOf/jdf/gbeaZFvbZrP/JOf/2y/rOVvTWqfrVhu+oJ/S2NPzrv//+3fzajskwO+efI/i/Ofa6Nq5YAfqyJnAOAMQsNvvqv//UQfzNQ882QvKwMfPQoVcAAP3VXe2pLfvMQJEBA9uKBPK3PuOVD78oMcRwAwEAALliA/esJdJ+BuGWHl8AAOObIvKyOGcBAO2jH+CQCfW+QxQAAHMCAMJxDv/VSfHLnLoiLN2TIPrFQMV1EP/90v7JP9KbJTEGALNcAv/YVNaEAv/RNf/jQdqPHb5tDP7fZcp7E34jAdeLGv/bPP/zRf/OLvjGSd2QEOejKv/cXdOGGP/rQYYtArQcJf++L//nejseAs6AFqUME8RmAM15A5oHDJVFDf/+5/S/Ta0VHclzA6ZKAUsBAPbFViEGAfSnIP711f/8SKFCA3cZAqpiGPDElf3ko+ywOKJWEZhWCTsAAP//+ueoM//+gf/wfLFuINCVG718HuCcLPfLYf/tZ3tVJeu5h8mJJf7II7R1NVNJPsePWNWicpwlDlg/MWNWP51ZIUoyEfrQceOte8CCP/HPNadmMs+aZe/IhOPCMoJtJ7mAT8+uU92/lu22YPC/c5qGK3ZpTng4E6GLVo55R7WXNMazNKw3Hv//ltV6Y8lWRf/zlMYA3F4AAAAqdFJOUwDX/vd5/v7+Ef5P/e8loSu/Qv2+htxfv0T+ov39h4piuP7k2bPraquy3DlEK8oAACAASURBVHja7JtNaNtoGsebJl3sUKfx2M5S4znNoVBipINAq2JcMi67GEfyxQYfbEESWJODiwMKoXFgTwOF3nwwtsG4oMPgULGgHHuZy9JDD6mzhc1Ap4dmTnsYcmi3KeQwz/O+kmzn00okd2H8D44/IK388//5lHzjhovy+PxUvhtjDSufPxgOhKpKtarMz/NboUB4bszvcmrBcGhLmQdqrVYV0HGodpvLB4L+MZ2LuP0t8q8f4wpgIwJ0ioI3jou3lVBw7LzzuP2lXl/uPke/tbSWBkLfmQDhVzUwN8Z0uiQEI8ugeheYqSBZlllZVgEfPNFI7CK80JjdCc39tU7A1Y/3ZbZAtQMqFBAhy5rwFG7MbtBw9XoEsK2+rB/vFZDXDvxQfHBDlKysbtKi0QmP851luOXVeh257e4ud03HmegsATuN5Lz21rjOUgVXLXAvI3ssNdwJbiz+UHZQatvBMTXQN5QbAVc/LlDPsT0Z6NgcosshuqrSCY+5eQJdoEYMt/tylVgOAIFyco6KVAh0XY6Fx7JGCkU78IcnF1D+eVx/idzAcZEuUlMfbvbpIQj5sQQoPBijIwor1fXn3QiJ1MjxHqABbCuZTGq7Vksmk6VabXuF8ssRbtjqkRLLt//YATs3j1OCtncciRx391jktpIBaI2lrC4kEgsJQdeTpe3MygqFh12xRiss1xl9Y+fx+ckOx+fzeb7ywMUjOBUCcX+fBKO2kkJq4kblhTeK8lYeLAC82nYmA/A0Cg7JcXw7Pcqj9/iDgcDzrTivzM/Df/61VzghDsFhB4JFgJU3M6lGtljxRptEUXIP9BZ0oVRLEXaauQrguc6oUp3PH/wmshyBuHjO0yEQxc1zW4G5rwMvCHN8VbUa3dxmppHd8FJmfYKnFV0XCTtjh4L7J35E8YqbiNX6Mumc9iG1tIwhmixx4u3AV1jh+NoE3I7Rrj1cSWUr0RPUTHZesN3jGrAzwMFBA7mQ+wfpDwKzZQQHHedqV5VprjUOAw4k3s6HRz3TBCBWNZaCk4Hb0sbZ3Ci7N7qAtut93Dwfj/ld9xudb3DCIbOhjKMM6TeNDQ4xXme07PxguZZMwMkPIVCFF+dyI+y8gs6UGuvrRpaBcOXb7poON1/GfINt0+5uZF8mY41MRcxH6ny7ExxhuQoorZZWMMBtx5joRdwQXZTRmWSaouMIuXjHzc96LtQ9jhhuQ2679W4/OBXjlsKD7rIdGpntfO8g28oIDjLcdrbYvAQcoisCusYWzxuW43k3M923z5V97NGJ3RAcxGofOQOcSnfXigK2G1VhbYPlcJzPba5s15LRS8FhsnsE6PI8VTzO8fF3bn3SnsCP69Xq/nF919Dq8b5KwRnk1B45Y4MTHk3EhqA8YUfCIjjdOwQ4RLehJ6R8Ph4HbnDH8W590B5sNaubaqEbgWh9iSO1kePOsJzWoug6oVGg83MtGqxQHGrZylDgEB0jMOk8URrRuTT4+0LzpEdnc/J+l46G5LyIZTXzkUajFZsUyCDtUaALKzRYSawKzSHJQYXFKgHY0mkpHctzcXdGMAAHEWF0IPsgumzQNHODQ04sWWnORKe0v3MfXUghwQplNTW85RBdRWekdDomScmkJOU5N6qrJ8AZ47QZnMCNAFvpU2tTs6LVGgndX37520oVgpVFy5X0qA1yUUEQJeSGkuJuJLrAvNIDh+xUZJYhSqEyKfoE4Fmeow0653qFDSM5OCbMcjozPDhquqSlNB37PXemp6emZmZmZycmbt++fR8F9xMTs7MzM1NT09N3bERRkB8AB9xWENh2KtVYb1CtpwxlyFl1BEfR8VzH5b4uAORUBIeWe2OLXFTQxWRSRAG6vDQzO0FRXazbE7MzU9N3hgsHiAdaQlkWuKVwz1prZEvF4hvU6+JjCfDBa6kUzIPmFoIsIhSXq4QvzyktGcFlaoIQtUMuChOsaEoQY52D+7Y0cRm/EF4PJFsT1mYmVauVStnshrn8oquvYomwQ3zVlhWtCnTnri6r/fO8osm4N6+J+oItcCTTCaKAQtt1ju7b1+3ZqWnPeR16VYFY7YGj3IregeUXhSctSaVSqdaoWnsIssJxc+0011GUFubcVIkZsgvuE6MLpsTku6uQI5qdOYOer40bHNkCRw3HeM/om+CljWy2hOzW+xae7m5cg22FJNlaSRD0qE1yMIMBM8ZwnXBlciR2p6ZPlS7MI2RGIOCAm145p9+El8VsUkyWGusWON7dIgHHR1JESWT0ol3LwQjGgKjpkuVrkcPInZnqy3uhOF81JysMVTTcBR9ts1lBdMmGxS2fd7WpC2fzEqYIkWH0im1ybwg5w3SJj/evrwkTnr/Dcy3VApcqlWIbF68NYarJikmJp+DiMN3k3Vx+hbPYy0KoAbk3/wfkLHjhDqdo5lzVgljNbjQv3Rvq0CalFVJY82loz/Mumu6eLmFHBuDspzkyu1roxLJD5LBkTHlCUCDoFG+AqwyzN0R0cTypBJaD2JXy7pnunmCAg3cfjV6P3NF953TwLpZvaQa4TE0abqIGdElR4oEcxCq+sbR7MxiSw/oIwbrQvDI5kUSrk+Q+6pJU1Yzru1Ol2JDVq+mFVJcmlpPwjSXda0zCggGO0Tea1/TcJwfJRQVJ2jLGqVRt6fGw2y8o92IyHzfJiTHXRrB7HTIEMFcprVaFIOiY8oFz4N4/AHK0ra1W12uxoXt0usHBdSshxyRdS3R/7iQeFB89evDoUfn7t6DmqRP7l2xLTHBiYvG9c+Q+CVAZ01uIbn29trRhb22YTCM4Qk6IuXL5gcfnD7QmUSHQLe8tr9eLjdFbQ5dRNDphg1zUwWA9SsAgjOhAjaWs7bVhGgoESeCi7vjY7/MHA5OT+zsDwhNgwPEm6NatW144jLdv+zCeOspiP7mmg+S+JEQTXSMd27C9NpQwWLFlEAVnySE1WSaXSw9eB0wB7oF29nYKuVyOUkQvNt+etiJM/L0C8cVBcs0yDDUCsgMEWXubiOaCkJSMYGWYxHdO7kcCeL5y4OLps0Q47hHBA5aYEZ2I19MZDMvlciLB0C1T4qODBcKboN0Orkyzgu1pGv+MgnOQnGcuULic2imIBRMiUJTBiv8hVnz9+nWl8vfFxUUgWP7NwT54kZLDT0TUH9hcG1Z0JE7aeyTnUFsyNykX7HIzTwOYGM2A3tvBcDay4j++/3TgWHE9KBvkyFT4wia5FzohzjAOes4XkK+I7TwrFqzaMvlw8ubh3bt3Px8dHHy6Zmv3W5mxZHfHT1fVRnvvFLm5SSe5nUyK8E9DOmTlwt6ebEL8dHBwcKWmpEdOL9qepxmh9+eOkAuyhfMKgdmTOEC2YFxrzMoyW5CxrBze/fz5888fPrwfOpq/9HnuCrON0+SCpyK1QL5NSK7bI5domEnMEYxWz4MQd7q//rT2au3Vq//9/CfQh/c2yNleG0YX+siV7zkBbvCdAR0ZL/3h2lRxjlM4+j1qVVNlK4k5YMVCofvvJ2vPQE+fPl17+uzJrzcPD0kwvz/TiF5B7JGze16pOeC58rfXznGD4CAjaS0KjbPU7hOHXzxHihpt/npOvBK77n+fvFpbW8Mb6KdfusZZewzmw89HR0cDlTmq98gJ1yR3Xc/51cIAN7nFDUA7pX6InAFRVXvxbNOJ6Lmenh52ZZoRydfyCqwqyzkjIaIPm4nFH37AHhH7bO+18tx1PedT+6pDYUettjsXYTuXYg8iDm89iCeC0+j/ZKsHZLu/PKF+w9/P1tSufLqqEIayjFXld2LOJrSN9IzjEFO8OuQQ3JpSE3rIpktBxloQiBhrjDfWQTiSwKzABEnBFJLLyruCWcK4xuRSMstkFxGoIYLFb8lORll3GRHRy5wERR2B5ZBYHhrQ+pZDtCDIsS576PO873zqIx7JG/dxsOXPSL/5P5/vO+8Elohmme1j9NC7A9xN7oyzkimXr1ZDwC08njkMOWSIe9se/3D48l2GFTOLc5az6qL+6nBogYjc2ckBayZC2u+Vhg8e+sk54Obunm2d/1LOLbixuQ2A+HR3VykZ7Tcz7Rmwk5M3b46Pj1stfDAz8/bthYkJCJOA9uc3Lm8VXr/M5vyUiGz+UK2uYdd8Aac3rsnDMIT21JBGybM1Xx9M2L6arX47ip/2WhDN+yWeNITac3irCYIgCi4TMZFCJaLHXr/+z0+i7ay6cPIzCjHE9ij5REjbvWw1x2ToUeGQqSGODM5YzjkFCYLjxuamqJYRojgA1U6gZBzIEmATpWi0CBY1jdUhQLFWcFKrLmgTr2xfZgRHnTzAQxYMXfMvE6E9NURyZ0utF53nVf1hbE+N8Gq4ZLSaLaNdmt1PKSqxvhEm5XK9rnRKhiZLAsXnwCtSK0Slgqk5oKdLBT2m/XQyc2Hi1aHJzz++XhmycOggnL1+/ZdKrdO2r1ZDu+O6KkfUtmz7oaRXGvtlxZRvhOM4nqjlelnpHAG+KP6Ii57bGECJubUkyZXXjZMLjxm/as6Vjf1Mb8xK87BqIaSjryt35+f/wkaHc1+caQFnyskOD8eVXIQoBzWBKQi9UBRqYouQiJtthOFTSafdjBVEU3zRgQYyLIAQGUG4DtrxzAWGLzuS+Oxbv1hChmySDbF1lStXrtxd/uJMCcJx1urjsX1VIVot6nVB8XlTVfqkSfHVy2pnttWU303PQgjXAQFKFe3k7QTFl835HRnmvACt8y2ybEXlNytTF8+UH+zgwI/rq0G1BeB6XrNUM9TgIH2C7yoQ+8pKwDioFPrpFc3o57Eo1Z8kvz5+O/ESTzaqntKkUGy5ED0CZI1io48co/g2p6Y/GL8KNv+ns0iO08Vin1rEQooMde8I1CsQ+UjnqFGBwCcVHeKix6xShn0i1Gqi2HpI25SQa+bQ25SwR+xLawxgiJ6s4mYHtri5Oe55eRftbfHjR7kwuVOQ+nyuGBVK6juDI7iuApGPdEtNWXKShKzrsixX5FglhqZpWrPVgpyNhUVgH1uGH2mZTZsUnIDlsllXq5yjqQHfMVwebF5weMbK5p9WvvloHOFNWysI2Rw3dilHkgVxQLQ6hRyLfFwE6c2KFm+hVe50FEUh+EZUgvUhiNMy/EzlaerhnMENHglCR4iWCk3FMWzIK9eHjYKjt57s5K9fGT3JTlfN6Am1XCQydpzTnnuCE3M7KU/8lTTr5ZJFLioG6gQNwIHxirmRHAQaobcuovX8Ou3znrJu+SEbfNmHlFkn9qz12qJF7tPvd77ZmP/nR6P67K/NvBPKPgRy46IjG7Krq5JorVusaUTp91AkEOGwQo7gaAVNUeoWOQiOYcKN/DTYfbQcl3mKlslEcMsJ3vCVc85262eH4PCGhfzGnbs3Vlcvj5ogmIGz7sI1jYxbCHMlowHW1LSKHsVyQ6wJAbWndFFQTOBuYHXoK2z/U+tdS3PiQZmPcKNzM9HBK4hkMpkF01KZrS+B4OaidUCjo7hFR3L5O8s3bn+yujqa7KZC9DivXPbxQoYbHx1rWiEsERLk9meNpqxrfyfeoqTTAQ0qnU43MBtoG2CthtbUDiADxLSGHeYMIAq+CvhOfy5BGgnZT5uW4TK2pTKphYV0Oh1PJlOPtlbw5CNWjGRDLsl9D5IDcg8+++rW1RHQXdwMsRPQqt8usGt2xkkJBieM6uEM8VZzPPlO1gtioUDbfKHHrARTlPSGMQt/oY4AFZ57h/6CROXvBEqzL/LQ+8EFoxfehQ3J4Q22eI8t3vN47Vo8nUqtmAQxc+BdWSvgrEvztx+s3vzq6r0R0F3aNP0/C+Qy/dF3bIhKb4wL8p2u0ahIWJJh9Wsnk6J7egLogCO0W43WUYD2uipBQQ3slPfhz0nwpwp6zHgBFyrjNQtbyqKH/My7M+I77BQkqEl28nMoudWbt+5f/do/uktW4Mw+TGcy3Fn89dRohNVHebcbOGrGdOxbMZewXq2nDowySYpy7KAd6CoQD1WiRHrcgSgNoSZAMkINQ5uslQgZAi1JqdkWjzOA16/Fkzs7jx7ll5DczVu37v0V0Pmt7KatmJn9Mr1uogu/L4OrwmYmRMG+VZPNoQgm46hn7GT2WyKdlzSNQCcIza5ngMBDISQ5moVeT9D2ictRMw42L7p40rrpNmHqb84it7f3t+0P/RYlVrLJPUqvr79ncqxrxc6BYH5VlU53to0EdUnsa70kathvPYeOS9KBn+KuINuCp20BhDXxhQvdQMWZ1Ex2uKeJwlumznoPyO3tbV8ejVxobSG9wNC9X3J21x/heUIFCK7Y6caEIssPMRmaL2y/dDpp17ENq8hyQY4VPlcUV3bQhN4RQ1HQk8FeX01ScCmTm1dy9M5b3H0/d8Mht7ftL9T9znLWxTSUPwxd+NwMa4kwKJBAPSex1quuQN3SUXbxPVhYodlagaLHk3KUiNw/Y4gKbRSdN8KlekOcm5sJbm7pNpLbY+T8+euUWRhmN59h5XhuouvNk7t02CJB60Wr5R6DQgc7DTe5jDygUxZapD+ful016abGbvbGNcSlpfkHt+7vmbb9W1/LXlZRYpHL/D/IhckugiiKOiFcmDaB+I52BmH62aBRav9IVDDIUHBxujs4nkxgeEvEPeTmoKC7ec8m96GvQtjy1k8pOSq68yYHfZNCKkhOaJZ5n7+kBgTBGYGaPW/0rjIEXNz01STdI+wSHduhsjR/4+O9vVFE55RzK8/S5+uuwCuMQU5B9yzXDzDgC6Wy3ygLyVWqWRMGVsxItYaSGcYNHDWRxHuDE25wbAVsaQkquk/u700+2X7iV3TTIYvco2fp9DmS47DBwrYf12YhE3QPQHNioVznfWaoCK9utFoG1DQV3VwqqzWD4WHVbwL/AbtE0sXtWmIu4SE3OblNReejHLbLOYvcwjkFOn6r0223jQa88IqM64TYOkiFIwVo+oTH0bEnIcHki5IBRaHWVoIewaWcCIdemjRPT3G56lzC0dztm0huctKnu9rk1pBc+twCXaTcLrAdE1bZa/ashVi7q9ZVX/AgdeBzDdJsrICKuYHlL+VG2VHBxXtCHAW3tDx/+zNGDlW3/fvTyS1a5NK/DDncVhIM+hhKQfsfo24mujZMFLFjlWJGt+wHHjvbjnUN8MPcsNyQYG+0Z0h4coMjOSR339HcZT+FMGUXWqTkkN36Og6t7VFh5NRBMYAKmiMmc0NO/76cflfjMcR1Sy1NFs0NJ1YTJVF4nXKdhLlTUowzi0sN7fBZhKO5IZnwgnOTW77x8f0nkyY7HyliapEatBALuzhbI2zBxL1eQgtRthZAVwIG719i7CzV+dEd7pgo1+uqEjhqgPqsLpQiFGs1hGeu1Awdn2dsyaVcDVfSDQ65xc3U4LU5K8r1kgPNff3HU8lNHB6yjYGvflxYvvPnQKnEhrUGRO9SKRAIdLvQClGeFkui8P37vuwPru/47F5xzVoNdw1dklytflSoCYXvFH747JyRG6Q5b4yLx/NUbRtedg4401shudqaOz25Xpx4/O9fvX1z3GpomOGikrUyTD/iiyhI2GzHtINmyzCAZiAAJK3XE9wNMkJUdUH20Il3/us6ntTrWk0/oic8B6h19zv/DYT5QdzCFritgcO4nn4rkacptR+bV3MucoDu1AHnHwq6tW+IXWxnuGhub5PM2XcNjE17KrF/mOiYm7LIZlOzvmR+zydAjlf/9dyoexZV1TJ5h+DMuflWasszGXEpLk+9NQ+So66ad5Hb+B9r5xvaxnnHcZKtTl3WtS83RsmbMTZzwQ0IRIx8wcv8oii23sSsA3XjCOTe9I4KJII7sY64OAqhdTaIRzzoXbI4d8r+yLgKCX4RguGQoV4gaTwaouzFWsH0QqIvtA3r1X5/nrt7Tv+97DnpFAvJWJ98f/+e5/ecZMkJclPnLkFwXRaOblhacvQB5gPYd3WlR1MWPXWZHXhmfWNr59mx8Ua90WgIYQn7pEPx79Tpyn4vpoxkszy8nQd1V1ODlZiePjVg5y/XpAlcx2RcIDsjiKmB5kxSHIPTI5qb+vGlUHND05KjBdGwlummBorjFqzZ3b0n43XK+dHNwZASEKnDVQnlJh5jByDn/rXQ3frUlfDwem0ILmKunP2molGVtWb0DQ+S5i5eB80tE7mPhpH7AZKbzkxHyPmNQ4XMBjBr4OqBR4GhI0nxFaWECIUBB/F2dG8Xs8ef2SO4RMqX1A5yQYiYj9Zc6OEMQ/JxrDhzksGZoaNjPxeS+/Uwcj8sZDo0x/nUYmF9a2+tTsxsR4mrPbMRAU64OcV/wpcj9n+OLjvVHlbsE7LQmiOSS6c7w4MBajNwXoTlZvRVXEDuHEaIZUb30bBU+N8Fltx0xqeGOfzG7loD68cSy6yP7UhEWHRBFuy7wZhlKaMH2vhQucVlbFHJhX7OEMHBQHYd4Mw54d6Qm9lBDiLELaG54eReqYSau8KVz/rus4aNSssOKcKUrnxY+DclbO0H2VmKMrqvG6X7IZRdn4VVI+AGmmNkJpkp3HW6ieAgyU74uVBzQ8qvlw9VhObgDNgyWzfGLRfMU9UOWLrip0JsDncaSfSsopUV6OIvxE2NNDOlI+C6sjmD7gaJzUR6xA4lB8iE2CTNnWJrvXR9VHLfnhCaA2yFK7trdRviABSuB1mspryK16Ax9FIsyYbwAB9t6VFeQGpByRCQS8uKS3UUrSmhOQODg2EGktPhrJOT0zsd3QyggwghyC0PJffaxN8rl6mDvrC+82TeLlkJqPgPMLUJyTz+1Q7kKo12q9lsjo01W/sNbGIF8fnkssXi/wEbd4/1cnGdRSt7OQOtFRU3b/roIKbO6SA6nWjpk7LmmNyo1npo4ktM2S5vfP7Sp184yoI0KTx0Lkl8uPR8uuTZ7WZtZSkYK+Vas+16dsAO0GXjLwYt4NbTx0miW03NrzI8vMSlMFM+dNIaGiuwMyejsdUnt7x8hzQ3MEJ8c2Ji7GFh4/lLXzx69Dj5nphjGk1z5PXj8VSq5NVbZQbmD/qptu+E7LJWNZb9H6mlw3+oqhRc+yjO93PMDYAZghufJgNmei9y18lY7yC5AdNML38LyD0/DNjeOXny7eSmTG6ExjW4p0FvjacrMjWJ3nYLdKeF6OIHwpYPsPE97ceIeEeXXKpzZTolSQ6BCWhAjE4suQ6DDSt+lBxq7pM3BoWHiYl/PXr8Dk/PHYgcR8207dWbPralqO7oiXKr5GqxkdGF0PIIKs/M8r7s+KwWrb6pHBurpDmgZpokOcaHcjPNbsmJ2MrWyuSWjw4ID3jdj5NiYpNXIUacTae8V1U9t7UNsJa6RwCv5nqqj64IH3tARhwRW55vaQSXlkxWLRK4dFrtlcpxsR+6OZMHhgY+o+6Qmd4J7pSsuTvk5/qTex3J/Yd3BJwUqxAjag4/f9rxGjXGVBtrtVr7bRj7EFxr5ZUQ3lLZ9oSzyxbJ1ylBVOYO6x7uLS8EB9rLk5nSz6pVLFaLViwbj0yiS5oDZqlVoTi4mT65cAhmerfkQnJCc/3JvULXYPguk4PzwgE0R0Wm10JA5bFWA9tSXY/mjLEvyWnsN8s+vKXtRoDOqlrZHnlNl6XiCbjxGemhDLHjHHv2YzwxB6ASGucgbKRwsItbZb0ZhG7OR2aaEBp0FNwccTMjBiuTu8ma6z8/d4jIff0ma+7N9zc3R46tIDkANwYxYKxd8rySBVoAj41dxrj3nDbVtAkeoltpBAYbq1oysYAag0NI5OIQGRspm246nitW6SofvH0klcbuRbG3pGTHtXlDTJMYQQFhBMYK8CAdwfukruuTeiC7bs0dv8iSQ3JHXu2fkRC5n/uaOwA5sDjbLkPstCHhRSnELNnYVE2zHNBge4zYLa20PT85wb39PXM10lpePOTzvtTyFCHyuaJIauCv0rQsMKu3KfEGL9GGvNu1U6YROjjKgjmy+maKqZzugyO5zfQhdxMOJPfHV/tnJETu7VBzwaLhYGulqsCxms26B9jUPiS0ouN5DY4gKw1X83NipS85ohVgI0MlbHBUi9msIriVPBfy7u1o3t1wS9dMCA6GIcKqHCB0PoCZqesC3wzwm5HoUYQ4dxzTuXukuV/1W4cQkps47K8Zvr+pqaqlUmN8TBWN1vHegsOvVbSoRiB33RNDPJdLVEte6Smiq8FrgzmAUGGRQ4xQc3FmByeoQDiwqBrm3bWO+I1jbL/kzpsiNPgjEJyuEz+d7LVXjMDYOjV17l2J3I8GS+7LT3nJ8PGjPxeLicRC8S30U9TC6/L+jFhnQ7iCG6xw+iNYgYp3sgiFV7W9Nmhu6amnBHPucYlQdPjPxVF8Ii3Jg48rZoWhZj27ubLUI/HGmqXt2qbMLdScoSXmdN3XmzDZmclAcidYc6fPvXtr+R4MIvf9wZL7x+E/HP76e/98/tVXW7Mb6+uV9crGxuzs1u7e3t6x8Xq9zgxtOXtQaHdkZx7Rw2fBZ47nqkWvgaGi7Wliel0Clsvl8DUw8jmZH584O4nn1GqWMxkNwvl23+QRdNfwrplGFzrdOP+3z1THUdQEW+sMC25GuvTfJE2VnLsE5G4iur7kfMlNjBUqwW6YcCMuXVbkcqFSwe0ce2vjjrR4F05TRkj1Gbl4uuiWIFKUbbLXgFyORz44R7UnDz+VSbnuU4nXdrlcrtVq5W1fhHBuuVnTZyZqCCCnXZqtrG/t3frTpOYoiqotUAPOzMykdHntU6eohPjLvSGa8yU38ZTWDKfFmmF0iyV31OMqa2Z2ze6aCJbU1uPjAhs88JQoeVCitSC+4rvp1bleo9Nyxa9JFxmc5ro1H1qtud+mDbAlx6k3Wk9rDA9khxZrBNmcb63zx3YzDx8+KMx+eOPWxalNCwEuzE0KenThSNbckXv3799ncm8MlBxo7krvNcMr02L1a3p9a+fZs3Gnd7EUIZaLHAG6XMIBdGXX4XflJ5Pq1QAAIABJREFUkkApybCSMrkkEu1WbZH9LCiu7AcDGxey4dNbWqJqUQdYA6drqGSp23pgqoaIrLoRc5TxvfXFh79/uFjIVLY+v3n1+Alw6FZi4cQpRseaO3J/MLlAchPR9Ztg7SuAtneMZildW+0HTnJaPrTwJsYqoKthXzmF3GSvgU+z8JJwSL+1ypLTXI/AbTfbnuckqpD18gvwG3pWFyzXbtdIdttOSZfcnG6ybztvqo46eWfrMpgQ7jorFCqzO3tXTyRAf9bCJpgrlRDLFy4Icp8c7V8+ELnFqOSCCzTA/8uTBjUa0W61eE/JsWsXQsn1HkkktWqVsCmJ3tGDWuQhjwRDfkUKqxAcajRvBbl34kQi7WtzVdD72EzYpX3UHXhUR0YncjmEN6c6ylt7swXcKsZ+aDGzsXXj6k8s20mcmjqN5O7+9IIg952+FWtEcxlpxTAzu7PWsKg7KxvrlxMThA5EsvEl+fDH7ZwiwOXORAZ+Y6NMMe8/3s7fTq7CI1Un1xys9VaatucsVENuAt4qCm/VXCg5+4i35q2Gvs78wAeH7M6bmuP8cmf9wYMCO/LFxQfYqrdzDKrGzdPHr967e3cQudej5Gjw7j6Q2m+OpdGN2EpXItehuMA7JfGe7G2EwThzJhejt4ivtjx7Fm5n4dHnF0JOIrTbCA/OEB+QHMaYsW8At0Ta53YNiKWYm2D3sUhbWq5JAcI32A/0CDzV0da2UHjT3H5E2xTXd6++V9z8xf0PfzaA3GvS1ccrdBmpKxmAX6hs/W48jTuE4riDKT5w3SYrsHUTSkY1JGicQRSUujE54haOUIG36Ysw6Ub4EupvwZ267aXtfa+0+V/Wzj+myTuP4znnoY7dTPzPLPcHl+VyoVxQo7YiwtNR6DmJOg8GTtzOh0F5zImSQRrAWAMEWRupZ3JevU7LzWFXboam1wXSh9T2GQ7SIcQzd0CGzqA0i8uJXOTQy/1xn8/3+33ap7UtP8bnaQrWauDV9/vz+Xyfz/PjEpEjgNp3iRiVPMvgAJ3pWG8XiLOh3hQVnUEhOgZvrzMr525dIGDZQ+FduGDBY/V8f/rr+f6WlhZC7sv1iXcFy+QsFjpntbiH/1yBB3nLs6+UC36WrpRmk2+TGm9FGWcPu6EqE5wc4/HsSFDQ5F/mTjVcbGjo+i8skh17iZtPM1NTPwMzhg3JdZrMWb0vWtN6axWaA8mZFOC0BoPOmJ3n3P9tYWOgI9pLWBqhbxn62n/mDKy/1l1NsPhar7z6OOl763zfr7ni7HKUlnqWtKsEsUXpKGyGMsG7fbLo6aHAKhmtEiWkygRREscP/seS01MuVwX0NV0nIkKkbpb/CHGph4I70QnsdvX+69kluRcmi1aTIS6gjzPqSp2Of94E0youhNdot0qj7r4zH5xf1/5mqpYEFl8Bi/sxXiPqf1fYrpIlkKuvZ5YD3xw4AHbZRzE05efnh8PlTfA1nN8EcsLfHn+p/ZcukR2O+ER4wl/E3A95PJn4ME7nQt0+cAA/ox75E9qnMHQPDSI5ZGcqdmSZOiOl1RTDzag1EtnhEiJnV5ajebgOdMca/47A6Khdstozbrcf+urnqVoS0ByZfP2tPDL5Whq5iw0VFVDh9jXlVx0P7QiFjmg0OzUcz/ODEPjMwzOv0uu5mqIjIXxHaNvxd6qOH60Kl4fxWg1XJq7dmGCB9zojEINKhAp0lUyBTIeYDEsU3GR0EJ0YJmCVfaITiip2wiA4uhFu+KTDr4xdtsO5/1NLgJyySMjZ7QhPCrhPvpmqJVFOvi4vg5xrynXxxpZQkR5BCYNy8CRUvBzy6wKLQYG8WcVrdtoWZmbwaIBnT188XQNqZQzJHc0ZRMovWFKZIH9SjEgxSq1nADcIRFd7qrYTGxJTVHNm2JAZ0ZyWPrRanTbXqQPdWS7I5ABdAL5af5WqPrDJVznuEj62VHLAzXF0Nw88kJWKiwmVir2gfB2kx15TYfC8TZyXdxNJkoTL9rTJZ0+eAcQ1DOINgMLqRzBJGuyRnyi+gR4KroeiM+hAdQSbiRQIc1RzqDit0aBlodPmOQ0joLs9suZGkZ19bar6kJm5kB83+VqMXL1jylXOiwIg01NSLBTfLhKcXnjbavV66a6OGa9dAntIkhUSjN3u9aZNPn/xxit3rlE5lZQoCzCVoyzDIG7BHrLRBxUdQWcyENHV4neMnaw5Ss1IRactKNAWOHq/8UGd7QjYI+RG16aqDysgNzVVrhIHQUWqlQcnfOS12pFb2uTkZNqMVw4gSHfxWqX5QVVox/GqMJYZSlCBMIhCBB8HCT18ILgB3FhAukOvEoIoOrM5xq9aqBTRyN5VAOw+7sYL98rkRkd/mWL9ADE7wcjlx5PLS2zUKzXiIKdX/bjgxYetSG5yYfPmzc8V6LzwmUtEgK3zYwLJB9zuotC2qnB4fDxIHaxUH2z4IEHBEXadA6RSADmCz2AyU7+a0a5AzogVVheBhzc4KsjOcnyWYZUoOCS3Mfn6QTH5yt8iT75SkKuvn3LtEETVsrgl1OZOcQH3S85Mbk5Pf7AwqSDntRPdWaXWGZsNhE3KDJYVXkUJAkCI8Uq6VUa4yfAUoiNVFsIM1MyEm7yEQHrEr8yuuJepICfb9VUhZAzCDbaNKc0aM/laxK3126cuqkRev1hK4xY3sl74DSa6mbQnzxeeP0mLJWen5B6KkErlOqOSC7VKXwQmZvyC4xgx4IIyN8h1nSbmV4BnZuyYXbUgOx0WB4YOyWlzth462wayo5oL/CxFM6fQ3FGcGSqHhi+Rg9LwviCQ/MatQGax7+DF+8SuePOReHCM3C9EfeznQeoRT/ugmprQNjBwEO0JAF9mh341RTRnJuio8tCrJHQ6nVEniw4nOMVvXS/rv3rTbiWay1if0qz3/13OhoZNnlI8NTMLJ4bbI6fAqJUpbhtUBtXqhF6ca8UaQeYICcFNizyXUNAcepjg41VHQgerxgmqeNENmAYYNxmdwSyDY6LTITucT2OiA3K64q3Xy9rKzrd3QyMcsKelNuvDcPkWOjaccDldrlzXXpfD0eXs7WJnFUbOLq13OULEqasTRHSSNz6i4KS3RU2qhMAcDBlQtTt0MBxElVF8ikSnRMdER+uDkdQIHQsUHYSu+vfr+toOH74KlpVGXyIXZ9aHE3f+fu2Vnz594/vhmz53N04N3W5f4cjIMJka/tp565ZTTay6vUbkONWqhQZFJyUCJyG41rkxzeL4mX+hBHO7d4D4wJ+Ij9nVpAjZsBBGs4GCo4aV0YH4qt8Dcn0tZf6zZwvt1umUZs2cH35U2I2361EODeUL6Vk6Gi23//ENXvEzz6EXk7RwZJ3FLTfjgeimWyV7PDdaWK2tC2M7l/oxIT+iPp4LHRwHXp0DMrrOWMmh6Bg3pKYkR9aw1e+1Hz7ch3OIqx/4M2Y2pjJrZlqgkZ6YWZfgctGBRrwc3gYyKt6RQHG8zQYtl83GJ22LuVSi2wSisyvBeSPg5seWmRiIeVF8mlA4CKRIputMpDmj2WiM1ggFO11x9bn2NiDn9/f7+8+2p61NvmZFco0vzwzpNKJjT/cwninnVF9uUE8dFOMo8ADNpt8092D23iOfO11QLV90Y/OtUhQdUxySa70v2jQryJ0oPqDHF1UFzUbTgFJzsugQ3YncWpbsciB0kSjeeq6fkesHdg9fjyH3Wjw5coamYmYI2HBa6AZqXbc+/9ypPn1Z3TDVJCj9yKPSiuZ+uOdzk4MAHs++a1tBeRX0UgSdzI2BEzQrLj16/PEGQ2ETsEuU5syGL5pLs3LxgNnSvaW7svGUpRyZnL/tcFkLGbj2902/lnQHk0xuT0RyVGygNUMXOX+JHs3U4MobjLQjSI3/MP27x4VDQ93A7MHcb0F+Nv3SVhIxEtSMYZGQCDTqVGrVaVGsWUGPqIDHwU/JVxmrzQp2kVAPjw75fCNtn/3xrQKdp9ThcOR6cL6fU7z1Ly1Ucxhl9zNfTZHm2OSLzAwvXKDYNnTh3At7u7yKPDVLcnrZofzv0r975EZq9x5sOkLyHM8vwZvJ/ErQeSOKg/XqtCDULFNniZQ3KOrDxdUJNFdrvNsIy3qcFdbVDbm/PvmHc6c8ODLM+RjaOaY5f8snmZlrk/ck8rSV3MACzzG8u8HZ25uF6y/klnuMDKOnmrAp5YlDkVqd+9Fs+iYuFtqKOhObOAN+laIpTkKrisu1asIPTKMXxN3BanNcdcU85/RcHyGX+6dXJgg01nX7Tl4/5fEcKmtrY5prGcnM/EmyXXMY9Gw5xNbhHv7C0YtDnNxIqKnkikQsB+/+AA4l1D4kiY7/8U1djfiRtVVC2UkyuPkxqrhVaB31nCi8Y6yOQwe1tXlvvbN52ELnrZGDjizu4U/b2/uxKfG3+PtuA531ydNc5n/wbDmoCIV3Edsxj4Lb/twKKrn3xwTN3Kyve0imFpUaRxwsCDy3In1wekh1BB3dP4LgbDWqVSKn4jS8yAcPmeP9ajQ2G3Odu+4O4WUwItEYGLVnuD85c769BaJvEui8mrQnybw/1NERsBR+u+bOhDPP41HIDR2rVl9W1zu7iuYeuyGvMa0ppUYcvOnBvdkifqlO4mIKhp4fW4gcfQkrh4Uxm0a1isHpBaGqujnGrnIzV+r0fNkdy24UfogMn//8GX9ZG5J7PXmam/4/bWcb29R5xXGNoXVgBJW/TdoX9jFOtbEycBLHXAL29cClk5wY0tDNvvVcWwKKlUROYiBSscLrGrUW6Q2hBLSZKBNDV9mQ6fVEszTCNrl2UkKoZMe1gUyO7EqeP7RU4svO81zfe/0a8tYHIUFIwuPf/Z9z/ud5ibu7NYsboAN7t/n3AwNmc6e5CF3HjRvHH3OMV5NOWhSlAYrKhRycidehyR6gVp/qnp8VwPX/appaV3DoP6CmtXyhKGWn1781orrFjuPTOXzQRnDXHPn+Wt+Z+4jcT6qnuWfxnz766tEfe97raT44CKN5UOI2PFLbG+MYZiGRU5ZoDWNrz2FrwqRliny0EqvwEUo76sL4Jj83LSyarmODTCr8in9fLrAlTrGNqHftVY9eCHfnhYfJRSIRyB7jD9zPagoSXXmae/HVo9/gH1YP5AaA3UGBnHpk5P0Yp2GDjz+i/fYSn8tjgyrr1cQzctq+tgLrx4YYiurkNEkq1n9AxE4idL1l8YrY7TeP6oPe7nGBHGYHypvA5DZXc3M1G3rw5g2Q+/tHA0h0g2azWWWuHTn0OMiys5tO3Rj9p7+s69LJshyDHZ2RKqsOxEo9LOmXIf/7HNwIofgxBgEhw6uut1hzuPvS61uGx84xke78ZusQv1fdj990fGPFvRtUIDbgna8je95rzoMDcrtrVbfnOG5uZhi948L8QztZqDYasEGZRQXDQNvXIDeJku1hGmoDTe9S/FgD0PVeRtiminp+Pc/Oat07PDrnAG8cGcqPyMQEfnfi16s0rTXf/EckB9BOwW91h3oqNjs7d7t2pFal3t2p+kRaQQJQB2SoIiB3oqXXxdEhFR+Ixr5/Qets1HJ7j6prCFUfpNKuuGjlo3UKuEmac+qR6vTWfcP7PuiewILjyf0LA9pSrUA8/+xInhyuD+BBDm2KzcVmVCO1ZmyEO+f32EUDQoGpCyBTl7MVY4MIXstqsTYVnPvWYiTW+iAog5yu5tBJP+ly9eYrRIHmeHD6er11bPgdvPHFk+vnydVsq1IgvvuMvywnkOt9EovNDKID30ILMf9bOzrTADOyZDhQWzqRay+aHUHRflqelNOr3dShdulSwWDSZFqzeO2yQPUcQvp1l53CEp0gOr0TQdPz7Jrqv/Rt78+z69/OE9pcpUD80FNE7viTTSc6dprNUvN1VNU2CUHgp2RpFKQZOfK+hRhgmoYEy6Qt9NKMliBHGjA5w+oWRoq+UzLtbWTSGQMKCaJ0Av4/X+bDVeImSA6Rq7eeu9PX98X42QmEbuK/PKGNlTsIiVxzJyI3MNihNpsLybUMosbekNA4vDw2qmgytJ/Kpb3etHwF7VfZ61WakhyXMhiWmeaIqv9MwvxMyXSgkVlI6tBUi/6ZnJzs1efjdcopaU4c1guvuVvP9DF4r1ogt7VyB1HzApMDV8KT402JRE69e/6vfjuwCbAZC10yFwKaCjLDOpisYS0lVkHZjBmOSxp061FvUEjIMwsBmBXkvKLogHj9w+XiFXW9U5Scnj/Q3+q+fwaHrECO7yLKwNX8opSc+e1CcuaOkT1JNqDJlqqN56ZLMI4FGVT8FS07lr3YNk+Cg2htWJ9KjUuZPME6AgvJA0Vmk0CiK96K0BeKDpHz+Vpb+868GTl79lkeUaVtr3JyR0FygyI58MNTsxpornbZS5sItOZqyXoD6RxtX+E6eln6odpSi0DO00CtYhuo5FtJyVeJU142B+VL/HoSMl1vYbSC5gqidcfNe0DOd9jtu94X6BfIbatYWmv+t0cgNyhF66CZb7+G3whq2ER7GTbEjZbHA4E4arzWbPspUwbIZTwGSrE2cvh5UkIGhikiD5VOakXhEZMksiRQIsQ8V0zufitCh0L2L4yAaHPF0lojtBA9B0/lJWdG8Qrdfu1bMY6dnRn9pV9RiVs64M3Kl7Us96rPoKhoIs4GEyEjSa2JG5gSNptTiJMCjO0gPIcmIT5gyv61FcgNDJ5wOl0u7IQLCsSxW0AO/fL53L5rAqKNFUur1EIczCuOrxDq4fdjweDVQyPDow2TRBm33EKASRgqcluxAilKl1zk2GA8ZTSsMdFRuoTXAQ5AmhgIL5fVOJh4PqkQdqgRTued2AkzeIiWvU69q4jch25ecxCxnMBoa6Wuteb516Xk0NipnoE+wlk7ojbPf1K8e4+4yRYcmkxbSd1aveIM0cwselPbRJenjaqwarz8o2YE5W+D3KvJFiQREJ4hs+CAQgYzV5D2h66LF/d9fP4SE7x7ZccYvNiWuv3Qt2Jy77x2WNCczx0WGL1e0ZR8V2yEeXDmqauxNw7VDqNkN/+unSjhxjZqkrskbms686qgFaZQMs6Gw+HgbMrjIVdwyKLSh8B7yuMMciRSbgPhUbK4t5FFT9uunXK5XHVTs4HI0PglLxf89MpJtBBeB/Ss5xA5rLlWH14RFm3JlmWRe3vm6oy6Nl9e538nBSvyITnWUcgN3X9YQhWvLIV0QxcG9+AloFsMhTzVzqcQlQ5DVK4RNFr6x/EpsgPhycHLMwndNN0L5Kx1HR0XNOiHcfOXND++pVeNqvadu9vq5jVXSG5LpX6/tPnC5A6dUO8U/FxLi5jm4Hn65RCnScovlVrSpF2CHfGqQKUMnmhyNhx++fnpl+EgFImoh6KXJ2Ki2rEqkV1aYoeLbluSbfRmLT0nELqmix3qm5rxcemuffDKlyf/dB/UdthXTK7m55Xs3A//KCOnQrlTIDd/VDlJiDkkHgBudlqaM0VHk0bFkrpbgptC64mmFsNh9ulpGIBuNhOKhii6aI+HqBaX4t0KaeFBDARgh2I2LYO6ICYVFLRpR2B25vheyGtW18Wd6qsMuuTK7xpGui9p3vT1XUfwfK2Hr/1MhLStkp17UUzOLAyRXCeFyQE3OuHVJPP9DKHMLynR7ZnFlMGG792sIOXhz28DbhkQ3IPPT+PxlFddqI2mSnRbeYmu5KOURSf2MkhiKN95sVEX77aAP5ZDBeGejO3TQ1qzOkfMN5mIsPd1fnxoYmj7F/fO3Dvsdre6n9VIhm5ztRZiz5GeYnIqidwkReAEJ2OZpGjHCeHQF2RkWRz8hJbkD9Etgx7+NMKmA26JuCA4Hh0XDC5Go1ETtYyyXUaUzrGofyYK2GU1Aaw7SrgHRCrs09+6GS/PTm9tqj+qeszg7ZvzeBciv+91vc937ZsCchuXaCGKyEm7X/PNQA6elTytSYDsyl8PSfnbMxyEmUlrsxHidS8JEv+3gptgFEHatKZQKlPCDauOCy6motFQA02t/PQ7cplZrZ8uYedd4NmReCj9D0+65jQB7hjWXdMxl2rsTn7PFe1CRIbwhusHfR9KkDYulxz0qxK5nkkoTMrEQlbppyvmZIK0+00JjgsmUh6Trq2hocGmRJe8FLsIG/pj/ouQGgmlssGmNZhAbclEPBjGleF0MTqosMlQNNpFvmqhvjzPQWBkAt4M6S8sC5gdilmFEpOzTWqb9HXOuyzDXRjbb82z+xSz6x7nN77QDuZ2TSG5rVWbLyDXKZArBAfk7MgMJbRVuGHZ7bL725NxaAMWM9GQsaury2gyGXRardZksliMFosJDYvRaOzyhKIpoLaIsXFPS7jhgA1z8UQUhaziFXWnohHWphsZkJiiiB3r8MZzdjupJOHRTZKuHS593a9jwO42YtfUdKx+tOVvAfSDOIbEcXZIgrR1qebr/6zdb2wT5x0H8Gna+mJBG8q7SXvTt7UE8qZFl1wiLiaJHRMMxTjBtbQml9S6U8O2xkJDsbKVKAOFojLk/LmoaFIQyYsoQwQpLjYkbamVOMzwxsrQwlzbXQZWPAn2ouukvNnv9zz357nz2YTCk0JNUNXj4+/zPL/f3flAub6ZGdNMxZMl/zh1pz6fH3hBvwDLxx2lu5B7kITZVirl8+VyAcZTmHgghYP+q4BouXQG2TK78cRIAoaZLrEGscuV4T/c8Dte9gIRLThbdjqMjwPQczpJaLLhD8FxnCS4/3oi6oJiuHM2055evIUVcNjVBrlbf2jAfXL5X6xcjeaLZk5f447pmTuEFxiUmm87/oz36PL15Wym2L6WQRm0SafT2WwulyvhyOWy2XSa/E46s7u7kqgYIwQxATP2QbZUQLteTqx1k5lQWajgxa/83FzZiB3h9Ofx/GuHLEqSW7z4DsqB3a35TPJK+FaXZjf2+eV7D23k9tdqvkxyx5jM9furbXTGp1nV7UDwbJWysOInEsVicW0tSccDY8Cv1tZ2d3eX4nGAiltGIq4CxiF2GWq3Fetwi+KebtHTP0iryAPbH20P4PLClHKefDs0jQ6Yso6L77iIXDR68NZkJnm9iZYozvAfV29+clmTM4oSaL/2KmfY9dFbDmsdqTFERdzKZpnNkkAU0RF+JFij+AoZS/ClDviO+puQvSKmNo12Gxsb3XvCU6sOHIKsFObW86Ls0GsnN3j6yflrRW74nS4XjbYenk2n59vIcndh+fb5T9+8d7kic3Zy/zPJaXBs5g7J1d3c2geltXJJkZ9mMyO2Q52R1GzJOlb0QezAe43Y5QtoF+vukF6AZ7hh5SHKnp2PkvV3FI7OCuKp4Dnslh2P8usThlw0erh1NpudbOtyDs5O94ytnv/sTXIH6eU3ast9q8sNn2E31mOmeq5a4Og77DYOWlKUfNpejeSJUZtYmiADXuh8SxqeYZeleLHYgIcn9WFVORRTB8ZOrpv7E42ddqAcvLHdz9bX8x//lpUDu6b57OZ4eHx+Onj16uj51eTneBckM1v32clpzdeh/jM2+4PWQ1hrAAaO4AlujlZLnLyRzlRxM9io2Tn4wn8sgEbw4kVcJDPpXL7wdAvwuns9vCCy4aPH0UCPRorwfCjER0g5CQU6n2tpr5cVtyEncVjSf3Bz/labThcmczb8eHP5wuz02NWrY2M9q0G80m+S21e1+dLkNDAjczOOVIWcBY68rZyEb7Ykyvl0wsbNzHbOPCYmzH5WPChTSmWCB5WiJ8Q5dD6BWS7cEs9H+EgkQqpvPFNXd7PlGcZOn8US2tUl16GQ62Jj5wp3jV/fXAa5sWCwJzh6e+zhvbdqy9EWgsgZkTNlrs9N5Yz72ph1jZFDOsCT5N7smmV1Y9wMtiF1GHx6/DQ9ghePF4tJdd6CHsGDKtvT4Q2F4P8ouTn9IQyAyXs9HTxHNwaoi7mdluR/ZEXSFhNJioRSP2tcvjl3rfUgK+caHBycv34FGv2enp7RnuDvV//LMn2vSvNF8PpNVbBuF+gTqsoRPeMlHBf8UQT5aVrfXrHUNdwmNLehimGN3xICMmseWfRg4iJfARvb2AD2JNie+Hv9fo/H4+/GMy+FrW4vp++oDVrscAnE2Urkfv7l4dZrc+2zjU26m8s5OH5h8gaRw3ure4Kr27Xl1JvnNLkKN5BrlmrKsUMiQ+FLSSNyxM2G7X1mVOPD9K3E1c02jiUiLQth5QPAPI7CFm1QCmVoTkrQ8XoFwfjsHqx2Mqx2yXpZZOTeuwSNazR9MxNt1OQWBwfHJ2eXr+BcHSV0n/69ttw/+/XMnTT1XT7jZYdV7oV0W1ro4M9L3cyT9H27YdXTBJdWdLwELbFJcZ1RO5QsdCbQmuBCuOXnoKJk4WhdXDf3QVlRkA4OjufFJ5fAqqkRa+DWNiZyRA7m6ugqyI29SG74lJa5k8eMrPkwa2pB13w/VW1vrRj4pkq8KJQyBlwVtgOWwfLVsKNLZ5GONfIjk4U5XMaPnimig+1q6DFxDqjtWrZDMvasuP2Kj04glqvt4I1M+m+t5DWRm1++EiRymDnmvCbK7bNtIU6R0B3R5+kxNnN9zW+n9tRAaNsbhm6DNBIIR9yMHcHOzBZP59Mm7YoWO0vBM7ICDXG5Hi+G6M8z0g+wgSxvnKIU1m/WY8+Ku6/77iWi5Yq2Nm2mN6NNLtwfYLLOX79GJusqhu7217X3VrWFgDF8RPUidgE9czPNp15CTuB4XuIFJZ9JUDjCNjT0YjY7vCHNTqUzcseclSqlc3Wcoj0bqkFwG3J6aeyQO7Zb8rIIRUvILV1U5dBucTM73xReVOV6aOamcZ3bixzJHMoFDLtm9SNMsN8OO1LCS9HxIcUPocOpCnA1Zmh1O1Py1EJFb8xGGLtENlvqxlNg7IOz9OaQ0wfGbtstw7E57oc1OBhdTbOby4thsszd0ORwtjLn0m17iG+NzM2Qx5QEwE77WZU7yaeEPacO5gfQ8XJdJpGANQ7h9oxmi2dg9vkCAAAgAElEQVSaseqUZSKXzeY9sHGyFab+kmNGxCHXt0NHwXlTx7XIOakdtA+TzkGUmw4yciyTTd/600N65qYoXEC7zEpD19c3c+a+ccG1cgGuoBMkfGOVfBHnKszUl1OzwdOqFMPOgMvkygP4CAEdS5MzsRE6XlaezRXkhpS6QbicTifiOV1d4zcmQW7+xrSRuWBmL3I0c1MBH341q3zwmtLNzBxPWaSqx87tbiBNUEjxZONa5A4c+M52lTPWRLebK591qHBqw0/prGw4eIdc154T5T8YcojnWlx0ucbHL8zOs5kLPjDL7a/RQkwF1Ecy+egqFwA7KjdM+y/rw/nsGgo6oO+OKHVrKxi57yrH2lXOWHV3yBVivMKwaWdKTGxSRB08BxvFTu9pJwOHoVt0YlFilhszye2vvA7x3GghTgc64ctH+Xwkc4FOlDtz5JepyoQ5qnexsNSFvGJD6RXlNDxmxup0dHcAOI96NZCrOiLGgKmglHfm26KMHBl0a11m5UyF8I9ry3V2dgZI0MiMDZDJC6mbmTlyPGU3N6ucN8G1RgqFQkosvXRu6NXkqJ15xiIdDV22LjagmN0iteUiIf7O01887orC6qapLcKXSY7QBS1yP7C/ZkhaiE4y1BkbUMMHjn0zR94TRLtFzV4OpwvHe71u8fkuzdwr0zGx04pi3B0ATnRgT7VXOFh/+dTddzevu8JOS+QuoNwVQ270DZbJ5kr1939llaNJUyOHv/ZNLTzy28oJptPquhsZIa9X9OfU0L0SHeINsXSq3Gd1sW4CR3YFjYkVY9c4AhfhvY6OE192PV52uqrJqdP1z1+b5X5UNXPDC0zmfFrk8Ds+38IXxzmH+YqD9SGuVjgMXcRRt6vWwQdelc5InSa39jx2lsDh+V/rQhexGVhmhrypf78LJdz4uMsEpxbC14zMmZovmztyjJNM/VOqXKc+T30B+q3TUwtPPJxgJydUg5MkCJ0Qyi+9HjoaOzV0uNCNFJ+fjTkckl6QuM1ulkmqjVAo9UOQc4UtkSP9PpWjdD1jX5nlrPfPffVIlRvunzra2dmoZ06NHLU7vfDF25zbNnQmOPbgJcnrDQmx3MTQ65ivauxo6EAuAXAbEVHCp8vqVxls48awwf7g5fjoO5Z9lUxWIjfNyP3G5PSTins26ek50u+fPnq08SgTOjVxjfi3in+88KTDXYOuAg6OH0Mn8XW7E0OvNXVkuiYS5e4ND56sFBzWN84UNxMcRK4jdfxDa0VCIqeXc0SuZ7TH1ELgR/ktLf83hww5/PtzGulS5zOWOfQ8CqHr5mrQ2cBFJDjOkNSrztfXREfl4olS70avyJHnGVvkqicO52oodfdDm8hRObpBqHKmQnhf5b3p3/xFhfs/a2fz2saZx3G61LtQyrLk1r/BYCOWLGPPoWPFPJpM7cNqFgVnDhZB64yJ1wEN2CI+OAoOgeAGwii7PeSSUnrYpgEdom2wFAjSIZILMiysiWFNIAEvVCyNTehhsdnnfZ63UZ22jyxZtoX9+KPv7+155nmea5+cR+BmJ4jqEkudRd+dvdP8s5eOTgdn4U57IAwqJ/XyL4kOWeuT/5S6lUs5i4Jz3kFyxfmMkVwSWjG5C2rxpa2HoBcJI81hcthez+NigoYHRG4c2uuzUsTL6Zyh6ZENRTIv9AfVerla/WXQEXKNf5/txqMquNNIzusc6ZKjbu7Bo8efC+ReyMWXtgaHDWxeu/bX8+PcXHGcoF4OgRtH6AaRRSejealAMykZHA9sMOsMgO0VD1p0cPPn53WIXL3xz7jbtZww54w6OjhLphYEAjhwKbiYTyPHQitBpxZf2rqvhNwnlNwsS04IuQlCbnz5TrOgkCMjE/zBUq0F9ToAlts7blR/FroVeEOPkFy1Wm88H8R7oRM6BsVZitYC1ATJLR7p8UFISubm8DQ1JqeUENpaQ7bVPCQ3OzEhiO58IjlMbnx5+SjKRZaAzVhkC24GdxzaazGutuhExE9VHWS3gjVXrTW+HVT2PKy404Ej7AIEbjTI6CmJkJTMcc3N3VfSOW1960dCOgcR8SChgYPk1mMnDNnVIynclCIRobOD3kGrXq39RHQrrFFw/4PgwB9COaoOB4fZBVhyn2bN5G7RpGSD+bnf78vpnLam+nuBHDq+FAdSTm6WGeu5qamp5ctNz7FDNv71I4pL+g4iAO21Vnt3dCsyOeTlILjCnu8IpYMEzkoBF2DJOUFm3gBOrlopOTmd09fx8+KLkZNUN8G9HD6uc3l60Ant0CwyRXJi772ce7ZM0L2zr1tJ2hgE10KK83O2JSRDiuLsNHBpXo6Rg6F1g4Pb0JISJbi+Ssj9/S8EEkaH2U1wyWHNTV2eWi11gjAcVlUbCkXYouJe653QEetcERuSXAsrLgosMYmTFWfkhrAFYNTCkkshh0KrQE4LrUpwlcjN8vNfYZhg8YKBm56anr58sxnlAnIBRBSdChwRneX1Xj5pnR4dNVNJcTANxopzQxDSC+IsMSFKdXG8LR4avVxCbo6TU0aE39f3yFHInePkILuJ86LiyDbF7aOOHfwIOdtW8087QKnJKdERuSmCQ+CutKpxvOeHIGBTgjlD8p3CDUqu487nU8ixqpXHhxtyUvKBvi+TSG4ZnQw+LrBj4MjRRNPTk/CjXeh4QSSQk4YidEtlzxy/d/KkTtGZp1+JgZo83AoeKWmVu/GeG7nAGnW0eQeT4DwRnGcvjlzPphrrLTqUzkZK5n6t1PvqXmBv2SDTLiIHtXVuStDdeAKOkJtcbd/2IoB5aNoi6GzVQ5PnkeWfrT6pDUUnCM6kuHIFpiOh69raXGokB1WKCjaODUpu8Y/XM0OMFQaIv20k45ob+0q9r+4/J5C7s0xPNTmXHHeNLHWcckPbY09CdLtOALxAMkfyENiBbRsiG/nSiopxrVETDPaKCEzSmRobsI87qcRdz3ZdkHOsYV6CwKKNSg+yc5zsfHY4ubsJOXlc83eGPQ/fXmPknjWXoahEdOOS4Ag42NoDB19nam5GN4O/l/N6LMBq6AyOTQPX63btwHXdwAmHgAskcAgdvKPebpHwYAAnJyVEcheu7msBQg4RieaeNdeRI0sOhEkER6IDxobs9WbR8QHqVPK2ypRSeI76vYOGGd3KMHDwZdXWca8bRx4E52I3EdnmqBSYyMEHsHj2ej6VnFjvY3BPLzzXA4QcIhi5XURudZKfL3GOtCkFHIoRq+111/Nd4JnbECleKvVeNsQAKzk7s9yQ4MZqCFyBgHMDYfgjJfUVu4MfQMe+OD9Ecji0SuS+NQQIqYqA5D6mmrtDybGzOXibJsGBNvik3Yxc30VLMAE4LTv0n1mjMSzD6inojNjwZGu9dtDrFiPMDb9j0giInoho4Dyns309DRyrvdBICTXWp08vvNYqCKWKEDR35zIjN61yE8BheO2jyPcZO6ARlPovostZBRGdYLArY6mCK7fGupWua7uUHEh+qTF7Q39U6lAALDKEPpTcI5KU4IuEn37zj9daBaE4OpbPIXK3VycVdMlBHQI5aK8324PAx+zQqgS5eYkHlNjh/9GJir2TRp2RS9Dp5JjiavXjShzj2EDJgSFegfxl6c0MQA7Wq5lUcGZyLwxuTnJ0+wo54VQTgZqkOJSaQHResUjYuRI/z2TCnF3keB5BJ6juiimB45ZahZZaCD30Byi4hMkwbqgr5GVOh4Fjl30J1BI3R+f3sbF+c+OFyc1Jju77rwVyM4SRBG16mhywI5nr5fbNrlvE7Bg8RtA1ej+muigMOr1qEmDT0BFuMKaexJWubzEY8Ncb3avo3AjipB8WBJeXbFUjhwfnvriborn3zGeS0FVfjBwJAeiBaI1+VkSHav/2wCWL8yE7X4LnpsoORQnQ6RfM6MYUDwcFVz8+G3eDiHET3huuKLWRl3F0INc5nE831SU+70VHSojmnt54pWdziqP7gZNr3kabwyqNiG5ShQc9Ybs98AsFys7XxKfRo+gihC6A6Kpp6JJLv1rlPZTFRaLiZN8A0rixPni5ziCvgMuaZgwfPf6CJ8KQnFhCfGA+e+ktPsj8Y3SoIiI3w0Q3mchPDhAzFN1qu33k42VXpQSewE/73xg6G2z1O2WKTgqxK6yawDDrjZO4sFewAiBILtG1y70qkh8QwKE+0G4gcJnskOAgzBiykRJETixbP0w572sfJXS7EjktIBCrJdzwS/CrVmfah6VCBbIrlWR4BJ8eMQg7iK7T34JhQkcnXDBXbcDst9B1JXBA9grc62F2wGN0eSdgsXq0OQScFCAScnIJ8du0M+Y+wra622xCcmsLeBtnHRzkRO9ko2dMGKJrFkoxZYfX/KnwqMvjXilB1z9utKqSxUrXaLYa5fizS74XeprgXAVf4vqAgA01EHmH+eyawk2MD4KbE8ndmHtudnPSBNjba/j82GZzHZFbYJtgz8wITm8VwVvlomM/XJ1s3+6W4riAFksWqPS4+hKflIQMqroQRP3+mXoDr6jWR52goba++2zLwRHTKDgVHmHHuBV90gm3iMFlUgSXyQrkHuOVrYzcxmtl2suYl/wKHRjbHBnZ3l6D5BZmlKboD++oyB5gDTszKFWg7AqcXjGh5yrZHoMHw0QQLPY7J41GVZvCXhmD3I4h2cgFnkFxPr+5rhzVOTjSSn5pBIOT20M5OiTkPt9IBpmEsfT30s9v/eFrKDgIbmcH6nrBwI46NkFzC4gbft1ku31YgDk+2k6I4hPhGcMtRBeGARjt99/UGg12ZeIVGltrjTri1gF+ktOK3MiH5Bd8E7eCH29jU2XZh0F0Dxm5Lx8J5OT5m/fTD/jeH9ltIm4P0XoKjM5Eb0bSHHoBe117vVuIMTuKj3k92WxFeMhgQxBu9fsvyw0Ij12sU67WW1XEbSvwgZdUdBI3f1gj1EowcrnxWn4tAacaaqI5MsSE3Byfv5m7/yLNWCVzffEnDA7+CvgHGDqFnfgl2iyQ3FHbXGjPHJ6BshPhMXq+b4aH0hMiu37puIzWwaFtXurVk+M3EGff8jk4NwHHuKWzww4Ocyv4g838Gg0OS0vkLoDLUsPF5FiAYOTgs1dpxioPDO+s7+z8C5Ygt25dzJDsh7NjxNbQszVGjvwYc4MNPmwfxWcSdgI8pLuiZFIurzGCAHgwyEKP9ubg+OXLNwdnIoRtywE+MOvNl7kVhRv5hLlBx1vyD/MZtloEKysvCS+b0cltbNCrcebm7l99lWas8uUl/92G4O7de/DVV7cuXlwS4fE2wzVGhba5wMAhdvnN9aMY647iE9kVxWRPzpJdHziIFm+LHdstusDk4GRsCBPzaUJDgosrfjxCshECLg9vS6KrI2vlsg8zQu11l5BD4OauPk83VnkeZ2nn3oMHX/4GNsiO6prQ25ToMWqbRGscXR5+5Ef24lhgV8HolGir265b9N3IQWfEO04UuD7ZtE7N4AxqM4HDhhqXikdZbqk0fiJ6ierQT9A6Obn2+j9rZ/Pa1JrHcYVpIiLO/B3diJydOzsWHFQYUmlINqcLrTCkZtlAoQ0hNETaC5mSBoZzC5aYhcnI3YSWMiQMQsfSCgG5XjJyC9OKi0tx0ULX83t5Xs85ee39njZpaqz68ft7eZ7znOeIAgGPzlf/uZte4fo9Rdiiq6ur9QKyoz+CoPCTbTdTMfEJ6NaQ3YHfeLNGoxc+yDUIzIS3bSHZzMQ190wKuGVmMhNr80tGqCZBgp+PXONusLRirnO+9w5W3wnrLwhtdXUXjiiyY3ixGJkpRs/Eb21qDT9sdHSgXPDdgYJnsJvVwwzLfsGGzEfsYY8qEEBG2LA9mpshw+niAOBSeMQ0OQaH5BpYF8tELuHlua4CPl1ab4SQs1bmnNZ36a7MeIPh1RqxA8WSMZ/Ag2v0KViS42ICHKBz7yI7OA7MoM3M+tOeL3xnZlS/YZeDIDWDm8lsFjeohEB9mMEMp8GR35KxVJIC1jAdBWsjpchVLHKR0DFr6L1IP63utKR2o1AqCi4oybLYGV+tGaZkJd1srHOO8A4MeKb7bPPx9jbDycCmzCZ+aAa5wUhmZu5ifk1wE+BSSI34xVS88hxAQ3mOS6uXjwtyCVVab4aSsxbSHVdbO1K5FlSKej2LciVAC96ayVG9dJP07qxL7CS8jCGLni+7z/RjaFdSCU5yI23Mzjw8w1GDvlw6JaCJeFWprqGDVZEr5T2xJh3SXbtnMxdyf8PIFkIT+HK70Vq9LukxQF/krlnYJDtGl4WgvRDsCN5GgN6zUHo2xrlgNcC5QCtGyW+zGKczc2crovlVxYGRSTE8Ml3DICcnhGWw5uOJvT71IXizue7qjqFctRmNLi8v1+vrpFB6gQCOJSW7rNs4/y8gk1GL+DZ6RG5vgH5mc77cRimU8tvMs4vDmMXNcJztOvTcVJAcBWsOyenx/o0e5HyXRnxtGeTAsjkoFltbW8skya8nPgYHB4NDxQ4R3oGGZyW+jB8fIQxSfBbkNmsIfxJzW1vygzO52Z0Jmo7JiQlhLK2CXCInC8TtXuD8y9S/qmjdye/kUXGAh/QEPiZI9hOJz3yUT65ml43pqDXoBeuGzc9G6ZcPG3CbvThc44K65AvVpE1PoGvoNNfA0iqm0plcPp7zTnuOH66F34/0KK89h/I8+I8A6yE+AigYMj7iBy4TglcudHRcJgjbehbfiOVCymAXQq8fwaDZGBx4cUNyMx1nW84GB+GqpJsSSS6Rizu9xw+9bpL+0bMs55EwcBEfivrlVeIny4fL9RcVk48MTio1cX4RRi8YuT0JBn6dfhM4MnNxfjivdt/jbmQqDJxGR+SmGv7Syj0JkfvYtyUJv9d319OWI2xpQU/uZydbPoC4FV02qi8hxAf+RFcKcGBRN9Wx6IXmvQA/3tJwNkSMbS5zdn64NKU2LVwKTXIQBMkiHKq4Uo3Q4IpyvI+OM8ld7wcuuB9CxEmj4XaAW5rlGSInqg09aMAB/lP81vmwJfNjttiT3kamj/vC9MzCNmWKQ9XglgRqkl6R0cHQQZOTBSKRY8upxdV/6EvuRvD+wXttBw2H0Jy0IYWSXxinO1pcR5Yt8ct163tArzHB+CSujY2NHv7rB3HjAIIUXdZRvKb0LK8Vo5R36YsiMlQNsZgO/iwKRF6TE3uA3bpxbTTTge322m0HoDmktF+OIUAoJrX4zDgnwi0tzXFLFedsofi5AwCBICJEQkYyy6hBgUJnvIQG8ezs4nyiE4vdxek1a5ocRqZ+aHwUXbfA4JLSdqTPRaqsuHLO02ku4Q1huTDTEbt9gGdAStPRSxTReTkXLRCKgiIIhtBEhIXPjQ5ARIoXZ2cUwZz4aTpgjqY/MtTVnAGwi/PziYlOI2WMqA0PWcyUki4OwAtusuAWFD76TUXMcYWCHHrlc0wuLvYAG2S5UNNhzHYt4w2ntESoz75JhEZl9rlRtdlQWZLJBpAULJHmBT4BrokOnidJiqJtcLFl8EqKQXTBJWLZQpa/IHiAj1Uo44wuzpN4cUlOnPcaZLkepkOdADwHvNcOidIhGKY904jxuEqJvohetvOjWVuydnNjMQtX0tWBSsxEwS/gBz64hQLxo5MuBXQcTweLLEeiNDfYcr1Mx/Ai3Q9eG+m1jYTnOKNCTOvKrBao6e5QO3HZz9GESXXbbIE0LvaYnd3EAJrsVsjyR52fClKU45rVkspy5Lqj4SzXx3Qibr93T7qXe9N7+/vtfQdMKPLeOBS1GT3V3Mj20CSpc2LUdmLWhOe3oAHPlZHqkt8IHHDL1oWYXv01gavE5QQTRQbtfDCM5fqazkJ4EjmJXHbxFiNsw/aVIUqECRXLrZYvK67qpOjrE7Pr2V7xq1yH3IgaYINDfNQLzI9OWjUrUEw1ObEv6TCWC7275iCGJ5FI5PKSbsyCVpQYx0Jo5ES5OiFnedHCRz2inQldN5xfgZNcltgxMq0ygKvXlqOruwAunY9LdDzDdH04cGG3nRsa4mQXmmbPcQDdPklacUSKyroGRFmfW7t2WbETIAcueiqogoxTONbrfi1HAVwrnk97uortHA0csfaZMhlJHyrVarPZrFYrpe18HlgBwrayotFKXzEhtjRAP0RhQs2GUhoclBfhu+t1PQw0RjnRLXAcgEvrlThxWhbxp2HBhd1fc1jPbZcqFWT3TggYVoAhpI50GyEiQFmcrxrNqqaYqdCeO1Sqqwd+DpZs7M/JcY5nXA/8ccC8XP/J4eF1WgJKpSoQqylyaED0ILqwlEjkPYxlhwCqaB6zrPhbbU6IcqgS1tH0Eo1rdjHHOY6nfxxvUnJ7eHCDOpNe6pZKpUqzVma9hlpVE/SQG6hEwqft7QTEMvw9/dE8Tpvom8GhE6U5Y9Qc3Ros4NYicGlPei7H++IM15GM2Jn4wVWqtTIMYaitLPIwEIczGh4iIwmE4jsexEgaRyj7bSMhjtvfOHL2hicRWyE9tg0NVzMgtzz+UWlPzVoMO+66UmeC4KrN1ziMKSrhpCHe3IMmC98J4yl42xoiIaygESEhem2v3TZS4rgQ09aYT7bZNkYBDe+bwdzM+R5eVn19NHBjFImv78qSWqoo5lpp7RjeEXWK9ufFDl1GrcRmAiQfyl+Gf6/jtam9YSvapXmcQV/ajGQWQMMTgzhxa06VcYE4HrE8jFckPr0ul4XPUjjFyqvGaFGsWty51CjitKEM3JIBDF6UAhLvyVNVcdoiJUojjtlpy0kwbBDpHEFwlhGHrblc4nhyxPIgisRo8frr6zIYTsxKi3tUMDfrMqfH81Mcu82mCN2e8oU0PZI5PAebxLbVJI6dEn06ggPBQfR+IHDXb4xMbrSRxK9oOKK2JE+hLCG3Fy/VRbFyQTaeJuAT6YofJjlbofREThRvoJyYdhTE/f0rDPlsy0FVlVcC37w2hkaI108CXEfdZ4wWrz94+fLlHd+l/2JpMd2gp1DWdRcjuCqeTXzbJT86mQ3pvdwv0njF0+MVpDgmRK7KcsHc7XHAjRCvvwG4FE7fHqIWDxdB9xgcoLujrmNXlwEsYdXgK6y4b6nJphkhQudsIfRnv4oE14ShSg3yq6hMBV4yCBR50GeNmr2hKPJ7Psp1JOPE6ij19bdUuSi5vUIhucUH95HbwoK9q4669gQLLpVcgU8BVGq+kyh9oSyhATWNDWsTpVi8yVmxiBfRfD2J0EziNDL8374oKwJhOowZBr6zF+m3nPr37IdPnOISgANsK6wXqPsMbvPJE7VDjJHsxOUnhI/pFXlOVqkGHGvSi1WtJhkNmAE0Kkpy4aBeGtJo4FmscvmLHEwfn5x0u2o6FqSnY9SplTY5dK8bOZ6cnByw6Ot3mjQ5mX6zV37ZIW4/gFYWgBiQu4PkNhcEuT/7Nta59/jeY8N8d1MKn6mAE2uCGRtNdoy8TJ4TbKezhOzwvGn5H8G/7HGEIF6yEfdh3CIabufo6Gv3dHIyZA+hseL11hDgpqffTH/ZZGygzR8WFjC7EbjNv0hylunk9cSED9e3m9d4FE1JfFJlQU002lPz8/I6KsieIMq0eGbsc2OpvD3df047Eul2v9PH6enpsf8Nt/54BXKDW5PjadRPb778/e0Pb1mbm4AOwd1ZeLsA5J7IfTlt09E/9v3794/vLS4CPVqjbaw8UmfdJb2yAU1enUHYeFeQB4vwc15hsiB2hy86pb03P11eYabx5rUraVBrMj0t0P3849O3b58+ffSIyD15gpZ7tEnk7ph71ml079/fW/n3L9++Pf/r354///btl3+9esxXWpiLQiwXpiQ0dSUa7SDAO27df/CCkgWyW9lc+QLc4C92Mja421cDN6g1uZyW6P7z8z9/fPoU0W0COgT34v/MnU1oG0kWx7VhFTK7M7O5OYthZthD2Jtks32QWTZIah2MJcc9aCEELBgapUFY2j6sMbQCukQYDaEhBtlMGB0UpXVoJNOs8cXoIgyxkHUQY9zWIJJDAjrMIezJ561XVf2lr1ja+OM5YAd8aP/0f+//XnV1tRrFDCPOs9dY/FB29jCb6cXnmxAMg7815+O9egae8rEejHKeVGA+RWU+62hyg0D1ogZfGTWqtxSFXNi06KZtSC5Y6s7x50rRdTsFSi6JTSIpLSVt5GxHTLLZw9QZYGPm7cFgevWNw7A161oAbY88mucwOI54S0GlrdVqaiFzoinGdYWmA/f/FblPlrqPO62QyY6iw+Sw5CQe/bRILcI6SQyJLpvqDWCz6CV6wqE17Rr4wjad9R2xRQ5l9KQIOJ7vWheF4vw6itwnuroPm+l0/sS8TE2ZRegwOQTOH/UukYpnnpVIz2DLsmfMcGyEHdPk6mzW3zfw2mXm95idDjmWEf6HPi2ETi24G3ZuKG5PAe73rs8SI7q6d8Wc3ha2j08P6KVqyhcdALe8iMAlvaVtojnzQFhQXZDNyvEmw82PC6YZl0VEOmidP2bIy378YtCAS9ABuaUtJLhQX0xe6u5+HnCjXKKb09HkkFELtW7oCLPTNHeBSE5IPVjlbeQMdh4xiwRnycuMPnZNpi6akMihgZ7+CBoNIkWHJpYtuV9w+LLeX7k7jHWJt3kMDnVxhU70VMPslDdLW9gf/NG9ElafoTlf0AcmIQZ7puAYRwzIrieKnjEBAjYzmaBL/rt9oAxyU5SDq3eHMeh+XUtTcFGeL3VunWB2qCMGcihXvdHt7YfLxlnrQRAdUlwqYVY4Ziw5DmVscDQ6H5AjiiPLpyiTI3/La8oANS3UOs2/nYjcZwQ3xGDfay09hcDVAJwkSZ2O+yR0pBydbkGy+qU9CVW85WXrmHrQnJgimcoMcBtEN881VzziOMmJAM44x4L1+/6x68hUDWELtU66erut5z9eta2ONthzVIiLS8jLCDjMrtY9aGTWQXLbqzEewC0vWset+3xikCMljhkCblB1XJNLDkUHnwKQE48rxUkAAAskSURBVMUsaVkAnf8HOzhNOdIOTrpuWZWP2zqKD1dtq6PQ3YaipnRR/0bBFSSer1a3ttbxuC/tlaJOyQE4Md4clqcj0HEIHTMKHQWXzRqnpCz8s2h1lihHW6dudD3RWgbGf6S602sD55xg3xvDalXC5AqSxBf4aHRrHVc5dTUmLT2l4Ax0QfGsOT+WHNNPDkl0CDofLnKiiNGFyXwR9gWMbkRD2LpuqVOSeDhcyn0sH3cbBxed/b92uS4V3bk5rJaqJFcLPI/nByK5VUtyZraKUcMcGOYi7DiMLhERR1Q5orlD/D7CQNj3s2IY6WmbL5XQR4kCoYvK3ZYGcrx9beBsHfFt25zfqeJUBcVFSS+HJOeVaJWzJCcumn0cMzYc6BLN+IBN4Fy1yOHjbhZyIQ3LrfFSLhQAmiSdQT7weku7+Ox/93LAue7cteeqOXFJOFV5Ao5I7hG/9HB52aG44IoN3MVkR1TXE4ODijPKXPbwOZzVnVsoashLQ6/a61tLsNhF0JVK7oatUXn3SXB3XJeL7tzh/e6OkasEHEiuGv1pmZKjmjOL3ChnHZ2wZ32iA2cVqeYOEbnHuc3NucC/tNCL9N9/SMrbBrlqhz+daPa/PHAU3XtHs6mE6iWeN3KVSA75w8Nlh+bEbQvJeMkx/S7BMLI4xFmDpuYeb+aL+cBcee0/HlZAsyuQQ+g6pdmDvlHs/NrAEXTnima/IKVRqtokxx57vY94ag8Wud6wYfWCoos7hlafx1bnDgm5cjE3txB+kt4QUkmCTurUGspEs//lggN0v+6/aoXsF4VKnQlOWJyr7cWqA1VOtUlufgJ080PylXAzNfccyJU3c2uBQHphg4hOrVa72rAR9t21gUPxdm3juN09sNgpB9FCFK+hI3IL7Zg3Jj1dhhfSR8xWzmfaw4V019fXMY6GuF9zmNxukaDD5GS1Gm0cDa6ZKNqr0ytuR5wxUzlWC/ysudIfOjqtkvs2KSGSc+/FSnD/YZG8I9do5QaWLy+Obn4e+evgAEG7EkqunAd06TBGV8gcHA3qTWvtVkYNsFcCDqE7rtUlcHyFVGDtQN0iRU5Y0B94vdLTZDJJ3i08UOWmQucUXdDRzz1/vgZPQe8WCTogt9XuX93U8GDRruTz5Q9XNHKNQFerI9fvlNwtwk7Ryaqc4Nls78ViBZBcJBIZZqwXRecsdg7RGdZK6tzh8+8fbxZ398vFfC43B+jWdUeJgzUTNP2/PD6u6Pl8sXud4Fyub4AcapiQ7pBZHIXwCklKEDbKdURuiSguYrzLb4jkLmCx9paYsc2vvqCjzuF0Le6+hk1NWHTJtE1xmFqjq2fkTLui6whd+bfLXlYaH9/e4mEylEpVd/fkpE3BeXK6N+atbpObhRH6ttJghGOmAOeYw+yiMyRHstUgt4/Q4XxdfKZY2EKNrvtMKkRl2DJRAXLF/nz98k+uK417t8hMzReqBVhaSoLiPLvuvUdeiYIzyIl8cxpuFjtohy3RBT1Ba6nENFd47AdcopLeeGPO/iez9VKnU0KDv4xXm4jonPn6uysGhxq7//J4dFDpAokgsP7ALpofvFKEgDMlEm9OQ81BjmvWxf4yZ9Q5Qm4HoQOXCPifHSm4sulqFdZMUGByBrpi+ePVtnGD8R0Gp9KZS/Bv+Iv6aizmjXpSNnI+UXaW+ynJWYOEOXwZmkMWUd7fwfmKSl060HjTOtXlrQId/FFy1Cg6XOqK+++uwxscPlEDcEkKjl1Y2EfNXMyrCqmUTXO2WX9qctDTUdFRf/CLrKk5MNf9HRNd2LOR/Gl9WyY3lwAdr9ZkE51NdF/+wXVNcc9NFSdgcGv7KFljsSTSnL2HMJKVmRicXauG6MgI4bfXOUrOQIdK3YaAt/PRVROUGyA6Cx0V3dWXOFux+7OluHC4nPciyT1ICbDx0AgxOc/YyDHTkmOaqmgahOjQHJgrPAz6mhpsJZ2GnXQWOlRU7KLLl/EO6q/vuK4zvgFMyB0WFtKB15Csq5IgwI5NQ3JifWp/cNZH2pgEyT1q0VbnSFuy04cOy07FS06oqKiyXXQn15mpZsbO4lQNPwls7kAbvMqzgkeAnYCUXK/J0Zv63KTgnM5CGhPaBts1N2eQ26G9Cerq0hum7FQA5yS3++E6M9XM2Bm4Y5yeC+y+foCydTXKCngLJWwFgb8yznBGTNsJU9HVDXKADXMjQwQmB4+T4FK3S2YJKHYCUZ1KyFF0YK/lv7puRHz7BUrVubUXXQQOWSuLhgm87QjgiTJnjzF7v0bf7bcPr/jTQNxYkTXA4bVNTO6FZbCVAC52JrmabBNd977rhsSdmcraXPGZvgfkZFYgG7YwPfGMSSQSXIKDf+PhjQ80R8Atf5KsLK1y2cMnDnID6CBdZSo5k9zMHdfNifsvc69/dv8Sg6bEtqMS/ZE9IAfw7MrjpgCH5wjSzbE4WYlBPCFdSRmftPDCLHW5SoWKTlbp4waU3Ox9142KOzOvntV+gaZEsHYJ4jLHrawMsuMm50bHfrKHyZy9oMx9D+PX/j6cUYFFB2NYLldpp4+x6Ex2mNyNEhzd7tSAPnhVYv2sTXLJRGIFYlB3E4PjmDgtcwY4Irm5x4/JewngcXaCDuWrTh5Eyzg1N3vPdRPju0fQlMAWSvMVzWJ9foVGItEvvcm4we/LIpGcYa1hYhB2ci9ovuo6fhTtR9mKjHvGdUPjq788Wo2Gbe/KRQZhkjPRTQTPKIycVegscIfYINYschY6Q3Q/ZixwM1+5bm7c+6MaZq33DCOD4FbiKyuD9D6ZuJxNbDQSzTORbA52SA7IFU1yr6i/YtFhdJTdDU1U2zimsxY6NthLxOMIXXwovAQ3QaBfZnqiXXJhUuYscjv/a+/8WdsGwjCuoQGDCBktKFyEBpMUQmnBSzbTjBpO3tpdHY4SvHe+oVAMGUrnmn6MLCaLR0OpTDHdgofiD9F7733vfDrLMulkyX1kjCzJy4/n/XMndMI1FYzpivkcH4FU7E5YcPDqdOfWc6PbnOcgnldZL8NWT+xBSFeIrM9fjt7QUzwypUHr8MM7fPelXkRrgvEKpnPQnRxgRa1m99Enh77LK3IeYrNwHI72t9lV3+PRACx3Q56DlxeB5UrkKF6/YbzOD7MTqWenyI0NOKJXQc46T/g+sx99Ei7tTyU+lkPBipVVk3PCFdDpkUShXdcgbpbdQN4Lh9tOdoTPOG7jRUSWmfOivwBy2nI2WCvITe5oEFYUVw3jZvKdnIqS53K+mx3ByYSLz7pNi/dXQE7qYE1TAIfB+sUnd4fxumwgN82OXU1L0bqzzFYp2z7EX69uRhirKU6TYGV1yAG6txSvP1kzueEEVJLndey4qMdX4sZ5lg8kzAZqy4HnXpXIfXdWafv6pxc0W6dxWItun/UUMdgM51tJ5YGm5hQ4u9aOXidrMpspcLOLs6AFOk/WXp3IPXgC3ceJlEWG3BxlYyB3DYXVsVyJ3K8Xs8de0BaVjOdb7ikS9w9UHqSxnE/u8VknaJWiUtTyf+Gn/iam8tp0wQ9oOViUQ68GA+R+XERBC7UF7ynUcFPkpGIHsaotZ9Kc9lxLsRl4lPN4RaWo56b7G7HQzVxK44fhJlh/txkbdXnnjvX2wyOzkbIFDh9SbOaGGKzLbq8THIdOmaXHyXu53dx9vxkUK53l3ks9vwTgll12FhyXlPecbsWzGC+VEic5rjY3qD9/ujwer23nPRYnoVdw3aZvawBCnisuuywKjl4dzc8bamxB01qHz4FZ5z+0cvaLGIvjJFEU10qISikM1bE4Ziw6pFswfwGNfu4t4blEogAAAABJRU5ErkJggg=="
}(GameConfig||(GameConfig={}));var SoundConfig=function(){function t(){}return t.prototype.attrs=function(){return["id","soundName","coverKey","soundType"]},t}();__reflect(SoundConfig.prototype,"SoundConfig");var AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,i){function r(r){e.call(i,r,t)}if(RES.hasRes(t)){var n=RES.getRes(t);n?r(n):RES.getResAsync(t,r,this)}else RES.getResByUrl(t,r,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var core;!function(t){var e=function(){function t(){}return t.MODULE_SHOW="core.EventID.MODULE_SHOW",t.MODULE_HIDE="core.EventID.MODULE_HIDE",t.SOCKET_CONNECT="core.EventID.SOCKET_CONNECT",t.SOCKET_DATA="core.EventID.SOCKET_DATA",t.SOCKET_IOERROR="core.EventID.SOCKET_IOERROR",t.SOCKET_CLOSE="core.EventID.SOCKET_CLOSE",t.KEYBOARD_DOWN="core.EventID.KEYBOARD_DOWN",t.KEYBOARD_UP="core.EventID.KEYBOARD_UP",t}();t.EventID=e,__reflect(e.prototype,"core.EventID")}(core||(core={}));var core;!function(t){var e=function(t){function e(e,i,r){var n=t.call(this,e,r)||this;return n.moduleEnum=i,n}return __extends(e,t),e}(t.EventData);t.ModuleEventData=e,__reflect(e.prototype,"core.ModuleEventData")}(core||(core={}));var core;!function(t){var e=function(){function e(){}return e.run=function(e){egret.ImageLoader.crossOrigin="anonymous",t.FrameEventCenter.getInstance().init(e),t.LayerCenter.getInstance().init(e)},e}();t.Core=e,__reflect(e.prototype,"core.Core")}(core||(core={}));var core;!function(t){var e=function(){function e(){this._gravity=.8,this._speedupRunner=Matter.Runner.create({}),new t.MatterUtil(this),this.stage=GameConfig.curStage(),this.engine=Matter.Engine.create(),this.engine.enableSleeping=!0,this.world=this.engine.world,this.world.gravity.y=this._gravity,this.runner=Matter.Runner.create({}),Matter.Runner.run(this.runner,this.engine),GameConfig.openMatterDebugger&&(this.render=Matter.Render.create({element:document.getElementById("matter-debugger"),engine:this.engine,options:{width:GameConfig.curWidth(),height:GameConfig.curHeight(),wireframes:!1}}),Matter.Render.run(this.render));var e=new egret.Timer(16,0);e.addEventListener(egret.TimerEvent.TIMER,this.p2Step,this),e.start()}return Object.defineProperty(e.prototype,"gravity",{get:function(){return this._gravity},set:function(t){this._gravity=t,this.world.gravity.y=t},enumerable:!0,configurable:!0}),e.prototype.p2Step=function(t){this.updateWorldBodiesSkin(this.world)},e.prototype.updateWorldBodiesSkin=function(t){for(var e=t.bodies.length,i=0;e>i;i++){var r=t.bodies[i];this.updateBodySkin(r)}},e.prototype.updateBodySkin=function(t){if(!t.isStatic&&null!=t.displays&&0!=t.displays.length)for(var e=0;e<t.displays.length;e++){var i=t.displays[e];i&&(i.x=t.position.x,i.y=t.position.y,i.rotation=180*t.angle/Math.PI)}},e.prototype.speedUp=function(){Matter.Runner.run(this._speedupRunner,this.engine)},e.prototype.resetSpeed=function(){Matter.Runner.stop(this._speedupRunner)},e.prototype.clear=function(){this.resetSpeed(),Matter.Engine.clear(this.engine),Matter.World.clear(this.world,!1)},e}();t.MatterScene=e,__reflect(e.prototype,"core.MatterScene")}(core||(core={}));var core;!function(t){var e=function(){function e(t){e._matterScene=t}return e.addOneBox=function(t,e,i,r,n){var a=Matter.Bodies.rectangle(t,e,i,r,{isStatic:!0,restitution:1,friction:.1,angle:n/180*Math.PI});return Matter.World.add(this._matterScene.world,a),a},e.addOneBall=function(t,e,i,r){var n=Matter.Bodies.circle(t,e,i,{isStatic:!1,restitution:1.1,friction:.1});return Matter.World.add(this._matterScene.world,n),n},e.addTriangle=function(t,e,i,r){var n=Matter.Bodies.polygon(t,e,3,i,{isStatic:!0,restitution:1.3,friction:0,angle:Math.PI/180*r});return Matter.World.add(this._matterScene.world,n),n},e.removeBody=function(t){t&&(Matter.World.remove(this._matterScene.world,t),Matter.World.remove(this._matterScene.world,t))},e.addBody=function(t){Matter.World.add(this._matterScene.world,t)},e.setTimeout=function(e,i,r){function n(){s._matterScene.engine.timing.timestamp-l>=r&&(e.apply(i,[s].concat(a)),s.clearTimeout(n,i))}for(var a=[],o=3;o<arguments.length;o++)a[o-3]=arguments[o];var s=this,l=this._matterScene.engine.timing.timestamp;return t.TimerManager.instance.addTick(16,-1,n,i),n},e.clearTimeout=function(e,i){t.TimerManager.instance.removeTick(e,i)},e.clearTimeouts=function(e){t.TimerManager.instance.removeTicks(e)},e}();t.MatterUtil=e,__reflect(e.prototype,"core.MatterUtil")}(core||(core={}));var core;!function(t){var e=function(){function t(){}return t.ceil=function(t){return t%1==0?t:t>0?t+1<<0:t<<0},t.random=function(t,e){return Math.random()*(e-t)+t<<0},t}();t.MathUtils=e,__reflect(e.prototype,"core.MathUtils")}(core||(core={}));var core;!function(t){var e=function(){function t(){this.m_factorys={},this.m_mcFactorys={}}return t.prototype.getMovieClip=function(t,e,i,r){void 0===r&&(r=!0);var n=this.m_mcFactorys[t];if(!n){var a=RES.getRes(t),o=RES.getRes(e);n=new egret.MovieClipDataFactory(a,o),n.enableCache=!0,this.m_mcFactorys[t]=n}var s=this.m_factorys[t+">"+i];if(s||(s=[],this.m_factorys[t+">"+i]=s),s.length>0){var l=s.pop();return l.gotoAndStop(1),l}var h=n.generateMovieClipData(i);if(h.mcData){var l=new egret.MovieClip(h);return l.gotoAndStop(1),r&&(l.anchorOffsetX=.5*(l.width+2*h.mcData.frames[0].x),l.anchorOffsetY=.5*(l.height+2*h.mcData.frames[0].y)),l}return null},t.prototype.revertMovieClip=function(t,e,i){if(i){i.gotoAndStop(1),i.parent&&i.parent.removeChild(i);var r=this.m_factorys[t+">"+e];r||(r=[],this.m_factorys[t+">"+e]=r),r.push(i)}},Object.defineProperty(t,"instance",{get:function(){return null==t.s_instance&&(t.s_instance=new t),t.s_instance},enumerable:!0,configurable:!0}),t}();t.MCFactory=e,__reflect(e.prototype,"core.MCFactory")}(core||(core={}));var core;!function(t){var e=function(){function t(){RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this)}return t.prototype.onResourceLoadError=function(t){this.m_groupData.curGroup==t.groupName&&(this.m_groupData.curGroupLoaded=t.itemsLoaded,this.m_groupData.curGroupTotal=t.itemsTotal,this.m_groupData.curResItem=t.resItem,this.m_groupData.onLoadFaild&&this.m_groupData.onLoadFaild.call(this.m_groupData.thisObj,this.m_groupData))},t.prototype.onResourceProgress=function(t){this.updateGroupData(t.groupName,t.itemsLoaded,t.itemsTotal,t.resItem)},t.prototype.onResourceLoadComplete=function(t){this.updateGroupData(t.groupName,t.itemsTotal,t.itemsTotal,t.resItem)},t.prototype.updateGroupData=function(t,e,i,r){void 0===e&&(e=0),void 0===i&&(i=0),this.m_groupData.curGroup==t&&(this.m_groupData.curGroupLoaded=e,this.m_groupData.curGroupTotal=i,this.m_groupData.curResItem=r,this.m_groupData.onLoadProgress&&this.m_groupData.onLoadProgress.call(this.m_groupData.thisObj,this.m_groupData),e==i&&(this.m_groupData.loadedQueue.push(t),this.m_groupData.loaded=this.m_groupData.loadedQueue.length,this.loadNext()))},t.prototype.loadNext=function(){var t=this.m_groupData.loadQueue.shift();t?(this.m_groupData.curGroup=t,RES.isGroupLoaded(t)||this.m_groupData.loadedQueue.indexOf(t)>=0?this.updateGroupData(t,this.m_groupData.total,this.m_groupData.total,this.m_groupData.curResItem):RES.loadGroup(t)):(this.m_groupData.onLoadComplete&&this.m_groupData.onLoadComplete.call(this.m_groupData.thisObj,this.m_groupData),this.destory())},t.prototype.destory=function(){RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),this.m_groupData=null},t.prototype.loadGroups=function(t){this.m_groupData=t,this.loadNext()},t}();__reflect(e.prototype,"GroupLoader");var i=function(){function t(){}return t.loadGroups=function(t,i,n,a,o){new Date;if(t){var s=new r;if(s.loadQueue=t,s.loadedQueue=[],s.loaded=0,s.total=t.length,s.onLoadProgress=i,s.onLoadFaild=n,s.onLoadComplete=a,s.thisObj=o,t.length>0){var l=new e;l.loadGroups(s)}else a&&a.call(o,s)}},t}();t.ResUtils=i,__reflect(i.prototype,"core.ResUtils");var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.Progress);t.GroupData=r,__reflect(r.prototype,"core.GroupData")}(core||(core={}));var GameController=function(t){function e(){return t.call(this,ModuleEnum.GAME)||this}return __extends(e,t),e.prototype.show=function(e){t.prototype.show.call(this,e),this.startTick()},e.prototype.hide=function(){t.prototype.hide.call(this),this.release()},e.prototype.startTick=function(){egret.startTick(this.onDragonBonesTick,egret.MainContext.instance.stage)},e.prototype.onDragonBonesTick=function(t){return"undefined"==typeof dragonBones?!1:(dragonBones.WorldClock.clock.advanceTime(-1),egret.Capabilities.engineVersion<"5.0"?!0:!1)},e}(GameControllerBase);__reflect(GameController.prototype,"GameController");var core;!function(t){var e=function(){function t(){this.m_callbackMaps=new Dictionary,this.m_sendBuffer=[]}return t.getInstance=function(){return null==t.s_instance&&(t.s_instance=new t),t.s_instance},t.prototype.addEventListener=function(t,e,r,n){if(e&&r){var a=new i(e,r);a.messageID=t,a.index=n?n:0;var o=this.m_callbackMaps.get(t);o?(o.push(a),o.sort(this.sortIndex)):this.m_callbackMaps.add(t,[a])}},t.prototype.sortIndex=function(t,e){return t.index-e.index},t.prototype.removeEventListener=function(t,e,i){var r=this.m_callbackMaps.get(t);if(r)for(var n=0,a=r.length;a>n;n++){var o=r[n];o.callback===e&&o.thisObj===i&&(o.isValid=!1)}},t.prototype.sendEvent=function(t){this.m_sendBuffer.push(t),egret.callLater(this.sendAll,this)},t.prototype.sendAll=function(){for(;this.m_sendBuffer.length>0;){var t=this.m_sendBuffer.shift(),e=this.m_callbackMaps.get(t.messageID);if(e){for(var i=e.length;i>0;i--){var r=e[i-1];r.isValid||e.splice(i-1,1)}for(var i=0,n=e.length;n>i;i++){var r=e[i];r.callback.call(r.thisObj,t)}}else egret.log("事件ID:"+t.messageID+"无监听回调")}},t}();t.EventCenter=e,__reflect(e.prototype,"core.EventCenter");var i=function(t){function e(e,i){var r=t.call(this,e,i)||this;return r.isValid=!0,r}return __extends(e,t),e.prototype.clone=function(){var t=new e(this.callback,this.thisObj);return t.index=this.index,t.messageID=this.messageID,t.isValid=this.isValid,t},e}(t.Callback);__reflect(i.prototype,"EventCallBack",["core.IMessage"])}(core||(core={}));var LobbyController=function(t){function e(){return t.call(this,ModuleEnum.MAINUI)||this}return __extends(e,t),e.prototype.getLoadGroup=function(t){return["delay"]},e.prototype.preShow=function(t){},e.prototype.show=function(t){GameManager.getInstance().rebornCount=1,this.lobbyLayer||(this.lobbyLayer=new LobbyLayer),core.LayerCenter.getInstance().getLayer(LayerEnum.UI).addChild(this.lobbyLayer)},e.prototype.hide=function(){this.lobbyLayer&&this.lobbyLayer.parent&&(this.lobbyLayer.parent.removeChild(this.lobbyLayer),this.lobbyLayer=null)},e.prototype.release=function(){t.prototype.release.call(this)},e}(core.Control);__reflect(LobbyController.prototype,"LobbyController");var LoginController=function(t){function e(){var e=t.call(this,ModuleEnum.LOGIN)||this;return Facebook.init(),e}return __extends(e,t),e.prototype.getLoadGroup=function(t){return[]},e.prototype.preShow=function(t){},e.prototype.show=function(t){var e=this;this._loginLayer||(this._loginLayer=new LoginLayer),core.LayerCenter.getInstance().getLayer(LayerEnum.UI).addChild(this._loginLayer),"undefined"!=typeof gmbox&&BatterInfo.instance.init(),Utils.isRuntime?BatterInfo.instance.init().then(function(t){game.BattleManager.instance.init().then(function(){gmbox.loadingComplete(),e.startGame(),game.BattleManager.instance.ready()})["catch"](function(){game.BattleManager.instance.postResult(game.ResultCodeEnum.PLAYEVEN)})}):this.startGame()},e.prototype.startGame=function(){Utils.isRuntime?GlobalManager.getInstance().goGame():GlobalManager.getInstance().goLobby()},e.prototype.loginWx=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},e.prototype.hide=function(){this._loginLayer&&this._loginLayer.parent&&(this._loginLayer.parent.removeChild(this._loginLayer),this._loginLayer=null)},e.prototype.release=function(){t.prototype.release.call(this)},e}(core.Control);__reflect(LoginController.prototype,"LoginController");var LayerEnum;!function(t){t[t.BG=0]="BG",t[t.UI=1]="UI",t[t.POPUP=2]="POPUP",t[t.MENU=3]="MENU",t[t.LOADING=4]="LOADING",t[t.HINT=5]="HINT",t[t.HINTSEC=6]="HINTSEC",t[t.TOP=7]="TOP"}(LayerEnum||(LayerEnum={}));var ModuleEnum;!function(t){t[t.NONE=0]="NONE",t[t.LOADING=1]="LOADING",t[t.LOGIN=2]="LOGIN",t[t.MAINUI=3]="MAINUI",t[t.GAME=4]="GAME",t[t.GAMESETUI=5]="GAMESETUI",t[t.COMMON=6]="COMMON",t[t.BREAKLINE=7]="BREAKLINE",t[t.LINK=8]="LINK",t[t.NOTICEANIM=9]="NOTICEANIM",t[t.NOTICE=10]="NOTICE"}(ModuleEnum||(ModuleEnum={}));var WhereEnum;!function(t){t[t.GAME=0]="GAME",t[t.LOBBY=1]="LOBBY",t[t.LOGIN=2]="LOGIN",t[t.GAME_OVER=3]="GAME_OVER"}(WhereEnum||(WhereEnum={}));var MainLoadingUI=function(t){function e(){var e=t.call(this)||this;return e.m_pResNum=0,e.m_pResGroupsCompleteCount=0,e.m_pResItemCount=0,e.m_pResItemCompleteCount=0,e.skinName="LoadingUIExml",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this);var e=new Date;console.log("请求ssssssssssssssssssssssss======== ",e),EventUtils.logEvent("launch_loadingUI"),this.left=this.right=this.top=this.bottom=0,this.m_pProgressImg&&(this.loadWidth=this.m_pProgressMask.width,this.m_pProgressImg.mask=this.m_pProgressMask,this.m_pProgressMask.width=0)},e.prototype.setProgress=function(t){var e=t.curGroupLoaded/t.curGroupTotal;this.m_pProgressMask&&(this.m_pProgressMask.width=e*this.loadWidth)},e.prototype.show=function(){core.LayerCenter.getInstance().getLayer(LayerEnum.LOADING).addChild(this),core.LoadingManager.getLoading(PreLoadingUI).hide(),this.updateAdaptive()},e.prototype.release=function(){},e.prototype.hide=function(){this.parent&&this.parent.removeChild(this)},e.prototype.updateAdaptive=function(){},e.prototype.setGmboxProgress=function(t){Utils.isRuntime&&gmbox.setLoadingProgress({progress:t})},e}(core.EUIComponent);__reflect(MainLoadingUI.prototype,"MainLoadingUI",["core.ILoadingUI"]);var PreLoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){},e.prototype.setProgress=function(t){},e.prototype.show=function(){core.LayerCenter.getInstance().getLayer(LayerEnum.LOADING).addChild(this)},e.prototype.hide=function(){this.parent&&this.parent.removeChild(this)},e.prototype.release=function(){},e}(core.Component);__reflect(PreLoadingUI.prototype,"PreLoadingUI",["core.ILoadingUI"]);var GameDefine=function(){function t(){}return t.RANKBASEVIEW="RankBaseView",t.GAMEOVERBASEVIEW="GameoverBaseView",t.REBORNBASEVIEW="RebornBaseView",t.LOBBYVIEW="LobbyView",t.MAINVIEW="MainView",t}();__reflect(GameDefine.prototype,"GameDefine");var GameManager=function(t){function e(){var e=t.call(this)||this;return e.rebornCount=1,e.scoreManager=new ScoreManager,e.baskectBallManager=new BaskectBallManager,e}return __extends(e,t),e.getInstance=function(){return null==e.s_instance&&(e.s_instance=new e),e.s_instance},e.prototype.pauseGame=function(){this.dispatchEvent(new egret.Event(e.PAUSE_GAME))},e.prototype.resumeGame=function(){this.dispatchEvent(new egret.Event(e.RESUME_GAME))},e.prototype.gameover=function(){this.dispatchEvent(new egret.Event(e.GAME_OVER))},e.prototype.restart=function(){this.dispatchEvent(new egret.Event(e.RESTART_GAME))},e.prototype.revive=function(){this.dispatchEvent(new egret.Event(e.GAME_REVIVE))},e.prototype.refreshGold=function(t){this.dispatchEvent(new egret.Event(e.REFRESH_GOLD))},e.prototype.updateRankComplete=function(){this.dispatchEvent(new egret.Event(e.REFRESH_RANK))},e.PAUSE_GAME="pause_game",e.RESUME_GAME="resume_game",e.RESTART_GAME="restart_game",e.GAME_OVER="gameover",e.GAME_REVIVE="revive_game",e.GAME_TIME="game_time",e.GAME_COMBO_PROGRESS="game_combo_progress",e.GAME_COMBO="game_combo",e.SHARE_DIFFRERENTGROUPFAIL="SHARE_DIFFRERENTGROUPFAIL",e.REFRESH_GOLD="REFRESH_GOLD",e.REFRESH_RANK="REFRESH_RANK",e}(egret.EventDispatcher);__reflect(GameManager.prototype,"GameManager");var GlobalManager=function(t){function e(){var e=t.call(this)||this;return e.where=WhereEnum.LOGIN,e}return __extends(e,t),e.getInstance=function(){return null==e.s_instance&&(e.s_instance=new e),e.s_instance},e.prototype.goLobby=function(){this.hideAll(),core.LayerCenter.getInstance().getLayer(LayerEnum.POPUP).removeChildren(),core.EventCenter.getInstance().sendEvent(new core.ModuleEventData(core.EventID.MODULE_SHOW,ModuleEnum.MAINUI)),this.where=WhereEnum.LOBBY},e.prototype.goGame=function(){this.hideAll(),core.EventCenter.getInstance().sendEvent(new core.ModuleEventData(core.EventID.MODULE_SHOW,ModuleEnum.GAME)),this.where=WhereEnum.GAME},e.prototype.goLogin=function(){this.hideAll(),core.EventCenter.getInstance().sendEvent(new core.ModuleEventData(core.EventID.MODULE_SHOW,ModuleEnum.LOGIN)),this.where=WhereEnum.LOGIN},e.prototype.hideAll=function(){core.EventCenter.getInstance().sendEvent(new core.ModuleEventData(core.EventID.MODULE_HIDE,ModuleEnum.LOGIN)),core.EventCenter.getInstance().sendEvent(new core.ModuleEventData(core.EventID.MODULE_HIDE,ModuleEnum.MAINUI)),core.EventCenter.getInstance().sendEvent(new core.ModuleEventData(core.EventID.MODULE_HIDE,ModuleEnum.GAME))},e}(egret.EventDispatcher);__reflect(GlobalManager.prototype,"GlobalManager");var ScoreBaseManager=function(t){function e(){var e=t.call(this)||this;return e.totalScore=0,e}return __extends(e,t),e.prototype.updateScore=function(t,e){},e.prototype.reset=function(){this.totalScore=0},e.UPDATE_SCORE="update_score",e}(egret.EventDispatcher);__reflect(ScoreBaseManager.prototype,"ScoreBaseManager");var SwitchManager=function(){function t(){}return Object.defineProperty(t,"switchs",{set:function(t){for(var e=0;e<t.length;e++)this[this.keys[t[e].key]]=t[e]["switch"]},enumerable:!0,configurable:!0}),t.openborn=1,t.lookVideoToShare=0,t.differentTime=2,t.shareTimes="2_5_8",t.shareProNum=30,t.seeplay=0,t.isShowBanner=1,t.keys=["openborn","openborn","lookVideoToShare","differentTime","shareTimes","shareProNum","seeplay","isShowBanner"],t}();__reflect(SwitchManager.prototype,"SwitchManager");var ToastManager;!function(t){function e(t){var e=this;if(this.checkNext=function(){i.removeChildren();for(var t=0;t<r.length;t++)i.addChild(r[t])},!i){i=new eui.Group;var n=new eui.VerticalLayout;n.gap=10,n.horizontalAlign=egret.HorizontalAlign.CENTER,i.layout=n,i.bottom=GameConfig.curHeight()>>1,i.horizontalCenter=0,i.touchThrough=!0,i.touchEnabled=i.touchChildren=!1}core.LayerCenter.getInstance().getLayer(LayerEnum.TOP).contains(i)||core.LayerCenter.getInstance().getLayer(LayerEnum.TOP).addChild(i);var a=new ToastPanel(t);r.push(a),egret.Tween.get(a).wait(2500).to({alpha:0},500).call(function(){r.splice(r.indexOf(a),1),e.checkNext()}),this.checkNext()}var i,r=[];t.addPopUp=e}(ToastManager||(ToastManager={}));var UserManager=function(t){function e(){var e=t.call(this)||this;return e._maxScore=0,""==GameConfig.gameType&&(e.uid=GameConfig.testUid,e.avatar_url="",e.nickname="test"+GameConfig.testUid,e.gender="M",e.openId="test123456openId",e.userInfo={uid:e.uid,gender:e.gender,nickname:e.nickname,openId:e.openId,avatar_url:e.avatar_url}),e}return __extends(e,t),e.getInstance=function(){return null==e.s_instance&&(e.s_instance=new e),e.s_instance},e.prototype.getNickname=function(){return this.nickname},e.prototype.getOpenId=function(){return this.openId},e.prototype.getUid=function(){return this.uid},e.prototype.getUserData=function(){return JSON.parse(JSON.stringify(this.userInfo))},Object.defineProperty(e.prototype,"maxScore",{get:function(){return this._maxScore},set:function(t){this._maxScore=t},enumerable:!0,configurable:!0}),e.prototype.setUserData=function(t){this.avatar_url=t.iconUrl,this.openId=t.wxOpenId,this.nickname=t.nickName,this.gender=t.gender,this.uid=t.userId,this.time=t.time,this.token=t.token,t.thirdUid&&(this.openId=t.thirdUid),this.userInfo={uid:this.uid,gender:this.gender,nickname:this.nickname,openId:this.openId,avatar_url:this.avatar_url},this.dispatchEventWith(e.USER_DATA_CHANGE)},e.USER_DATA_CHANGE="user_data_change",e}(egret.EventDispatcher);__reflect(UserManager.prototype,"UserManager");var core;!function(t){var e=function(){function t(){this.m_callbacks=[]}return t.getInstance=function(){return null==t.s_instance&&(t.s_instance=new t),t.s_instance},t.prototype.init=function(t){this.m_stage=t,this.m_stage?(this.m_preTick=Date.now(),this.m_stage.addEventListener(egret.Event.ENTER_FRAME,this.onEnterFrame,this)):egret.log("Stage为null不能开启帧循环监听")},t.prototype.onEnterFrame=function(t){var e=Date.now(),i=this.m_callbacks;if(i){for(var r=i.length;r>0;r--){var n=i[r-1];n.isValid||i.splice(r-1,1)}for(var r=0,a=i.length;a>r;r++){var n=i[r];n.isValid&&n.callback&&n.callback.call(n.thisObj,e-this.m_preTick)}}this.m_preTick=e},t.prototype.addFrameEventListener=function(t,e){if(t&&e){var r=new i(t,e);this.m_callbacks.push(r)}},t.prototype.removeFrameEventListener=function(t,e){var i=this.m_callbacks;if(i)for(var r=0,n=i.length;n>r;r++){var a=i[r];a.callback===t&&a.thisObj===e&&(a.isValid=!1)}},t}();t.FrameEventCenter=e,__reflect(e.prototype,"core.FrameEventCenter");var i=function(t){function e(e,i){var r=t.call(this,e,i)||this;return r.isValid=!0,r}return __extends(e,t),e.prototype.clone=function(){var t=new e(this.callback,this.thisObj);return t.index=this.index,t.isValid=this.isValid,t},e}(t.Callback);__reflect(i.prototype,"FrameCallBack")}(core||(core={}));var SoundBg=function(t){function e(){var e=t.call(this)||this;return e._currBg="",e}return __extends(e,t),e.prototype.stop=function(){this._currSoundChannel&&this._currSoundChannel.stop(),this._currSoundChannel=null,this._currSound=null,this._currBg=""},e.prototype.play=function(t){if(this._currBg!=t){this.stop(),this._currBg=t;var e=this.getSound(t);e&&this.playSound(e)}},e.prototype.playSound=function(t){this._currSound=t,this._currSoundChannel=this._currSound.play(0,0),this._currSoundChannel.volume=this._volume},e.prototype.setVolume=function(t){this._volume=t,this._currSoundChannel&&(this._currSoundChannel.volume=this._volume)},e.prototype.loadedPlay=function(t){this._currBg==t&&this.playSound(RES.getRes(t))},e.prototype.checkCanClear=function(t){return this._currBg!=t},e}(BaseSound);__reflect(SoundBg.prototype,"SoundBg");var SoundEffects=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.play=function(t){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(i){switch(i.label){case 0:return[4,this.getSound(t)];case 1:return e=i.sent(),e&&this.playSound(e),[2]}})})},e.prototype.playSound=function(t){var e=t.play(0,1);e.volume=this._volume},e.prototype.setVolume=function(t){this._volume=t},e.prototype.loadedPlay=function(t){this.playSound(RES.getRes(t))},e}(BaseSound);__reflect(SoundEffects.prototype,"SoundEffects");var SoundManager=function(t){function e(){var e=t.call(this)||this;return e.bgOn=!0,e.effectOn=!0,e.bgVolume=.5,e.effectVolume=.5,e.bg=new SoundBg,e.bg.setVolume(e.bgVolume),e.effect=new SoundEffects,e.effect.setVolume(e.effectVolume),e}return __extends(e,t),e.getInstance=function(){return null==e._instance&&(e._instance=new e),e._instance},e.prototype.playEffect=function(t){this.effectOn&&this.effect.play(t)},e.prototype.playBg=function(t){this.currBg=t,this.bgOn&&this.bg.play(t)},e.prototype.stopBg=function(){this.bg.stop()},e.prototype.setEffectOn=function(t){this.effectOn=t},e.prototype.setBgOn=function(t){this.bgOn=t,this.bgOn?this.currBg&&this.playBg(this.currBg):this.stopBg()},e.prototype.setBgVolume=function(t){t=Math.min(t,1),t=Math.max(t,0),this.bgVolume=t,this.bg.setVolume(this.bgVolume)},e.prototype.getBgVolume=function(){return this.bgVolume},e.prototype.setEffectVolume=function(t){t=Math.min(t,1),t=Math.max(t,0),this.effectVolume=t,this.effect.setVolume(this.effectVolume)},e.prototype.getEffectVolume=function(){return this.effectVolume},e.CLEAR_TIME=18e4,e}(egret.EventDispatcher);__reflect(SoundManager.prototype,"SoundManager");var Config=function(){function t(){}return t.getConfig=function(e){var i=egret.getQualifiedClassName(e);return t.s_configs[i]},t}();__reflect(Config.prototype,"Config");var LocalData=function(){function t(){}return t}();__reflect(LocalData.prototype,"LocalData");var SoundUtils=function(){function t(){this.m_BGMVolume=1,this.m_effectVolume=1,this.m_sounds={},this.m_channels={},this.m_callbacks={},this.m_playChannel={},this.m_soundGroups={},this.m_soundGroups[egret.Sound.EFFECT]=[],this.m_soundGroups[egret.Sound.MUSIC]=[];var t=egret.localStorage.getItem("soundEffect");t&&(this.m_effectVolume=parseInt(t)),t=egret.localStorage.getItem("soundBGM"),t&&(this.m_BGMVolume=parseInt(t))}return t.prototype.playSound=function(t,e,i){void 0===e&&(e=1);var r=Config.getConfig(SoundConfig),n=r.get(t);if(!n)return void egret.log("ID为"+t+"的音效在SoundConfig中不存在");this.stopSound(n.coverKey.toString());var a=this.m_sounds[t];if(a||(a=RES.getRes(n.soundName),a&&(a.type=1==n.soundType?egret.Sound.EFFECT:egret.Sound.MUSIC,this.m_sounds[t]=a,this.m_soundGroups[a.type].push(a))),!a)return void egret.log("名称为"+n.soundName+"的音效资源不存在");this.m_playChannel[n.coverKey.toString()]=a,a.cover=n.coverKey.toString();var o=void 0;try{o=a.play(0,e)}catch(s){return egret.log("ID为"+t+"的音乐播放失败"),void delete this.m_playChannel[n.coverKey.toString()]}o.owner=a,o.maxCount=e>0?e:Number.MAX_VALUE,o.count=0,a.type==egret.Sound.EFFECT?o.volume=this.m_effectVolume:o.volume=this.m_BGMVolume,i&&(this.m_callbacks[o.hashCode.toString()]=i),o.addEventListener(egret.Event.SOUND_COMPLETE,this.onPlayComplete,this),this.m_channels[a.hashCode.toString()]=o},t.prototype.onPlayComplete=function(t){var e=t.currentTarget,i=this.m_callbacks[e.hashCode.toString()];i&&i(),e.count++,e.count>=e.maxCount&&this.stop(e.owner)},t.prototype.stopSoundByID=function(t){var e=this.m_sounds[t];e&&("bgm"==t&&this.stopSoundByID("carbg"),this.stop(e))},t.prototype.stopSound=function(t){var e=this.m_playChannel[t];e&&this.stop(e)},t.prototype.stop=function(t){var e=this.m_channels[t.hashCode.toString()];if(e){try{e.stop()}catch(i){egret.log("停止播放音乐失败")}e.hasEventListener(egret.Event.SOUND_COMPLETE)&&e.removeEventListener(egret.Event.SOUND_COMPLETE,this.onPlayComplete,this),delete this.m_callbacks[e.hashCode.toString()],delete this.m_channels[t.hashCode.toString()]}delete this.m_playChannel[t.cover]},t.prototype.setBGMValume=function(t,e){void 0===e&&(e=!1),e||egret.localStorage.setItem("soundBGM",t.toString()),this.m_BGMVolume=t;for(var i=this.m_soundGroups[egret.Sound.MUSIC],r=0,n=i.length;n>r;r++){var a=i[r];if(a){var o=this.m_channels[a.hashCode.toString()];if(o)try{o.volume=t}catch(s){egret.log("背景音乐音量设置失败")}}}},t.prototype.getBGMValue=function(){return this.m_BGMVolume},t.prototype.setEffectValume=function(t){egret.localStorage.setItem("soundEffect",t.toString()),this.m_effectVolume=t;for(var e=this.m_soundGroups[egret.Sound.EFFECT],i=0,r=e.length;r>i;i++){var n=e[i];if(n){var a=this.m_channels[n.hashCode.toString()];if(a)try{a.volume=t}catch(o){egret.log("音效音量设置失败")}}}},t.prototype.pauseBGM=function(){this.m_BGMVolume&&this.setBGMValume(.01,!0)},t.prototype.restartBGM=function(){var t=Number(egret.localStorage.getItem("soundBGM"));this.setBGMValume(t)},t.prototype.getEffectValue=function(){return this.m_effectVolume},t.getInstance=function(){return null==t.s_instance&&(t.s_instance=new t),t.s_instance},t}();__reflect(SoundUtils.prototype,"SoundUtils");var Utils=function(){function t(){}return t.setAnchorCenter=function(t){t.anchorOffsetX=t.width/2,t.anchorOffsetY=t.height/2},t.distance=function(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))},t.lineIntersectSide=function(t,e,i,r){var n=(i.y-t.y)*(t.x-e.x)-(i.x-t.x)*(t.y-e.y),a=(r.y-t.y)*(t.x-e.x)-(r.x-t.x)*(t.y-e.y);return n*a>0?!1:!0},t.sideIntersectSide=function(e,i,r,n){return t.lineIntersectSide(e,i,r,n)&&t.lineIntersectSide(r,n,e,i)?!0:!1},t.getAngleBySide=function(t,e){return Math.atan(t/e)*(180/Math.PI)},t.setRichText=function(t,e){if(t)if(e){var i=new egret.HtmlTextParser;t.textFlow=i.parse(e)}else t.text=e},t.hitTest=function(t,e){if(null!=t.getBounds&&null!=e.getBounds){var i=t.getBounds(),r=e.getBounds();return i.x=t.x,i.y=t.y,r.x=e.x,r.y=e.y,i.intersects(r)}},t.checkLength=function(t){var e=new egret.ByteArray;return e.writeUTF(t),e.length},t.pointAmongAngle=function(t,e,i,r){var n=i-t,a=r-e,o=0;return 0==n&&0==a?0:(n>=0&&a>=0?o=180*Math.atan(a/n)/Math.PI:0>=n&&a>=0?o=180*Math.atan(Math.abs(n)/a)/Math.PI+90:0>=n&&0>=a?o=180*Math.atan(Math.abs(a)/Math.abs(n))/Math.PI+180:n>=0&&0>=a&&(o=180*Math.atan(n/Math.abs(a))/Math.PI+270),o)},t.arrToArr2=function(t,e){var i=[];if(t)for(var r=void 0,n=0,a=t.length;a>n;n++)n%e===0&&(r=[],i.push(r)),r.push(t[n]);return i},t.throttle=function(t,e){var i=null;return function(){var r=this,n=arguments;clearTimeout(i),i=setTimeout(function(){t.apply(r,n)},e)}},t.getQueryString=function(t){var e=new RegExp("(^|&)"+t+"=([^&]*)(&|$)","i"),i=window.location.search.substr(1).match(e);return null!=i?i[2]:null},t.timestampToTime=function(t,e){void 0===e&&(e=!1);var i=t;e&&(i=1e3*i);var r=new Date(i),n=r.getHours(),a=r.getMinutes(),o=r.getSeconds(),s=n,l=s+":",h=a+":",c=o+"";return 1>s/10&&(l="0"+l),1>a/10&&(h="0"+h),1>o/10&&(c="0"+c),l+h+c},t.secondToTime=function(t,e){void 0===e&&(e=!1);var i=t;e&&(i/=1e3);var r=Math.floor(i/3600),n=r+"";10>r&&(n="0"+r),0>=r&&(n="00");var a=Math.floor((i-3600*r)/60),o=a+"";10>a&&(o="0"+a),0>=a&&(o="00");var s=Math.floor((i-3600*r-60*a)%60),l=s+"";10>s&&(l="0"+s),0>=s&&(l="00");var h=n+":"+o+":"+l;return 0/0==r||0/0==a||0/0==s?"":h},t.getGoldText=function(t){t=Number(t);var e="",i="";if(t>=1e8){var r=t/1e8;return r%1==0?e+r.toFixed(0)+"亿":10>r?(i=r+"",i=i.substring(0,i.lastIndexOf(".")+3)+"亿",e+i):(i=r+"",i=i.substring(0,i.lastIndexOf(".")+3)+"亿",e+i)}if(t>=1e4){var r=t/1e4;return r%1==0?e+r.toFixed(2)+"万":10>r?(i=r+"",i=i.substring(0,i.lastIndexOf(".")+3)+"万",e+i):(i=r+"",i=i.substring(0,i.lastIndexOf(".")+3)+"万",e+i)}return-1!=String(t).indexOf(".")?""+e+t.toFixed(2):""+e+t},t.getShortName=function(t,e){this.tf.size=e.size;var i=t.split("");this.tf.text="";for(var r=0;r<i.length;r++)if(this.tf.text+=i[r]+"",this.tf.width>e.width)return t.slice(0,r-1)+"..";return t},t.setChildrenVisible=function(t,e){for(var i=0;i<t.numChildren;i++)t.getChildAt(i).visible=e},t.getBitmapVal=function(t){var e=t.toString();return-1!==t.indexOf("-")?(e=e.replace(/0/g,"a"),e=e.replace(/1/g,"b"),e=e.replace(/2/g,"c"),e=e.replace(/3/g,"d"),e=e.replace(/4/g,"e"),e=e.replace(/5/g,"f"),e=e.replace(/6/g,"g"),e=e.replace(/7/g,"h"),e=e.replace(/8/g,"i"),e=e.replace(/9/g,"j"),e=e.replace(/\./g,"o")):(e=e.replace(/\./g,"z"),"+"+e)},t.getHVCenter=function(t){var e=null;if(!t)throw new Error("组件不存在，不能取到中心点");if(isNaN(t.horizontalCenter)&&isNaN(t.left)&&isNaN(t.right)){if(!t.parent)return;e=t.parent}else e=t;var i=0,r=0,n=0,a=0;return isNaN(e.horizontalCenter)?isNaN(e.left)?isNaN(e.right)||(i=e.right,a=GameConfig.curWidth()/2-i-e.width/2):(i=e.left,a=i-GameConfig.curWidth()/2+e.width/2):a=e.horizontalCenter,isNaN(e.verticalCenter)?isNaN(e.top)?isNaN(e.bottom)||(r=e.bottom,n=GameConfig.curHeight()/2-r-e.height/2):(r=e.top,n=r-GameConfig.curHeight()/2+e.height/2):n=e.verticalCenter,new egret.Point(a,n)},t.bezier=function(t,e,i,r,n,a,o,s,l,h,c,u){void 0===h&&(h=15e3);var p=new egret.Point(e,i),d=new egret.Point(r,n),f=new egret.Point(a,o),g=new egret.Point(s,l),m={get factor(){return 0},set factor(e){t.x=Math.pow(1-e,3)*p.x+3*Math.pow(1-e,2)*e*d.x+3*(1-e)*e*e*f.x+e*e*e*g.x,t.y=Math.pow(1-e,3)*p.y+3*Math.pow(1-e,2)*e*d.y+3*(1-e)*e*e*f.y+e*e*e*g.y
}};egret.Tween.get(m).to({factor:1},h).call(function(){c&&c.apply(u)})},t.getTexture=function(t,e){var i=new Image;i.avaliable=!0,i.src=t,i.onload=function(){var t=new egret.Texture,r=new egret.BitmapData(i);t._setBitmapData(r),e(t)}},t.gray=function(t){var e=[.3,.6,0,0,0,.3,.6,0,0,0,.3,.6,0,0,0,0,0,0,1,0],i=new egret.ColorMatrixFilter(e);t.filters=[i]},t.highLight=function(t){var e=[1,0,0,0,50,0,1,0,0,50,0,0,1,0,50,0,0,0,1,0],i=new egret.ColorMatrixFilter(e);t.filters=[i]},t.setImageColor=function(t,e){var i=function(t){var e={r:-1,g:-1,b:-1};return e.b=t%256,e.g=Math.floor(t/256)%256,e.r=Math.floor(t/256/256),e},r=i(e),n=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];n[0]=r.r/255,n[6]=r.g/255,n[12]=r.b/255;var a=new egret.ColorMatrixFilter(n);t.filters=[a]},t.euiPosToNormal=function(t){var e=new egret.Point(0,0);if(t)return t.right&&(e.x=GameConfig.curWidth()-t.right-t.anchorOffsetX),t.top&&(e.y=t.top+t.anchorOffsetY),t.left&&(e.x=t.left+t.anchorOffsetX),t.bottom&&(e.y=GameConfig.curHeight()-t.bottom-t.anchorOffsetY),e},t.euiPosToNormal1=function(t){var e=new egret.Point(0,0);return t.right&&(e.x=GameConfig.curWidth()-t.right-t.anchorOffsetX),t.top&&(e.y=t.top+t.anchorOffsetY),t.left&&(e.x=t.left+t.anchorOffsetX),t.bottom&&(e.y=GameConfig.curHeight()-t.bottom-t.anchorOffsetY),e},t.shake=function(t,e){void 0===e&&(e=15);var i=egret.Tween.get(t,{loop:!0}),r=t.x;i.to({x:t.x+=e},80).to({x:t.x-=e},80).to({x:t.x+=e},80).to({x:t.x-=e},80).call(function(){t.x=r})},t.stopShake=function(t){egret.Tween.removeTweens(t)},t.dateFtt=function(t,e){var i={"M+":t.getMonth()+1,"d+":t.getDate(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds(),"q+":Math.floor((t.getMonth()+3)/3),S:t.getMilliseconds()};e||(e="yyyy-MM-ddThh:mm:ss+00:00"),/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(t.getFullYear()+"").substr(4-RegExp.$1.length)));for(var r in i)new RegExp("("+r+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?i[r]:("00"+i[r]).substr((""+i[r]).length)));return e},t.getNowDate=function(){return this.dateFtt(new Date,"yyyy-MM-dd hh:mm:ss")},t.getWeekTime=function(){var e=new Date,i=e.getFullYear(),r=e.getMonth(),n=e.getDate(),a=e.getDay(),o=new Date(i,r,n-(a?a-1:6)),s=new Date(i,r,n+(a?8-a:1));return t.dateRange=[this.dateFtt(o),this.dateFtt(s)],t.dateRange},t.isInTimeRange=function(t){if(t){var e=new Date(t.replace(/-/g,"/")).getTime();return e>this.dateRange[0]&&e<this.dateRange[1]}return!1},t.transObj=function(t){var e={};return t.map(function(t){e[t.key]=t.value}),e},Object.defineProperty(t,"isRuntime",{get:function(){return!1},enumerable:!0,configurable:!0}),t.tf=new egret.TextField,t.dateRange=[],t}();__reflect(Utils.prototype,"Utils");var AlertPanel=function(t){function e(e,i,r,n,a){void 0===e&&(e="");var o=t.call(this)||this;return o._descStr="",o._descStr=e,o._type=i,o._resolve=r,o._reject=n,o._thisObject=a,o.skinName="",o.m_desc.textFlow=(new egret.HtmlTextParser).parser(o._descStr),o}return __extends(e,t),e.prototype.onShow=function(e){t.prototype.onShow.call(this),this.left=this.right=this.top=this.bottom=0,1==this._type&&(this.m_reject.visible=!1,this.m_resolve.horizontalCenter=0)},e.prototype.addListener=function(){t.prototype.addListener.call(this),this.m_resolve.addEventListener(egret.TouchEvent.TOUCH_TAP,this.resolveHander,this),this.m_reject.addEventListener(egret.TouchEvent.TOUCH_TAP,this.rejectHandler,this)},e.prototype.resolveHander=function(t){this.removeFromParent(0),this._resolve.apply(this._thisObject)},e.prototype.rejectHandler=function(t){this.removeFromParent(0),this._reject.apply(this._thisObject)},e.prototype.removeListener=function(){t.prototype.removeListener.call(this)},e.prototype.release=function(){this.removeChildren()},e}(DialogBaseView);__reflect(AlertPanel.prototype,"AlertPanel");var TipsPanel=function(t){function e(e){void 0===e&&(e="");var i=t.call(this)||this;return i.descStr="",i.descStr=e,i.initUI(),i}return __extends(e,t),e.prototype.initUI=function(){this.bg=new egret.Bitmap,this.bg.texture=RES.getRes("blackImagePan_jpg"),this.addChild(this.bg),this.bg.touchEnabled=!0,this.descTF=new egret.TextField,this.addChild(this.descTF),this.descTF.textColor=0,this.descTF.size=12,this.descTF.x=5,this.descTF.textAlign="center",this.descTF.text=this.descStr;var t=new egret.Rectangle(5,5,5,5);this.bg.scale9Grid=t,this.bg.width=this.descTF.width+10,this.bg.height=3*this.descTF.height,this.descTF.y=this.bg.height/2-this.descTF.height/2+2},e.prototype.getHeight=function(){return this.bg.height},e.prototype.getWidth=function(){return this.bg.width},e}(eui.Component);__reflect(TipsPanel.prototype,"TipsPanel");var HDGGame;!function(t){var e=function(){function t(){this.scoreRateJson=[{index:1,minTimes:0,maxTimes:5,rate:[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},{index:2,minTimes:6,maxTimes:10,rate:[.4,.6,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},{index:3,minTimes:11,maxTimes:15,rate:[.25,.6,.15,0,0,0,0,0,0,0,0,0,0,0,0,0]},{index:4,minTimes:16,maxTimes:20,rate:[.25,.25,.35,.15,0,0,0,0,0,0,0,0,0,0,0,0]},{index:5,minTimes:21,maxTimes:25,rate:[.15,.2,.35,.2,.1,0,0,0,0,0,0,0,0,0,0,0]},{index:6,minTimes:26,maxTimes:30,rate:[.1,.1,.25,.3,.15,.1,0,0,0,0,0,0,0,0,0,0]},{index:7,minTimes:31,maxTimes:35,rate:[.05,.1,.15,.2,.2,.2,.1,0,0,0,0,0,0,0,0,0]},{index:8,minTimes:36,maxTimes:40,rate:[.05,.05,.1,.1,.2,.2,.2,.1,0,0,0,0,0,0,0,0]},{index:9,minTimes:41,maxTimes:45,rate:[.05,.05,.05,.05,.15,.15,.2,.2,.1,0,0,0,0,0,0,0]},{index:10,minTimes:46,maxTimes:50,rate:[0,.05,.05,.05,.15,.15,.15,.15,.15,.1,0,0,0,0,0,0]},{index:11,minTimes:51,maxTimes:55,rate:[0,0,.05,.05,.05,.15,.15,.15,.15,.15,.1,0,0,0,0,0]},{index:12,minTimes:56,maxTimes:60,rate:[0,0,0,.05,.05,.05,.15,.15,.15,.15,.15,.1,0,0,0,0]},{index:13,minTimes:61,maxTimes:65,rate:[0,0,0,0,.05,.05,.1,.1,.15,.15,.15,.15,.1,0,0,0]},{index:14,minTimes:66,maxTimes:70,rate:[0,0,0,0,0,.05,.05,.1,.1,.15,.15,.15,.15,.1,0,0]},{index:15,minTimes:71,maxTimes:75,rate:[0,0,0,0,0,0,.05,.05,.1,.1,.15,.15,.15,.15,.1,0]},{index:16,minTimes:76,maxTimes:80,rate:[0,0,0,0,0,0,0,.05,.05,.05,.15,.15,.15,.15,.15,.1]},{index:17,minTimes:81,maxTimes:85,rate:[0,0,0,0,0,0,0,0,.05,.1,.15,.15,.15,.15,.15,.1]},{index:18,minTimes:86,maxTimes:90,rate:[0,0,0,0,0,0,0,0,0,.05,.15,.15,.2,.2,.15,.1]},{index:19,minTimes:91,maxTimes:95,rate:[0,0,0,0,0,0,0,0,0,0,.05,.2,.2,.2,.2,.15]},{index:20,minTimes:96,maxTimes:1e4,rate:[0,0,0,0,0,0,0,0,0,0,0,.2,.2,.2,.2,.2]}],this.scoreJson=[{index:1,minScore:5,maxScore:20},{index:2,minScore:20,maxScore:40},{index:3,minScore:40,maxScore:60},{index:4,minScore:60,maxScore:80},{index:5,minScore:80,maxScore:100},{index:6,minScore:100,maxScore:150},{index:7,minScore:150,maxScore:200},{index:8,minScore:200,maxScore:250},{index:9,minScore:250,maxScore:300},{index:10,minScore:300,maxScore:400},{index:11,minScore:400,maxScore:500},{index:12,minScore:500,maxScore:600},{index:13,minScore:600,maxScore:700},{index:14,minScore:700,maxScore:800},{index:15,minScore:800,maxScore:900},{index:16,minScore:900,maxScore:1e3}],this.blockNumRate=[{minTimes:0,maxTimes:20,rate:[.3,.4,.3,0,0]},{minTimes:21,maxTimes:50,rate:[.2,.3,.3,.2,0]},{minTimes:51,maxTimes:70,rate:[.1,.2,.3,.2,.2]},{minTimes:71,maxTimes:1e4,rate:[0,.2,.2,.3,.3]}],this.propNumRate=[{blockNum:1,rate:[.6,.3,.05,.05]},{blockNum:2,rate:[.6,.3,.05,.05]},{blockNum:3,rate:[.6,.3,.05,.05]},{blockNum:4,rate:[.6,.3,.1,0]},{blockNum:5,rate:[.7,.3,0,0]}]}return t.getInstance=function(){return null==t._instance&&(t._instance=new t),t._instance},t.prototype.getScoreByTimes=function(t){for(var e=null,i=0;i<this.scoreRateJson.length;i++)if(this.scoreRateJson[i].minTimes>=t&&this.scoreRateJson[i].maxTimes>=t){e=this.scoreRateJson[i].rate;break}if(null==e||e.length<=0)return console.log("cannot find times = ",t," score rate config"),0;for(var r=Math.random(),n=0,a=-1,i=0;i<e.length;i++)if(n+=e[i],n>=r){a=i;break}var o=this.scoreJson[a];if(null==o)return 0;var s=Math.floor(Math.random()*(o.maxScore-o.minScore))+o.minScore;return console.log("times ",t," score is",s),s},t.prototype.getBlockNum=function(t){for(var e=null,i=0;i<this.blockNumRate.length;i++)if(this.blockNumRate[i].minTimes>=t&&this.blockNumRate[i].maxTimes>=t){e=this.blockNumRate[i].rate;break}if(null==e&&e.length<=0)return 0;for(var r=Math.random(),n=0,a=-1,i=0;i<e.length;i++)if(n+=e[i],n>=r){a=i;break}return console.log("times ",t," block num is",a+1),a+1},t.prototype.getProNumByBlockNum=function(t){var e=this.propNumRate[t-1];if(null==e)return 0;for(var i=e.rate,r=0,n=-1,a=Math.random(),o=0;o<i.length;o++)if(r+=i[o],r>=a){n=o;break}return console.log("blockNum ",t," block num is",n+1),n+1},t.prototype.getRandomArray=function(){for(var t=[0,1,2,3,4,5],e=t.length,i=0;e-1>i;i++){var r=Math.floor(Math.random()*(e-i)),n=t[r];t[r]=t[e-i-1],t[e-i-1]=n}return console.log(t),t},t}();t.Config=e,__reflect(e.prototype,"HDGGame.Config")}(HDGGame||(HDGGame={}));var EffectLine=function(t){function e(){var e=t.call(this)||this;return e.LineArr=[],e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e}return __extends(e,t),e.prototype.onAddToStage=function(t){this.stage.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onStageTouch,this),this.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onStageTouch,this),this.stage.addEventListener(egret.TouchEvent.TOUCH_END,this.onStageTouch,this),this.addEventListener(egret.Event.ENTER_FRAME,this.clean,this)},e.prototype.dis=function(t,e,i,r){var t=t,i=i,e=e,r=r,n=e-t,a=r-i;return Math.pow(n*n+a*a,.5)},e.prototype.createLine=function(t,e){var i=new eui.Image("z_png");i.type=0,i.x=t,i.y=e,i.width=25,i.height=25,i.anchorOffsetX=i.width/2,i.anchorOffsetY=i.height/2,i.alpha=1,this.addChild(i),this.LineArr.push(i)},e.prototype.onStageTouch=function(t){if("touchBegin"==t.type);else if("touchMove"==t.type){if(this.LineArr.length>0){var e=this.LineArr[this.LineArr.length-1].x,i=this.LineArr[this.LineArr.length-1].y,r=t.stageX,n=t.stageY,a=this.dis(e,r,i,n);if(a>3){var o=(e+r)/2,s=(i+n)/2,l=(e+o)/2,h=(i+s)/2,c=(l+r)/2,u=(h+n)/2,p=(e+l)/2,d=(i+h)/2,f=(l+o)/2,g=(h+s)/2,m=(o+c)/2,y=(s+u)/2,v=(c+r)/2,_=(u+n)/2;this.createLine(p,d),this.createLine(l,h),this.createLine(f,g),this.createLine(o,s),this.createLine(m,y),this.createLine(c,u),this.createLine(v,_)}}this.createLine(t.stageX,t.stageY)}else"touchEnd"==t.type},e.prototype.clean=function(){if(this.LineArr.length>0)for(var t=0;t<this.LineArr.length;t++)this.LineArr[t].scaleX<.8&&0==this.LineArr[t].type?(this.LineArr[t].scaleX=this.LineArr[t].scaleX+.06,this.LineArr[t].scaleY=this.LineArr[t].scaleY+.06):(this.LineArr[t].type=1,this.LineArr[t].scaleX=this.LineArr[t].scaleX-.06,this.LineArr[t].scaleY=this.LineArr[t].scaleY-.06,this.LineArr[t].scaleX<=0&&(this.removeChild(this.LineArr[t]),this.LineArr.splice(t,1),t--))},e.prototype.createBitmapByName=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},e}(egret.DisplayObjectContainer);__reflect(EffectLine.prototype,"EffectLine");var ReconnectView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.onShow=function(e){t.prototype.onShow.call(this,e),this.left=this.right=this.top=this.bottom=0},e.prototype.onHide=function(e){t.prototype.onHide.call(this,e)},e.prototype.addListener=function(){},e.prototype.removeListener=function(){},e.prototype.init=function(){this.darkSprite=new egret.Sprite,this.darkSprite.graphics.clear(),this.darkSprite.graphics.beginFill(0,.05),this.darkSprite.graphics.drawRect(0,0,GameConfig.curWidth(),GameConfig.curHeight()),this.darkSprite.graphics.endFill(),this.darkSprite.width=GameConfig.curWidth(),this.darkSprite.height=GameConfig.curHeight(),this.darkSprite.touchEnabled=!1,this.darkSprite.visible=!0,this.addChild(this.darkSprite);var t=new egret.Point(150,150);this.darkSprite=new egret.Sprite,this.darkSprite.graphics.clear(),this.darkSprite.graphics.beginFill(0,.1),this.darkSprite.graphics.drawRoundRect(0,0,t.x,t.y,20),this.darkSprite.graphics.endFill(),this.darkSprite.width=t.x,this.darkSprite.height=t.y,this.darkSprite.x=GameConfig.curWidth()-t.x>>1,this.darkSprite.y=GameConfig.curHeight()-t.y>>1,this.addChild(this.darkSprite),this.darkSprite.touchEnabled=!1,this.darkSprite.visible=!0,this.label=new egret.TextField,this.label.text="网络重连中",this.label.size=20,this.addChild(this.label),this.label.width=GameConfig.curWidth(),this.label.textAlign="center",this.label.y=GameConfig.curHeight()/2+t.x/4},e.prototype.popup=function(t){void 0===t&&(t=""),core.LayerCenter.getInstance().getLayer(LayerEnum.POPUP).contains(this)||(this.init(),this.label.text=t,t?this.darkSprite.visible=!0:this.darkSprite.visible=!1,this.ReconnectMc.play(-1),this.addChild(this.ReconnectMc),core.LayerCenter.getInstance().getLayer(LayerEnum.POPUP).addChild(this))},e.prototype.removeFromParent=function(){this.removeChildren(),this.parent&&this.parent.removeChild(this)},e.prototype.release=function(){},Object.defineProperty(e.prototype,"isShow",{get:function(){return core.LayerCenter.getInstance().getLayer(LayerEnum.POPUP).contains(this)},enumerable:!0,configurable:!0}),e.getInstance=function(){return null==e.s_instance&&(e.s_instance=new e),e.s_instance},e}(core.EUIComponent);__reflect(ReconnectView.prototype,"ReconnectView");var LobbyLayer=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){this._lobbyView=new LobbyView,this.addChild(this._lobbyView)},e.prototype.release=function(){t.prototype.release.call(this),this._lobbyView=null},e}(core.EUILayer);__reflect(LobbyLayer.prototype,"LobbyLayer");var LoginLayer=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){},e}(core.EUILayer);__reflect(LoginLayer.prototype,"LoginLayer");var MainLayer=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){GameConfig.gameMode==GameConfig.GameMode.TIME?(this.scoreView=new ScoreView,this.addChild(this.scoreView)):GameConfig.gameMode==GameConfig.GameMode.ENDLESS&&(this.endlessScore=new EndlessScore,this.addChild(this.endlessScore)),this.girl=new Girl,this.addChild(this.girl),this.girl.x=GameConfig.curWidth()/2,this.girl.y=GameConfig.curHeight()-620,this.main=new MainView,this.addChild(this.main)},e.prototype.release=function(){t.prototype.release.call(this),this.main=null,this.scoreView=null,this.girl=null},e}(core.EUILayer);__reflect(MainLayer.prototype,"MainLayer");var MainLayerBase=function(t){function e(){var e=t.call(this)||this;return GameConfig.curStage().addEventListener(egret.TouchEvent.TOUCH_TAP,e.playFirstSound,e),e.initViews(),e}return __extends(e,t),e.prototype.initViews=function(){},e.prototype.playFirstSound=function(){GameConfig.curStage().removeEventListener(egret.TouchEvent.TOUCH_TAP,this.playFirstSound,this)},e}(core.EUILayer);__reflect(MainLayerBase.prototype,"MainLayerBase");var core;!function(t){var e=function(){function t(){this.m_keyMap=new Dictionary}return t.prototype.addKeyListener=function(t,e,n){var a=this.m_keyMap.get(t);a||(a=new i(t)),a.callbacks.push(new r(e,n)),this.m_keyMap.add(t,a)},t.prototype.removeKeyListener=function(t,e,i){var r=this.m_keyMap.get(t);if(r)for(var n=r.callbacks,a=0,o=n.length;o>a;a++){var s=n[a];s&&s.callback===e&&s.thisObj===i&&(s.isValid=!1)}},t.prototype.enableKey=function(t,e){this.m_keyMap.get(t).keyEnable=e},t.prototype.enable=function(t){for(var e=this.m_keyMap,i=e.values,r=0,n=i.length;n>r;r++)i[r].keyEnable=t},t.prototype.sendKey=function(t){var e=this.m_keyMap.get(t);if(e){for(var i=e.callbacks,r=i.length;r>0;r--){var n=i[r-1];n.isValid||i.splice(r-1,1)}for(var r=0,a=i.length;a>r;r++){var o=i[r];o.callback.call(o.thisObj)}}},t.getInstance=function(){return t.s_instance||(t.s_instance=new t),t.s_instance},t}();t.InputManager=e,__reflect(e.prototype,"core.InputManager");var i=function(){function t(t){this.key=t,this.keyEnable=!0,this.callbacks=[]}return t}();__reflect(i.prototype,"KeyData");var r=function(t){function e(e,i){var r=t.call(this,e,i)||this;return r.isValid=!0,r}return __extends(e,t),e}(t.Callback);__reflect(r.prototype,"KeyCallBack")}(core||(core={}));var core;!function(t){var e=function(){function e(){}return e.getInstance=function(){return null==e.s_instance&&(e.s_instance=new e),e.s_instance},e.prototype.init=function(t){t&&(this.stage=t,t.addEventListener(egret.Event.RESIZE,this.onStageResize,this),this.m_layers=[],e.stageWidth=t.stageWidth,e.stageHeight=t.stageHeight)},e.prototype.onStageResize=function(i){e.stageWidth=this.stage.stageWidth,e.stageHeight=this.stage.stageHeight,t.EventCenter.getInstance().sendEvent(new t.EventData(egret.Event.RESIZE))},e.prototype.addLayer=function(t,e){this.m_layers[t]=e,this.stage.addChildAt(e,t)},e.prototype.getLayer=function(t){return this.m_layers[t]},e.prototype.removeLayer=function(t){var e=this.m_layers[t];e&&(e.parent&&e.parent.removeChild(e),e.removeChildren(),this.m_layers[t]=null)},e}();t.LayerCenter=e,__reflect(e.prototype,"core.LayerCenter")}(core||(core={}));var LobbyViewBase=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.left=0,this.right=0,this.top=0,this.bottom=0},e.prototype.onShow=function(e){t.prototype.onShow.call(this,e),this.getAdData()},e.prototype.onHide=function(e){t.prototype.onHide.call(this,e)},e.prototype.getAdData=function(){var t=this,e=UserManager.getInstance().getUid();Api.get(Api.GET_JUMP_INFO+("?appId="+GameConfig.appid+"&channel="+GameConfig.channelId+"&userId="+e)).then(function(e){console.info("广告信息",e),t.dealAd(e.data)})},e.prototype.dealAd=function(t){this._adIcon||(this._adIcon=new eui.Image(t.icon)),this._adIcon.left=0,this._adIcon.bottom=200,this.addChild(this._adIcon),this._adIcon.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){},this)},e.prototype.goGameHandler=function(t){GlobalManager.getInstance().goGame()},e.prototype.rankHandler=function(t){},e.prototype.shareHandler=function(t){},e.prototype.release=function(){t.prototype.release.call(this)},e}(core.EUIComponent);__reflect(LobbyViewBase.prototype,"LobbyViewBase");var core;!function(t){var e=function(e){function i(t){return e.call(this,t)||this}return __extends(i,e),i.prototype.readUTFData=function(){var t=this.readShort();return e.prototype.readUTFBytes.call(this,t)},i.prototype.writeUTFBytes=function(t){this.writeShort(this.getStringBytesLen(t)),e.prototype.writeUTFBytes.call(this,t)},i.prototype.getStringBytesLen=function(t){var e=new egret.ByteArray;return e.writeUTFBytes(t),e.length},i.prototype.clone=function(){var e=new t.ByteBuffer;return e.writeBytes(this),e},i}(egret.ByteArray);t.ByteBuffer=e,__reflect(e.prototype,"core.ByteBuffer")}(core||(core={}));var core;!function(t){var e=function(t){function e(e,i){return void 0===i&&(i={}),t.call(this,e,i)||this}return __extends(e,t),e}(t.EventData);t.MessageData=e,__reflect(e.prototype,"core.MessageData")}(core||(core={}));var NetStateEnum;!function(t){t[t.conneting=0]="conneting",t[t.close=1]="close",t[t.authing=2]="authing",t[t.connected=3]="connected"}(NetStateEnum||(NetStateEnum={}));var Api=function(){function t(){}return t.post=function(t,e){return __awaiter(this,void 0,void 0,function(){var i=this;return __generator(this,function(r){return this.decoratePostData(e),[2,new Promise(function(r,n){var a=new egret.HttpRequest;a.responseType=egret.HttpResponseType.TEXT,a.open(t,egret.HttpMethod.POST),a.setRequestHeader("Content-Type","application/json"),a.send(e),a.addEventListener(egret.Event.COMPLETE,function(t){var e=t.currentTarget;r(e.response?JSON.parse(e.response):{})},i),a.addEventListener(egret.IOErrorEvent.IO_ERROR,function(t){n(t)},i)})]})})},t.get=function(t,e){return __awaiter(this,void 0,void 0,function(){var e=this;return __generator(this,function(i){return[2,new Promise(function(i,r){var n=new egret.HttpRequest;n.responseType=egret.HttpResponseType.TEXT,n.open(t,egret.HttpMethod.GET),n.send(),n.addEventListener(egret.Event.COMPLETE,function(t){var e=t.currentTarget;i(JSON.parse(e.response))},e),n.addEventListener(egret.IOErrorEvent.IO_ERROR,function(t){r(t)},e)})]})})},t.decoratePostData=function(t){var e=UserManager.getInstance().getOpenId(),i=UserManager.getInstance().getUid();t.userId=i,t.open_id=e,t.appid=GameConfig.appid},t.GET_JUMP_INFO="https://gws.365you.com/wx/getJumpInfo",t}();__reflect(Api.prototype,"Api");var launchData=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.setLaunchData=function(t){this.scene=t.scene,this.query=t.query,this.shareTicket=t.shareTicket,t.referrerInfo&&(this.referrerInfo=t.referrerInfo)},e}(egret.EventDispatcher);__reflect(launchData.prototype,"launchData");var SystemData=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.setSystemData=function(t){this.SDKVersion=t.SDKVersion,this.model=t.model,this.system=t.system,this.screenWidth=t.screenWidth,this.screenHeight=t.screenHeight},e.SDKVersion="",e.model="",e.system="",e.screenWidth=720,e.screenHeight=1280,e}(egret.EventDispatcher);__reflect(SystemData.prototype,"SystemData");var BaskectBallManager=function(t){function e(){var i=t.call(this)||this;return i._curSide="right",i._curPos=[3],i.comboTimeout=1e4,i.curRound=1,i.curCombo=0,i._skinInfo=["0"],i._coinsNumber=0,i._curCoins=0,i._use=0,i._rankScore=0,i.comboTimer=0,i.maxCombo=0,i._comboSecond=0,i._timeoutSecond=e.TIME,i.tiemoutInterval=0,i.highShotCount=0,i.kongxinCount=0,i.yashaoCount=0,i.bankCount=0,i.endlessCombo=0,i}return __extends(e,t),Object.defineProperty(e.prototype,"matterScene",{get:function(){return this._matterScene},set:function(t){this._matterScene=t},enumerable:!0,configurable:!0}),e.prototype.generateCurPos=function(){if(1==this.curRound)this._curPos=[3];else if(this.curRound<=3){var t=core.MathUtils.random(1,3);this._curPos=[t]}else{var t=core.MathUtils.random(0,100);4>t?this._curPos=[1,2,3]:12>t?this._curPos=[1,2]:20>t?this._curPos=[2,3]:46>t?this._curPos=[3]:73>t?this._curPos=[2]:this._curPos=[1]}},e.prototype.generateNextPos=function(){var t=core.MathUtils.random(1,4);this._curPos=[],this._curPos.push(t)},e.prototype.switchSide=function(){return this.curRound++,GameConfig.gameMode==GameConfig.GameMode.TIME?this.generateCurPos():GameConfig.gameMode==GameConfig.GameMode.ENDLESS&&this.generateNextPos(),"right"==this._curSide?this._curSide="left":this._curSide="right",this._curSide},Object.defineProperty(e.prototype,"curSide",{get:function(){return this._curSide},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"curPos",{get:function(){return this._curPos},enumerable:!0,configurable:!0}),e.prototype.startCombTimer=function(t){var i=this;void 0===t&&(t=!1),t||(this.curCombo++,this.curCombo>this.maxCombo&&(this.maxCombo=this.curCombo-1),this.calcShotTime(),this._comboSecond=this.comboTimeout),this.dispatchEventWith(GameManager.GAME_COMBO,!1,{round:this.curCombo});var r=this._matterScene.engine.timing.timestamp;egret.clearInterval(this.comboTimer),this.comboTimer=egret.setInterval(function(){i._comboSecond-=i._matterScene.engine.timing.timestamp-r;var t=i._comboSecond/i.comboTimeout;i.dispatchEventWith(GameManager.GAME_COMBO_PROGRESS,!1,{percent:t,round:i.curCombo}),r=i._matterScene.engine.timing.timestamp,0>=t&&(i.curCombo=0,egret.clearInterval(i.comboTimer),i.dispatchEvent(new egret.Event(e.COMPLETE_COMBO)))},this,16)},e.prototype.startTimeout=function(){var t=this;this.dispatchEvent(new egret.Event(e.START_TIMEOUT)),this.dispatchEventWith(GameManager.GAME_TIME,!1,{time:this._timeoutSecond});var i=this._matterScene.engine.timing.timestamp;egret.clearInterval(this.tiemoutInterval),this.tiemoutInterval=egret.setInterval(function(){t._timeoutSecond--,t.dispatchEventWith(GameManager.GAME_TIME,!1,{time:t._timeoutSecond}),i=t._matterScene.engine.timing.timestamp,t._timeoutSecond<=10&&SoundMgr.getInstance().daojishi(t._timeoutSecond),t._timeoutSecond<=0&&(egret.clearInterval(t.tiemoutInterval),egret.clearInterval(t.comboTimer),t.dispatchEvent(new egret.Event(e.COMPLETE_COMBO))),t.updateRobotScore()},this,1e3)},e.prototype.updateRobotScore=function(){if(PlatfromUtil.getPlatformEnum()==PlatfromEnum.GMBOX){var t=BatterInfo.instance.otherUserInfo;if(!t||0!=t.type){var e=t?t.aiRank:1;if(this._timeoutSecond%2!=1){var i=0;i=1==e?this.getRobotScoreLevel1():2==e?this.getRobotScoreLevel2():3==e?this.getRobotScoreLevel3():4==e?this.getRobotScoreLevel4():this.getRobotScoreLevel5(),i>0&&GameManager.getInstance().scoreManager.updateOtherScore(i)}}}},e.prototype.getRobotScoreLevel1=function(){var t=0;if(0==this._timeoutSecond){var e=core.MathUtils.random(0,10);5==e&&(t=5)}if(this._timeoutSecond>=80){var e=core.MathUtils.random(0,3);t=0==e?0:1==e?1:2}else{var e=core.MathUtils.random(0,10);6>e?t=1:6==e?t=2:7==e?t=3:8==e?t=4:9==e&&(t=5)}return t},e.prototype.getRobotScoreLevel2=function(){var t=0;if(0==this._timeoutSecond){var e=core.MathUtils.random(0,10);5==e&&(t=5)}if(this._timeoutSecond>=80){var e=core.MathUtils.random(0,2);0==e?t=1:1==e&&(t=2)}else{var e=core.MathUtils.random(0,10);5>e?t=1:5==e?t=2:8>e?t=3:8==e?t=4:9==e&&(t=5)}return t},e.prototype.getRobotScoreLevel3=function(){var t=0;if(0==this._timeoutSecond){var e=core.MathUtils.random(0,10);5==e&&(t=5)}if(this._timeoutSecond>=80){var e=core.MathUtils.random(0,2);0==e?t=1:1==e&&(t=2)}else{var e=core.MathUtils.random(0,10);3>e?t=1:5>e?t=2:8>e?t=3:8==e?t=4:9==e&&(t=5)}return t},e.prototype.getRobotScoreLevel4=function(){var t=0;if(0==this._timeoutSecond){var e=core.MathUtils.random(0,10);(5==e||7==e)&&(t=5)}if(this._timeoutSecond>=82){var e=core.MathUtils.random(0,2);0==e?t=1:1==e&&(t=2)}else{var e=core.MathUtils.random(0,5);0==e?t=1:1==e?t=2:2==e?t=3:3==e?t=4:4==e&&(t=5)}return t},e.prototype.getRobotScoreLevel5=function(){var t=0;if(0==this._timeoutSecond){var e=core.MathUtils.random(0,10);5==e&&(t=5)}if(this._timeoutSecond>=84){var e=core.MathUtils.random(0,2);0==e?t=1:1==e&&(t=2)}else{var e=core.MathUtils.random(0,10);t=3>e?2:5>e?3:7>e?4:5}return t},e.prototype.getRobotScoreLevel6=function(){var t=0;if(0==this._timeoutSecond){var e=core.MathUtils.random(0,1);0==e&&(t=5)}if(this._timeoutSecond>=86){var e=core.MathUtils.random(0,2);0==e?t=1:1==e&&(t=2)}else{var e=core.MathUtils.random(0,10);t=0==e?1:1==e?2:2==e?3:3==e?4:5}return t},e.prototype.calcShotTime=function(){var t;GameConfig.gameMode==GameConfig.GameMode.TIME?t=1==this.curCombo?10:this.curCombo<=5?10-.3*this.curCombo:this.curCombo<=35?8.5-.2*(this.curCombo-5):this.curCombo<=50?2.5-.1*(this.curCombo-35):1:GameConfig.gameMode==GameConfig.GameMode.ENDLESS&&(t=1==this.curRound?6:this.curRound<=25?6-.1*this.curRound:3.5),this.comboTimeout=1e3*t},e.prototype.isLastTime=function(){if(GameConfig.gameMode==GameConfig.GameMode.TIME){if(this._timeoutSecond<=0)return!0}else if(GameConfig.gameMode==GameConfig.GameMode.ENDLESS&&this._comboSecond<0)return!0;return!1},Object.defineProperty(e.prototype,"timeoutSecond",{get:function(){return this._timeoutSecond},enumerable:!0,configurable:!0}),e.prototype.addEffect=function(t){"highShot"==t?(this.endlessCombo++,this.highShotCount++):"kongxin"==t?(this.endlessCombo++,this.kongxinCount++):"yashao"==t?(this.endlessCombo++,this.yashaoCount++):"bank"==t?(this.endlessCombo++,this.bankCount++):(t="null")&&(this.endlessCombo=0),this.dispatchEventWith(e.ADD_EFFECT,!1,{type:t})},Object.defineProperty(e.prototype,"skinInfo",{get:function(){return this._skinInfo},set:function(t){this._skinInfo=t},enumerable:!0,configurable:!0}),e.prototype.addSkinInfo=function(t){this._skinInfo.push(t),Facebook.isFBInit()?FacebookStorage.getInstance().saveDataToFB({ownSkin:this._skinInfo.toString()}):localStorage.setItem("ownSkin",JSON.stringify({ownSkin:this._skinInfo.toString()}))},Object.defineProperty(e.prototype,"coinsNumber",{get:function(){return this._coinsNumber},set:function(t){this._coinsNumber=t},enumerable:!0,configurable:!0}),e.prototype.collectCoinsNumber=function(t){this._coinsNumber+=t,this._curCoins+=t,GameManager.getInstance().refreshGold(this._coinsNumber),Facebook.isFBInit()?FacebookStorage.getInstance().saveDataToFB({gameCoin:this._coinsNumber}):localStorage.setItem("gameCoin",JSON.stringify({gameCoin:this._coinsNumber}))},e.prototype.payCoinsNumber=function(t){this._coinsNumber-=t,GameManager.getInstance().refreshGold(this._coinsNumber),Facebook.isFBInit()?FacebookStorage.getInstance().saveDataToFB({gameCoin:this._coinsNumber}):localStorage.setItem("gameCoin",JSON.stringify({gameCoin:this._coinsNumber}))},Object.defineProperty(e.prototype,"use",{get:function(){return this._use},set:function(t){this._use=t,Facebook.isFBInit()?FacebookStorage.getInstance().saveDataToFB({usingSkin:t}):localStorage.setItem("usingSkin",JSON.stringify({usingSkin:t}))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rankScore",{get:function(){return this._rankScore},set:function(t){this._rankScore=t,Facebook.isFBInit()?FacebookStorage.getInstance().saveDataToFB({rankScore:t}):localStorage.setItem("rankScore",JSON.stringify({rankScore:t}))},enumerable:!0,configurable:!0}),e.prototype.reborn=function(){egret.clearInterval(this.comboTimer),egret.clearInterval(this.tiemoutInterval),this.dispatchEventWith(e.REBORN,!1,{})},e.prototype.reset=function(){egret.clearInterval(this.comboTimer),egret.clearInterval(this.tiemoutInterval),GameManager.getInstance().scoreManager.reset(),this._curSide="right",this.kongxinCount=this.yashaoCount=this.highShotCount=this.bankCount=0,this.curCombo=0,this.curRound=1,this.endlessCombo=0,this._curPos=[3],this._timeoutSecond=e.TIME,this._comboSecond=0,this._curCoins=0,this.maxCombo=0},e.prototype.pauseGame=function(){egret.clearInterval(this.comboTimer),egret.clearInterval(this.tiemoutInterval)},e.prototype.resumeGame=function(t){GameConfig.gameMode==GameConfig.GameMode.TIME&&this.startTimeout(),t&&this.startCombTimer(!0)},e.prototype.rebornGame=function(){GameConfig.gameMode==GameConfig.GameMode.TIME?(this._timeoutSecond=15,this.startTimeout(),this.startCombTimer(!0)):GameConfig.gameMode==GameConfig.GameMode.ENDLESS&&(this._comboSecond=0)},e.prototype.isYanMode=function(){return GameConfig.gameMode==GameConfig.GameMode.TIME?this.curCombo>1&&this.curCombo<4:GameConfig.gameMode==GameConfig.GameMode.ENDLESS?this.endlessCombo>1&&this.endlessCombo<5:!1},e.prototype.isFireMode=function(){return GameConfig.gameMode==GameConfig.GameMode.TIME?this.curCombo>=4:GameConfig.gameMode==GameConfig.GameMode.ENDLESS?this.endlessCombo>=5:!1},e.prototype.isLightMode=function(){return GameConfig.gameMode==GameConfig.GameMode.TIME?this.curCombo>=14:GameConfig.gameMode==GameConfig.GameMode.ENDLESS?this.endlessCombo>=14:!1},e.TIME=90,e.SWITCH_SIDE="switch_side",e.REBORN="reborn",e.START_TIMEOUT="start_timeout",e.COMPLETE_TIMEOUT="complete_timeout",e.COMPLETE_COMBO="complete_combo",e.GAME_TIMEOUT="game_timeout",e.ADD_EFFECT="add_effect",e.CHANGE_SKIN="change_skin",e.COLLECT_COINS="collect_coins",e.BASKET_PRICE=[-1,0,0,500,800,1300,2e3],e}(egret.EventDispatcher);__reflect(BaskectBallManager.prototype,"BaskectBallManager");var EndlessScore=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/assets/exml/EndlessScoreView.exml",e.top=e.bottom=e.left=e.right=0,e}return __extends(e,t),e.prototype.addListener=function(){GameManager.getInstance().addEventListener(GameManager.RESTART_GAME,this.restartHandler,this),GameManager.getInstance().scoreManager.addEventListener(ScoreManager.UPDATE_SCORE,this.updateScoreHandler,this),GameManager.getInstance().baskectBallManager.addEventListener(BaskectBallManager.ADD_EFFECT,this.addEffectHandler,this),GameManager.getInstance().baskectBallManager.addEventListener(GameManager.GAME_COMBO_PROGRESS,this.updateComboProgress,this),GameManager.getInstance().baskectBallManager.addEventListener("show_coin",this.showCoin,this),GameManager.getInstance().baskectBallManager.addEventListener("collect_coin",this.collectCoin,this)},e.prototype.removeListener=function(){GameManager.getInstance().removeEventListener(GameManager.RESTART_GAME,this.restartHandler,this),GameManager.getInstance().scoreManager.removeEventListener(ScoreManager.UPDATE_SCORE,this.updateScoreHandler,this),GameManager.getInstance().baskectBallManager.removeEventListener(BaskectBallManager.ADD_EFFECT,this.addEffectHandler,this),GameManager.getInstance().baskectBallManager.removeEventListener(GameManager.GAME_COMBO_PROGRESS,this.updateComboProgress,this),GameManager.getInstance().baskectBallManager.removeEventListener("show_coin",this.showCoin,this),GameManager.getInstance().baskectBallManager.addEventListener("collect_coin",this.collectCoin,this)
},e.prototype.onShow=function(e){t.prototype.onShow.call(this),this.updateGold();var i=this;setTimeout(function(){i.m_goin_image.visible=!0,i.m_goin_image.x=i.m_coin_total.x+54,i.m_goin_image.y=i.m_coin_total.y+42},i,2e3)},e.prototype.restartHandler=function(t){this.m_score.text="0",this.m_progress_group.visible=!1,this.m_shot_type.visible=!1,this.m_combo.visible=!1,this.m_mask.visible=!1},e.prototype.updateScoreHandler=function(t){var e=this,i=new eui.Label;this.addChild(i),i.text="+"+t.data.score;var r=t.data.pos;i.size=50,i.width=90,i.anchorOffsetX=45,i.textAlign="center",i.visible=!0,r.anchorOffsetX=0,r.anchorOffsetY=0,i.y=Utils.euiPosToNormal1(r).y,i.x=Utils.euiPosToNormal1(r).x,i.scaleX=i.scaleY=1,i.alpha=1,egret.Tween.get(i).to({scaleX:1.2,scaleY:1.2},200).to({scaleX:1,scaleY:1},200).to({y:i.y-150,alpha:1},500,egret.Ease.sineOut).call(function(){i.visible=!1,i.parent&&i.parent.removeChild(i),i=null});var n=GameManager.getInstance().scoreManager.totalScore;egret.Tween.get(this.m_score).wait(100).to({scaleX:1.2,scaleY:1.2},200).call(function(){e.m_score.text=n+"",egret.Tween.get(e.m_score).to({scaleX:1,scaleY:1},200)})},e.prototype.addEffectHandler=function(t){var e=t.data.type;"highShot"==e?(this.m_shot_type.visible=!0,this.m_shot_type.text="HIGH ARC SHOT"):"kongxin"==e?(this.m_shot_type.visible=!0,this.m_shot_type.text="CLEAN SHOT"):"bank"==e?(this.m_shot_type.visible=!0,this.m_shot_type.text="BANK SHOT"):"yashao"==e?(this.m_shot_type.visible=!0,this.m_shot_type.text="BUZZER BEATER",this.m_mask.visible=!1):"null"==e&&(this.m_shot_type.visible=!1),this.updateCombo()},e.prototype.updateCombo=function(){var t=this,e=GameManager.getInstance().baskectBallManager.endlessCombo;e>0?(this.m_combo.visible=!0,e>4?this.m_combo.text="Fire "+e+"X":this.m_combo.text=e+"X"):this.m_combo.visible=!1,egret.Tween.removeTweens(this.m_shot_group),this.m_shot_group.visible=!0,egret.Tween.get(this.m_shot_group).to({x:(GameConfig.curWidth()-this.m_shot_group.width)/2,alpha:1},200).wait(500).to({x:0,alpha:0},200,egret.Ease.sineOut).call(function(){t.m_shot_group.visible=!1,t.m_shot_group.x=500})},e.prototype.updateComboProgress=function(t){this.m_progress_group.visible=!0;var e=t.data.percent;t.data.round;this.m_progress_bg.source="img_xuetiao_l2_png",this.m_progress.source="img_xuetiao_l1_png",this.m_progress.mask=this.m_progress_mask,this.m_progress_mask.width=257*e,this.m_progress_bg.visible=!0,this.m_zhen_short.rotation=90+270*(1-e),this.m_zhen_long.rotation=-90+360*(1-e),0>=e&&(this.dispatchEvent(new egret.Event(BaskectBallManager.COMPLETE_TIMEOUT)),this.m_progress_group.visible=!1)},e.prototype.showCoin=function(t){var e=t.data.x,i=t.data.y;this._coin||(this._coin=DragonUtils.createDragonBonesDisplay("coin_ske_json","coin_tex_json","coin_tex_png","Sprite"),dragonBones.WorldClock.clock.add(this._coin),this._coinDisplay=this._coin.display,this.m_goin_image.parent.addChildAt(this._coinDisplay,4),this._coin.animation.play("Sprite",-1)),this._coinDisplay.alpha=1,this._coinDisplay.x=e,this._coinDisplay.y=i},e.prototype.collectCoin=function(t){var e=this;if(this._coin){var i=this.m_coin_total.x+50,r=this.m_coin_total.y+40,n="left"==GameManager.getInstance().baskectBallManager.curSide?this._coinDisplay.x+100:this._coinDisplay.x-100;egret.Tween.get(this._coinDisplay).to({x:n},100).to({x:i,y:r},600).call(function(){e._coinDisplay.alpha=0,egret.Tween.get(e.m_goin_image).to({scaleX:1.6,scaleY:1.6},200).to({scaleX:1,scaleY:1},200),e.updateGold(!0)})}},e.prototype.updateGold=function(t){void 0===t&&(t=!1),t&&GameManager.getInstance().baskectBallManager.collectCoinsNumber(1);var e=GameManager.getInstance().baskectBallManager.coinsNumber;this.m_gold.text=e+""},e}(core.EUIComponent);__reflect(EndlessScore.prototype,"EndlessScore");var LobbyView=function(t){function e(){var e=t.call(this)||this;return e.isGetSkin=!1,e.inter=0,e.skinName="LoginViewexml",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.left=0,this.right=0,this.top=0,this.bottom=0,EventUtils.logEvent("launch_lobbyUI")},e.prototype.onShow=function(e){t.prototype.onShow.call(this),"undefined"!=typeof gmbox&&gmbox.updateActionView({action:2}),SoundMgr.getInstance(),SkinManager.getInstance(),this.getFirstInfo(),this.initLabel(),this.initSound(),TweenUtil.playTweenGroup(this.tween,!0)},e.prototype.initSound=function(){GameConfig.soundSwitch?this.m_sound_btn.source="img_shengyin_png":this.m_sound_btn.source="img_shengyin2_png"},e.prototype.initLabel=function(){this._rank_label.text=LanguageManager.instance.getLangeuage(9),this._skin_label.text=LanguageManager.instance.getLangeuage(10)},e.prototype.onHide=function(e){t.prototype.onHide.call(this),"undefined"!=typeof gmbox&&gmbox.updateActionView({action:1}),egret.clearInterval(this.inter),TweenUtil.stopTweenGroup(this.tween)},e.prototype.addListener=function(){this.m_game_group.addEventListener(egret.TouchEvent.TOUCH_TAP,this.goGameHandler,this),this.m_mode_group.addEventListener(egret.TouchEvent.TOUCH_TAP,this.changeMode,this),this.m_rank_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.rankHandler,this),this.m_skin_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.skinsHandler,this),this.m_sound_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.changeSound,this),this.m_vibrate_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.changedVibrate,this)},e.prototype.removeListener=function(){this.m_game_group.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.goGameHandler,this),this.m_mode_group.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.changeMode,this),this.m_rank_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.rankHandler,this),this.m_skin_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.skinsHandler,this),this.m_sound_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.changeSound,this)},e.prototype.goGameHandler=function(t){EventUtils.logEvent("click_playGame"),GlobalManager.getInstance().goGame()},e.prototype.changeMode=function(t){EventUtils.logEvent("click_changeMode"),GameConfig.gameMode==GameConfig.GameMode.TIME?GameConfig.gameMode=GameConfig.GameMode.ENDLESS:GameConfig.gameMode==GameConfig.GameMode.ENDLESS&&(GameConfig.gameMode=GameConfig.GameMode.TIME),localStorage.setItem("mode",JSON.stringify({mode:GameConfig.gameMode})),this.updateBg()},e.prototype.rankHandler=function(t){EventUtils.logEvent("click_rank"),Facebook.isFBInit()?core.ResUtils.loadGroups(["rank"],function(t){},function(t){},function(t){PlatfromUtil.getPlatform().getLeaderboard()},this):gmbox.openRankPage()},e.prototype.shareHandler=function(t){EventUtils.logEvent("click_share"),PlatfromUtil.getPlatform().share()},e.prototype.skinsHandler=function(t){EventUtils.logEvent("click_skin"),core.ResUtils.loadGroups(["skin"],function(t){},function(t){},function(t){(new ChangeSkinView).popUp(!0)},this)},e.prototype.updateBg=function(){GameConfig.gameMode==GameConfig.GameMode.TIME?this.m_mode_name.text="Time Mode":GameConfig.gameMode==GameConfig.GameMode.ENDLESS&&(this.m_mode_name.text="Fun Mode")},e.prototype.changeSound=function(t){GameConfig.soundSwitch=!GameConfig.soundSwitch,this.updateSound(),localStorage.setItem("soundSwitch",JSON.stringify({soundSwitch:GameConfig.soundSwitch}))},e.prototype.updateSound=function(){GameConfig.soundSwitch?(this.m_sound_btn.source="img_shengyin_png",SoundMgr.getInstance().playBGM()):(this.m_sound_btn.source="img_shengyin2_png",SoundMgr.getInstance().stopBGM())},e.prototype.changedVibrate=function(t){GameConfig.vibrateSwitch=!GameConfig.vibrateSwitch,GameConfig.vibrateSwitch?this.m_vibrate_btn.source="img_zhengdong1_png":this.m_vibrate_btn.source="img_zhengdong2_png"},e.prototype.release=function(){t.prototype.release.call(this),TweenUtil.stopTweenGroup(this.tween)},e.prototype.getLocalData=function(){var t=localStorage.getItem("mode");void 0==t||""==t?GameConfig.gameMode=GameConfig.GameMode.TIME:(GameConfig.gameMode=JSON.parse(t).mode,this.updateBg());var e=localStorage.getItem("showTips");void 0==e||""==e?GameConfig.showTips=!0:GameConfig.showTips=JSON.parse(e).showTips;var i=localStorage.getItem("soundSwitch");void 0==i||""==i?(GameConfig.soundSwitch=!0,this.updateSound()):(GameConfig.soundSwitch=JSON.parse(i).soundSwitch,this.updateSound())},e.prototype.readDataFromFacebook=function(){var t=GameManager.getInstance().baskectBallManager;FacebookStorage.getInstance().loadDataFormFB(["gameCoin","ownSkin","usingSkin","rankScore"],function(e){egret.log(e),void 0==e.gameCoin?t.coinsNumber=0:t.coinsNumber=e.gameCoin,void 0==e.ownSkin?t.skinInfo=["0"]:t.skinInfo=e.ownSkin.split(","),void 0==e.usingSkin?t.use=0:t.use=e.usingSkin,void 0==e.rankScore?t.rankScore=0:t.rankScore=e.rankScore})},e.prototype.readDataFromLocal=function(){var t=GameManager.getInstance().baskectBallManager,e=localStorage.getItem("gameCoin");void 0==e||""==e?t.coinsNumber=0:t.coinsNumber=JSON.parse(e).gameCoin;var i=localStorage.getItem("ownSkin");void 0==i||""==i?t.skinInfo=["0"]:t.skinInfo=JSON.parse(i).ownSkin.split(",");var r=localStorage.getItem("usingSkin");void 0==r||""==r?t.use=0:t.use=JSON.parse(r).usingSkin;var n=localStorage.getItem("rankScore");void 0==n||""==n?t.rankScore=0:t.rankScore=JSON.parse(n).rankScore},e.prototype.getFirstInfo=function(){this.getLocalData(),Facebook.isFBInit()?this.readDataFromFacebook():this.readDataFromLocal()},e}(core.EUIComponent);__reflect(LobbyView.prototype,"LobbyView");var MainView=function(t){function e(){var e=t.call(this)||this;return e._ballAngular=.05,e._ballForce_x=4,e._ballForce_y=-16,e._netDisplays=[],e._netW=4,e._netH=4,e._isFirst=!0,e._avgposYArr=[],e._isKongxin=!0,e._isBank=!1,e._isHighShot=!1,e._basketrys=new Map,e._hou=[],e._qian=[],e._fire=[],e._isReadyGo=!1,e.sideleftPosY=-1,e.sideRightPosY=1,e._fromBank=!1,e._isTilt=!1,e._shakeNum=1,e._hasShake=!1,e._fromUnder=new Map,e._netAnimation=!1,e._switching=!1,e._hasWin=!1,e._jinQiuStatus=new Map,e._tempY=0,e._tempX=0,e._flagTimestamp=-1,e._finishRound=!1,e._isBabySleep=!1,e.hasGameOver=!1,e._playGame=!1,e._loadHelpRes=!1,e.skinName="resource/assets/exml/MainView.exml",e._manager=GameManager.getInstance().baskectBallManager,e}return __extends(e,t),e.prototype.childrenCreated=function(){var e=this;if(t.prototype.childrenCreated.call(this),this.left=0,this.right=0,this.top=0,this.bottom=0,this._matterScene=new core.MatterScene,this._manager.matterScene=this._matterScene,this._walls=new MatterWalls,this.addChild(this._walls),this._particleView=new ParticleView,this.addChild(this._particleView),GameConfig.openGUI){core.DatGuiUtil.getInstance().addItem("ball_x",this._ballForce_x),core.DatGuiUtil.getInstance().addItem("ball_y",this._ballForce_y),core.DatGuiUtil.getInstance().addItem("gravity",this._matterScene.gravity);var i=this;core.DatGuiUtil.getInstance().addEventListener(core.DatGuiUtil.DAT_GUI_FINISH_CHANGE,function(t){var r=t.data;"ball_x"==r.name?i._ballForce_x=r.val:"ball_y"==r.name?i._ballForce_y=r.val:(r.name="gravity")&&(e._matterScene.gravity=r.val)},this)}GameConfig.gameMode==GameConfig.GameMode.TIME?EventUtils.logEvent("launch_timeMode_game"):EventUtils.logEvent("launch_funMode_game")},e.prototype.creatScenne=function(){var t=this;this._basketrys&&(this._basketrys.forEach(function(t,e){var i=t;i.forEach(function(t){core.MatterUtil.removeBody(t)})}),this._basketrys.clear());var e=this._manager.curPos;if(e){var i;e.forEach(function(e){var r=core.MatterUtil.addOneBox(Utils.euiPosToNormal(t["m_"+t._manager.curSide+"_basketry_kuan"+e]).x,Utils.euiPosToNormal(t["m_"+t._manager.curSide+"_basketry_kuan"+e]).y,t["m_"+t._manager.curSide+"_basketry_kuan"+e].width,t["m_"+t._manager.curSide+"_basketry_kuan"+e].height,0),n=core.MatterUtil.addOneBox(Utils.euiPosToNormal(t["m_"+t._manager.curSide+"_colli_point"+(2*e-1)]).x,Utils.euiPosToNormal(t["m_"+t._manager.curSide+"_colli_point"+(2*e-1)]).y,t["m_"+t._manager.curSide+"_colli_point"+(2*e-1)].width,t["m_"+t._manager.curSide+"_colli_point"+(2*e-1)].height,0),a=core.MatterUtil.addOneBox(Utils.euiPosToNormal(t["m_"+t._manager.curSide+"_colli_point"+2*e]).x,Utils.euiPosToNormal(t["m_"+t._manager.curSide+"_colli_point"+2*e]).y,t["m_"+t._manager.curSide+"_colli_point"+2*e].width,t["m_"+t._manager.curSide+"_colli_point"+2*e].height,0);t.createNet(e,1),i=[],Matter.World.add(t._matterScene.world,r),r.isStatic=!0,r.label="basketryBank",i.push(r),Matter.World.add(t._matterScene.world,n),n.isStatic=!0,n.label="basketryPoint",i.push(n),Matter.World.add(t._matterScene.world,a),a.isStatic=!0,a.label="basketryPoint",i.push(a),t._basketrys.set(e,i)})}},e.prototype.clearArmature=function(t){null!=t&&0!=t.length&&t.forEach(function(t){t&&(t.animation.stop(),DragonUtils.removeFromParent(t.display),dragonBones.WorldClock.clock.remove(t),t=null)})},e.prototype.createNet=function(t,e){this["m_"+this._manager.curSide+"_basketry_part"+(2*t-1)].removeChildren(),this["m_"+this._manager.curSide+"_basketry_part"+2*t].removeChildren(),this.factory||(this.factory=DragonUtils.createDragonBones("net_back_ske_json","net_back_tex_json","net_back_tex_png"));var i=this.factory.buildArmature(""+e);this.factory2||(this.factory2=DragonUtils.createDragonBones("net_font_ske_json","net_font_tex_json","net_font_tex_png"));var r=this.factory2.buildArmature(""+e);dragonBones.WorldClock.clock.add(i),this._hou.push(i);var n=i.display;"left"==this._manager.curSide?n.scaleX=-1:n.scaleX=1,n.anchorOffsetX=61,dragonBones.WorldClock.clock.add(r),this._qian.push(r);var a=r.display;"left"==this._manager.curSide?a.scaleX=-1:a.scaleX=1,a.anchorOffsetX=61,this["m_"+this._manager.curSide+"_basketry_part"+(2*t-1)].addChild(n),this["m_"+this._manager.curSide+"_basketry_part"+2*t].addChild(a),i.animation.play("newAnimation",1),r.animation.play("newAnimation",1)},e.prototype.playFire=function(t){var e=this;if(!(GameConfig.gameMode==GameConfig.GameMode.TIME&&this._manager.curCombo<4||GameConfig.gameMode==GameConfig.GameMode.ENDLESS&&this._manager.endlessCombo<5)){var i=this._fire.pop();i||(i=DragonUtils.createDragonBonesDisplay("fire_ske_json","fire_tex_json","fire_tex_png","Sprite"),dragonBones.WorldClock.clock.add(i),i.addEventListener(dragonBones.EgretEvent.COMPLETE,function(){e._fire.push(i),i.display.parent&&i.display.parent.removeChild(i.display)},this));var r=i.display;r.x=60,r.y=-40,this["m_"+this._manager.curSide+"_fire_group"+t].addChild(r),i.animation.play("Sprite",-1)}},e.prototype.checkNetCollision=function(){if(2==this._ballBody.collisionFilter.mask&&(this._ballBody.position.y>600||!this._hasWin)){var t=this._ballBody.velocity.y;this.addBallBody(this._ballBody.position.y,0,this._ballBody.position.x),Matter.Body.setVelocity(this._ballBody,{x:0,y:t})}},e.prototype.disableNetCollision=function(){this._ballBody.collisionFilter.mask=2},e.prototype.onShow=function(e){t.prototype.onShow.call(this),this.readyGo()},e.prototype.readyGo=function(){var t=this;this._isReadyGo||(this._isReadyGo=!0,this._readyGo.visible=!0,SoundMgr.getInstance().playReadyGo(),this.tween.play(),this.tween.once(egret.Event.COMPLETE,function(){t.m_gamedesc.visible=GameConfig.showTips,TweenUtil.playTweenGroup(t.game,!0),t.restartHandler(null)},this))},e.prototype.startGame=function(){this._matterScene&&(this.switchSideHandler(),this.addBallBody(-1,0,350),this.m_shadow.visible=!0)},e.prototype.addBallBody=function(t,e,i){void 0===t&&(t=-1),void 0===e&&(e=0),void 0===i&&(i=-1),-1==t&&(t=GameConfig.curHeight()/2),-1==i&&(i="right"==this._manager.curSide?10:GameConfig.curWidth()-10),core.MatterUtil.removeBody(this._ballBody),this._ballBody=core.MatterUtil.addOneBall(i,t,this.m_ball.width/2,0),this._ballBody.density=.3,this._ballBody.restitution=.7,this._ballBody.displays=[this.m_ball],this._ballBody.label="ball",this._ballBody.collisionFilter.group=-2,Matter.World.add(this._matterScene.world,this._ballBody),e&&Matter.Body.setVelocity(this._ballBody,{x:e,y:0})},e.prototype.onHide=function(e){t.prototype.onHide.call(this)},e.prototype.addListener=function(){Matter.Events.on(this._matterScene.engine,"collisionStart",this.onCollisionStart.bind(this)),Matter.Events.on(this._matterScene.engine,"collisionEnd",this.onCollisionEnd.bind(this)),Matter.Events.on(this._matterScene.engine,"beforeUpdate",this.onUpdateBefore.bind(this)),this._manager.addEventListener(BattleEventConst.GAME_START,this.readyGo,this),this._manager.addEventListener(BaskectBallManager.SWITCH_SIDE,this.switchSideHandler,this),this._manager.addEventListener(BaskectBallManager.COMPLETE_TIMEOUT,this.completeTimeoutHandler,this),this._manager.addEventListener(BaskectBallManager.REBORN,this.rebornHandler,this),this._manager.addEventListener(BaskectBallManager.CHANGE_SKIN,this.changeSkinHandler,this),GameManager.getInstance().addEventListener(GameManager.PAUSE_GAME,this.pauseGameHandler,this),GameManager.getInstance().addEventListener(GameManager.RESUME_GAME,this.resumeGameHandler,this),GameManager.getInstance().addEventListener(GameManager.RESTART_GAME,this.restartHandler,this),this.m_back.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showExitDialog,this),this.m_help.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showHelpDialog,this),this.m_pause.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showPauseDialog,this)},e.prototype.removeListener=function(){this.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.shotBallHandler,this),Matter.Events.off(this._matterScene.engine,"collisionStart",this.onCollisionStart.bind(this)),Matter.Events.off(this._matterScene.engine,"collisionEnd",this.onCollisionEnd.bind(this)),Matter.Events.off(this._matterScene.engine,"beforeUpdate",this.onUpdateBefore.bind(this)),this._manager.removeEventListener(BattleEventConst.GAME_START,this.readyGo,this),this._manager.removeEventListener(BaskectBallManager.SWITCH_SIDE,this.switchSideHandler,this),this._manager.removeEventListener(BaskectBallManager.COMPLETE_TIMEOUT,this.completeTimeoutHandler,this),this._manager.removeEventListener(BaskectBallManager.REBORN,this.rebornHandler,this),this._manager.removeEventListener(BaskectBallManager.CHANGE_SKIN,this.changeSkinHandler,this),GameManager.getInstance().removeEventListener(GameManager.PAUSE_GAME,this.pauseGameHandler,this),GameManager.getInstance().removeEventListener(GameManager.RESUME_GAME,this.resumeGameHandler,this),GameManager.getInstance().removeEventListener(GameManager.RESTART_GAME,this.restartHandler,this),this.m_back.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.showExitDialog,this),this.m_help.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.showHelpDialog,this),this.m_pause.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.showPauseDialog,this)},e.prototype.stopFrontMc=function(t){},e.prototype.stopBackMc=function(t){},e.prototype.pauseGameHandler=function(t){this.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.shotBallHandler,this),this._matterScene&&(this._matterScene.runner.enabled=!1),this._manager.pauseGame()},e.prototype.resumeGameHandler=function(t){this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.shotBallHandler,this),this._matterScene&&(this._matterScene.runner.enabled=!0),this._manager.resumeGame(!this._isFirst)},e.prototype.rebornGameHandler=function(t){this.hasGameOver=!1,this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.shotBallHandler,this),this._matterScene&&(this._matterScene.runner.enabled=!0),this._manager.rebornGame()},e.prototype.restartGameHandler=function(t){this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.shotBallHandler,this),this._matterScene&&(this._matterScene.runner.enabled=!0)},e.prototype.switchSideHandler=function(){var t=this;this._isKongxin=!0,this._isBank=!1,this._hasWin=!1,this._isHighShot=!1,this._jinQiuStatus.clear(),this._finishRound=!1,this._hasShake=!1,GameConfig.gameMode==GameConfig.GameMode.TIME?this._isFirst?this._manager.startTimeout():this._manager.startCombTimer():GameConfig.gameMode==GameConfig.GameMode.ENDLESS&&(this._isFirst||this._manager.startCombTimer()),this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.shotBallHandler,this),this.m_left.visible=this.m_right.visible=!1,this._shapeContainer&&(this._shapeContainer.visible=!1),this.hideView(),this._manager.isYanMode()?(this._particleView&&this.addChild(this._particleView),this.addChild(this.m_ball)):(this.addChild(this.m_ball),this._particleView&&this.addChild(this._particleView)),"left"==this._manager.curSide?(this._shapeContainer=this.m_shapeContainer_left,this.m_left.visible=!0,this.m_left.right=500,egret.Tween.get(this.m_left).to({right:0},400,egret.Ease.bounceIn).call(function(){t.creatScenne(),t._shapeContainer.visible=!0,t._manager.isYanMode()?(t.m_left_ball_container.addChild(t._particleView),t.m_left_ball_container.addChild(t.m_ball)):(t.m_left_ball_container.addChild(t.m_ball),t.m_left_ball_container.addChild(t._particleView)),t.showCoinImage()})):(this.m_right.visible=!0,this.m_right.left=500,this._shapeContainer=this.m_shapeContainer_right,egret.Tween.get(this.m_right).to({left:0},400,egret.Ease.bounceIn).call(function(){t.creatScenne(),t._shapeContainer.visible=!0,t._manager.isYanMode()?(t.m_right_ball_container.addChild(t._particleView),t.m_right_ball_container.addChild(t.m_ball)):(t.m_right_ball_container.addChild(t.m_ball),t.m_right_ball_container.addChild(t._particleView)),t.showCoinImage()}))},e.prototype.showCoinImage=function(){if(GameConfig.gameMode==GameConfig.GameMode.ENDLESS){var t,e,i=this._manager.curPos[0],r=125,n=230,a=core.MathUtils.random(0,2);1==i?(t="left"==this._manager.curSide?a?r:r+100:a?GameConfig.curWidth()-r:GameConfig.curWidth()-r-100,e=GameConfig.curHeight()-796-n):2==i?(t="left"==this._manager.curSide?a?r:r+100:a?GameConfig.curWidth()-r:GameConfig.curWidth()-r-100,e=GameConfig.curHeight()-596-n):(t="left"==this._manager.curSide?a?r:r+100:a?GameConfig.curWidth()-r:GameConfig.curWidth()-r-100,e=GameConfig.curHeight()-396-n),this["m_"+this._manager.curSide+"_coin"].visible=!0,this["m_"+this._manager.curSide+"_coin"].x=t,this["m_"+this._manager.curSide+"_coin"].y=e,this._manager.dispatchEventWith("show_coin",!1,{x:t,y:e})}},e.prototype.isCollectCoin=function(){if(this["m_"+this._manager.curSide+"_coin"].visible){var t=this["m_"+this._manager.curSide+"_coin"].x-14,e=this["m_"+this._manager.curSide+"_coin"].x+14,i=this["m_"+this._manager.curSide+"_coin"].y-14,r=this["m_"+this._manager.curSide+"_coin"].y+14;(this.m_ball.hitTestPoint(t,i)||this.m_ball.hitTestPoint(t,r)||this.m_ball.hitTestPoint(e,i)||this.m_ball.hitTestPoint(e,r))&&(this["m_"+this._manager.curSide+"_coin"].visible=!1,this._manager.dispatchEvent(new egret.Event("collect_coin")))}},e.prototype.hideView=function(){var t=this;this.clearArmature(this._hou),this.clearArmature(this._qian);[1,2,3].forEach(function(e){t["m_"+t._manager.curSide+"_basketry_block"+e].visible=!1,t["m_"+t._manager.curSide+"_basketry_part"+(2*e-1)].visible=!1,t["m_"+t._manager.curSide+"_basketry_part"+2*e].visible=!1}),this.showView()},e.prototype.showView=function(){var t=this,e=this._manager.curPos;e&&e.forEach(function(e){t["m_"+t._manager.curSide+"_basketry_block"+e].visible=!0,t["m_"+t._manager.curSide+"_basketry_part"+(2*e-1)].visible=!0,t["m_"+t._manager.curSide+"_basketry_part"+2*e].visible=!0})},e.prototype.changeSidePosY=function(t){var e,i=0,r=0;e="left"==t?this.m_left:this.m_right,r=core.MathUtils.random(200,GameConfig.curHeight()-500),i=r-this["m_"+this._manager.curSide+"_basketry_block"].top,egret.log(r,i);for(var n=0;n<e.numChildren;n++){var a=e.getChildAt(n);if(a.numChildren&&0==a.top)for(var o=0;o<a.numChildren;o++){var s=a.getChildAt(o);s.top+=i}else 0!=a.top&&(a.top+=i)}},e.prototype.completeTimeoutHandler=function(t){this.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.shotBallHandler,this)},e.prototype.rebornHandler=function(t){this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.shotBallHandler,this),this.rebornGameHandler(null)},e.prototype.changeSkinHandler=function(t){console.log(t)},e.prototype.onCollisionStart=function(t){for(var e=t.pairs,i=this,r=0;r<e.length;r++){e[r];"ball"==e[r].bodyA.label&&"background"==e[r].bodyB.label||"background"==e[r].bodyA.label&&"ball"==e[r].bodyB.label?(SoundMgr.getInstance().playGround(),this.isGameover(!0)):"ball"==e[r].bodyA.label&&"basketryPoint"==e[r].bodyB.label||"basketryPoint"==e[r].bodyA.label&&"ball"==e[r].bodyB.label?(this._isKongxin=!1,SoundMgr.getInstance().playKuang(),this._fromBank&&(this._isBank=!0)):("ball"==e[r].bodyA.label&&"basketryBank"==e[r].bodyB.label||"basketryBank"==e[r].bodyA.label&&"ball"==e[r].bodyB.label)&&(SoundMgr.getInstance().playBank(),i._fromBank=!0,egret.clearTimeout(this._bankTimeout),this._bankTimeout=egret.setTimeout(function(){i._fromBank=!1},i,1e3))}},e.prototype.shakeBasketry=function(t,e,i){1==t&&e>20&&this._isBank?(this.createNet(i,6),this._isTilt=!0):(this.createNet(i,2),this._isTilt=!1)},e.prototype.screenShake=function(){var t=this;if(!(this._hasShake&&this._shakeNum<=0||this._manager.curCombo<5)){this._hasShake=!0;var e=this.parent,i=50,r=10,n=function(){egret.Tween.get(e).to({x:r,y:-r},i).to({x:0,y:0},i).to({x:-r,y:r},2*i).to({x:0,y:0},i).call(function(){t._shakeNum--,t._shakeNum>0?n():t._shakeNum=1})};n()}},e.prototype.isJinQiu=function(t,e){var i=this,r=this;if(!this["m_"+this._manager.curSide+"_basketry_block"+t].visible)return!1;var n=Utils.euiPosToNormal(this["m_"+this._manager.curSide+"_net"+(2*t-1)]),a=Utils.euiPosToNormal(this["m_"+this._manager.curSide+"_net_side"+t]),o=this.m_ball.hitTestPoint(n.x,n.y),s=this.m_ball.hitTestPoint(a.x,a.y);o&&(this._netAnimation||(this._netAnimation=!0,this.createNet(t,5),egret.setTimeout(function(){i._netAnimation=!1},r,750)),this._fromUnder.set(t,!0),egret.clearTimeout(this["_forceTimeout_"+t]),this["_forceTimeout_"+t]=egret.setTimeout(function(){r._fromUnder.set(t,!1)},r,500)),s&&(this._netAnimation||(this._netAnimation=!0,this.createNet(t,4),egret.setTimeout(function(){i._netAnimation=!1},r,750)));var l=Utils.euiPosToNormal(this["m_"+this._manager.curSide+"_net"+2*t]);if(this.m_ball.hitTestPoint(l.x,l.y)&&!this._fromUnder.get(t)){if(t==e){var h=GameConfig.curHeight()-this._lastPointerPos.y,c=this["m_"+this._manager.curSide+"_basketry_block"+e].bottom+250;h-c>=100&&(this._isHighShot=!0)}return!0}return!1},e.prototype.isWin=function(){var t=this,e=this,i=this._manager.curPos,r=i.length;i.forEach(function(n){if(!t._jinQiuStatus.get(n)&&t.isJinQiu(n,i[0])){var a=void 0;a=Math.abs(t._ballBody.velocity.y),a=t._manager.curCombo>=5?1.5*a:a,a=Math.min(a,30),Matter.Body.setVelocity(t._ballBody,{x:0,y:a}),SoundMgr.getInstance().playJinqiu(),t.screenShake(),t.shakeBasketry(r,a,n),t.playFire(n),t.updateScore(n),t._jinQiuStatus.set(n,!0);var o=t._basketrys.get(n);o&&o.forEach(function(t){core.MatterUtil.removeBody(t)}),egret.clearTimeout(t._jinqiuTimeOut),t._jinqiuTimeOut=egret.setTimeout(function(){e._hasWin=!0},e,1e3),i[r-1]==n&&(e._hasWin=!0,egret.clearTimeout(t._jinqiuTimeOut))}})},e.prototype.onCollisionEnd=function(t){},e.prototype.onUpdateBefore=function(t){var e=this;if(this._manager.isLastTime()&&this.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.shotBallHandler,this),!this.isGameover()){if(this._lastJinQiuTime-this._manager.timeoutSecond>=15?(this._manager.dispatchEventWith(Girl.PLAY_ANIMATION,!1,{type:ANIMATION_TYPE.TANQI}),this._lastJinQiuTime=this._manager.timeoutSecond-10):!this._isBabySleep&&this._lastShotTime-this._manager.timeoutSecond>=10&&(this._isBabySleep=!0,this._manager.dispatchEventWith(Girl.PLAY_ANIMATION,!1,{type:ANIMATION_TYPE.CHUIPAOPAO})),this.isCollectCoin(),this.isWin(),this._hasWin){if(this._finishRound)return;var i=2;this._isTilt&&(i=10),i="left"==this._manager.curSide?i:-i,egret.setTimeout(function(){Matter.Body.setVelocity(e._ballBody,{x:i,y:e._ballBody.velocity.y})},this,50),this._lastJinQiuTime=this._manager.timeoutSecond,this._finishRound=!0,this._forceTimeout_1=null,this._forceTimeout_2=null,this._forceTimeout_3=null,this._switching||(this._manager.switchSide(),egret.clearTimeout(this._switchSideTimeout),this._switchSideTimeout=egret.setTimeout(function(){e.switchSideHandler()},this,400))}this._ballBody&&this._ballBody.position&&(this._ballBody&&this._ballBody.position.x>GameConfig.curWidth()+this._ballBody.displays[0].width?(this._ballBody.position.x=0,core.MatterUtil.removeBody(this._ballBody),this._tempY=this._ballBody.position.y,this._tempX=this._ballBody.velocity.x,this.addBallBody(this._tempY,this._tempX)):this._ballBody&&this._ballBody.position.x<-this._ballBody.displays[0].width&&(this._tempY=this._ballBody.position.y,this._tempX=this._ballBody.velocity.x,core.MatterUtil.removeBody(this._ballBody),this.addBallBody(this._tempY,this._tempX))),this._ballBody&&(this._particleView.updatePos(this._ballBody.position.x,this._ballBody.position.y),this.m_shadow.scaleX=this.m_shadow.scaleY=Math.abs(100/(this._ballBody.position.y-this.m_shadow.y)),this.m_shadow.scaleX>1?this.m_shadow.scaleX=this.m_shadow.scaleY=1:this.m_shadow.scaleX<.4&&(this.m_shadow.scaleX=this.m_shadow.scaleY=.4),this.m_shadow.x=this.m_ball.x)}},e.prototype.isGameover=function(t){var e=this;if(void 0===t&&(t=!1),!this.hasGameOver&&this._ballBody){var i=500;return Matter.Bounds.overlaps(this._ballBody.bounds,this._walls.bottomWall.bounds)&&(i=0),this._manager.isLastTime()&&this._ballBody&&this._ballBody.position.y>GameConfig.curHeight()-this.m_left_basketry_kuan1.bottom+i&&!this._hasWin?(egret.setTimeout(function(){e.timeOut()},this,1e3),this.hasGameOver=!0,!0):!1}},e.prototype.shotBallHandler=function(t){var e=this;if(!(this._ballBody.position.y<-100)){if(this._isBabySleep&&(this._isBabySleep=!1,this._manager.dispatchEventWith(Girl.PLAY_ANIMATION,!1,{type:ANIMATION_TYPE.NORMAL})),SoundMgr.getInstance().click(),this.m_gamedesc.visible)return EventUtils.logEvent("click_gameInfo"),this.m_gamedesc.alpha=.9,TweenUtil.stopTweenGroup(this.game),egret.Tween.get(this.m_gamedesc).wait(200).to({alpha:0},200,egret.Ease.backOut).call(function(){e.m_gamedesc.visible=!1}),void localStorage.setItem("showTips",JSON.stringify({showTips:!1}));this._lastPointerPos=new egret.Point(this._ballBody.position.x,this._ballBody.position.y),this._switching?"left"==this._manager.curSide?(Matter.Body.setVelocity(this._ballBody,{x:Math.abs(this._ballForce_x),y:this._ballForce_y}),Matter.Body.setAngularVelocity(this._ballBody,this._ballAngular)):(Matter.Body.setVelocity(this._ballBody,{x:-Math.abs(this._ballForce_x),y:this._ballForce_y}),Matter.Body.setAngularVelocity(this._ballBody,-this._ballAngular)):"right"==this._manager.curSide?(Matter.Body.setVelocity(this._ballBody,{x:Math.abs(this._ballForce_x),y:this._ballForce_y}),Matter.Body.setAngularVelocity(this._ballBody,this._ballAngular)):(Matter.Body.setVelocity(this._ballBody,{x:-Math.abs(this._ballForce_x),y:this._ballForce_y}),Matter.Body.setAngularVelocity(this._ballBody,-this._ballAngular)),this._lastShotTime=this._manager.timeoutSecond,this._playGame||(this._playGame=!0,EventUtils.logEvent("click_ballShot"))}},e.prototype.updateScore=function(t){var e=this,i={left:0,right:0,top:0,bottom:0};egret.setTimeout(function(){e._fromUnder.clear()},this,1e3);var r=this["m_"+this._manager.curSide+"_net"+2*t];if("left"==this._manager.curSide?(i.left=r.left,i.bottom=r.bottom):(i.right=r.right,i.bottom=r.bottom),!this._manager.isLastTime()||(0==this._jinQiuStatus.size&&(this._manager.addEffect("yashao"),this._manager.dispatchEventWith(Girl.PLAY_ANIMATION,!1,{type:ANIMATION_TYPE.TIAOQI})),i.bottom=r.bottom-200,GameManager.getInstance().scoreManager.updateScore("yashao",i),GameConfig.gameMode!=GameConfig.GameMode.ENDLESS)){i.bottom=r.bottom;var n=0;if(this._isHighShot){if(!this._manager.isLastTime()&&0==this._jinQiuStatus.size){this._manager.addEffect("highShot");var a=core.MathUtils.random(0,100);25>a&&this._manager.dispatchEventWith(Girl.PLAY_ANIMATION,!1,{type:ANIMATION_TYPE.TIAOQI}),3==this._manager.highShotCount&&(n+=10)}GameManager.getInstance().scoreManager.updateScore("highShot",i)}else if(this._isKongxin){if(!this._manager.isLastTime()&&0==this._jinQiuStatus.size){this._manager.addEffect("kongxin");var a=core.MathUtils.random(0,100);
30>a&&this._manager.dispatchEventWith(Girl.PLAY_ANIMATION,!1,{type:ANIMATION_TYPE.HUANHU}),5==this._manager.kongxinCount&&(n+=10)}GameManager.getInstance().scoreManager.updateScore("kongxin",i)}else if(this._isBank){if(!this._manager.isLastTime()&&0==this._jinQiuStatus.size){this._manager.addEffect("bank");var a=core.MathUtils.random(0,100);30>a&&this._manager.dispatchEventWith(Girl.PLAY_ANIMATION,!1,{type:ANIMATION_TYPE.HUANHU}),5==this._manager.bankCount&&(n+=10)}GameManager.getInstance().scoreManager.updateScore("bank",i)}else this._manager.isLastTime()||0!=this._jinQiuStatus.size||this._manager.addEffect("null"),GameManager.getInstance().scoreManager.updateScore("null",i);(10==this._manager.curCombo||20==this._manager.curCombo||30==this._manager.curCombo||40==this._manager.curCombo)&&(n+=10),n&&GameConfig.gameMode==GameConfig.GameMode.TIME&&(this._manager.collectCoinsNumber(n),this._manager.dispatchEventWith(BaskectBallManager.COLLECT_COINS,!1,{coinNumber:n,pos:i})),this._isFirst=!1}},e.prototype.timeOut=function(){var t=this;this._exitView&&this._exitView.parent&&this._exitView.closeDialog(),this._helpView&&this._helpView.parent&&this._helpView.closeDialog();var e=500;GameConfig.gameMode==GameConfig.GameMode.TIME&&(TweenUtil.playTweenGroup(this.timeout,!1),e=2e3),egret.setTimeout(function(){t.gameover()},this,e)},e.prototype.gameover=function(){var t=this;if(this.pauseGameHandler(null),egret.log("gameover"),!(this._gameoverDlg&&this._gameoverDlg.parent||this._rebornView&&this._rebornView.parent)){var e=!1;SwitchManager.openborn&&GameManager.getInstance().rebornCount>0&&(GameConfig.gameMode==GameConfig.GameMode.TIME&&GameManager.getInstance().scoreManager.totalScore>20?(e=!0,core.ResUtils.loadGroups(["reborn"],function(t){},function(t){},function(e){t._rebornView=new RebornView,t._rebornView.popUp(!0,0,0,0,0)},this)):GameConfig.gameMode==GameConfig.GameMode.ENDLESS&&GameManager.getInstance().scoreManager.totalScore>50&&(e=!0,core.ResUtils.loadGroups(["reborn_endless"],function(t){},function(t){},function(e){t._rebornView=new EndlessRebornDialog,t._rebornView.popUp(!0,0,0,0,0)},this))),e||core.ResUtils.loadGroups(["result"],function(t){},function(t){},function(e){t._gameoverDlg=new ResultDialog,t._gameoverDlg.popUp()},this)}},e.prototype.restartHandler=function(t){this._switching=!1,this._forceTimeout_1=null,this._forceTimeout_2=null,this._forceTimeout_3=null,this._jinqiuTimeOut=null,this._isFirst=!0,this._flagTimestamp=-1,this.sideleftPosY=-1,this.sideRightPosY=-1,this._lastShotTime=this._manager.timeoutSecond,this._lastJinQiuTime=this._manager.timeoutSecond,this._playGame=!1,core.MatterUtil.clearTimeouts(this),this.m_ball.source="mg_qiu_"+GameManager.getInstance().baskectBallManager.use+"_png",this._gameoverDlg&&this._gameoverDlg.closeDialog(),this.hasGameOver=!1,this._isBabySleep=!1,this._manager.reset(),null!=t&&this.restartGameHandler(null),this.startGame()},e.prototype.showExitDialog=function(){this._manager.timeoutSecond<=0||this._exitView&&this._exitView.parent||(EventUtils.logEvent("click_exit"),this._exitView=new ExitDialog,this._exitView.popUp())},e.prototype.showHelpDialog=function(){var t=this;this._manager.timeoutSecond<=0||this._loadHelpRes||this._helpView&&this._helpView.parent||(this._loadHelpRes=!0,EventUtils.logEvent("click_help"),core.ResUtils.loadGroups(["help"],function(t){},function(t){},function(e){t._helpView=new HelpDialog,t._helpView.popUp(),t._loadHelpRes=!1},this))},e.prototype.showPauseDialog=function(){if(!(this._manager.timeoutSecond<=0)){EventUtils.logEvent("click_pause");var t=new PauseDialog;t.popUp()}},e.prototype.release=function(){t.prototype.release.call(this),this._matterScene.clear(),this._matterScene=null,dragonBones.WorldClock.clock.clear(),this._fire=[],this._hou=[],this._qian=[]},e}(core.EUIComponent);__reflect(MainView.prototype,"MainView");var MatterWalls=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.left=0,this.right=0,this.top=0,this.bottom=0},e.prototype.onShow=function(e){t.prototype.onShow.call(this),this.bottomWall=core.MatterUtil.addOneBox(GameConfig.curWidth()/2,GameConfig.curHeight()-100,GameConfig.curWidth()+1e3,250,0),this.bottomWall.label="background"},e.prototype.onHide=function(e){t.prototype.onHide.call(this)},e.prototype.addListener=function(){},e.prototype.removeListener=function(){},e.prototype.release=function(){t.prototype.release.call(this)},e}(core.EUIComponent);__reflect(MatterWalls.prototype,"MatterWalls");var ParticleView=function(t){function e(){var e=t.call(this)||this;return e.touchEnabled=!1,e.touchChildren=!1,e}return __extends(e,t),e.prototype.onShow=function(e){t.prototype.onShow.call(this,e)},e.prototype.onHide=function(e){t.prototype.onHide.call(this,e)},e.prototype.addListener=function(){GameManager.getInstance().baskectBallManager.addEventListener(BaskectBallManager.ADD_EFFECT,this.addEffectHandler,this),GameManager.getInstance().baskectBallManager.addEventListener(BaskectBallManager.COMPLETE_COMBO,this.removeEffectHandler,this)},e.prototype.removeListener=function(){},e.prototype.addEffectHandler=function(t){t.data.type;if(this.system&&(this.system.stop(),this.system.parent&&this.system.parent.removeChild(this.system)),GameManager.getInstance().baskectBallManager.isYanMode()){var e=RES.getRes("maoyan_png"),i=RES.getRes("maoyan_json");this.system=new particle.GravityParticleSystem(e,i),this.addChild(this.system),this.system.start()}else if(GameManager.getInstance().baskectBallManager.isLightMode()){var e=RES.getRes("fire_png"),i=RES.getRes("fire_json");this.system=new particle.GravityParticleSystem(e,i),this.addChild(this.system),this.system.start()}else if(GameManager.getInstance().baskectBallManager.isFireMode()){var e=RES.getRes("fire_png"),i=RES.getRes("fire_json");this.system=new particle.GravityParticleSystem(e,i),this.addChild(this.system),this.system.start()}},e.prototype.removeEffectHandler=function(t){this.system&&(this.system.stop(),this.system.parent&&this.system.parent.removeChild(this.system))},e.prototype.changeTexture=function(t){var e=RES.getRes(t);this.system.changeTexture(e)},e.prototype.updatePos=function(t,e){this.system&&(this.system.emitterX=t,this.system.emitterY=e)},e}(core.EUIComponent);__reflect(ParticleView.prototype,"ParticleView");var ScoreManager=function(t){function e(){var e=t.call(this)||this;return e.totalScore=0,e.otherScore=0,e}return __extends(e,t),e.prototype.updateScore=function(t,i){var r=0;GameConfig.gameMode==GameConfig.GameMode.TIME?r=this.getTimeScore(t):GameConfig.gameMode==GameConfig.GameMode.ENDLESS&&(r=this.getEndLesScore(t)),this.totalScore+=r,this.dispatchEventWith(e.UPDATE_SCORE,!1,{score:r,pos:i}),game.BattleManager.instance.sendDragMessage(r)},e.prototype.getTimeScore=function(t){var e=0,i=GameManager.getInstance().baskectBallManager;switch(t){case"highShot":e+=3;break;case"yashao":e+=5;break;case"kongxin":e+=2;break;case"bank":e+=2;break;case"null":e+=1}return i.isLightMode()?e+=2:i.isFireMode()&&(e+=1),e},e.prototype.getEndLesScore=function(t){var e=GameManager.getInstance().baskectBallManager.endlessCombo,i=0;return i="null"==t?1:e},e.prototype.reset=function(){this.totalScore=0,this.otherScore=0},e.prototype.updateOtherScore=function(t){this.otherScore+=t,this.dispatchEventWith(BattleEventConst.UPDATE_OTHER_SCORE,!1,this.otherScore)},e.UPDATE_SCORE="update_self_score",e}(egret.EventDispatcher);__reflect(ScoreManager.prototype,"ScoreManager");var ScoreView=function(t){function e(){var e=t.call(this)||this;return e.randomRank=new Map,e.rankIndex=1,e.randomTime=new Map,e.timeIndex=1,e._hasUpdateSelf=!1,e.isGameOver=!1,e._isAnimation=!1,e.skinName="resource/assets/exml/ScoreView.exml",e._manager=GameManager.getInstance().scoreManager,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.left=0,this.right=0,this.top=0,this.bottom=0,this.generateRandomRank()},e.prototype.generateRandomRank=function(){this.randomRank.set(1,core.MathUtils.random(50,70)),this.randomRank.set(2,core.MathUtils.random(80,100)),this.randomRank.set(3,core.MathUtils.random(120,150)),this.randomTime.set(1,core.MathUtils.random(30,60)),this.randomTime.set(2,core.MathUtils.random(80,110)),this.randomTime.set(3,core.MathUtils.random(130,200))},e.prototype.onShow=function(e){var i=this;if(t.prototype.onShow.call(this),this.rankIndex=1,this.m_self_score.text="0",this.m_self_high_score.text=LanguageManager.instance.getLangeuage(17)+GameManager.getInstance().baskectBallManager.rankScore,this.updateGold(),this.updateSelfRank(),"undefined"!=typeof gmbox){var r=BatterInfo.instance.myUserInfo;r?(this.m_self_avatar.source=r.avatar,this.setPlayerIconMask(this.m_self_avatar)):egret.setTimeout(function(){var t=BatterInfo.instance.myUserInfo;t&&(i.m_self_avatar.source=t.avatar,i.setPlayerIconMask(i.m_self_avatar))},this,2e3)}},e.prototype.setPlayerIconMask=function(t){var e=this.createCircle(1,t.width/2-1);e.x=t.x,e.y=t.y,t.parent.addChild(e),t.mask=e},e.prototype.createCircle=function(t,e,i){void 0===t&&(t=.3),void 0===i&&(i=0);var r=new egret.Sprite;return r.graphics.clear(),r.graphics.beginFill(i,t),r.graphics.drawCircle(0,0,e),r.graphics.endFill(),r},e.prototype.addListener=function(){GameManager.getInstance().addEventListener(GameManager.RESTART_GAME,this.restartHandler,this),GameManager.getInstance().addEventListener(GameManager.REFRESH_RANK,this.updateSelfRank,this),GameManager.getInstance().baskectBallManager.addEventListener(GameManager.GAME_COMBO,this.updateCombo,this),GameManager.getInstance().baskectBallManager.addEventListener(GameManager.GAME_COMBO_PROGRESS,this.updateComboProgress,this),GameManager.getInstance().baskectBallManager.addEventListener(GameManager.GAME_TIME,this.updateTime,this),GameManager.getInstance().baskectBallManager.addEventListener(BaskectBallManager.ADD_EFFECT,this.addEffectHandler,this),GameManager.getInstance().baskectBallManager.addEventListener(BattleEventConst.VOICE_CHANGE,this.voiceChange,this),GameManager.getInstance().baskectBallManager.addEventListener(BaskectBallManager.COLLECT_COINS,this.collectCoin,this),this._manager.addEventListener(ScoreManager.UPDATE_SCORE,this.updateScoreHandler,this),this._manager.addEventListener(BattleEventConst.UPDATE_OTHER_SCORE,this.updateOtherScore,this),this.m_vibrate.addEventListener(egret.TouchEvent.TOUCH_TAP,this.switchMikeStatus,this),this.m_self_avatar.addEventListener(egret.TouchEvent.TOUCH_TAP,this.headClick,this),this.m_oppenent_avatar.addEventListener(egret.TouchEvent.TOUCH_TAP,this.headClick,this)},e.prototype.removeListener=function(){GameManager.getInstance().removeEventListener(GameManager.RESTART_GAME,this.restartHandler,this),GameManager.getInstance().addEventListener(GameManager.REFRESH_RANK,this.updateSelfRank,this),GameManager.getInstance().baskectBallManager.removeEventListener(GameManager.GAME_COMBO,this.updateCombo,this),GameManager.getInstance().baskectBallManager.removeEventListener(GameManager.GAME_COMBO_PROGRESS,this.updateComboProgress,this),GameManager.getInstance().baskectBallManager.removeEventListener(GameManager.GAME_TIME,this.updateTime,this),GameManager.getInstance().baskectBallManager.removeEventListener(BaskectBallManager.ADD_EFFECT,this.addEffectHandler,this),GameManager.getInstance().baskectBallManager.removeEventListener(BattleEventConst.VOICE_CHANGE,this.voiceChange,this),GameManager.getInstance().baskectBallManager.removeEventListener(BaskectBallManager.COLLECT_COINS,this.collectCoin,this),this._manager.removeEventListener(ScoreManager.UPDATE_SCORE,this.updateScoreHandler,this),this._manager.addEventListener(BattleEventConst.UPDATE_OTHER_SCORE,this.updateOtherScore,this),this.m_vibrate.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.switchMikeStatus,this),this.m_self_avatar.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.headClick,this),this.m_oppenent_avatar.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.headClick,this)},e.prototype.updateSelfRank=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){return this._hasUpdateSelf?[2]:(t=PlatfromUtil.getPlatform().getSelfRank(),t&&(this._hasUpdateSelf=!0,this.m_self_avatar.source=t.playerPicUrl,this.setPlayerIconMask(this.m_self_avatar)),this.updateOpponentsRank(!0,0),[2])})})},e.prototype.restartHandler=function(t){this.rankIndex=1,this.timeIndex=1,this.m_self_score.text="0",this.m_self_high_score.text=LanguageManager.instance.getLangeuage(17)+GameManager.getInstance().baskectBallManager.rankScore,this.generateRandomRank()},e.prototype.updateCombo=function(t){var e=t.data.round;5==e||15==e?(this.m_combo1.visible=!1,this.m_combo_label1.visible=!1,this.m_combo2.visible=!0,this.m_combo_label2.visible=!0,this.m_combo2.text=e+""):(this.m_combo1.visible=!0,this.m_combo_label1.visible=!0,this.m_combo2.visible=!1,this.m_combo_label2.visible=!1,this.m_combo1.text=e+"")},e.prototype.updateComboProgress=function(t){if(!this.isGameOver){var e=t.data.percent,i=t.data.round;5==i||15==i?(this.m_progress_bg.source="img_xuetiao_h2_png",this.m_progress.source="img_xuetiao_h1_png"):(this.m_progress_bg.source="img_xuetiao_l2_png",this.m_progress.source="img_xuetiao_l1_png"),this.m_progress.mask=this.m_progress_mask,this.m_progress_mask.width=257*e,this.m_progress_bg.visible=!0,this.m_progress.visible=!0,0>=e&&(this.dispatchEvent(new egret.Event(BaskectBallManager.COMPLETE_TIMEOUT)),this.m_progress_bg.visible=!1,this.m_progress.visible=!1,this.m_combo1.visible=!1,this.m_combo_label1.visible=!1,this.m_combo2.visible=!1,this.m_combo_label2.visible=!1)}},e.prototype.updateTime=function(t){var e=t.data.time;e>=0&&(this.m_time.text=e+""),10>=e?this.m_time.font="time_last_fnt":this.m_time.font="time_fnt",0==e?this.isGameOver=!0:this.isGameOver=!1},e.prototype.updateEnemy=function(t){var e=this,i=this.randomTime.get(this.timeIndex);if(!(i>=t)){var r=PlatfromUtil.getPlatform().getOpponentsPassMeRank(this.timeIndex,t);r&&(this.timeIndex++,this.m_enemy_group.visible=!0,this.m_enemy_group.x=-400,this.m_enemy_avatar.source=r.playerPicUrl,this.setPlayerIconMask(this.m_enemy_avatar),this.m_enemy_name.text=r.playerName,this.m_enemy_rank.text=LanguageManager.instance.getLangeuage(18)+r.playerRank,this.m_enemy_score.text=t+core.MathUtils.random(5,10)+"",this.m_enemy_label.text=LanguageManager.instance.getLangeuage(20),egret.Tween.get(this.m_enemy_group).to({x:196},400).call(function(){var t=DragonUtils.createDragonBonesDisplay("expression_ske_json","expression_tex_json","expression_tex_png","Sprite");dragonBones.WorldClock.clock.add(t);var i=t.display;i.x=60,i.y=40,e.m_biaoqing_group.addChild(i),t.animation.play("Sprite",-1),egret.setTimeout(function(){e.clearArmature(t),e.m_enemy_group.visible=!1},e,4e3)}))}},e.prototype.clearArmature=function(t){t&&(t.animation.stop(),DragonUtils.removeFromParent(t.display),dragonBones.WorldClock.clock.remove(t))},e.prototype.updateScoreHandler=function(t){var e=new eui.Label;this.addChild(e),e.text="+"+t.data.score;var i=t.data.pos;e.size=50,e.width=90,e.anchorOffsetX=45,e.textAlign="center",e.visible=!0,i.anchorOffsetX=0,i.anchorOffsetY=0,e.y=Utils.euiPosToNormal1(i).y,e.x=Utils.euiPosToNormal1(i).x,e.scaleX=e.scaleY=1,e.alpha=1,egret.Tween.get(e).to({scaleX:1.2,scaleY:1.2},200).to({scaleX:1,scaleY:1},200).to({y:e.y-150,alpha:1},500,egret.Ease.sineOut).call(function(){e.visible=!1,e.parent&&e.parent.removeChild(e),e=null});var r=this._manager.totalScore;this.updateOpponentsRank(!1,r),this.updateEnemy(r),this.m_self_score.text=r+""},e.prototype.updateOpponentsRank=function(t,e){var i=this;void 0===t&&(t=!0);var r=this.randomRank.get(this.rankIndex);if(!(e>0&&r>0&&r>=e)){t?this.rankIndex=1:this.rankIndex+=1;var n=this.randomRank.get(this.rankIndex),a=PlatfromUtil.getPlatform().getTargetOpponentsRank(this.rankIndex,n);egret.log(a),a&&a.length>=3?(this.m_oppenent_avatar.source=a[0].playerPicUrl,this.setPlayerIconMask(this.m_oppenent_avatar),this.m_oppenent_name.text=a[0].playerName,this.m_oppenent_rank.text=LanguageManager.instance.getLangeuage(18)+a[0].playerRank,this.m_oppenent_score.text=n+"",this.m_oppenent_label.text=LanguageManager.instance.getLangeuage(19),this.m_oppenent_avatar1.source=a[1].playerPicUrl,this.setPlayerIconMask(this.m_oppenent_avatar1),this.m_oppenent_avatar2.source=a[2].playerPicUrl,this.setPlayerIconMask(this.m_oppenent_avatar2),t||this._isAnimation||(this._isAnimation=!0,egret.Tween.get(this.m_guang).to({scaleX:1.3,scaleY:1.3},200).to({scaleX:0,scaleY:0},200),egret.Tween.get(this.m_opponent_group).to({x:572,y:180},100).to({x:552,y:200},200).to({x:562,y:190},100).to({scaleX:1.2,scaleY:1.2},100).to({scaleX:0,scaleY:0},300).to({x:1572,scaleX:1,scaleY:1},10).to({x:572},400).call(function(){i._isAnimation=!1}))):(this.m_opponent_group.visible=!1,this.m_guang.visible=!1,this.m_vs_image.visible=!1)}},e.prototype.updateOtherScore=function(t){this.m_oppenent_score.text=t.data+""},e.prototype.addEffectHandler=function(t){var e=this,i=t.data.type;if("highShot"==i)this.m_shot_type.source="img_high arc shot_png";else if("kongxin"==i)this.m_shot_type.source="img–clean shot_png";else if("bank"==i)this.m_shot_type.source="img_bank shot_png";else if("yashao"==i)this.m_shot_type.source="img_buxzzer_png";else if("null"==i)return void(this.m_shot.visible=!1);this.m_shot.visible=!0,egret.Tween.get(this.m_shot).to({x:0,alpha:1},400).to({x:31},100).wait(500).to({x:-500,alpha:0},500,egret.Ease.sineOut).call(function(){e.m_shot.visible=!1,e.m_shot.x=500})},e.prototype.updateGold=function(){var t=GameManager.getInstance().baskectBallManager.coinsNumber;this.m_gold.text=t+""},e.prototype.collectCoin=function(t){var e=this,i=(t.data.coinNumber,t.data.pos);this.m_goin_image.visible=!0,this.m_goin_image.y=Utils.euiPosToNormal1(i).y,this.m_goin_image.x=Utils.euiPosToNormal1(i).x,TweenUtil.playTweenGroup(this.coin,!0);var r=this.m_coin_total.x+50,n=this.m_coin_total.y+30;egret.Tween.get(this.m_goin_image).to({x:r,y:n},1e3).call(function(){TweenUtil.stopTweenGroup(e.coin),egret.Tween.get(e.m_goin_image).to({scaleX:0,scaleY:0},300),e.updateGold()})},e.prototype.showExitDialog=function(){EventUtils.logEvent("click_exit");var t=new ExitDialog;t.popUp()},e.prototype.showHelpDialog=function(){EventUtils.logEvent("click_help"),core.ResUtils.loadGroups(["help"],function(t){},function(t){},function(t){(new HelpDialog).popUp()},this)},e.prototype.switchMikeStatus=function(){},e.prototype.voiceChange=function(t){var e=t.data;this.updateVoiceStatus(e.userId,e.status)},e.prototype.updateVoiceStatus=function(t,e){},e.prototype.headClick=function(t){if("undefined"!=typeof gmbox){var e=void 0;e=t.currentTarget===this.m_self_avatar?BatterInfo.instance.myUserInfo.userId:BatterInfo.instance.otherUserInfo.userId,gmbox.openUserInfoDialog&&gmbox.openUserInfoDialog({uid:e})}},e}(core.EUIComponent);__reflect(ScoreView.prototype,"ScoreView");var SoundMgr=function(){function t(){this.hasPlayBgm=!1,this._bg=RES.getRes("bg_mp3")}return t.getInstance=function(){return null==t._instance&&(t._instance=new t),t._instance},t.prototype.playReadyGo=function(){GameConfig.soundSwitch&&RES.getRes("ready_go_mp3").play(0,1)},t.prototype.playJinqiu=function(){GameConfig.soundSwitch&&(GameManager.getInstance().baskectBallManager.isFireMode()?RES.getRes("ball_in_fire_mp3").play(0,1):RES.getRes("ball_in_mp3").play(0,1))},t.prototype.playWin=function(){GameConfig.soundSwitch&&RES.getRes("win_mp3").play(0,1)},t.prototype.gameover=function(t){if(GameConfig.soundSwitch)switch(t){case game.ResultCodeEnum.WIN:RES.getRes("win_mp3").play(0,1);break;case game.ResultCodeEnum.LOSE:RES.getRes("win_mp3").play(0,1);break;case game.ResultCodeEnum.PLAYEVEN:RES.getRes("playeven_mp3").play(0,1)}},t.prototype.click=function(){GameConfig.soundSwitch&&RES.getRes("ball_jump_mp3").play(0,1)},t.prototype.playGround=function(){GameConfig.soundSwitch&&RES.getRes("ball_background_mp3").play(0,1)},t.prototype.playKuang=function(){GameConfig.soundSwitch&&RES.getRes("ball_kuang_mp3").play(0,1)},t.prototype.playBank=function(){GameConfig.soundSwitch&&RES.getRes("ball_bank_mp3").play(0,1)},t.prototype.playCheer=function(){GameConfig.soundSwitch&&RES.getRes("baby_cheer_mp3").play(0,1)},t.prototype.playExciting=function(){GameConfig.soundSwitch&&RES.getRes("baby_exceting_mp3").play(0,1)},t.prototype.playSleep=function(){GameConfig.soundSwitch&&RES.getRes("baby_paopaotang_mp3").play(0,1)},t.prototype.playWake=function(){GameConfig.soundSwitch&&RES.getRes("baby_paopaotang_bmob_mp3").play(0,1)},t.prototype.playTanqi=function(){GameConfig.soundSwitch&&RES.getRes("playeven_mp3").play(0,1)},t.prototype.daojishi=function(t){if(GameConfig.soundSwitch)switch(t){case 10:RES.getRes("ten_mp3").play(0,1);break;case 9:RES.getRes("nine_mp3").play(0,1);break;case 8:RES.getRes("eight_mp3").play(0,1);break;case 7:RES.getRes("seven_mp3").play(0,1);break;case 6:RES.getRes("six_mp3").play(0,1);break;case 5:RES.getRes("five_mp3").play(0,1);break;case 4:RES.getRes("four_mp3").play(0,1);break;case 3:RES.getRes("three_mp3").play(0,1);break;case 2:RES.getRes("two_mp3").play(0,1);break;case 1:RES.getRes("one_mp3").play(0,1);break;case 0:RES.getRes("time_out_mp3").play(0,1)}},t.prototype.playBGM=function(){GameConfig.soundSwitch&&(this.hasPlayBgm||(this.hasPlayBgm=!0,this._bg&&(this._bgSoundChannel=this._bg.play(0,-1))))},t.prototype.stopBGM=function(){this._bgSoundChannel&&this._bgSoundChannel.stop(),this.hasPlayBgm=!1},t}();__reflect(SoundMgr.prototype,"SoundMgr");var BuyDialog=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/assets/exml/BuyView.exml",e.top=e.bottom=e.left=e.right=0,e}return __extends(e,t),e.prototype.addListener=function(){this.m_buy_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.buyEvent,this),this.m_close.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closeDialog,this)},e.prototype.removeListener=function(){this.m_buy_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.buyEvent,this),this.m_close.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.closeDialog,this)},e.prototype.closeDialog=function(){core.LayerCenter.getInstance().getLayer(LayerEnum.POPUP).contains(this)&&core.LayerCenter.getInstance().getLayer(LayerEnum.POPUP).removeChild(this)},e.prototype.onShow=function(e){t.prototype.onShow.call(this,e),this.m_skin_image.source="mg_qiu_"+this.skinId+"_png",0==this.price?(this.m_video_image.visible=!0,this.m_coin_image.visible=!1,this.m_coin_count.visible=!1,this.m_info.text=LanguageManager.instance.getLangeuage(13)):(this.m_video_image.visible=!1,this.m_coin_image.visible=!0,this.m_coin_count.visible=!0,this.m_coin_count.text=this.price+"",this.m_info.text=LanguageManager.instance.getLangeuage(16),GameManager.getInstance().baskectBallManager.coinsNumber<this.price&&Utils.gray(this.m_buy_btn)),this.m_try_label.text=LanguageManager.instance.getLangeuage(12),this.m_buy_group.scaleX=.5,this.m_buy_group.scaleY=.5,egret.Tween.get(this.m_buy_group).to({scaleX:1,scaleY:1},500,egret.Ease.backOut)},e.prototype.touchDarkEnable=function(){return!0},e.prototype.popUp=function(){core.LayerCenter.getInstance().getLayer(LayerEnum.POPUP).addChild(this)},e.prototype.buy=function(t,e){this.price=t,this.skinId=e,core.LayerCenter.getInstance().getLayer(LayerEnum.POPUP).addChild(this)},e.prototype.buyEvent=function(){var t=this;if(this.closeDialog(),0==this.price){var e=function(){t.buySuccess(),SoundMgr.getInstance().playBGM()};return AdManager.showRewardedVideoAd(e),void SoundMgr.getInstance().stopBGM()}GameManager.getInstance().baskectBallManager.coinsNumber>=this.price?(GameManager.getInstance().baskectBallManager.payCoinsNumber(this.price),this.buySuccess()):ChangeSkinView.getInstance().showToast(3)},e.prototype.buySuccess=function(){ChangeSkinView.getInstance().skinPlay[this.skinId].buySuccess(),GameManager.getInstance().baskectBallManager.addSkinInfo(this.skinId.toString()),ChangeSkinView.getInstance().showToast(2),EventUtils.logEvent("buySkin",{skinId:this.skinId})},e}(core.EUIComponent);__reflect(BuyDialog.prototype,"BuyDialog");var EndlessRebornDialog=function(t){function e(){var e=t.call(this)||this;return e._isEnable=!0,e.skinName="resource/assets/exml/EndlessRebornView.exml",e}return __extends(e,t),e.prototype.onShow=function(e){t.prototype.onShow.call(this,e),this.m_content.text=LanguageManager.instance.getLangeuage(23),this._isEnable=!0},e.prototype.onHide=function(e){t.prototype.onHide.call(this,e)},e.prototype.addListener=function(){t.prototype.addListener.call(this),this.m_reborn_btn&&this.m_reborn_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.rebornHandler,this),this.m_pass_btn&&this.m_pass_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.passHandler,this)},e.prototype.removeListener=function(){t.prototype.removeListener.call(this),this.m_reborn_btn&&this.m_reborn_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.rebornHandler,this),this.m_pass_btn&&this.m_pass_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.passHandler,this)},e.prototype.rebornHandler=function(t){var e=this;if(this._isEnable){this._isEnable=!1,EventUtils.logEvent("click_endeless_reborn");var i=function(){GameManager.getInstance().rebornCount-=1,egret.setTimeout(function(){e.removeFromParent(),GameManager.getInstance().baskectBallManager.reborn()},e,300),SoundMgr.getInstance().playBGM()},r=function(){e._isEnable=!0,SoundMgr.getInstance().playBGM()};AdManager.showRewardedVideoAd(i,r),SoundMgr.getInstance().stopBGM()}},e.prototype.passHandler=function(t){EventUtils.logEvent("click_endless_skipReborn"),this.removeFromParent(),core.ResUtils.loadGroups(["result"],function(t){},function(t){},function(t){var e=new ResultDialog;e.popUp()},this)},e.prototype.touchDarkEnable=function(){return!1},e}(DialogBaseView);__reflect(EndlessRebornDialog.prototype,"EndlessRebornDialog");var ExitDialog=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/assets/exml/ExitDialog.exml",e.top=e.bottom=e.left=e.right=0,e}return __extends(e,t),e.prototype.addListener=function(){this.m_cancel.addEventListener(egret.TouchEvent.TOUCH_TAP,this.cancel,this),this.m_confirm.addEventListener(egret.TouchEvent.TOUCH_TAP,this.confirm,this)},e.prototype.removeListener=function(){this.m_cancel.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.cancel,this),this.m_confirm.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.confirm,this)},e.prototype.onShow=function(e){t.prototype.onShow.call(this,e),GameManager.getInstance().pauseGame(),this.m_message.text=LanguageManager.instance.getLangeuage(21),this.m_confirm_label.text=LanguageManager.instance.getLangeuage(22),this.m_exit_group.scaleX=.5,this.m_exit_group.scaleY=.5,egret.Tween.get(this.m_exit_group).to({scaleX:1,scaleY:1},500,egret.Ease.backOut)},e.prototype.touchDarkEnable=function(){return!0},e.prototype.popUp=function(){core.LayerCenter.getInstance().getLayer(LayerEnum.POPUP).addChild(this)},e.prototype.closeDialog=function(){core.LayerCenter.getInstance().getLayer(LayerEnum.POPUP).contains(this)&&core.LayerCenter.getInstance().getLayer(LayerEnum.POPUP).removeChild(this),GameManager.getInstance().resumeGame()},e.prototype.cancel=function(){this.closeDialog()},e.prototype.confirm=function(){this.closeDialog(),GameManager.getInstance().baskectBallManager.reset(),GlobalManager.getInstance().goLobby()},e}(core.EUIComponent);__reflect(ExitDialog.prototype,"ExitDialog");var HelpDialog=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/assets/exml/HelpView.exml",e.top=e.bottom=e.left=e.right=0,e}return __extends(e,t),e.prototype.addListeners=function(){this.m_help_back.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closeDialog,this)},e.prototype.removeListeners=function(){this.m_help_back.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.closeDialog,this)},e.prototype.closeDialog=function(){core.LayerCenter.getInstance().getLayer(LayerEnum.POPUP).contains(this)&&(this.removeListeners(),core.LayerCenter.getInstance().getLayer(LayerEnum.POPUP).removeChild(this)),GameManager.getInstance().resumeGame()},e.prototype.onShow=function(e){t.prototype.onShow.call(this,e),GameManager.getInstance().pauseGame(),this.title_info.text=LanguageManager.instance.getLangeuage(3),this.m_content1.text=LanguageManager.instance.getLangeuage(4),this.m_content2.text=LanguageManager.instance.getLangeuage(5),this.m_help_group.scaleX=.5,this.m_help_group.scaleY=.5,egret.Tween.get(this.m_help_group).to({scaleX:1,scaleY:1},500,egret.Ease.backOut)},e.prototype.touchDarkEnable=function(){return!0},e.prototype.popUp=function(){core.LayerCenter.getInstance().getLayer(LayerEnum.POPUP).addChild(this),this.addListeners()},e}(core.EUIComponent);__reflect(HelpDialog.prototype,"HelpDialog");var PauseDialog=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/assets/exml/PauseView.exml",e.top=e.bottom=e.left=e.right=0,e}return __extends(e,t),e.prototype.addListener=function(){this.m_game_continue.addEventListener(egret.TouchEvent.TOUCH_TAP,this.cancel,this),this.m_game_home.addEventListener(egret.TouchEvent.TOUCH_TAP,this.confirm,this)},e.prototype.removeListener=function(){this.m_game_continue.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.cancel,this),this.m_game_home.addEventListener(egret.TouchEvent.TOUCH_TAP,this.confirm,this)},e.prototype.onShow=function(e){t.prototype.onShow.call(this,e),GameManager.getInstance().pauseGame()},e.prototype.touchDarkEnable=function(){return!0},e.prototype.popUp=function(){core.LayerCenter.getInstance().getLayer(LayerEnum.POPUP).addChild(this)},e.prototype.closeDialog=function(){core.LayerCenter.getInstance().getLayer(LayerEnum.POPUP).contains(this)&&core.LayerCenter.getInstance().getLayer(LayerEnum.POPUP).removeChild(this),GameManager.getInstance().resumeGame()},e.prototype.cancel=function(){this.closeDialog()},e.prototype.confirm=function(){this.closeDialog(),GameManager.getInstance().baskectBallManager.reset(),GlobalManager.getInstance().goLobby()},e}(core.EUIComponent);__reflect(PauseDialog.prototype,"PauseDialog");var RankDialog=function(t){function e(){var e=t.call(this)||this;return e.isGlobalRank=!1,e.arr=new eui.ArrayCollection,e.skinName="resource/assets/exml/RankDialogView.exml",e.top=e.bottom=e.left=e.right=0,e.mode=GameConfig.gameMode,e}return __extends(e,t),e.prototype.addListener=function(){GameManager.getInstance().addEventListener(GameManager.REFRESH_RANK,this.loadRankComplete,this),this.m_share_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.shareHandler,this),this.m_mode_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.modeHandler,this),this.m_back_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onBackPressed,this),this.m_gobal_rank.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showGlobalRank,this),this.m_friend_rank.addEventListener(egret.TouchEvent.TOUCH_TAP,this.showFriendsRank,this)},e.prototype.removeListener=function(){GameManager.getInstance().removeEventListener(GameManager.REFRESH_RANK,this.loadRankComplete,this),this.m_share_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.shareHandler,this),this.m_mode_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.modeHandler,this),this.m_back_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onBackPressed,this),this.m_gobal_rank.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.showGlobalRank,this),this.m_friend_rank.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.showFriendsRank,this)},e.prototype.onShow=function(e){t.prototype.onShow.call(this,e),this._title.text=this.mode==GameConfig.GameMode.TIME?"Time Mode Leaderboard":"Playground Mode Leaderboard",this.m_share_btn.text=LanguageManager.instance.getLangeuage(11),this.m_gobal_rank.text=LanguageManager.instance.getLangeuage(14),this.m_friend_rank.text=LanguageManager.instance.getLangeuage(15),this.m_list.itemRenderer=RankItem,this.m_list.dataProvider=this.arr;var i;this.mode==GameConfig.GameMode.TIME?i=FacebookRank.getInstance()._globalRankList:this.mode==GameConfig.GameMode.ENDLESS&&(i=FacebookRank.getInstance()._endless_globalRankList),i.length>0&&(this.isGlobalRank=!0,this.refreshListView(i)),FacebookRank.getInstance().updateRankList()
},e.prototype.refreshListView=function(t){this.arr.source=t,this.arr.refresh()},e.prototype.popUp=function(){core.LayerCenter.getInstance().getLayer(LayerEnum.POPUP).addChild(this)},e.prototype.shareHandler=function(t){PlatfromUtil.getPlatform().share()},e.prototype.modeHandler=function(t){this.mode==GameConfig.GameMode.TIME?this.mode=GameConfig.GameMode.ENDLESS:this.mode==GameConfig.GameMode.ENDLESS&&(this.mode=GameConfig.GameMode.TIME),this.loadRankComplete()},e.prototype.onBackPressed=function(){core.LayerCenter.getInstance().getLayer(LayerEnum.POPUP).contains(this)&&core.LayerCenter.getInstance().getLayer(LayerEnum.POPUP).removeChild(this)},e.prototype.loadRankComplete=function(){this.isGlobalRank?(this.isGlobalRank=!1,this.showGlobalRank(!0)):(this.isGlobalRank=!0,this.showFriendsRank(!0)),this._title.text=this.mode==GameConfig.GameMode.TIME?"Time Mode Leaderboard":"Playground Mode Leaderboard"},e.prototype.showGlobalRank=function(t){if(void 0===t&&(t=!1),!this.isGlobalRank||t){this.isGlobalRank=!0,this.m_global_select.visible=!0,this.m_friend_unselect.visible=!0,this.m_global_unselect.visible=!1,this.m_friend_select.visible=!1;var e;this.mode==GameConfig.GameMode.TIME?e=FacebookRank.getInstance()._globalRankList:this.mode==GameConfig.GameMode.ENDLESS&&(e=FacebookRank.getInstance()._endless_globalRankList),this.refreshListView(e)}},e.prototype.showFriendsRank=function(t){if(void 0===t&&(t=!1),this.isGlobalRank||t){this.isGlobalRank=!1,this.m_friend_select.visible=!0,this.m_global_unselect.visible=!0,this.m_friend_unselect.visible=!1,this.m_global_select.visible=!1;var e;this.mode==GameConfig.GameMode.TIME?e=FacebookRank.getInstance()._friendRankList:this.mode==GameConfig.GameMode.ENDLESS&&(e=FacebookRank.getInstance()._endless_friendRankList),this.refreshListView(e)}},e}(core.EUIComponent);__reflect(RankDialog.prototype,"RankDialog");var RankItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/assets/exml/ItemView.exml",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){var t=this.data;this.setRankView(t.playerRank),this.m_item_avatar.source=t.playerPicUrl,this.m_item_name.text=t.playerName+"",this.m_item_score.text=t.playerScore+""},e.prototype.setRankView=function(t){1==t?(this.m_item_rank_image.visible=!0,this.m_item_rank_text.visible=!1,this.m_item_rank_image.source="2048_hz_1_png"):2==t?(this.m_item_rank_image.visible=!0,this.m_item_rank_text.visible=!1,this.m_item_rank_image.source="2048_hz_2_png"):3==t?(this.m_item_rank_image.visible=!0,this.m_item_rank_text.visible=!1,this.m_item_rank_image.source="2048_hz_3_png"):(this.m_item_rank_image.visible=!1,this.m_item_rank_text.visible=!0,this.m_item_rank_text.text=t+"")},e}(eui.ItemRenderer);__reflect(RankItem.prototype,"RankItem");var RebornView=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(RebornBaseView);__reflect(RebornView.prototype,"RebornView");var ResultDialog=function(t){function e(){var e=t.call(this)||this;return e._has_collect_coin=!1,e.skinName="resource/assets/exml/ResultView.exml",e.top=e.bottom=e.left=e.right=0,e.baskectBallManager=GameManager.getInstance().baskectBallManager,e.scoreManager=GameManager.getInstance().scoreManager,e}return __extends(e,t),e.prototype.onShow=function(e){t.prototype.onShow.call(this,e),SoundMgr.getInstance().playWin(),GameManager.getInstance().rebornCount=1,TweenUtil.playTweenGroup(this.result,!0),TweenUtil.playTweenGroup(this.adCoin,!0),this.setScoreText(),this.updateGold(),this.logEvent(),GameConfig.gameMode==GameConfig.GameMode.ENDLESS&&this.scoreManager.totalScore<40?this.free_coin_group.visible=!1:this.free_coin_group.visible=!0},e.prototype.logEvent=function(){var t=this.scoreManager.totalScore,e=this.baskectBallManager.coinsNumber,i=this.baskectBallManager._curCoins;EventUtils.logEvent("score",{score:t}),EventUtils.logEvent("coin",{curCoin:i,totalCoin:e})},e.prototype.updateGold=function(){var t=this,e=this.baskectBallManager.coinsNumber;egret.Tween.get(this.m_total_coin).to({scaleX:1.2,scaleY:1.2},300).call(function(){t.m_total_coin.text=e+""}).to({scaleX:1,scaleY:1},300),this.updateBuySkin(e)},e.prototype.updateBuySkin=function(t){var e=this.baskectBallManager.skinInfo;e.sort(function(t,e){var i=parseInt(t),r=parseInt(e);return i-r});for(var i=-1,r=[3,4,5,6],n=0;n<r.length;n++){for(var a=!1,o=0;o<e.length;o++){var s=parseInt(e[o]);if(s==r[n]){a=!0;break}}if(!a){i=r[n];break}}if(-1==i)return this.m_finger.visible=!1,this.m_skin_point.visible=!1,void(this.m_skin_btn.touchEnabled=!0);var l=BaskectBallManager.BASKET_PRICE[i];t>=l?(this.m_finger.visible=!0,this.m_skin_point.visible=!0,this.m_skin_btn.touchEnabled=!0,TweenUtil.playTweenGroup(this.finger,!0)):(this.m_finger.visible=!1,this.m_skin_point.visible=!1,TweenUtil.stopTweenGroup(this.finger))},e.prototype.addListener=function(){this.m_home_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.goGameHome,this),this.m_close.addEventListener(egret.TouchEvent.TOUCH_TAP,this.backEvent,this),this.m_restart_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.restartGame,this),this.m_skin_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.changeSkin,this),this.free_coin_group.addEventListener(egret.TouchEvent.TOUCH_TAP,this.collectCoin,this),this.free_coin_ad_group.addEventListener(egret.TouchEvent.TOUCH_TAP,this.collectCoinAd,this)},e.prototype.removeListener=function(){this.m_home_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.goGameHome,this),this.m_close.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.backEvent,this),this.m_restart_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.restartGame,this),this.m_skin_btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.changeSkin,this),this.free_coin_group.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.collectCoin,this),this.free_coin_ad_group.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.collectCoinAd,this)},e.prototype.popUp=function(){core.LayerCenter.getInstance().getLayer(LayerEnum.POPUP).addChild(this)},e.prototype.showResultLabel=function(){var t;SoundMgr.getInstance().gameover(t),egret.setTimeout(function(){game.BattleManager.instance.postResult(t)},this,3e3)},e.prototype.getData=function(){this.recordData=JSON.parse(localStorage.getItem("record")),egret.log(this.recordData)},e.prototype.setScoreText=function(){this.getData();var t=this.scoreManager.totalScore,e=this.baskectBallManager.rankScore,i=this.baskectBallManager.maxCombo,r=this.baskectBallManager.kongxinCount,n=this.baskectBallManager.bankCount,a=this.baskectBallManager.highShotCount,o=this.baskectBallManager.yashaoCount,s=this.baskectBallManager._curCoins;if(this.m_score.text=t+"",GameConfig.gameMode==GameConfig.GameMode.ENDLESS){var l=JSON.parse(localStorage.getItem("endless_rank"));e=l?l.score:0}if(t>e?(this.baskectBallManager.rankScore=t,this.m_rank.text=LanguageManager.instance.getLangeuage(1),this.baskectBallManager.rankScore=t,"undefined"!=typeof gmbox?gmbox.updateGameRank({value:Number(t),type:1}):PlatfromUtil.getPlatform().setScoreAsync(t)):this.m_rank.text=LanguageManager.instance.getLangeuage(2),this.m_max_combo.text=i+"",this.m_clean_shot.text=r+"",this.m_ban_shot.text=n+"",this.m_high_shot.text=a+"",this.m_buzzer_shot.text=o+"",this.m_cur_coin_number.text=s+"",this.recordData){var h=this.recordData.m_max_combo;i>h?(egret.Tween.get(this.m_combo_new).to({x:0,alpha:1},500,egret.Ease.bounceIn),this.changedToRrecordText(this.m_max_combo),this.changedToRrecordText(this.m_max_combo_label)):i=h;var c=this.recordData.m_clean_shot;r>c?(egret.Tween.get(this.m_clean_shot_new).to({x:0,alpha:1},500,egret.Ease.bounceIn),this.changedToRrecordText(this.m_clean_shot),this.changedToRrecordText(this.m_clean_shot_label)):r=c;var u=this.recordData.m_bank_shot;n>u?(egret.Tween.get(this.m_ban_shot_new).to({x:0,alpha:1},500,egret.Ease.bounceIn),this.changedToRrecordText(this.m_ban_shot),this.changedToRrecordText(this.m_ban_shot_label)):n=u;var p=this.recordData.m_high_shot;a>p?(egret.Tween.get(this.m_high_shot_new).to({x:0,alpha:1},500,egret.Ease.bounceIn),this.changedToRrecordText(this.m_high_shot),this.changedToRrecordText(this.m_high_shot_label)):a=p;var d=this.recordData.m_buzzer_shot;o>d?(egret.Tween.get(this.m_buzzer_shot_new).to({x:0,alpha:1},500,egret.Ease.bounceIn),this.changedToRrecordText(this.m_buzzer_shot),this.changedToRrecordText(this.m_buzzer_shot_label)):o=d}this.saveData(t,i,r,n,a,o),GameConfig.gameMode==GameConfig.GameMode.ENDLESS&&localStorage.setItem("endless_rank",JSON.stringify({score:t}))},e.prototype.changedToRrecordText=function(t){t.textColor=16718362,t.strokeColor=16767706,t.stroke=2},e.prototype.saveData=function(t,e,i,r,n,a){var o={m_score:t,m_max_combo:e,m_clean_shot:i,m_bank_shot:r,m_high_shot:n,m_buzzer_shot:a};localStorage.setItem("record",JSON.stringify(o))},e.prototype.closeDialog=function(){core.LayerCenter.getInstance().getLayer(LayerEnum.POPUP).contains(this)&&core.LayerCenter.getInstance().getLayer(LayerEnum.POPUP).removeChild(this)},e.prototype.backEvent=function(){EventUtils.logEvent("click_back"),this.closeDialog(),this.baskectBallManager.reset(),GlobalManager.getInstance().goLobby()},e.prototype.goGameHome=function(){EventUtils.logEvent("click_home"),this.closeDialog(),this.baskectBallManager.reset(),GlobalManager.getInstance().goLobby()},e.prototype.restartGame=function(){EventUtils.logEvent("click_restart"),this.closeDialog(),GameManager.getInstance().restart()},e.prototype.shareGame=function(){EventUtils.logEvent("click_resultShare"),PlatfromUtil.getPlatform().share()},e.prototype.changeSkin=function(){EventUtils.logEvent("click_resultSkin");var t=new ChangeSkinView;t.popUp()},e.prototype.collectCoin=function(){EventUtils.logEvent("click_collectCoin"),this._has_collect_coin||(this._has_collect_coin=!0,this.playCollectCoinAnimation(!1))},e.prototype.collectCoinAd=function(){var t=this;if(EventUtils.logEvent("click_collectCoinAd"),!this._has_collect_coin){var e=function(){t._has_collect_coin=!0,SoundMgr.getInstance().playBGM(),egret.setTimeout(function(){t.playCollectCoinAnimation(!0)},t,300)};AdManager.showRewardedVideoAd(e),SoundMgr.getInstance().stopBGM()}},e.prototype.getCoin=function(t){Utils.gray(this.free_coin_group),Utils.gray(this.free_coin_ad_group),this.free_coin_group.touchEnabled=!1,this.free_coin_ad_group.touchEnabled=!1,this.baskectBallManager.collectCoinsNumber(t),TweenUtil.stopTweenGroup(this.adCoin),this.updateGold()},e.prototype.playCollectCoinAnimation=function(t){var e=this,i=t?120:40,r=DragonUtils.createDragonBonesDisplay("langqiu_feijingbi_ske_json","langqiu_feijingbi_tex_json","langqiu_feijingbi_tex_png","Armature");r.addEventListener(dragonBones.EgretEvent.COMPLETE,function(){e.getCoin(i),r.display.parent&&r.display.parent.removeChild(r.display),dragonBones.WorldClock.clock.remove(r)},this),dragonBones.WorldClock.clock.add(r);var n=r.display;if(n.x=this.m_coin_total.x+58,n.y=this.m_coin_total.y+46,this.addChild(n),r.animation.play("newAnimation_1",1),null==r){var a=0,o=0;t?(a=this.m_ad_coin_image.localToGlobal().x,o=this.m_ad_coin_image.localToGlobal().y):(a=this.m_free_coin_image.localToGlobal().x,o=this.m_free_coin_image.localToGlobal().y);for(var s=t?120:40,l=this.m_coin_total.localToGlobal().x+55,h=this.m_coin_total.localToGlobal().y+40,c=function(t){var i=new egret.Bitmap(RES.getRes("img_jinbi_xiao_png"));u.addChild(i),i.width=32,i.height=32,i.anchorOffsetX=16,i.anchorOffsetY=16,i.x=a,i.y=o;var r=72*t,n=100,c=a+(n-.2*n*Math.random())*Math.cos(r*Math.PI/180),p=o+(n-.2*n*Math.random())*Math.sin(r*Math.PI/180);egret.Tween.get(i).wait(50+10*t).to({x:c,y:p},200).wait(400).to({x:l,y:h},500).to({scaleX:1.5,scaleY:1.5},100).call(function(){4==t&&(Utils.gray(e.free_coin_group),Utils.gray(e.free_coin_ad_group),e.free_coin_group.touchEnabled=!1,e.free_coin_ad_group.touchEnabled=!1,e.baskectBallManager.collectCoinsNumber(s),TweenUtil.stopTweenGroup(e.adCoin),e.updateGold())})},u=this,p=0;5>p;p++)c(p)}},e}(core.EUIComponent);__reflect(ResultDialog.prototype,"ResultDialog");var SkinDialog=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/assets/exml/SkinView.exml",e.top=e.bottom=e.left=e.right=0,e}return __extends(e,t),e.prototype.addListener=function(){this.m_skin_back.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closeDialog,this),this.m_ball_tab.addEventListener(egret.TouchEvent.TOUCH_TAP,this.switchTab,this),this.m_hoop_tab.addEventListener(egret.TouchEvent.TOUCH_TAP,this.switchTab,this),this.m_basket_tab.addEventListener(egret.TouchEvent.TOUCH_TAP,this.switchTab,this)},e.prototype.removeListener=function(){this.m_skin_back.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.closeDialog,this),this.m_ball_tab.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.switchTab,this),this.m_hoop_tab.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.switchTab,this),this.m_basket_tab.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.switchTab,this)},e.prototype.closeDialog=function(){core.LayerCenter.getInstance().getLayer(LayerEnum.POPUP).contains(this)&&core.LayerCenter.getInstance().getLayer(LayerEnum.POPUP).removeChild(this),GameManager.getInstance().resumeGame()},e.prototype.onShow=function(e){t.prototype.onShow.call(this,e)},e.prototype.touchDarkEnable=function(){return!0},e.prototype.popUp=function(){core.LayerCenter.getInstance().getLayer(LayerEnum.POPUP).addChild(this)},e.prototype.switchTab=function(t){t.target==this.m_ball_tab?egret.log(1):t.target==this.m_ball_tab?egret.log(2):egret.log(3)},e}(core.EUIComponent);__reflect(SkinDialog.prototype,"SkinDialog");var Facebook=function(){function t(){this.globalRankList=new Array,this.friendRankList=new Array}return t.init=function(){t.isFBInit()&&(t.FBPlatformInfo=new FacebookContextId,t.supportApi=FBInstant.getSupportedAPIs(),t.FBPropAd=new FacebookRewardedVideoAd("406768563375011_406771486708052","Prop"),t.FBTrasureChestAd=new FacebookRewardedVideoAd("406768563375011_406771876708013","TrasureChest"))},t.isFBInit=function(){return"undefined"==typeof FBInstant?(egret.warn("FBInstant is undefined"),!1):!0},t.IsApiSupport=function(e){return t.isFBInit()?-1!=t.supportApi.indexOf(e)?!0:(egret.warn("Unsupport API:",e),!1):void 0},t.logEvent=function(e,i,r){t.IsApiSupport("logEvent")&&FBInstant.logEvent(e,i,r)},t}();__reflect(Facebook.prototype,"Facebook");var FacebookContextId=function(){function t(){this.contextId=null,this.contextType="",this.local="",this.lanCode="",this.platform="",this.SDKVersion="",this.entryPoint="",this.entryPointData=null}return t.prototype.Init=function(){Facebook.isFBInit()&&(this.contextType=FBInstant.context.getType(),"SOLO"==this.contextType?this.contextId=FBInstant.player.getID()+"_SOLO":this.contextId=FBInstant.context.getID(),this.local=FBInstant.getLocale(),this.lanCode=this.local.substr(0,2),this.platform=FBInstant.getPlatform(),this.SDKVersion=FBInstant.getSDKVersion(),this.entryPoint=FBInstant.getEntryPointAsync(),this.entryPointData=FBInstant.getEntryPointData(),egret.log("contextType:"+this.contextType),egret.log("contextId:"+this.contextId),egret.log("local:"+this.local),egret.log("lanCode:"+this.lanCode),egret.log("SDKVersion:"+this.SDKVersion),egret.log("entryPoint:"+this.entryPoint),egret.log("entryPointData:"+JSON.stringify(this.entryPointData)))},t.prototype.RefreshContextInfo=function(){this.contextType=FBInstant.context.getType(),"SOLO"==this.contextType?this.contextId=FBInstant.player.getID()+"_SOLO":this.contextId=FBInstant.context.getID()},t}();__reflect(FacebookContextId.prototype,"FacebookContextId");var FacebookPlatform=function(){function t(){}return t.prototype.init=function(){Facebook.init()},t.prototype.share=function(t,e,i){if(Facebook.IsApiSupport("context.chooseAsync")){var r=RES.getRes("img_logo_png"),n=r.toDataURL("image/png");FBInstant.context.chooseAsync(t).then(function(){Facebook.FBPlatformInfo.RefreshContextInfo(),egret.log("updateAsync"),FBInstant.updateAsync({action:"CUSTOM",cta:"I wants to play On The Clock with you!",image:n,text:"Play On The Clock with me",template:"play_turn",data:{myReplayData:"nice"},strategy:"IMMEDIATE",notification:"NO_PUSH"}).then(function(){egret.log("customUpdate finish"),e&&e()})["catch"](function(t){egret.error("failed : "+t.code+" :: "+t.message),i&&i(t)}),e&&e()})["catch"](function(t){egret.error("failed : "+t.code+" :: "+t.message),i&&i(t)})}},t.prototype.showAd=function(){Facebook.FBPropAd.showRewardedVideoAd()},t.prototype.getLeaderboard=function(){var t=new RankDialog;t.popUp()},t.prototype.setScoreAsync=function(t,e){GameConfig.gameMode==GameConfig.GameMode.TIME?FacebookRank.getInstance().setScoreToGloalRank(t,e):GameConfig.gameMode==GameConfig.GameMode.ENDLESS&&FacebookRank.getInstance().setScoreToEndlessRank(t,e)},t.prototype.getSelfRank=function(){return FacebookRank.getInstance().myRankInGlobal},t.prototype.getTargetOpponentsRank=function(t,e){var i=FacebookRank.getInstance()._oppentRankList;egret.log(i);var r=i.length,n=3*t-3,a=3*t;return r>a-1?i.slice(n,a):null},t.prototype.getOpponentsPassMeRank=function(t,e){var i=FacebookRank.getInstance()._emenyRankList;egret.log(i);var r=i.length,n=t;return r>n?i[n]:null},t.prototype.saveData=function(t,e,i){egret.log("saveData:"+t),FacebookStorage.getInstance().saveDataToFB(t)},t.prototype.getData=function(t,e,i){},t}();__reflect(FacebookPlatform.prototype,"FacebookPlatform",["platform.IPlatform"]);var FacebookPlayerInfoInRank=function(){function t(){}return t}();__reflect(FacebookPlayerInfoInRank.prototype,"FacebookPlayerInfoInRank");var FacebookRank=function(){function t(){this.globalRank=null,this._globalRankList=new Array,this._friendRankList=new Array,this._oppentRankList=new Array,this._emenyRankList=new Array,this.myRankInGlobal=null,this.endlessRank=null,this._endless_globalRankList=new Array,this._endless_friendRankList=new Array,this._isRankUpdate=!1,this._isEndlessUpdate=!1}return t.getInstance=function(){return t._instance||(t._instance=new t),t._instance},t.prototype.getGlobalRank=function(){egret.log("getGlobalRank");var e=!1;Facebook.IsApiSupport("getLeaderboardAsync")&&FBInstant.getLeaderboardAsync(t.RANK_NAME).then(function(t){return this.globalRank=t,t.getPlayerEntryAsync()}.bind(this)).then(function(t){return null==t&&this.globalRank?(egret.warn("no data in",this.globalRank),e=!0,this.globalRank.setScoreAsync(0,"")):(e=!1,void this.getGlobalRankList())}.bind(this)).then(function(){0!=e&&this.getGlobalRankList()}.bind(this))["catch"](function(t){egret.error("failed : "+t.code+" :: "+t.message)})},t.prototype.getGlobalRankList=function(t,e){void 0===t&&(t=30),void 0===e&&(e=0),this.globalRank&&(this.globalRank.getEntriesAsync(t,e).then(function(t){this._globalRankList=new Array,this.fullRank(t,this._globalRankList,1)}.bind(this))["catch"](function(t){egret.error("failed : "+t.code+" :: "+t.message)}),this.globalRank.getPlayerEntryAsync().then(function(t){this.myRankInGlobal=this.changeToFacebookPlayerInfoInRank(t)}.bind(this))["catch"](function(t){egret.error("failed : "+t.code+" :: "+t.message)}),this.globalRank.getConnectedPlayerEntriesAsync(t,e).then(function(t){this._friendRankList=new Array,this.fullRank(t,this._friendRankList,2)}.bind(this))["catch"](function(t){egret.error("failed : "+t.code+" :: "+t.message)}),this.globalRank.getEntryCountAsync().then(function(t){var e=t/2,i=core.MathUtils.random(Math.max(e-100,0),Math.min(e+100,t));egret.log(i),this.globalRank.getEntriesAsync(15,i).then(function(t){this._oppentRankList=new Array,this.fullRank(t,this._oppentRankList,3)}.bind(this))["catch"](function(t){egret.error("failed : "+t.code+" :: "+t.message)});var r=t/3,n=core.MathUtils.random(Math.max(r-100,0),Math.min(r+100,t));egret.log(n),this.globalRank.getEntriesAsync(4,n).then(function(t){this._emenyRankList=new Array,this.fullRank(t,this._emenyRankList,4)}.bind(this))["catch"](function(t){egret.error("failed : "+t.code+" :: "+t.message)})}.bind(this))["catch"](function(t){egret.error("failed : "+t.code+" :: "+t.message)}))},t.prototype.getEndlessRank=function(){egret.log("getEndlessRank");var e=!1;Facebook.IsApiSupport("getLeaderboardAsync")&&FBInstant.getLeaderboardAsync(t.ENDLESS_RANK_NAME).then(function(t){return this.endlessRank=t,t.getPlayerEntryAsync()}.bind(this)).then(function(t){return null==t&&this.endlessRank?(egret.warn("no data in",this.endlessRank),e=!0,this.endlessRank.setScoreAsync(0,"")):(e=!1,void this.getEndlessRankList())}.bind(this)).then(function(){0!=e&&this.getEndlessRankList()}.bind(this))["catch"](function(t){egret.error("failed : "+t.code+" :: "+t.message)})},t.prototype.getEndlessRankList=function(t,e){void 0===t&&(t=30),void 0===e&&(e=0),this.endlessRank&&(this.endlessRank.getEntriesAsync(t,e).then(function(t){this._endless_globalRankList=new Array,this.fullRank(t,this._endless_globalRankList,1)}.bind(this))["catch"](function(t){egret.error("failed : "+t.code+" :: "+t.message)}),this.endlessRank.getConnectedPlayerEntriesAsync(t,e).then(function(t){this._endless_friendRankList=new Array,this.fullRank(t,this._endless_friendRankList,2)}.bind(this))["catch"](function(t){egret.error("failed : "+t.code+" :: "+t.message)}))},t.prototype.changeToFacebookPlayerInfoInRank=function(t){var e=new FacebookPlayerInfoInRank;return e.playerId=t.getPlayer().getID(),e.playerName=t.getPlayer().getName(),e.playerRank=t.getRank(),e.playerScore=t.getScore(),e.playerPicUrl=t.getPlayer().getPhoto(),e},t.prototype.fullRank=function(t,e,i){2==i&&(this.m_playerId=FBInstant.player.getID());var r=t.length;egret.log("fullRank : "+this.m_playerId+"; totalCount : "+r+"; isFriendsRank : "+i);for(var n=0;n<t.length;n++){var a=this.changeToFacebookPlayerInfoInRank(t[n]);1==i||2==i?e.push(a):a.playerId!=this.m_playerId&&e.push(a)}2==i?e=e.sort(function(t,e){return t.playerRank-e.playerRank}):3==i&&(e=e.sort(function(t,e){return e.playerRank-t.playerRank})),this.loadRankFinish()},t.prototype.loadRankFinish=function(){GameManager.getInstance().updateRankComplete()},t.prototype.setScoreToGloalRank=function(e,i){if(Facebook.isFBInit()){var r=this;FBInstant.getLeaderboardAsync(t.RANK_NAME).then(function(t){console.log(t.getName()),t.setScoreAsync(e,i).then(function(t){egret.log(t),r._isRankUpdate=!0}.bind(this))["catch"](function(t){egret.error("failed : "+t.code+" :: "+t.message)})}).then(function(){return egret.log("Score saved")})["catch"](function(t){return console.error(t)})}},t.prototype.setScoreToEndlessRank=function(e,i){if(Facebook.isFBInit()){var r=this;FBInstant.getLeaderboardAsync(t.ENDLESS_RANK_NAME).then(function(t){console.log(t.getName()),t.setScoreAsync(e,i).then(function(t){egret.log(t),r._isEndlessUpdate=!0}.bind(this))["catch"](function(t){egret.error("failed : "+t.code+" :: "+t.message)})}).then(function(){return egret.log("Score saved")})["catch"](function(t){return console.error(t)})}},t.prototype.updateRankList=function(){this._isRankUpdate&&(this._isRankUpdate=!1,this.getGlobalRank()),this._isEndlessUpdate&&(this._isEndlessUpdate=!1,this.getEndlessRank())},t._instance=null,t.RANK_NAME="basketball_rank",t.ENDLESS_RANK_NAME="test_rank",t}();__reflect(FacebookRank.prototype,"FacebookRank");var FacebookRewardedVideoAd=function(){function t(t,e){void 0===e&&(e=null),this.mLogTag=null,this.mAdUnitId=null,this.mRewardedVideoAd=null,this.mRewardedVideoAdLoading=!1,this.mRewardedVideoAdLoaded=!1,this.mSuccessCallback=null,this.mFailCallback=null,this.mOnLoadSuccess=null,this.mRetryCount=0,this.mAdUnitId=t,this.mLogTag=e,this.init()}return t.prototype.init=function(){Facebook.isFBInit()&&this.loadRewardedVideoAd()},t.prototype.callSuccess=function(){this.mSuccessCallback&&this.mSuccessCallback(),this.resetCall(),clearTimeout(this.mTimeoutId)},t.prototype.callFail=function(){this.mFailCallback&&this.mFailCallback(),this.resetCall(),clearTimeout(this.mTimeoutId)},t.prototype.resetCall=function(){this.mSuccessCallback=null,this.mFailCallback=null,this.mOnLoadSuccess=null},t.prototype.callLoad=function(){this.mOnLoadSuccess&&this.mOnLoadSuccess()},t.prototype.loadRewardedVideoAd=function(){var t=this;return clearTimeout(this.mRetryId),Facebook.IsApiSupport("getRewardedVideoAsync")?this.mRewardedVideoAdLoading?void(null==this.mRewardedVideoAd?this.logDebug("激励视频正在创建"):this.logDebug("激励视频正在加载")):this.mRewardedVideoAdLoaded?void this.callLoad():(this.mRewardedVideoAdLoading=!0,this.mRewardedVideoAdLoaded=!1,void(null==this.mRewardedVideoAd?(this.logDebug("激励视频开始创建"+this.mRetryCount),this.logCreateEvent(),FBInstant.getRewardedVideoAsync(this.mAdUnitId).then(function(e){t.mRewardedVideoAd=e,t.logDebug("激励视频创建完成"+t.mRetryCount),t.loadRewardedVideoAdInternal()})["catch"](function(e){t.onLoadFail(e),t.logLoadFailEvent(JSON.stringify(e))})):this.loadRewardedVideoAdInternal())):void this.callFail()},t.prototype.loadRewardedVideoAdInternal=function(){var t=this;return null==this.mRewardedVideoAd?void this.onLoadFail({reson:"mRewardedVideoAd is null"}):this.mRewardedVideoAdLoaded?void this.callLoad():(this.logDebug("激励视频开始加载"+this.mRetryCount),this.logRequestEvent(),void this.mRewardedVideoAd.loadAsync().then(function(){t.logDebug("激励视频加载完成"+t.mRetryCount),t.mRewardedVideoAdLoading=!1,t.mRewardedVideoAdLoaded=!0,t.mRetryCount=0,t.callLoad(),t.logLoadSuccessEvent()})["catch"](function(e){t.onLoadFail(e),t.logLoadFailEvent(JSON.stringify(e))}))},t.prototype.onLoadFail=function(t){var e=this;return this.mRewardedVideoAdLoading=!1,this.mRewardedVideoAdLoaded=!1,null==this.mRewardedVideoAd?this.logDebug("激励视频创建失败 : "+JSON.stringify(t)):this.logDebug("激励视频加载失败 : "+JSON.stringify(t)),this.mRetryCount++,this.mRetryCount>3?(this.logError("激励视频失败次数太多"),void this.callFail()):void(this.mRetryId=setTimeout(function(){e.loadRewardedVideoAd()},1e4*this.mRetryCount))},t.prototype.abandonShow=function(){this.logDebug("激励视频放弃显示"),this.resetCall()},t.prototype.showRewardedVideoAd=function(t,e,i){var r=this;return void 0===t&&(t=null),void 0===e&&(e=null),void 0===i&&(i=5),this.logDebug("激励视频请求显示"),this.mSuccessCallback=t,this.mFailCallback=e,clearTimeout(this.mTimeoutId),this.mOnLoadSuccess=function(){r.showRewardedVideoAdInternal()},Facebook.isFBInit()?(i>0&&(this.mTimeoutId=setTimeout(function(){var t="激励视频"+i+"秒显示超时";r.logDebug(t),r.callFail(),r.logTimeoutEvent(i)},1e3*i)),this.mRewardedVideoAdLoaded?void this.showRewardedVideoAdInternal():(this.mRetryCount=0,void this.loadRewardedVideoAd())):void this.callFail()},t.prototype.showRewardedVideoAdInternal=function(){var t=this;if(!Facebook.isFBInit()||null==this.mRewardedVideoAd||!this.mRewardedVideoAdLoaded)return void this.callFail();clearTimeout(this.mTimeoutId),this.logDebug("激励视频开始显示");var e=this.mRewardedVideoAd;e.showAsync().then(function(){t.logDebug("激励视频显示成功"),t.callSuccess(),t.logShowSuccessEvent(),t.mRetryCount=0,t.mRewardedVideoAd=null,t.loadRewardedVideoAd()})["catch"](function(e){t.mRewardedVideoAd=null,t.callFail(),t.logShowFailEvent(JSON.stringify(e)),t.logError("激励视频显示失败 : "+JSON.stringify(e))}),this.mRewardedVideoAd=null,this.mRewardedVideoAdLoaded=!1},t.prototype.reloadRewardedVideoAd=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return this.mRewardedVideoAdLoaded||(this.mRetryCount=0,this.loadRewardedVideoAd()),[2]})})},t.prototype.isLoaded=function(){return this.mRewardedVideoAdLoaded},t.prototype.createLogObj=function(){return{adUnitId:this.mAdUnitId}},t.prototype.logCreateEvent=function(){EventUtils.logEvent("reward_create",this.createLogObj())},t.prototype.logRequestEvent=function(){EventUtils.logEvent("reward_request",this.createLogObj())},t.prototype.logLoadSuccessEvent=function(){EventUtils.logEvent("reward_load_success",this.createLogObj())},t.prototype.logLoadFailEvent=function(t){var e=this.createLogObj();e.reason=t,EventUtils.logEvent("reward_load_fail",e)},t.prototype.logShowSuccessEvent=function(){EventUtils.logEvent("reward_show_success",this.createLogObj())},t.prototype.logShowFailEvent=function(t){var e=this.createLogObj();e.reason=t,EventUtils.logEvent("reward_show_fail",e)},t.prototype.logTimeoutEvent=function(t){var e=this.createLogObj();e.loaded=this.mRewardedVideoAdLoaded,e.timeout=t,EventUtils.logEvent("reward_timeout",e)},t.prototype.logDebug=function(t){this.mLogTag&&(t=this.mLogTag+"_"+t),egret.log(t)},t.prototype.logError=function(t){this.mLogTag&&(t=this.mLogTag+"_"+t),egret.error(t)},t}();__reflect(FacebookRewardedVideoAd.prototype,"FacebookRewardedVideoAd");var FacebookStorage=function(){function t(){}return t.getInstance=function(){return null==t._instance&&(t._instance=new t),t._instance},t.prototype.loadItem=function(t,e,i){var r=t[e];return void 0!=r?r:i},t.prototype.loadDataFormFB=function(t,e,i){Facebook.IsApiSupport("player.getDataAsync")&&FBInstant.player.getDataAsync(t).then(function(t){egret.log("data is loaded"),e&&e(t),this.fbStorageLoadFinish=!0}.bind(this))["catch"](function(t){egret.error("failed : "+t.code+" :: "+t.message),i&&i()})},t.prototype.saveDataToFB=function(t,e,i){Facebook.IsApiSupport("player.setDataAsync")&&FBInstant.player.setDataAsync(t).then(function(){egret.log("Data Presaved"),e&&e()}.bind(this))["catch"](function(t){egret.error("failed : "+t.code+" :: "+t.message),i&&i()})},t.prototype.flushData=function(t,e){Facebook.IsApiSupport("player.flushDataAsync")&&FBInstant.player.flushDataAsync().then(function(){egret.log("Data persisted to FB!"),t&&t()}.bind(this))["catch"](function(t){egret.error("failed : "+t.code+" :: "+t.message),e&&e()})},t.highestScore="highestScore",t.ownSkin="ownSkin",t.usingSkin="usingSkin",t.GAME_COIN="gameCoin",t}();__reflect(FacebookStorage.prototype,"FacebookStorage");var BatterInfo=function(t){function e(){var e=t.call(this)||this;return e.isRobot=!0,e._mikeStatus=new Map,e}return __extends(e,t),Object.defineProperty(e,"instance",{get:function(){return this._instance||(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.init=function(){var t=this;return new Promise(function(e,i){t.myUserInfo?e():gmbox.login({loginOpts:{appId:"10115674281540328553"},success:function(i){t.myUserInfo=i,egret.error(i),e()}})})},Object.defineProperty(e.prototype,"otherUserInfo",{get:function(){return this._otherUserInfo},set:function(t){1==t.type&&(this.isRobot=!0),this._otherUserInfo=t},enumerable:!0,configurable:!0}),e.prototype.setMikeStatus=function(t){var e=t.userId,i=t.status;this._mikeStatus.set(e,i)},e}(egret.EventDispatcher);__reflect(BatterInfo.prototype,"BatterInfo");var game;!function(t){var e=function(){function e(){this.isAgainstRobert=!1,this.registCallback()}return Object.defineProperty(e,"instance",{get:function(){return e._instance||(e._instance=new e),e._instance},enumerable:!0,configurable:!0}),e.prototype.registCallback=function(){var e=this;Utils.isRuntime&&(gmbox.battleBridge.onStart(function(){egret.log("game start"),GameManager.getInstance().baskectBallManager.dispatchEventWith(BattleEventConst.GAME_START),e.voiceRes&&e.postMessage({type:t.BattleMsgType.VOICE,data:e.voiceRes.status})}),gmbox.battleBridge.onMessage(function(t){e.onMessage(t)}),gmbox.battleBridge.onForceQuit(function(){e.postMessage({type:t.BattleMsgType.RESULT,data:t.ResultCodeEnum.LOSE}),e.postResult(4)}),gmbox.battleBridge.updateVoiceStatus&&gmbox.battleBridge.updateVoiceStatus(function(i){egret.log("收到语音修改",JSON.stringify(i)),GameManager.getInstance().baskectBallManager.dispatchEventWith(BattleEventConst.VOICE_CHANGE,!1,i),i.userId==BatterInfo.instance.myUserInfo.userId&&(e.voiceRes=i,e.postMessage({type:t.BattleMsgType.VOICE,data:i.status})),BatterInfo.instance.setMikeStatus(i)}),gmbox.battleBridge.onEmojiMessage&&gmbox.battleBridge.onEmojiMessage(function(i){e.onMessage({type:t.BattleMsgType.EMOJI,data:i.id})}))},e.prototype.init=function(){var t=this;return new Promise(function(e,i){egret.log("准备游戏"),gmbox.battleBridge.init({success:function(i){t.initBattleData=i,i.players.forEach(function(t){t.userId!=BatterInfo.instance.myUserInfo.userId&&(BatterInfo.instance.otherUserInfo=t,0==t.type&&(BatterInfo.instance.isRobot=!1))
}),egret.log("收到用户信息",JSON.stringify(i)),e(i)},fail:function(t){i(t),egret.log("收到用户信息失败",JSON.stringify(t))},complete:function(t){egret.log("收到用户信息完成")}})})},e.prototype.ready=function(){egret.log("-----本人ready"),Utils.isRuntime&&gmbox.battleBridge.ready()},e.prototype.postMessage=function(t){egret.log("-----postMessage-----",JSON.stringify(t)),Utils.isRuntime&&gmbox.battleBridge.postMessage(t)},e.prototype.onMessage=function(e){switch(egret.log("-----onMessage-----",JSON.stringify(e)),clearTimeout(BatterInfo.instance.resultTimeout),e.type){case t.BattleMsgType.DRAGDOWN:GameManager.getInstance().scoreManager.updateOtherScore(e.data);break;case t.BattleMsgType.EMOJI:GameManager.getInstance().baskectBallManager.dispatchEventWith(BattleEventConst.RECV_EMOJI,!1,e.data);break;case t.BattleMsgType.RESULT:var i=void 0;e.data==t.ResultCodeEnum.LOSE?i=t.ResultCodeEnum.WIN:e.data==t.ResultCodeEnum.PLAYEVEN?i=t.ResultCodeEnum.PLAYEVEN:e.data==t.ResultCodeEnum.WIN&&(i=t.ResultCodeEnum.LOSE);break;case t.BattleMsgType.VOICE:GameManager.getInstance().baskectBallManager.dispatchEventWith(BattleEventConst.VOICE_CHANGE,!1,{userId:BatterInfo.instance.otherUserInfo.userId,status:e.data})}},e.prototype.postResult=function(t){egret.log("-----postResult-----",JSON.stringify(t)),Utils.isRuntime&&gmbox.battleBridge.postResult({result:t})},e.prototype.sendDragMessage=function(e){if(!BatterInfo.instance.isRobot){var i={};i.type=t.BattleMsgType.DRAGDOWN,i.data=e,this.postMessage(i)}},e.prototype.initEmojiData=function(){var t=this;return new Promise(function(e,i){t.emojiDataArr&&t.emojiDataArr.length?e(t.emojiDataArr):gmbox.platformCall({type:1,success:function(i){t.emojiDataArr=i.data,e(i.data)},fail:function(t){},complete:function(t){}})})},e.prototype.postEmoji=function(t){GameManager.getInstance().baskectBallManager.dispatchEventWith(BattleEventConst.SEND_EMOJI,!1,t),Utils.isRuntime&&gmbox.battleBridge.postEmojiMessage({id:t.toString()})},e.prototype.getEmojiById=function(t){var e;return this.emojiDataArr.some(function(i){return i.id==t?(e=i,!0):void 0}),e},e._instance=null,e}();t.BattleManager=e,__reflect(e.prototype,"game.BattleManager")}(game||(game={}));var BattleEventConst=function(){function t(){}return t.GAME_START="game_start",t.RECV_MESSAGE="recv_message",t.VOICE_CHANGE="voice_change",t.RECV_EMOJI="recv_emoji",t.SEND_EMOJI="send_emoji",t.UPDATE_OTHER_SCORE="update_other_score",t}();__reflect(BattleEventConst.prototype,"BattleEventConst");var game;!function(t){var e;!function(t){t[t.DRAGDOWN=0]="DRAGDOWN",t[t.RESULT=1]="RESULT",t[t.EMOJI=2]="EMOJI",t[t.VOICE=3]="VOICE"}(e=t.BattleMsgType||(t.BattleMsgType={}));var i;!function(t){t[t.WIN=2]="WIN",t[t.PLAYEVEN=3]="PLAYEVEN",t[t.LOSE=4]="LOSE"}(i=t.ResultCodeEnum||(t.ResultCodeEnum={}))}(game||(game={}));var GmBoxPlatform=function(){function t(){}return t.prototype.init=function(){},t.prototype.share=function(t,e,i){},t.prototype.showAd=function(){},t.prototype.getLeaderboard=function(){},t.prototype.setScoreAsync=function(t,e){},t.prototype.getSelfRank=function(){return null},t.prototype.getTargetOpponentsRank=function(t,e){return null},t.prototype.getOpponentsPassMeRank=function(t,e){return null},t.prototype.saveData=function(t,e,i){},t.prototype.getData=function(t,e,i){},t}();__reflect(GmBoxPlatform.prototype,"GmBoxPlatform",["platform.IPlatform"]);var GmboxRewardedVideoAd=function(){function t(e){var i=this;this.mAdUnitId=null,this.mVideoAds=null,this.mRewardedVideoAdLoading=!1,this.mRewardedVideoAdLoaded=!1,this.mSuccessCallback=null,this.mFailCallback=null,this.mOnLoadSuccess=null,this.mRetryCount=0,t.isValid()&&(this.mAdUnitId=e,this.mVideoAds=gmbox.createRewardedVideoAd({adUnitId:e}),this.mVideoAds.onClose(function(t){var e=!t||t.isEnded;i.logDebug("激励视频关闭 是否播放完成 = "+e),e?i.callSuccess():i.callFail(),i.logCloseEvent(e),i.mRetryCount=0,i.loadRewardedVideoAd()}),this.loadRewardedVideoAd())}return t.isValid=function(){return"undefined"!=typeof gmbox&&gmbox.createRewardedVideoAd?!0:!1},t.prototype.callSuccess=function(){this.mSuccessCallback&&this.mSuccessCallback(),this.resetCall(),clearTimeout(this.mTimeoutId)},t.prototype.callFail=function(){this.mFailCallback&&this.mFailCallback(),this.resetCall(),clearTimeout(this.mTimeoutId)},t.prototype.resetCall=function(){this.mSuccessCallback=null,this.mFailCallback=null,this.mOnLoadSuccess=null},t.prototype.callLoad=function(){this.mOnLoadSuccess&&this.mOnLoadSuccess()},t.prototype.loadRewardedVideoAd=function(){var t=this;return clearTimeout(this.mRetryId),null==this.mVideoAds?void this.callFail():this.mRewardedVideoAdLoading?void this.logDebug("激励视频正在加载"):this.mRewardedVideoAdLoaded?void this.callLoad():(this.logDebug("激励视频开始加载"),this.mRewardedVideoAdLoading=!0,this.mRewardedVideoAdLoaded=!1,this.logRequestEvent(),void this.mVideoAds.load().then(function(){t.mRewardedVideoAdLoading=!1,t.mRewardedVideoAdLoaded=!0,t.mRetryCount=0,t.logDebug("激励视频加载完成"),t.callLoad(),t.logLoadSuccessEvent()})["catch"](function(e){return t.mRewardedVideoAdLoading=!1,t.mRewardedVideoAdLoaded=!1,t.logDebug("激励视频加载失败 : "+JSON.stringify(e)),t.mRetryCount++,t.logLoadFailEvent(JSON.stringify(e)),t.mRetryCount>3?(t.logError("激励视频失败次数太多"),void t.callFail()):void(t.mRetryId=setTimeout(function(){t.loadRewardedVideoAd()},1e4*t.mRetryCount))}))},t.prototype.isLoaded=function(){return this.mRewardedVideoAdLoaded},t.prototype.abandonShow=function(){this.logDebug("激励视频放弃显示"),this.resetCall()},t.prototype.showRewardedVideoAd=function(t,e,i){var r=this;return void 0===t&&(t=null),void 0===e&&(e=null),void 0===i&&(i=5),this.logDebug("激励视频请求显示"),this.mSuccessCallback=t,this.mFailCallback=e,clearTimeout(this.mTimeoutId),this.mOnLoadSuccess=function(){r.showRewardedVideoAdInternal()},null==this.mVideoAds?void this.callFail():(i>0&&(this.mTimeoutId=setTimeout(function(){var t="激励视频"+i+"秒显示超时";r.logDebug(t),r.callFail(),r.logTimeoutEvent(i)},1e3*i)),this.mRewardedVideoAdLoaded?void this.showRewardedVideoAdInternal():(this.mRetryCount=0,void this.loadRewardedVideoAd()))},t.prototype.showRewardedVideoAdInternal=function(){var t=this;return null!=this.mVideoAds&&this.mRewardedVideoAdLoaded?(this.logDebug("激励视频开始显示"),this.mVideoAds.show().then(function(){t.logDebug("激励视频显示成功"),t.logShowSuccessEvent()})["catch"](function(e){t.callFail(),t.logShowFailEvent(JSON.stringify(e)),t.logError("激励视频显示失败 : "+JSON.stringify(e))}),void(this.mRewardedVideoAdLoaded=!1)):void this.callFail()},t.prototype.reloadRewardedVideoAd=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return this.mRewardedVideoAdLoaded||(this.mRetryCount=0,this.loadRewardedVideoAd()),[2]})})},t.prototype.createLogObj=function(){return{adUnitId:this.mAdUnitId}},t.prototype.logRequestEvent=function(){void 0!=EventUtils&&EventUtils.logEvent("reward_request",this.createLogObj())},t.prototype.logLoadSuccessEvent=function(){EventUtils.logEvent("reward_load_success",this.createLogObj())},t.prototype.logLoadFailEvent=function(t){var e=this.createLogObj();e.reason=t,EventUtils.logEvent("reward_load_fail",e)},t.prototype.logShowSuccessEvent=function(){EventUtils.logEvent("reward_show_success",this.createLogObj())},t.prototype.logShowFailEvent=function(t){var e=this.createLogObj();e.reason=t,EventUtils.logEvent("reward_show_fail",e)},t.prototype.logTimeoutEvent=function(t){var e=this.createLogObj();e.loaded=this.mRewardedVideoAdLoaded,e.timeout=t,EventUtils.logEvent("reward_timeout",e)},t.prototype.logCloseEvent=function(t){var e=this.createLogObj();e.isEnded=t,EventUtils.logEvent("reward_close",e)},t.prototype.logDebug=function(t){t="Gmbox_"+t,egret.log(t)},t.prototype.logError=function(t){t="Gmbox_"+t,egret.error(t)},t}();__reflect(GmboxRewardedVideoAd.prototype,"GmboxRewardedVideoAd");var LanguageManager=function(){function t(){}return Object.defineProperty(t,"instance",{get:function(){return this._ins||(this._ins=new t),this._ins},enumerable:!0,configurable:!0}),t.prototype.initTable=function(){this._languageTable=RES.getRes("Language_json")},t.prototype.getLangeuage=function(t){if(!(0>=t)){var e=this._languageTable[t-1];return e.id!=t&&this._languageTable.some(function(i){return i.id==t?(e=i,!0):void 0}),e[GameConfig.languageType]?e[GameConfig.languageType].trim():void 0}},t}();__reflect(LanguageManager.prototype,"LanguageManager");var table;!function(t){var e=function(){function t(){}return t.prototype.GetType=function(){return"table.TableLanguage"},t}();t.TableLanguage=e,__reflect(e.prototype,"table.TableLanguage")}(table||(table={}));var AdManager=function(){function t(){}return t.checkRewardedVideoAdLoad=function(){return PlatfromUtil.getPlatformEnum()==PlatfromEnum.FACEBOOK?(Facebook.FBPropAd.reloadRewardedVideoAd(),Facebook.FBTrasureChestAd.reloadRewardedVideoAd(),Facebook.FBPropAd.isLoaded()||Facebook.FBTrasureChestAd.isLoaded()):t.RewardedVideoAd?(t.RewardedVideoAd.reloadRewardedVideoAd(),t.RewardedVideoAd.isLoaded()):!1},t.showRewardedVideoAd=function(e,i,r){void 0===e&&(e=null),void 0===i&&(i=null),void 0===r&&(r=5),PlatfromUtil.getPlatformEnum()==PlatfromEnum.FACEBOOK?Facebook.FBPropAd.isLoaded()||!Facebook.FBTrasureChestAd.isLoaded()?Facebook.FBPropAd.showRewardedVideoAd(e,i,r):Facebook.FBTrasureChestAd.showRewardedVideoAd(e,i,r):t.RewardedVideoAd&&t.RewardedVideoAd.showRewardedVideoAd(e,i,r)},t.abandonShowRewardedVideoAd=function(){PlatfromUtil.getPlatformEnum()==PlatfromEnum.FACEBOOK?(Facebook.FBPropAd.abandonShow(),Facebook.FBTrasureChestAd.abandonShow()):t.RewardedVideoAd&&t.RewardedVideoAd.abandonShow()},t.RewardedVideoAd=GmboxRewardedVideoAd.isValid()?new GmboxRewardedVideoAd(""):null,t}();__reflect(AdManager.prototype,"AdManager");var EventUtils=function(){function t(){}return t.logEvent=function(t,e){return void 0===e&&(e=null),__awaiter(this,void 0,void 0,function(){return __generator(this,function(i){return null!=e?e.event=t:e={event:t},egret.log(e),"undefined"!=typeof gmbox&&gmbox.logEvent&&gmbox.logEvent(e),Facebook.logEvent(t,1,e),[2]})})},t}();__reflect(EventUtils.prototype,"EventUtils");var PlatfromEnum;!function(t){t[t.FACEBOOK=1]="FACEBOOK",t[t.GP=2]="GP",t[t.GMBOX=3]="GMBOX"}(PlatfromEnum||(PlatfromEnum={}));var PlatfromUtil=function(){function t(){}return t.getPlatformEnum=function(){return Facebook.isFBInit()?PlatfromEnum.FACEBOOK:Utils.isRuntime?PlatfromEnum.GMBOX:PlatfromEnum.GP},t.getPlatform=function(){return Facebook.isFBInit()?new FacebookPlatform:(Utils.isRuntime,new GmBoxPlatform)},t}();__reflect(PlatfromUtil.prototype,"PlatfromUtil");var Girl=function(t){function e(){var e=t.call(this)||this;return e.newAnimationType=ANIMATION_TYPE.NONE,e}return __extends(e,t),e.prototype.addListener=function(){GameManager.getInstance().baskectBallManager.addEventListener(e.PLAY_ANIMATION,this.playAnimation,this)},e.prototype.removeListener=function(){GameManager.getInstance().baskectBallManager.removeEventListener(e.PLAY_ANIMATION,this.playAnimation,this)},e.prototype.onShow=function(e){t.prototype.onShow.call(this,e),this.factory=DragonUtils.createDragonBones("lalamei_ske_json","lalamei_tex_json","lalamei_tex_png"),this.createOrComplete(ANIMATION_TYPE.NORMAL)},e.prototype.onHide=function(e){t.prototype.onHide.call(this,e)},e.prototype.playAnimation=function(t){var e=t.data.type;this.createOrComplete(e)},e.prototype.pauseAnimation=function(t){this.clearArmature()},e.prototype.getRandomType=function(){return core.MathUtils.random(1,3)},e.prototype.createOrComplete=function(t){"number"!=typeof t&&(t=this.getRandomType()),this.clearArmature(),this.currentArmature=this.factory.buildArmature(""+t),dragonBones.WorldClock.clock.add(this.currentArmature);var e=this.currentArmature.display;e.scaleX=e.scaleY=1,this.addChild(e),this.currentArmature.addEventListener(dragonBones.EventObject.COMPLETE,this.createOrComplete,this),this.currentArmature.addEventListener(dragonBones.EventObject.FRAME_EVENT,this.animationEvent,this),this.currentArmature.addEventListener(dragonBones.EventObject.LOOP_COMPLETE,this.looperComplete,this),t==ANIMATION_TYPE.NORMAL?this.currentArmature.animation.play("animation",10):t==ANIMATION_TYPE.TANQI||t==ANIMATION_TYPE.TIAOQI||t==ANIMATION_TYPE.HUANHU?this.currentArmature.animation.play("animation",1):this.currentArmature.animation.play("animation",2)},e.prototype.clearArmature=function(){this.currentArmature&&(this.currentArmature.animation.stop(),DragonUtils.removeFromParent(this.currentArmature.display),dragonBones.WorldClock.clock.remove(this.currentArmature),this.currentArmature.removeEventListener(dragonBones.EventObject.COMPLETE,this.createOrComplete,this),this.currentArmature.removeEventListener(dragonBones.EventObject.FRAME_EVENT,this.animationEvent,this),this.currentArmature.removeEventListener(dragonBones.EventObject.LOOP_COMPLETE,this.looperComplete,this),this.currentArmature=null)},e.prototype.animationEvent=function(t){"chui"==t.frameLabel?SoundMgr.getInstance().playSleep():"bmob"==t.frameLabel?SoundMgr.getInstance().playWake():"tanqi"==t.frameLabel?SoundMgr.getInstance().playTanqi():"nice"==t.frameLabel?SoundMgr.getInstance().playCheer():"perfact"==t.frameLabel&&SoundMgr.getInstance().playExciting()},e.prototype.looperComplete=function(){},e.PLAY_ANIMATION="play_animation",e.PAUSE_ANIMATION="pause_animation",e}(core.EUIComponent);__reflect(Girl.prototype,"Girl");var ANIMATION_TYPE;!function(t){t[t.NONE=0]="NONE",t[t.NORMAL=1]="NORMAL",t[t.JIAYOU=2]="JIAYOU",t[t.TANQI=3]="TANQI",t[t.CHUIPAOPAO=4]="CHUIPAOPAO",t[t.HUANHU=5]="HUANHU",t[t.TIAOQI=6]="TIAOQI"}(ANIMATION_TYPE||(ANIMATION_TYPE={}));var ChangeSkinView=function(t){function e(){var i=t.call(this)||this;return i.valueNumber=500,i.isHideActionUp=!1,i.skinName="resource/assets/exml/ChangeSkinExml.exml",e._instance=i,i.top=i.bottom=i.left=i.right=0,i}return __extends(e,t),e.getInstance=function(){return e._instance},e.prototype.onShow=function(e){t.prototype.onShow.call(this,e),this.skinString=GameManager.getInstance().baskectBallManager.skinInfo,this.m_coins.text=GameManager.getInstance().baskectBallManager.coinsNumber+"",this.targetBall=GameManager.getInstance().baskectBallManager.use,this.init(),this.isHideActionUp&&"undefined"!=typeof gmbox&&gmbox.updateActionView({action:1})},e.prototype.onHide=function(e){t.prototype.onHide.call(this,e),this.isHideActionUp&&"undefined"!=typeof gmbox&&gmbox.updateActionView({action:2})},e.prototype.addListener=function(){t.prototype.addListener.call(this),this.m_skin_back.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closeDialog,this),this.m_ball_tab.addEventListener(egret.TouchEvent.TOUCH_TAP,this.switchTab,this),this.m_hoop_tab.addEventListener(egret.TouchEvent.TOUCH_TAP,this.switchTab,this),this.m_basket_tab.addEventListener(egret.TouchEvent.TOUCH_TAP,this.switchTab,this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.itemClickHandler,this),GameManager.getInstance().addEventListener(GameManager.REFRESH_GOLD,this.changeGold,this)},e.prototype.removeListener=function(){t.prototype.removeListener.call(this),this.m_skin_back.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.closeDialog,this),this.m_ball_tab.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.switchTab,this),this.m_hoop_tab.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.switchTab,this),this.m_basket_tab.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.switchTab,this),this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.itemClickHandler,this),GameManager.getInstance().removeEventListener(GameManager.REFRESH_GOLD,this.changeGold,this)},e.prototype.itemClickHandler=function(t){t.target},e.prototype.changeGold=function(){this.m_coins.text=GameManager.getInstance().baskectBallManager.coinsNumber+""},e.prototype.popUp=function(t){void 0===t&&(t=!1),this.isHideActionUp=t,core.LayerCenter.getInstance().getLayer(LayerEnum.POPUP).addChild(this)},e.prototype.buyEvent=function(t){SkinManager.getInstance().getGoldInfo,GameManager.getInstance().baskectBallManager.coinsNumber>=500&&(GameManager.getInstance().baskectBallManager.payCoinsNumber(this.valueNumber),this.m_coins.text=GameManager.getInstance().baskectBallManager.coinsNumber+"",this.skinPlay[this.buySkinId].m_skins_mask.visible=!1,this.skinPlay[this.buySkinId].status=1,SkinManager.getInstance().payGold())},e.prototype.onShareAward=function(){},e.prototype.onVideoAward=function(){},e.prototype.shareHandler=function(t){GameManager.getInstance().baskectBallManager.dispatchEventWith(BaskectBallManager.CHANGE_SKIN),GameManager.getInstance().dispatchEventWith(GameManager.RESUME_GAME)},e.prototype.init=function(){this.skinPlay=[];var t=this.skinString;t.sort(function(t,e){var i=parseInt(t),r=parseInt(e);return i-r});for(var e=0,i=0;7>i;i++){this.skinPlay[i]=new SkinItemView,this.skinPlay[i].m_ball.source="mg_qiu_"+i+"_png",this.skinPlay[i].price=BaskectBallManager.BASKET_PRICE[i],this.m_skinItem_container.addChild(this.skinPlay[i]);var r=parseInt(t[e]);r==i&&t[e]?(this.skinPlay[i].status=1,e++):this.skinPlay[i].status=0,this.skinPlay[i].skinId=i,this.skinPlay[i].init()}this.skinPlay[this.targetBall].m_selected.visible=!0,this.skinPlay[this.targetBall].m_selected.visible=!0},e.prototype.clearSelected=function(){for(var t=0;12>t;t++)if(this.skinPlay[t].m_selected.visible){this.skinPlay[t].m_selected.visible=!1;break}},e.prototype.closeDialog=function(){core.LayerCenter.getInstance().getLayer(LayerEnum.POPUP).contains(this)&&core.LayerCenter.getInstance().getLayer(LayerEnum.POPUP).removeChild(this),GameManager.getInstance().resumeGame()},e.prototype.switchTab=function(t){t.target==this.m_ball_tab?egret.log(1):t.target==this.m_ball_tab?egret.log(2):egret.log(3)},e.prototype.showToast=function(t){TweenUtil.stopTweenGroup(this.toast),this.m_toast.text=1==t?"Exchange Succeeded!":2==t?"Successful transaction":"Not enough coin",TweenUtil.playTweenGroup(this.toast,!1)},e}(core.EUIComponent);__reflect(ChangeSkinView.prototype,"ChangeSkinView");var SkinItemView=function(t){function e(){var e=t.call(this)||this;return e.status=0,e.isSelect=!1,e.skinId=0,e.price=0,e.skinName="resource/assets/exml/SkinItemExml.exml",e}return __extends(e,t),e.prototype.onShow=function(e){t.prototype.onShow.call(this,e),this.m_selected.visible=!1,this.init()},e.prototype.init=function(){1==this.status?(this.m_skins_mask.visible=!1,this.m_video.visible=!1,this.m_coin.visible=!1,this.m_price.visible=!1):(this.m_selected.visible=!1,this.price<0?(this.m_video.visible=!1,this.m_coin.visible=!1,this.m_price.visible=!1):0==this.price?(this.m_video.visible=!0,this.m_coin.visible=!1,this.m_price.visible=!1):(this.m_video.visible=!1,this.m_coin.visible=!0,this.m_price.visible=!0,this.m_price.text=this.price+""))},e.prototype.onHide=function(e){t.prototype.onHide.call(this,e)},e.prototype.onTouch=function(){if(egret.log("onTouch: "+this.skinId),1==this.status)ChangeSkinView.getInstance().targetBall!=this.skinId&&(this.selectSkin(),ChangeSkinView.getInstance().showToast(1));else{var t=new BuyDialog;t.buy(this.price,this.skinId)}},e.prototype.selectSkin=function(){GameManager.getInstance().baskectBallManager.use=this.skinId,GameManager.getInstance().baskectBallManager.dispatchEventWith(BaskectBallManager.CHANGE_SKIN),ChangeSkinView.getInstance().clearSelected(),this.m_selected.visible=!0,ChangeSkinView.getInstance().targetBall=this.skinId,EventUtils.logEvent("useSkin",{skinId:this.skinId})},e.prototype.curSkin=function(){({skinId:this.skinId})},e.prototype.addListener=function(){t.prototype.addListener.call(this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouch,this)},e.prototype.removeListener=function(){t.prototype.removeListener.call(this)},e.prototype.buySuccess=function(){this.status=1,this.m_skins_mask.visible=!1,this.m_video.visible=!1,this.m_coin.visible=!1,this.m_price.visible=!1,this.selectSkin()},e}(core.EUIComponent);__reflect(SkinItemView.prototype,"SkinItemView");var SkinManager=function(){function t(){this.addListener()}return t.getInstance=function(){return null==t._instance&&(t._instance=new t),t._instance},t.prototype.addListener=function(){core.EventCenter.getInstance().addEventListener("event2007",this.getGoldInfo,this),core.EventCenter.getInstance().addEventListener("event2008",this.getBuyInfo,this),core.EventCenter.getInstance().addEventListener("event2009",this.getCurSkin,this)},t.prototype.getGoldInfo=function(t){console.log(t);var e=t.messageData.data.gold;GameManager.getInstance().baskectBallManager.coinsNumber=e,GameManager.getInstance().refreshGold(e)},t.prototype.getBuyInfo=function(t){},t.prototype.getCurSkin=function(t){GameManager.getInstance().baskectBallManager.use=t.messageData.data.use},t.prototype.payGold=function(){({skinId:ChangeSkinView.getInstance().buySkinId});console.log("买到的皮肤",ChangeSkinView.getInstance().buySkinId)},t.prototype.getGold=function(t){},t}();__reflect(SkinManager.prototype,"SkinManager");var DragonUtils=function(){function t(){}return t.createDragonBones=function(t,e,i){var r=RES.getRes(t);if(null==r||void 0==r)return null;if(i&&null!=i)var n=RES.getRes(e),a=RES.getRes(i);else var n=RES.getRes(e+"_json"),a=RES.getRes(e+"_png");if(dragonBones){var o=new dragonBones.EgretFactory;return o.parseDragonBonesData(r),o.parseTextureAtlasData(n,a),o}return null},t.createDragonBonesDisplay=function(t,e,i,r,n){var a=RES.getRes(t);if(null==a||void 0==a)return null;if(i&&null!=i)var o=RES.getRes(e),s=RES.getRes(i);else var o=RES.getRes(e+"_json"),s=RES.getRes(e+"_png");this.stringIsNullOrEmpty(r)&&(r="armature");var l;if(dragonBones){var h=new dragonBones.EgretFactory;h.parseDragonBonesData(a),h.parseTextureAtlasData(o,s),n?(l=h.buildFastArmature(r),l.enableAnimationCache(n)):l=h.buildArmature(r)}return l},t.stringIsNullOrEmpty=function(t){return null==t||0==t.length},t.removeFromParent=function(t){t&&t.parent&&t.parent.removeChild(t)},t}();__reflect(DragonUtils.prototype,"DragonUtils");var TweenUtil=function(){function t(){}return t.playTweenGroup=function(t,e){if(this.stopTweenGroup(t),e)for(var i in t.items)t.items[i].props={loop:!0};t.play()},t.stopTweenGroup=function(t){if(t.items)for(var e in t.items)t.items[e].props={loop:!1};t.stop()},t}();__reflect(TweenUtil.prototype,"TweenUtil");