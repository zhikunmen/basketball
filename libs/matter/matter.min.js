var egret=window.egret;(function(N){"object"===typeof exports&&"undefined"!==typeof module?(module.exports=N(),window.Matter=N()):"function"===typeof define&&define.amd?define([],N):("undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:this).Matter=N()})(function(){return function n(q,w,a){function e(b,l){if(!w[b]){if(!q[b]){var h="function"==typeof require&&require;if(!l&&h)return h(b,!0);if(d)return d(b,!0);h=Error("Cannot find module '"+b+"'");throw h.code="MODULE_NOT_FOUND",h;}h=w[b]={exports:{}};q[b][0].call(h.exports,function(c){var a=q[b][1][c];return e(a?a:c)},h,h.exports,n,q,w,a)}return w[b].exports}for(var d="function"==typeof require&&require,b=0;b<a.length;b++)e(a[b]);return e}({1:[function(n,q,w){var a={};q.exports=a;var e=n("../geometry/Vertices"),d=n("../geometry/Vector"),b=n("../core/Sleeping");n("../render/Render");var h=n("../core/Common"),l=n("../geometry/Bounds"),g=n("../geometry/Axes");(function(){a._inertiaScale=4;a._nextCollidingGroupId=1;a._nextNonCollidingGroupId=-1;a._nextCategory=1;a.create=function(c){var b={id:h.nextId(),type:"body",label:"Body",parts:[],plugin:{},angle:0,vertices:e.fromPath("L 0 0 L 40 0 L 40 40 L 0 40"),position:{x:0,y:0},force:{x:0,y:0},torque:0,positionImpulse:{x:0,y:0},constraintImpulse:{x:0,y:0,angle:0},totalContacts:0,speed:0,angularSpeed:0,velocity:{x:0,y:0},angularVelocity:0,isSensor:!1,isStatic:!1,isSleeping:!1,motion:0,sleepThreshold:60,density:.001,restitution:0,friction:.1,frictionStatic:.5,frictionAir:.01,collisionFilter:{category:1,mask:4294967295,group:0},slop:.05,timeScale:1,render:{visible:!0,opacity:1,sprite:{xScale:1,yScale:1,xOffset:0,yOffset:0},lineWidth:0}},b=h.extend(b,c);c=c||{};a.set(b,{bounds:b.bounds||l.create(b.vertices),positionPrev:b.positionPrev||d.clone(b.position),anglePrev:b.anglePrev||b.angle,vertices:b.vertices,parts:b.parts||[b],isStatic:b.isStatic,isSleeping:b.isSleeping,parent:b.parent||b});e.rotate(b.vertices,b.angle,b.position);g.rotate(b.axes,b.angle);l.update(b.bounds,b.vertices,b.velocity);a.set(b,{axes:c.axes||b.axes,area:c.area||b.area,mass:c.mass||b.mass,inertia:c.inertia||b.inertia});c=b.isStatic?"#2e2b44":h.choose(["#006BA6","#0496FF","#FFBC42","#D81159","#8F2D56"]);b.render.fillStyle=b.render.fillStyle||c;b.render.strokeStyle=b.render.strokeStyle||"#000";b.render.sprite.xOffset+=-(b.bounds.min.x-b.position.x)/(b.bounds.max.x-b.bounds.min.x);b.render.sprite.yOffset+=-(b.bounds.min.y-b.position.y)/(b.bounds.max.y-b.bounds.min.y);return b};a.nextGroup=function(c){return c?a._nextNonCollidingGroupId--:a._nextCollidingGroupId++};a.nextCategory=function(){a._nextCategory<<=1;return a._nextCategory};a.set=function(c,m,d){var f;"string"===typeof m&&(f=m,m={},m[f]=d);for(f in m)if(d=m[f],m.hasOwnProperty(f))switch(f){case "isStatic":a.setStatic(c,d);break;case "isSleeping":b.set(c,d);break;case "mass":a.setMass(c,d);break;case "density":a.setDensity(c,d);break;case "inertia":a.setInertia(c,d);break;case "vertices":a.setVertices(c,d);break;case "position":a.setPosition(c,d);break;case "angle":a.setAngle(c,d);break;case "velocity":a.setVelocity(c,d);break;case "angularVelocity":a.setAngularVelocity(c,d);break;case "parts":a.setParts(c,d);break;default:c[f]=d}};a.setStatic=function(c,a){for(var b=0;b<c.parts.length;b++){var f=c.parts[b];(f.isStatic=a)?(f._original={restitution:f.restitution,friction:f.friction,mass:f.mass,inertia:f.inertia,density:f.density,inverseMass:f.inverseMass,inverseInertia:f.inverseInertia},f.restitution=0,f.friction=1,f.mass=f.inertia=f.density=Infinity,f.inverseMass=f.inverseInertia=0,f.positionPrev.x=f.position.x,f.positionPrev.y=f.position.y,f.anglePrev=f.angle,f.angularVelocity=0,f.speed=0,f.angularSpeed=0,f.motion=0):f._original&&(f.restitution=f._original.restitution,f.friction=f._original.friction,f.mass=f._original.mass,f.inertia=f._original.inertia,f.density=f._original.density,f.inverseMass=f._original.inverseMass,f.inverseInertia=f._original.inverseInertia,delete f._original)}};a.setMass=function(c,a){c.inertia=c.inertia/(c.mass/6)*(a/6);c.inverseInertia=1/c.inertia;c.mass=a;c.inverseMass=1/c.mass;c.density=c.mass/c.area};a.setDensity=function(c,b){a.setMass(c,b*c.area);c.density=b};a.setInertia=function(c,a){c.inertia=a;c.inverseInertia=1/c.inertia};a.setVertices=function(c,b){c.vertices=b[0].body===c?b:e.create(b,c);c.axes=g.fromVertices(c.vertices);c.area=e.area(c.vertices);a.setMass(c,c.density*c.area);var d=e.centre(c.vertices);e.translate(c.vertices,d,-1);a.setInertia(c,a._inertiaScale*e.inertia(c.vertices,c.mass));e.translate(c.vertices,c.position);l.update(c.bounds,c.vertices,c.velocity)};a.setParts=function(c,b,d){var f;b=b.slice(0);c.parts.length=0;c.parts.push(c);c.parent=c;for(f=0;f<b.length;f++){var h=b[f];h!==c&&(h.parent=c,c.parts.push(h))}if(1!==c.parts.length){if("undefined"!==typeof d?d:1){d=[];for(f=0;f<b.length;f++)d=d.concat(b[f].vertices);e.clockwiseSort(d);b=e.hull(d);f=e.centre(b);a.setVertices(c,b);e.translate(c.vertices,f)}b=a._totalProperties(c);c.area=b.area;c.parent=c;c.position.x=b.centre.x;c.position.y=b.centre.y;c.positionPrev.x=b.centre.x;c.positionPrev.y=b.centre.y;a.setMass(c,b.mass);a.setInertia(c,b.inertia);a.setPosition(c,b.centre)}};a.setPosition=function(c,b){var a=d.sub(b,c.position);c.positionPrev.x+=a.x;c.positionPrev.y+=a.y;for(var f=0;f<c.parts.length;f++){var h=c.parts[f];h.position.x+=a.x;h.position.y+=a.y;e.translate(h.vertices,a);l.update(h.bounds,h.vertices,c.velocity)}};a.setAngle=function(c,a){var b=a-c.angle;c.anglePrev+=b;for(var f=0;f<c.parts.length;f++){var h=c.parts[f];h.angle+=b;e.rotate(h.vertices,b,c.position);g.rotate(h.axes,b);l.update(h.bounds,h.vertices,c.velocity);0<f&&d.rotateAbout(h.position,b,c.position,h.position)}};a.setVelocity=function(c,b){c.positionPrev.x=c.position.x-b.x;c.positionPrev.y=c.position.y-b.y;c.velocity.x=b.x;c.velocity.y=b.y;c.speed=d.magnitude(c.velocity)};a.setAngularVelocity=function(c,b){c.anglePrev=c.angle-b;c.angularVelocity=b;c.angularSpeed=Math.abs(c.angularVelocity)};a.translate=function(c,b){a.setPosition(c,d.add(c.position,b))};a.rotate=function(c,b,d){if(d){var f=Math.cos(b),h=Math.sin(b),m=c.position.x-d.x,p=c.position.y-d.y;a.setPosition(c,{x:d.x+(m*f-p*h),y:d.y+(m*h+p*f)})}a.setAngle(c,c.angle+b)};a.scale=function(c,b,d,f){var h=0,m=0;f=f||c.position;for(var p=0;p<c.parts.length;p++){var k=c.parts[p];e.scale(k.vertices,b,d,f);k.axes=g.fromVertices(k.vertices);k.area=e.area(k.vertices);a.setMass(k,c.density*k.area);e.translate(k.vertices,{x:-k.position.x,y:-k.position.y});a.setInertia(k,a._inertiaScale*e.inertia(k.vertices,k.mass));e.translate(k.vertices,{x:k.position.x,y:k.position.y});0<p&&(h+=k.area,m+=k.inertia);k.position.x=f.x+(k.position.x-f.x)*b;k.position.y=f.y+(k.position.y-f.y)*d;l.update(k.bounds,k.vertices,c.velocity)}1<c.parts.length&&(c.area=h,c.isStatic||(a.setMass(c,c.density*h),a.setInertia(c,m)));c.circleRadius&&(c.circleRadius=b===d?c.circleRadius*b:null)};a.update=function(c,b,a,f){b=Math.pow(b*a*c.timeScale,2);a=1-c.frictionAir*a*c.timeScale;var h=c.position.y-c.positionPrev.y;c.velocity.x=(c.position.x-c.positionPrev.x)*a*f+c.force.x/c.mass*b;c.velocity.y=h*a*f+c.force.y/c.mass*b;c.positionPrev.x=c.position.x;c.positionPrev.y=c.position.y;c.position.x+=c.velocity.x;c.position.y+=c.velocity.y;c.angularVelocity=(c.angle-c.anglePrev)*a*f+c.torque/c.inertia*b;c.anglePrev=c.angle;c.angle+=c.angularVelocity;c.speed=d.magnitude(c.velocity);c.angularSpeed=Math.abs(c.angularVelocity);for(f=0;f<c.parts.length;f++)b=c.parts[f],e.translate(b.vertices,c.velocity),0<f&&(b.position.x+=c.velocity.x,b.position.y+=c.velocity.y),0!==c.angularVelocity&&(e.rotate(b.vertices,c.angularVelocity,c.position),g.rotate(b.axes,c.angularVelocity),0<f&&d.rotateAbout(b.position,c.angularVelocity,c.position,b.position)),l.update(b.bounds,b.vertices,c.velocity)};a.applyForce=function(c,b,a){c.force.x+=a.x;c.force.y+=a.y;c.torque+=(b.x-c.position.x)*a.y-(b.y-c.position.y)*a.x};a._totalProperties=function(c){for(var b={mass:0,area:0,inertia:0,centre:{x:0,y:0}},a=1===c.parts.length?0:1;a<c.parts.length;a++){var f=c.parts[a],h=Infinity!==f.mass?f.mass:1;b.mass+=h;b.area+=f.area;b.inertia+=f.inertia;b.centre=d.add(b.centre,d.mult(f.position,h))}b.centre=d.div(b.centre,b.mass);return b}})()},{"../core/Common":14,"../core/Sleeping":22,"../geometry/Axes":25,"../geometry/Bounds":26,"../geometry/Vector":28,"../geometry/Vertices":29,"../render/Render":31}],2:[function(n,q,w){var a={};q.exports=a;var e=n("../core/Events"),d=n("../core/Common"),b=n("./Body");(function(){a.create=function(b){return d.extend({id:d.nextId(),type:"composite",parent:null,isModified:!1,bodies:[],constraints:[],composites:[],label:"Composite",plugin:{}},b)};a.setModified=function(b,d,g,c){b.isModified=d;g&&b.parent&&a.setModified(b.parent,d,g,c);if(c)for(var h=0;h<b.composites.length;h++)a.setModified(b.composites[h],d,g,c)};a.add=function(b,l){var h=[].concat(l);e.trigger(b,"beforeAdd",{object:l});for(var c=0;c<h.length;c++){var m=h[c];switch(m.type){case "body":if(m.parent!==m){d.warn("Composite.add: skipped adding a compound body part (you must add its parent instead)");break}a.addBody(b,m);break;case "constraint":a.addConstraint(b,m);break;case "composite":a.addComposite(b,m);break;case "mouseConstraint":a.addConstraint(b,m.constraint)}}e.trigger(b,"afterAdd",{object:l});return b};a.remove=function(b,d,g){var c=[].concat(d);e.trigger(b,"beforeRemove",{object:d});for(var h=0;h<c.length;h++){var k=c[h];switch(k.type){case "body":a.removeBody(b,k,g);break;case "constraint":a.removeConstraint(b,k,g);break;case "composite":a.removeComposite(b,k,g);break;case "mouseConstraint":a.removeConstraint(b,k.constraint)}}e.trigger(b,"afterRemove",{object:d});return b};a.addComposite=function(b,d){b.composites.push(d);d.parent=b;a.setModified(b,!0,!0,!1);return b};a.removeComposite=function(b,e,g){var c=d.indexOf(b.composites,e);-1!==c&&(a.removeCompositeAt(b,c),a.setModified(b,!0,!0,!1));if(g)for(g=0;g<b.composites.length;g++)a.removeComposite(b.composites[g],e,!0);return b};a.removeCompositeAt=function(b,d){b.composites.splice(d,1);a.setModified(b,!0,!0,!1);return b};a.addBody=function(b,d){b.bodies.push(d);a.setModified(b,!0,!0,!1);return b};a.removeBody=function(b,e,g){var c=d.indexOf(b.bodies,e);-1!==c&&(a.removeBodyAt(b,c),a.setModified(b,!0,!0,!1));if(g)for(g=0;g<b.composites.length;g++)a.removeBody(b.composites[g],e,!0);return b};a.removeBodyAt=function(b,d){b.bodies.splice(d,1);a.setModified(b,!0,!0,!1);return b};a.addConstraint=function(b,d){b.constraints.push(d);a.setModified(b,!0,!0,!1);return b};a.removeConstraint=function(b,e,g){var c=d.indexOf(b.constraints,e);-1!==c&&a.removeConstraintAt(b,c);if(g)for(g=0;g<b.composites.length;g++)a.removeConstraint(b.composites[g],e,!0);return b};a.removeConstraintAt=function(b,d){b.constraints.splice(d,1);a.setModified(b,!0,!0,!1);return b};a.clear=function(b,d,g){if(g)for(g=0;g<b.composites.length;g++)a.clear(b.composites[g],d,!0);d?b.bodies=b.bodies.filter(function(c){return c.isStatic}):b.bodies.length=0;b.constraints.length=0;b.composites.length=0;a.setModified(b,!0,!0,!1);return b};a.allBodies=function(b){for(var d=[].concat(b.bodies),h=0;h<b.composites.length;h++)d=d.concat(a.allBodies(b.composites[h]));return d};a.allConstraints=function(b){for(var d=[].concat(b.constraints),h=0;h<b.composites.length;h++)d=d.concat(a.allConstraints(b.composites[h]));return d};a.allComposites=function(b){for(var d=[].concat(b.composites),h=0;h<b.composites.length;h++)d=d.concat(a.allComposites(b.composites[h]));return d};a.get=function(b,d,g){var c;switch(g){case "body":c=a.allBodies(b);break;case "constraint":c=a.allConstraints(b);break;case "composite":c=a.allComposites(b).concat(b)}if(!c)return null;b=c.filter(function(c){return c.id.toString()===d.toString()});return 0===b.length?null:b[0]};a.move=function(b,d,g){a.remove(b,d);a.add(g,d);return b};a.rebase=function(b){for(var h=a.allBodies(b).concat(a.allConstraints(b)).concat(a.allComposites(b)),g=0;g<h.length;g++)h[g].id=d.nextId();a.setModified(b,!0,!0,!1);return b};a.translate=function(d,e,g){g=g?a.allBodies(d):d.bodies;for(var c=0;c<g.length;c++)b.translate(g[c],e);a.setModified(d,!0,!0,!1);return d};a.rotate=function(d,e,g,c){var h=Math.cos(e),k=Math.sin(e);c=c?a.allBodies(d):d.bodies;for(var f=0;f<c.length;f++){var r=c[f],u=r.position.x-g.x,p=r.position.y-g.y;b.setPosition(r,{x:g.x+(u*h-p*k),y:g.y+(u*k+p*h)});b.rotate(r,e)}a.setModified(d,!0,!0,!1);return d};a.scale=function(d,e,g,c,m){m=m?a.allBodies(d):d.bodies;for(var h=0;h<m.length;h++){var f=m[h];b.setPosition(f,{x:c.x+(f.position.x-c.x)*e,y:c.y+(f.position.y-c.y)*g});b.scale(f,e,g)}a.setModified(d,!0,!0,!1);return d};a.bounds=function(b){b=Matter.Composite.allBodies(b);for(var a=[],d=0;d<b.length;d+=1){var c=b[d];a.push(c.bounds.min,c.bounds.max)}return Matter.Bounds.create(a)}})()},{"../core/Common":14,"../core/Events":16,"./Body":1}],3:[function(n,q,w){var a={};q.exports=a;var e=n("./Composite");n("../constraint/Constraint");var d=n("../core/Common");(function(){a.create=function(b){var a=e.create();return d.extend(a,{label:"World",gravity:{x:0,y:1,scale:.001},bounds:{min:{x:-Infinity,y:-Infinity},max:{x:Infinity,y:Infinity}}},b)}})()},{"../constraint/Constraint":12,"../core/Common":14,"./Composite":2}],4:[function(n,q,w){var a={};q.exports=a;(function(){a.create=function(e){return{id:a.id(e),vertex:e,normalImpulse:0,tangentImpulse:0}};a.id=function(a){return a.body.id+"_"+a.index}})()},{}],5:[function(n,q,w){var a={};q.exports=a;var e=n("./SAT"),d=n("./Pair"),b=n("../geometry/Bounds");(function(){a.collisions=function(h,l){for(var g=[],c=l.pairs.table,m=0;m<h.length;m++){var k=h[m][0],f=h[m][1];if((!k.isStatic&&!k.isSleeping||!f.isStatic&&!f.isSleeping)&&a.canCollide(k.collisionFilter,f.collisionFilter)&&b.overlaps(k.bounds,f.bounds))for(var r=1<k.parts.length?1:0;r<k.parts.length;r++)for(var u=k.parts[r],p=1<f.parts.length?1:0;p<f.parts.length;p++){var t=f.parts[p];if(u===k&&t===f||b.overlaps(u.bounds,t.bounds)){var z=d.id(u,t),z=c[z],t=e.collides(u,t,z&&z.isActive?z.collision:null);t.collided&&g.push(t)}}}return g};a.canCollide=function(b,a){return b.group===a.group&&0!==b.group?0<b.group:0!==(b.mask&a.category)&&0!==(a.mask&b.category)}})()},{"../geometry/Bounds":26,"./Pair":7,"./SAT":11}],6:[function(n,q,w){var a={};q.exports=a;var e=n("./Pair"),d=n("./Detector"),b=n("../core/Common");(function(){a.create=function(h){return b.extend({controller:a,detector:d.collisions,buckets:{},pairs:{},pairsList:[],bucketWidth:48,bucketHeight:48},h)};a.update=function(b,d,g,c){var m,k,f=g.world,h=b.buckets,u,p;m=!1;for(g=0;g<d.length;g++){var e=d[g];if(!(e.isSleeping&&!c||e.bounds.max.x<f.bounds.min.x||e.bounds.min.x>f.bounds.max.x||e.bounds.max.y<f.bounds.min.y||e.bounds.min.y>f.bounds.max.y)){var l=a._getRegion(b,e);if(!e.region||l.id!==e.region.id||c){if(!e.region||c)e.region=l;var B=a._regionUnion(l,e.region);for(m=B.startCol;m<=B.endCol;m++)for(k=B.startRow;k<=B.endRow;k++){p=a._getBucketId(m,k);u=h[p];var x=m>=l.startCol&&m<=l.endCol&&k>=l.startRow&&k<=l.endRow,v=m>=e.region.startCol&&m<=e.region.endCol&&k>=e.region.startRow&&k<=e.region.endRow;!x&&v&&v&&u&&a._bucketRemoveBody(b,u,e);if(e.region===l||x&&!v||c)u||(u=a._createBucket(h,p)),a._bucketAddBody(b,u,e)}e.region=l;m=!0}}}m&&(b.pairsList=a._createActivePairsList(b))};a.clear=function(b){b.buckets={};b.pairs={};b.pairsList=[]};a._regionUnion=function(b,d){return a._createRegion(Math.min(b.startCol,d.startCol),Math.max(b.endCol,d.endCol),Math.min(b.startRow,d.startRow),Math.max(b.endRow,d.endRow))};a._getRegion=function(b,d){var g=d.bounds;return a._createRegion(Math.floor(g.min.x/b.bucketWidth),Math.floor(g.max.x/b.bucketWidth),Math.floor(g.min.y/b.bucketHeight),Math.floor(g.max.y/b.bucketHeight))};a._createRegion=function(b,a,d,c){return{id:b+","+a+","+d+","+c,startCol:b,endCol:a,startRow:d,endRow:c}};a._getBucketId=function(b,a){return"C"+b+"R"+a};a._createBucket=function(b,a){return b[a]=[]};a._bucketAddBody=function(b,a,d){for(var c=0;c<a.length;c++){var m=a[c];if(!(d.id===m.id||d.isStatic&&m.isStatic)){var k=e.id(d,m),f=b.pairs[k];f?f[2]+=1:b.pairs[k]=[d,m,1]}}a.push(d)};a._bucketRemoveBody=function(a,d,g){d.splice(b.indexOf(d,g),1);for(var c=0;c<d.length;c++){var m=e.id(g,d[c]);(m=a.pairs[m])&&--m[2]}};a._createActivePairsList=function(a){var d,g,c=[];d=b.keys(a.pairs);for(var m=0;m<d.length;m++)g=a.pairs[d[m]],0<g[2]?c.push(g):delete a.pairs[d[m]];return c}})()},{"../core/Common":14,"./Detector":5,"./Pair":7}],7:[function(n,q,w){var a={};q.exports=a;var e=n("./Contact");(function(){a.create=function(d,b){var e=d.bodyA,l=d.bodyB,g=d.parentA,c=d.parentB,e={id:a.id(e,l),bodyA:e,bodyB:l,contacts:{},activeContacts:[],separation:0,isActive:!0,isSensor:e.isSensor||l.isSensor,timeCreated:b,timeUpdated:b,inverseMass:g.inverseMass+c.inverseMass,friction:Math.min(g.friction,c.friction),frictionStatic:Math.max(g.frictionStatic,c.frictionStatic),restitution:Math.max(g.restitution,c.restitution),slop:Math.max(g.slop,c.slop)};a.update(e,d,b);return e};a.update=function(d,b,h){var l=d.contacts,g=b.supports,c=d.activeContacts,m=b.parentA,k=b.parentB;d.collision=b;d.inverseMass=m.inverseMass+k.inverseMass;d.friction=Math.min(m.friction,k.friction);d.frictionStatic=Math.max(m.frictionStatic,k.frictionStatic);d.restitution=Math.max(m.restitution,k.restitution);d.slop=Math.max(m.slop,k.slop);c.length=0;if(b.collided){for(m=0;m<g.length;m++){var k=g[m],f=e.id(k),r=l[f];r?c.push(r):c.push(l[f]=e.create(k))}d.separation=b.depth;a.setActive(d,!0,h)}else!0===d.isActive&&a.setActive(d,!1,h)};a.setActive=function(a,b,e){b?(a.isActive=!0,a.timeUpdated=e):(a.isActive=!1,a.activeContacts.length=0)};a.id=function(a,b){return a.id<b.id?"A"+a.id+"B"+b.id:"A"+b.id+"B"+a.id}})()},{"./Contact":4}],8:[function(n,q,w){var a={};q.exports=a;var e=n("./Pair"),d=n("../core/Common");(function(){a._pairMaxIdleLife=1E3;a.create=function(b){return d.extend({table:{},list:[],collisionStart:[],collisionActive:[],collisionEnd:[]},b)};a.update=function(b,a,l){var g=b.list,c=b.table,m=b.collisionStart,k=b.collisionEnd;b=b.collisionActive;var f=[],r,u,p,h;m.length=0;k.length=0;for(h=b.length=0;h<a.length;h++)r=a[h],r.collided&&(u=e.id(r.bodyA,r.bodyB),f.push(u),(p=c[u])?(p.isActive?b.push(p):m.push(p),e.update(p,r,l)):(p=e.create(r,l),c[u]=p,m.push(p),g.push(p)));for(h=0;h<g.length;h++)p=g[h],p.isActive&&-1===d.indexOf(f,p.id)&&(e.setActive(p,!1,l),k.push(p))};a.removeOld=function(b,d){var e=b.list,g=b.table,c=[],m,k,f;for(f=0;f<e.length;f++)m=e[f],k=m.collision,k.bodyA.isSleeping||k.bodyB.isSleeping?m.timeUpdated=d:d-m.timeUpdated>a._pairMaxIdleLife&&c.push(f);for(f=0;f<c.length;f++)k=c[f]-f,m=e[k],delete g[m.id],e.splice(k,1)};a.clear=function(b){b.table={};b.list.length=0;b.collisionStart.length=0;b.collisionActive.length=0;b.collisionEnd.length=0;return b}})()},{"../core/Common":14,"./Pair":7}],9:[function(n,q,w){var a={};q.exports=a;var e=n("../geometry/Vector"),d=n("./SAT"),b=n("../geometry/Bounds"),h=n("../factory/Bodies"),l=n("../geometry/Vertices");(function(){a.collides=function(a,c){for(var m=[],k=0;k<c.length;k++){var f=c[k];if(b.overlaps(f.bounds,a.bounds))for(var e=1===f.parts.length?0:1;e<f.parts.length;e++){var g=f.parts[e];if(b.overlaps(g.bounds,a.bounds)&&(g=d.collides(g,a),g.collided)){m.push(g);break}}}return m};a.ray=function(b,c,d,k){k=k||1E-100;var f=e.angle(c,d),m=e.magnitude(e.sub(c,d));c=h.rectangle(.5*(d.x+c.x),.5*(d.y+c.y),m,k,{angle:f});b=a.collides(c,b);for(c=0;c<b.length;c+=1)d=b[c],d.body=d.bodyB=d.bodyA;return b};a.region=function(a,c,d){for(var k=[],f=0;f<a.length;f++){var e=a[f],m=b.overlaps(e.bounds,c);(m&&!d||!m&&d)&&k.push(e)}return k};a.point=function(a,c){for(var d=[],k=0;k<a.length;k++){var f=a[k];if(b.contains(f.bounds,c))for(var e=1===f.parts.length?0:1;e<f.parts.length;e++){var g=f.parts[e];if(b.contains(g.bounds,c)&&l.contains(g.vertices,c)){d.push(f);break}}}return d}})()},{"../factory/Bodies":23,"../geometry/Bounds":26,"../geometry/Vector":28,"../geometry/Vertices":29,"./SAT":11}],10:[function(n,q,w){var a={};q.exports=a;var e=n("../geometry/Vertices"),d=n("../geometry/Vector"),b=n("../core/Common"),h=n("../geometry/Bounds");(function(){a._restingThresh=4;a._restingThreshTangent=6;a._positionDampen=.9;a._positionWarming=.8;a._frictionNormalMultiplier=5;a.preSolvePosition=function(b){var a,c,d;for(a=0;a<b.length;a++)c=b[a],c.isActive&&(d=c.activeContacts.length,c.collision.parentA.totalContacts+=d,c.collision.parentB.totalContacts+=d)};a.solvePosition=function(b,e){var c,m,k,f,r,g,p;p=d._temp[0];var h=d._temp[1],l=d._temp[2],B=d._temp[3];for(c=0;c<b.length;c++)m=b[c],m.isActive&&!m.isSensor&&(k=m.collision,f=k.parentA,r=k.parentB,g=k.normal,f=d.sub(d.add(r.positionImpulse,r.position,p),d.add(f.positionImpulse,d.sub(r.position,k.penetration,h),l),B),m.separation=d.dot(g,f));for(c=0;c<b.length;c++)if(m=b[c],m.isActive&&!m.isSensor){k=m.collision;f=k.parentA;r=k.parentB;g=k.normal;p=(m.separation-m.slop)*e;if(f.isStatic||r.isStatic)p*=2;f.isStatic||f.isSleeping||(m=a._positionDampen/f.totalContacts,f.positionImpulse.x+=g.x*p*m,f.positionImpulse.y+=g.y*p*m);r.isStatic||r.isSleeping||(m=a._positionDampen/r.totalContacts,r.positionImpulse.x-=g.x*p*m,r.positionImpulse.y-=g.y*p*m)}};a.postSolvePosition=function(b){for(var g=0;g<b.length;g++){var c=b[g];c.totalContacts=0;if(0!==c.positionImpulse.x||0!==c.positionImpulse.y){for(var m=0;m<c.parts.length;m++){var k=c.parts[m];e.translate(k.vertices,c.positionImpulse);h.update(k.bounds,k.vertices,c.velocity);k.position.x+=c.positionImpulse.x;k.position.y+=c.positionImpulse.y}c.positionPrev.x+=c.positionImpulse.x;c.positionPrev.y+=c.positionImpulse.y;0>d.dot(c.positionImpulse,c.velocity)?(c.positionImpulse.x=0,c.positionImpulse.y=0):(c.positionImpulse.x*=a._positionWarming,c.positionImpulse.y*=a._positionWarming)}}};a.preSolveVelocity=function(b){var a,c,e,k,f,r,h,p,t,l,B=d._temp[0],x=d._temp[1];for(a=0;a<b.length;a++)if(e=b[a],e.isActive&&!e.isSensor)for(k=e.activeContacts,c=e.collision,e=c.parentA,f=c.parentB,r=c.normal,h=c.tangent,c=0;c<k.length;c++)if(p=k[c],t=p.vertex,l=p.normalImpulse,p=p.tangentImpulse,0!==l||0!==p)B.x=r.x*l+h.x*p,B.y=r.y*l+h.y*p,e.isStatic||e.isSleeping||(l=d.sub(t,e.position,x),e.positionPrev.x+=B.x*e.inverseMass,e.positionPrev.y+=B.y*e.inverseMass,e.anglePrev+=d.cross(l,B)*e.inverseInertia),f.isStatic||f.isSleeping||(l=d.sub(t,f.position,x),f.positionPrev.x-=B.x*f.inverseMass,f.positionPrev.y-=B.y*f.inverseMass,f.anglePrev-=d.cross(l,B)*f.inverseInertia)};a.solveVelocity=function(e,g){for(var c=g*g,h=d._temp[0],k=d._temp[1],f=d._temp[2],r=d._temp[3],u=d._temp[4],p=d._temp[5],t=0;t<e.length;t++){var l=e[t];if(l.isActive&&!l.isSensor){var B=l.collision,x=B.parentA,v=B.parentB,n=B.normal,B=B.tangent,q=l.activeContacts,J=1/q.length;x.velocity.x=x.position.x-x.positionPrev.x;x.velocity.y=x.position.y-x.positionPrev.y;v.velocity.x=v.position.x-v.positionPrev.x;v.velocity.y=v.position.y-v.positionPrev.y;x.angularVelocity=x.angle-x.anglePrev;v.angularVelocity=v.angle-v.anglePrev;for(var w=0;w<q.length;w++){var D=q[w],E=D.vertex,O=d.sub(E,x.position,k),E=d.sub(E,v.position,f),F=d.add(x.velocity,d.mult(d.perp(O),x.angularVelocity),r),H=d.add(v.velocity,d.mult(d.perp(E),v.angularVelocity),u),F=d.sub(F,H,p),G=d.dot(n,F),K=d.dot(B,F),I=Math.abs(K),M=b.sign(K),F=(1+l.restitution)*G,P=b.clamp(l.separation+G,0,1)*a._frictionNormalMultiplier,H=K,L=Infinity;I>l.friction*l.frictionStatic*P*c&&(L=I,H=b.clamp(l.friction*M*c,-L,L));I=d.cross(O,n);M=d.cross(E,n);I=J/(x.inverseMass+v.inverseMass+x.inverseInertia*I*I+v.inverseInertia*M*M);F*=I;H*=I;0>G&&G*G>a._restingThresh*c?D.normalImpulse=0:(G=D.normalImpulse,D.normalImpulse=Math.min(D.normalImpulse+F,0),F=D.normalImpulse-G);K*K>a._restingThreshTangent*c?D.tangentImpulse=0:(G=D.tangentImpulse,D.tangentImpulse=b.clamp(D.tangentImpulse+H,-L,L),H=D.tangentImpulse-G);h.x=n.x*F+B.x*H;h.y=n.y*F+B.y*H;x.isStatic||x.isSleeping||(x.positionPrev.x+=h.x*x.inverseMass,x.positionPrev.y+=h.y*x.inverseMass,x.anglePrev+=d.cross(O,h)*x.inverseInertia);v.isStatic||v.isSleeping||(v.positionPrev.x-=h.x*v.inverseMass,v.positionPrev.y-=h.y*v.inverseMass,v.anglePrev-=d.cross(E,h)*v.inverseInertia)}}}}})()},{"../core/Common":14,"../geometry/Bounds":26,"../geometry/Vector":28,"../geometry/Vertices":29}],11:[function(n,q,w){var a={};q.exports=a;var e=n("../geometry/Vertices"),d=n("../geometry/Vector");(function(){a.collides=function(b,h,l){var g,c;g=!1;l?(c=b.parent,g=h.parent,c=c.speed*c.speed+c.angularSpeed*c.angularSpeed+g.speed*g.speed+g.angularSpeed*g.angularSpeed,g=l&&l.collided&&.2>c,c=l):c={collided:!1,bodyA:b,bodyB:h};if(l&&g){if(g=c.axisBody,l=a._overlapAxes(g.vertices,(g===b?h:b).vertices,[g.axes[l.axisNumber]]),c.reused=!0,0>=l.overlap)return c.collided=!1,c}else{l=a._overlapAxes(b.vertices,h.vertices,b.axes);if(0>=l.overlap)return c.collided=!1,c;g=a._overlapAxes(h.vertices,b.vertices,h.axes);if(0>=g.overlap)return c.collided=!1,c;l.overlap<g.overlap?c.axisBody=b:(l=g,c.axisBody=h);c.axisNumber=l.axisNumber}c.bodyA=b.id<h.id?b:h;c.bodyB=b.id<h.id?h:b;c.collided=!0;c.depth=l.overlap;c.parentA=c.bodyA.parent;c.parentB=c.bodyB.parent;b=c.bodyA;h=c.bodyB;0>d.dot(l.axis,d.sub(h.position,b.position))?c.normal={x:l.axis.x,y:l.axis.y}:c.normal={x:-l.axis.x,y:-l.axis.y};c.tangent=d.perp(c.normal);c.penetration=c.penetration||{};c.penetration.x=c.normal.x*c.depth;c.penetration.y=c.normal.y*c.depth;l=a._findSupports(b,h,c.normal);g=[];e.contains(b.vertices,l[0])&&g.push(l[0]);e.contains(b.vertices,l[1])&&g.push(l[1]);2>g.length&&(b=a._findSupports(h,b,d.neg(c.normal)),e.contains(h.vertices,b[0])&&g.push(b[0]),2>g.length&&e.contains(h.vertices,b[1])&&g.push(b[1]));1>g.length&&(g=[l[0]]);c.supports=g;return c};a._overlapAxes=function(b,e,l){for(var g=d._temp[0],c=d._temp[1],h={overlap:Number.MAX_VALUE},k,f,r=0;r<l.length;r++){f=l[r];a._projectToAxis(g,b,f);a._projectToAxis(c,e,f);k=Math.min(g.max-c.min,c.max-g.min);if(0>=k){h.overlap=k;break}k<h.overlap&&(h.overlap=k,h.axis=f,h.axisNumber=r)}return h};a._projectToAxis=function(b,a,e){for(var h=d.dot(a[0],e),c=h,m=1;m<a.length;m+=1){var k=d.dot(a[m],e);k>c?c=k:k<h&&(h=k)}b.min=h;b.max=c};a._findSupports=function(b,a,e){var h=Number.MAX_VALUE,c=d._temp[0];a=a.vertices;b=b.position;var m,k,f,r;for(r=0;r<a.length;r++)k=a[r],c.x=k.x-b.x,c.y=k.y-b.y,m=-d.dot(e,c),m<h&&(h=m,f=k);k=a[0<=f.index-1?f.index-1:a.length-1];c.x=k.x-b.x;c.y=k.y-b.y;h=-d.dot(e,c);r=k;k=a[(f.index+1)%a.length];c.x=k.x-b.x;c.y=k.y-b.y;m=-d.dot(e,c);m<h&&(r=k);return[f,r]}})()},{"../geometry/Vector":28,"../geometry/Vertices":29}],12:[function(n,q,w){var a={};q.exports=a;var e=n("../geometry/Vertices"),d=n("../geometry/Vector"),b=n("../core/Sleeping"),h=n("../geometry/Bounds"),l=n("../geometry/Axes"),g=n("../core/Common");(function(){a._warming=.4;a._torqueDampen=1;a._minLength=1E-6;a.create=function(c){c.bodyA&&!c.pointA&&(c.pointA={x:0,y:0});c.bodyB&&!c.pointB&&(c.pointB={x:0,y:0});var b=c.bodyA?d.add(c.bodyA.position,c.pointA):c.pointA,a=c.bodyB?d.add(c.bodyB.position,c.pointB):c.pointB,b=d.magnitude(d.sub(b,a));c.length="undefined"!==typeof c.length?c.length:b;c.id=c.id||g.nextId();c.label=c.label||"Constraint";c.type="constraint";c.stiffness=c.stiffness||(0<c.length?1:.7);c.damping=c.damping||0;c.angularStiffness=c.angularStiffness||0;c.angleA=c.bodyA?c.bodyA.angle:c.angleA;c.angleB=c.bodyB?c.bodyB.angle:c.angleB;c.plugin={};b={visible:!0,lineWidth:2,strokeStyle:"#ffffff",type:"line",anchors:!0};0===c.length&&.1<c.stiffness?(b.type="pin",b.anchors=!1):.9>c.stiffness&&(b.type="spring");c.render=g.extend(b,c.render);return c};a.preSolveAll=function(c){for(var b=0;b<c.length;b+=1){var a=c[b],d=a.constraintImpulse;a.isStatic||0===d.x&&0===d.y&&0===d.angle||(a.position.x+=d.x,a.position.y+=d.y,a.angle+=d.angle)}};a.solveAll=function(c,b){for(var d=0;d<c.length;d+=1){var f=c[d],e=!f.bodyA||f.bodyA&&f.bodyA.isStatic,f=!f.bodyB||f.bodyB&&f.bodyB.isStatic;(e||f)&&a.solve(c[d],b)}for(d=0;d<c.length;d+=1)f=c[d],e=!f.bodyA||f.bodyA&&f.bodyA.isStatic,f=!f.bodyB||f.bodyB&&f.bodyB.isStatic,e||f||a.solve(c[d],b)};a.solve=function(c,b){var e=c.bodyA,f=c.bodyB,h=c.pointA,g=c.pointB;if(e||f){e&&!e.isStatic&&(d.rotate(h,e.angle-c.angleA,h),c.angleA=e.angle);f&&!f.isStatic&&(d.rotate(g,f.angle-c.angleB,g),c.angleB=f.angle);var p=h,m=g;e&&(p=d.add(e.position,h));f&&(m=d.add(f.position,g));if(p&&m){var l=d.sub(p,m),B=d.magnitude(l);B<a._minLength&&(B=a._minLength);var p=d.mult(l,(B-c.length)/B*(1>c.stiffness?c.stiffness*b:c.stiffness)),m=(e?e.inverseMass:0)+(f?f.inverseMass:0),x=m+((e?e.inverseInertia:0)+(f?f.inverseInertia:0)),n,q;c.damping&&(q=d.create(),n=d.div(l,B),q=d.sub(f&&d.sub(f.position,f.positionPrev)||q,e&&d.sub(e.position,e.positionPrev)||q),q=d.dot(n,q));e&&!e.isStatic&&(l=e.inverseMass/m,e.constraintImpulse.x-=p.x*l,e.constraintImpulse.y-=p.y*l,e.position.x-=p.x*l,e.position.y-=p.y*l,c.damping&&(e.positionPrev.x-=c.damping*n.x*q*l,e.positionPrev.y-=c.damping*n.y*q*l),h=d.cross(h,p)/x*a._torqueDampen*e.inverseInertia*(1-c.angularStiffness),e.constraintImpulse.angle-=h,e.angle-=h);f&&!f.isStatic&&(l=f.inverseMass/m,f.constraintImpulse.x+=p.x*l,f.constraintImpulse.y+=p.y*l,f.position.x+=p.x*l,f.position.y+=p.y*l,c.damping&&(f.positionPrev.x+=c.damping*n.x*q*l,f.positionPrev.y+=c.damping*n.y*q*l),h=d.cross(g,p)/x*a._torqueDampen*f.inverseInertia*(1-c.angularStiffness),f.constraintImpulse.angle+=h,f.angle+=h)}}};a.postSolveAll=function(c){for(var g=0;g<c.length;g++){var k=c[g],f=k.constraintImpulse;if(!(k.isStatic||0===f.x&&0===f.y&&0===f.angle)){b.set(k,!1);for(var r=0;r<k.parts.length;r++){var u=k.parts[r];e.translate(u.vertices,f);0<r&&(u.position.x+=f.x,u.position.y+=f.y);0!==f.angle&&(e.rotate(u.vertices,f.angle,k.position),l.rotate(u.axes,f.angle),0<r&&d.rotateAbout(u.position,f.angle,k.position,u.position));h.update(u.bounds,u.vertices,k.velocity)}f.angle*=a._warming;f.x*=a._warming;f.y*=a._warming}}}})()},{"../core/Common":14,"../core/Sleeping":22,"../geometry/Axes":25,"../geometry/Bounds":26,"../geometry/Vector":28,"../geometry/Vertices":29}],13:[function(n,q,w){var a={};q.exports=a;var e=n("../geometry/Vertices"),d=n("../core/Sleeping"),b=n("../core/Mouse"),h=n("../core/Events"),l=n("../collision/Detector"),g=n("./Constraint"),c=n("../body/Composite"),m=n("../core/Common"),k=n("../geometry/Bounds");(function(){a.create=function(d,e){var f=(d?d.mouse:null)||(e?e.mouse:null);f||(d&&d.render&&d.render.canvas?f=b.create(d.render.canvas):e&&e.element?f=b.create(e.element):(f=b.create(),m.warn("MouseConstraint.create: options.mouse was undefined, options.element was undefined, may not function as expected")));var p=g.create({label:"Mouse Constraint",pointA:f.position,pointB:{x:0,y:0},length:.01,stiffness:.1,angularStiffness:1,render:{strokeStyle:"#90EE90",lineWidth:3}}),r=m.extend({type:"mouseConstraint",mouse:f,element:null,body:null,constraint:p,collisionFilter:{category:1,mask:4294967295,group:0}},e);h.on(d,"beforeUpdate",function(){var b=c.allBodies(d.world);a.update(r,b);a._triggerEvents(r)});return r};a.update=function(c,b){var a=c.mouse,f=c.constraint,g=c.body;if(0===a.button)if(f.bodyB)d.set(f.bodyB,!1),f.pointA=a.position;else for(var r=0;r<b.length;r++){if(g=b[r],k.contains(g.bounds,a.position)&&l.canCollide(g.collisionFilter,c.collisionFilter))for(var m=1<g.parts.length?1:0;m<g.parts.length;m++)if(e.contains(g.parts[m].vertices,a.position)){f.pointA=a.position;f.bodyB=c.body=g;f.pointB={x:a.position.x-g.position.x,y:a.position.y-g.position.y};f.angleB=g.angle;d.set(g,!1);h.trigger(c,"startdrag",{mouse:a,body:g});break}}else f.bodyB=c.body=null,f.pointB=null,g&&h.trigger(c,"enddrag",{mouse:a,body:g})};a._triggerEvents=function(c){var a=c.mouse,d=a.sourceEvents;d.mousemove&&h.trigger(c,"mousemove",{mouse:a});d.mousedown&&h.trigger(c,"mousedown",{mouse:a});d.mouseup&&h.trigger(c,"mouseup",{mouse:a});b.clearSourceEvents(a)}})()},{"../body/Composite":2,"../collision/Detector":5,"../core/Common":14,"../core/Events":16,"../core/Mouse":19,"../core/Sleeping":22,"../geometry/Bounds":26,"../geometry/Vertices":29,"./Constraint":12}],14:[function(n,q,w){var a={};q.exports=a;(function(){a._nextId=0;a._seed=0;a._nowStartTime=+new Date;a.extend=function(e,d){var b,h;"boolean"===typeof d?(b=2,h=d):(b=1,h=!0);for(;b<arguments.length;b++){var l=arguments[b];if(l)for(var g in l)h&&l[g]&&l[g].constructor===Object?e[g]&&e[g].constructor!==Object?e[g]=l[g]:(e[g]=e[g]||{},a.extend(e[g],h,l[g])):e[g]=l[g]}return e};a.clone=function(e,d){return a.extend({},d,e)};a.keys=function(a){if(Object.keys)return Object.keys(a);var d=[],b;for(b in a)d.push(b);return d};a.values=function(a){var d=[];if(Object.keys){for(var b=Object.keys(a),e=0;e<b.length;e++)d.push(a[b[e]]);return d}for(b in a)d.push(a[b]);return d};a.get=function(a,d,b,h){d=d.split(".").slice(b,h);for(b=0;b<d.length;b+=1)a=a[d[b]];return a};a.set=function(e,d,b,h,l){h=d.split(".").slice(h,l);return a.get(e,d,0,-1)[h[h.length-1]]=b};a.shuffle=function(e){for(var d=e.length-1;0<d;d--){var b=Math.floor(a.random()*(d+1)),h=e[d];e[d]=e[b];e[b]=h}return e};a.choose=function(e){return e[Math.floor(a.random()*e.length)]};a.isElement=function(a){return"undefined"!==typeof HTMLElement?a instanceof HTMLElement:!!(a&&a.nodeType&&a.nodeName)};a.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)};a.isFunction=function(a){return"function"===typeof a};a.isPlainObject=function(a){return"object"===typeof a&&a.constructor===Object};a.isString=function(a){return"[object String]"===toString.call(a)};a.clamp=function(a,d,b){return a<d?d:a>b?b:a};a.sign=function(a){return 0>a?-1:1};a.now=function(){if(window.performance){if(window.performance.now)return window.performance.now();if(window.performance.webkitNow)return window.performance.webkitNow()}return new Date-a._nowStartTime};a.random=function(e,d){e="undefined"!==typeof e?e:0;a._seed=(9301*a._seed+49297)%233280;return e+a._seed/233280*(("undefined"!==typeof d?d:1)-e)};a.colorToNumber=function(a){a=a.replace("#","");3==a.length&&(a=a.charAt(0)+a.charAt(0)+a.charAt(1)+a.charAt(1)+a.charAt(2)+a.charAt(2));return parseInt(a,16)};a.logLevel=1;a.log=function(){console&&0<a.logLevel&&3>=a.logLevel&&console.log.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))};a.info=function(){console&&0<a.logLevel&&2>=a.logLevel&&console.info.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))};a.warn=function(){console&&0<a.logLevel&&3>=a.logLevel&&console.warn.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))};a.nextId=function(){return a._nextId++};a.indexOf=function(a,d){if(a.indexOf)return a.indexOf(d);for(var b=0;b<a.length;b++)if(a[b]===d)return b;return-1};a.map=function(a,d){if(a.map)return a.map(d);for(var b=[],e=0;e<a.length;e+=1)b.push(d(a[e]));return b};a.topologicalSort=function(e){var d=[],b=[],h=[],l;for(l in e)b[l]||h[l]||a._topologicalSort(l,b,h,e,d);return d};a._topologicalSort=function(e,d,b,h,l){var g=h[e]||[];b[e]=!0;for(var c=0;c<g.length;c+=1){var m=g[c];b[m]||d[m]||a._topologicalSort(m,d,b,h,l)}b[e]=!1;d[e]=!0;l.push(e)};a.chain=function(){for(var a=[],d=0;d<arguments.length;d+=1){var b=arguments[d];b._chained?a.push.apply(a,b._chained):a.push(b)}d=function(){for(var b,d=Array(arguments.length),e=0,c=arguments.length;e<c;e++)d[e]=arguments[e];for(e=0;e<a.length;e+=1)c=a[e].apply(b,d),"undefined"!==typeof c&&(b=c);return b};d._chained=a;return d};a.chainPathBefore=function(e,d,b){return a.set(e,d,a.chain(b,a.get(e,d)))};a.chainPathAfter=function(e,d,b){return a.set(e,d,a.chain(a.get(e,d),b))}})()},{}],15:[function(n,q,w){var a={};q.exports=a;var e=n("../body/World"),d=n("./Sleeping"),b=n("../collision/Resolver"),h=n("../render/Render"),l=n("../collision/Pairs");n("./Metrics");var g=n("../collision/Grid"),c=n("./Events"),m=n("../body/Composite"),k=n("../constraint/Constraint"),f=n("./Common"),r=n("../body/Body");(function(){a.create=function(c,b){b=f.isElement(c)?b:c;c=f.isElement(c)?c:null;b=b||{};(c||b.render)&&f.warn("Engine.create: engine.render is deprecated (see docs)");var a=f.extend({positionIterations:6,velocityIterations:4,constraintIterations:2,enableSleeping:!1,events:[],plugin:{},timing:{timestamp:0,timeScale:1},broadphase:{controller:g}},b);if(c||a.render)a.render=f.extend({element:c,controller:h},a.render);a.render&&a.render.controller&&(a.render=a.render.controller.create(a.render));a.render&&(a.render.engine=a);a.world=b.world||e.create(a.world);a.pairs=l.create();a.broadphase=a.broadphase.controller.create(a.broadphase);a.metrics=a.metrics||{extended:!1};return a};a.update=function(f,e,g){e=e||1E3/60;g=g||1;var p=f.world,h=f.timing,r=f.broadphase;h.timestamp+=e*h.timeScale;var u={timestamp:h.timestamp};c.trigger(f,"beforeUpdate",u);var t=m.allBodies(p),n=m.allConstraints(p);f.enableSleeping&&d.update(t,h.timeScale);a._bodiesApplyGravity(t,p.gravity);a._bodiesUpdate(t,e,h.timeScale,g,p.bounds);k.preSolveAll(t);for(e=0;e<f.constraintIterations;e++)k.solveAll(n,h.timeScale);k.postSolveAll(t);r.controller?(p.isModified&&r.controller.clear(r),r.controller.update(r,t,f,p.isModified),e=r.pairsList):e=t;p.isModified&&m.setModified(p,!1,!1,!0);r=r.detector(e,f);p=f.pairs;e=h.timestamp;l.update(p,r,e);l.removeOld(p,e);f.enableSleeping&&d.afterCollisions(p.list,h.timeScale);0<p.collisionStart.length&&c.trigger(f,"collisionStart",{pairs:p.collisionStart});b.preSolvePosition(p.list);for(e=0;e<f.positionIterations;e++)b.solvePosition(p.list,h.timeScale);b.postSolvePosition(t);k.preSolveAll(t);for(e=0;e<f.constraintIterations;e++)k.solveAll(n,h.timeScale);k.postSolveAll(t);b.preSolveVelocity(p.list);for(e=0;e<f.velocityIterations;e++)b.solveVelocity(p.list,h.timeScale);0<p.collisionActive.length&&c.trigger(f,"collisionActive",{pairs:p.collisionActive});0<p.collisionEnd.length&&c.trigger(f,"collisionEnd",{pairs:p.collisionEnd});a._bodiesClearForces(t);c.trigger(f,"afterUpdate",u);return f};a.merge=function(c,b){f.extend(c,b);if(b.world){c.world=b.world;a.clear(c);for(var e=m.allBodies(c.world),p=0;p<e.length;p++){var h=e[p];d.set(h,!1);h.id=f.nextId()}}};a.clear=function(c){var b=c.world;l.clear(c.pairs);var a=c.broadphase;a.controller&&(b=m.allBodies(b),a.controller.clear(a),a.controller.update(a,b,c,!0))};a._bodiesClearForces=function(c){for(var b=0;b<c.length;b++){var a=c[b];a.force.x=0;a.force.y=0;a.torque=0}};a._bodiesApplyGravity=function(c,b){var a="undefined"!==typeof b.scale?b.scale:.001;if((0!==b.x||0!==b.y)&&0!==a)for(var d=0;d<c.length;d++){var f=c[d];f.isStatic||f.isSleeping||(f.force.y+=f.mass*b.y*a,f.force.x+=f.mass*b.x*a)}};a._bodiesUpdate=function(c,b,a,d,f){for(f=0;f<c.length;f++){var e=c[f];e.isStatic||e.isSleeping||r.update(e,b,a,d)}}})()},{"../body/Body":1,"../body/Composite":2,"../body/World":3,"../collision/Grid":6,"../collision/Pairs":8,"../collision/Resolver":10,"../constraint/Constraint":12,"../render/Render":31,"./Common":14,"./Events":16,"./Metrics":18,"./Sleeping":22}],16:[function(n,q,w){var a={};q.exports=a;var e=n("./Common");(function(){a.on=function(a,b,e){b=b.split(" ");for(var d,h=0;h<b.length;h++)d=b[h],a.events=a.events||{},a.events[d]=a.events[d]||[],a.events[d].push(e);return e};a.off=function(a,b,h){if(b){"function"===typeof b&&(h=b,b=e.keys(a.events).join(" "));b=b.split(" ");for(var d=0;d<b.length;d++){var g=a.events[b[d]],c=[];if(h&&g)for(var m=0;m<g.length;m++)g[m]!==h&&c.push(g[m]);a.events[b[d]]=c}}else a.events={}};a.trigger=function(a,b,h){var d,g,c;if(a.events){h||(h={});b=b.split(" ");for(var m=0;m<b.length;m++)if(d=b[m],g=a.events[d])for(c=e.clone(h,!1),c.name=d,c.source=a,d=0;d<g.length;d++)g[d].apply(a,[c])}}})()},{"./Common":14}],17:[function(n,q,w){var a={};q.exports=a;var e=n("./Plugin"),d=n("./Common");(function(){a.name="matter-js";a.version="0.14.1";a.uses=[];a.used=[];a.use=function(){e.use(a,Array.prototype.slice.call(arguments))};a.before=function(b,e){b=b.replace(/^Matter./,"");return d.chainPathBefore(a,b,e)};a.after=function(b,e){b=b.replace(/^Matter./,"");return d.chainPathAfter(a,b,e)}})()},{"./Common":14,"./Plugin":20}],18:[function(n,q,w){},{"../body/Composite":2,"./Common":14}],19:[function(n,q,w){var a={};q.exports=a;var e=n("../core/Common");(function(){a.create=function(d){var b={};d||e.log("Mouse.create: element was undefined, defaulting to document.body","warn");b.element=d||document.body;b.absolute={x:0,y:0};b.position={x:0,y:0};b.mousedownPosition={x:0,y:0};b.mouseupPosition={x:0,y:0};b.offset={x:0,y:0};b.scale={x:1,y:1};b.wheelDelta=0;b.button=-1;b.pixelRatio=b.element.getAttribute("data-pixel-ratio")||1;b.sourceEvents={mousemove:null,mousedown:null,mouseup:null,mousewheel:null};b.mousemove=function(d){var e=a._getRelativeMousePosition(d,b.element,b.pixelRatio);d.changedTouches&&(b.button=0,d.preventDefault());b.absolute.x=e.x;b.absolute.y=e.y;b.position.x=b.absolute.x*b.scale.x+b.offset.x;b.position.y=b.absolute.y*b.scale.y+b.offset.y;b.sourceEvents.mousemove=d};b.mousedown=function(d){var e=a._getRelativeMousePosition(d,b.element,b.pixelRatio);d.changedTouches?(b.button=0,d.preventDefault()):b.button=d.button;b.absolute.x=e.x;b.absolute.y=e.y;b.position.x=b.absolute.x*b.scale.x+b.offset.x;b.position.y=b.absolute.y*b.scale.y+b.offset.y;b.mousedownPosition.x=b.position.x;b.mousedownPosition.y=b.position.y;b.sourceEvents.mousedown=d};b.mouseup=function(d){var e=a._getRelativeMousePosition(d,b.element,b.pixelRatio);d.changedTouches&&d.preventDefault();b.button=-1;b.absolute.x=e.x;b.absolute.y=e.y;b.position.x=b.absolute.x*b.scale.x+b.offset.x;b.position.y=b.absolute.y*b.scale.y+b.offset.y;b.mouseupPosition.x=b.position.x;b.mouseupPosition.y=b.position.y;b.sourceEvents.mouseup=d};b.mousewheel=function(a){b.wheelDelta=Math.max(-1,Math.min(1,a.wheelDelta||-a.detail));a.preventDefault()};a.setElement(b,b.element);return b};a.setElement=function(a,b){a.element=b;b.addEventListener("mousemove",a.mousemove);b.addEventListener("mousedown",a.mousedown);b.addEventListener("mouseup",a.mouseup);b.addEventListener("mousewheel",a.mousewheel);b.addEventListener("DOMMouseScroll",a.mousewheel);b.addEventListener("touchmove",a.mousemove);b.addEventListener("touchstart",a.mousedown);b.addEventListener("touchend",a.mouseup)};a.clearSourceEvents=function(a){a.sourceEvents.mousemove=null;a.sourceEvents.mousedown=null;a.sourceEvents.mouseup=null;a.sourceEvents.mousewheel=null;a.wheelDelta=0};a.setOffset=function(a,b){a.offset.x=b.x;a.offset.y=b.y;a.position.x=a.absolute.x*a.scale.x+a.offset.x;a.position.y=a.absolute.y*a.scale.y+a.offset.y};a.setScale=function(a,b){a.scale.x=b.x;a.scale.y=b.y;a.position.x=a.absolute.x*a.scale.x+a.offset.x;a.position.y=a.absolute.y*a.scale.y+a.offset.y};a._getRelativeMousePosition=function(a,b,e){var d=b.getBoundingClientRect(),g=document.documentElement||document.body.parentNode||document.body,c=void 0!==window.pageXOffset?window.pageXOffset:g.scrollLeft,g=void 0!==window.pageYOffset?window.pageYOffset:g.scrollTop,h=a.changedTouches;h?(c=h[0].pageX-d.left-c,a=h[0].pageY-d.top-g):(c=a.pageX-d.left-c,a=a.pageY-d.top-g);return{x:c/(b.clientWidth/(b.width||b.clientWidth)*e),y:a/(b.clientHeight/(b.height||b.clientHeight)*e)}}})()},{"../core/Common":14}],20:[function(n,q,w){var a={};q.exports=a;var e=n("./Common");(function(){a._registry={};a.register=function(d){a.isPlugin(d)||e.warn("Plugin.register:",a.toString(d),"does not implement all required fields.");if(d.name in a._registry){var b=a._registry[d.name],h=a.versionParse(d.version).number,l=a.versionParse(b.version).number;h>l?(e.warn("Plugin.register:",a.toString(b),"was upgraded to",a.toString(d)),a._registry[d.name]=d):h<l?e.warn("Plugin.register:",a.toString(b),"can not be downgraded to",a.toString(d)):d!==b&&e.warn("Plugin.register:",a.toString(d),"is already registered to different plugin object")}else a._registry[d.name]=d;return d};a.resolve=function(d){return a._registry[a.dependencyParse(d).name]};a.toString=function(a){return"string"===typeof a?a:(a.name||"anonymous")+"@"+(a.version||a.range||"0.0.0")};a.isPlugin=function(a){return a&&a.name&&a.version&&a.install};a.isUsed=function(a,b){return-1<a.used.indexOf(b)};a.isFor=function(d,b){var e=d["for"]&&a.dependencyParse(d["for"]);return!d["for"]||b.name===e.name&&a.versionSatisfies(b.version,e.range)};a.use=function(d,b){d.uses=(d.uses||[]).concat(b||[]);if(0===d.uses.length)e.warn("Plugin.use:",a.toString(d),"does not specify any dependencies to install.");else{for(var h=a.dependencies(d),h=e.topologicalSort(h),l=[],g=0;g<h.length;g+=1)if(h[g]!==d.name){var c=a.resolve(h[g]);c?a.isUsed(d,c.name)||(a.isFor(c,d)||(e.warn("Plugin.use:",a.toString(c),"is for",c["for"],"but installed on",a.toString(d)+"."),c._warned=!0),c.install?c.install(d):(e.warn("Plugin.use:",a.toString(c),"does not specify an install function."),c._warned=!0),c._warned?(l.push("\ud83d\udd36 "+a.toString(c)),delete c._warned):l.push("\u2705 "+a.toString(c)),d.used.push(c.name)):l.push("\u274c "+h[g])}0<l.length&&e.info(l.join("  "))}};a.dependencies=function(d,b){var h=a.dependencyParse(d),l=h.name;b=b||{};if(!(l in b)){d=a.resolve(d)||d;b[l]=e.map(d.uses||[],function(c){a.isPlugin(c)&&a.register(c);var b=a.dependencyParse(c),g=a.resolve(c);g&&!a.versionSatisfies(g.version,b.range)?(e.warn("Plugin.dependencies:",a.toString(g),"does not satisfy",a.toString(b),"used by",a.toString(h)+"."),g._warned=!0,d._warned=!0):g||(e.warn("Plugin.dependencies:",a.toString(c),"used by",a.toString(h),"could not be resolved."),d._warned=!0);return b.name});for(var g=0;g<b[l].length;g+=1)a.dependencies(b[l][g],b);return b}};a.dependencyParse=function(a){return e.isString(a)?(/^[\w-]+(@(\*|[\^~]?\d+\.\d+\.\d+(-[0-9A-Za-z-]+)?))?$/.test(a)||e.warn("Plugin.dependencyParse:",a,"is not a valid dependency string."),{name:a.split("@")[0],range:a.split("@")[1]||"*"}):{name:a.name,range:a.range||a.version}};a.versionParse=function(a){/^\*|[\^~]?\d+\.\d+\.\d+(-[0-9A-Za-z-]+)?$/.test(a)||e.warn("Plugin.versionParse:",a,"is not a valid version or range.");var b=a.split("-");a=b[0];var d=isNaN(Number(a[0])),l=d?a.substr(1):a,g=e.map(l.split("."),function(c){return Number(c)});return{isRange:d,version:l,range:a,operator:d?a[0]:"",parts:g,prerelease:b[1],number:1E8*g[0]+1E4*g[1]+g[2]}};a.versionSatisfies=function(d,b){b=b||"*";var e=a.versionParse(b),l=e.parts,g=a.versionParse(d),c=g.parts;if(e.isRange){if("*"===e.operator||"*"===d)return!0;if("~"===e.operator)return c[0]===l[0]&&c[1]===l[1]&&c[2]>=l[2];if("^"===e.operator)return 0<l[0]?c[0]===l[0]&&g.number>=e.number:0<l[1]?c[1]===l[1]&&c[2]>=l[2]:c[2]===l[2]}return d===b||"*"===d}})()},{"./Common":14}],21:[function(n,q,w){var a={};q.exports=a;var e=n("./Events"),d=n("./Engine"),b=n("./Common");(function(){var h,l;"undefined"!==typeof window&&(h=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame,l=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame);if(!h){var g;h=function(c){g=setTimeout(function(){c(b.now())},1E3/60)};l=function(){clearTimeout(g)}}a.create=function(c){c=b.extend({fps:60,correction:1,deltaSampleSize:60,counterTimestamp:0,frameCounter:0,deltaHistory:[],timePrev:null,timeScalePrev:1,frameRequestId:null,isFixed:!1,enabled:!0},c);c.delta=c.delta||1E3/c.fps;c.deltaMin=c.deltaMin||1E3/c.fps;c.deltaMax=c.deltaMax||1E3/(.5*c.fps);c.fps=1E3/c.delta;return c};a.run=function(c,b){"undefined"!==typeof c.positionIterations&&(b=c,c=a.create());(function f(d){c.frameRequestId=h(f);d&&c.enabled&&a.tick(c,b,d)})();return c};a.tick=function(c,a,b){var f=a.timing,g=1,h,p={timestamp:f.timestamp};e.trigger(c,"beforeTick",p);e.trigger(a,"beforeTick",p);c.isFixed?h=c.delta:(h=b-c.timePrev||c.delta,c.timePrev=b,c.deltaHistory.push(h),c.deltaHistory=c.deltaHistory.slice(-c.deltaSampleSize),h=Math.min.apply(null,c.deltaHistory),h=h<c.deltaMin?c.deltaMin:h,h=h>c.deltaMax?c.deltaMax:h,g=h/c.delta,c.delta=h);0!==c.timeScalePrev&&(g*=f.timeScale/c.timeScalePrev);0===f.timeScale&&(g=0);c.timeScalePrev=f.timeScale;c.correction=g;c.frameCounter+=1;1E3<=b-c.counterTimestamp&&(c.fps=(b-c.counterTimestamp)/1E3*c.frameCounter,c.counterTimestamp=b,c.frameCounter=0);e.trigger(c,"tick",p);e.trigger(a,"tick",p);a.world.isModified&&a.render&&a.render.controller&&a.render.controller.clear&&a.render.controller.clear(a.render);e.trigger(c,"beforeUpdate",p);d.update(a,h,g);e.trigger(c,"afterUpdate",p);a.render&&a.render.controller&&(e.trigger(c,"beforeRender",p),e.trigger(a,"beforeRender",p),a.render.controller.world(a.render),e.trigger(c,"afterRender",p),e.trigger(a,"afterRender",p));e.trigger(c,"afterTick",p);e.trigger(a,"afterTick",p)};a.stop=function(c){l(c.frameRequestId)};a.start=function(c,b){a.run(c,b)}})()},{"./Common":14,"./Engine":15,"./Events":16}],22:[function(n,q,w){var a={};q.exports=a;var e=n("./Events");(function(){a._motionWakeThreshold=.18;a._motionSleepThreshold=.08;a._minBias=.9;a.update=function(d,b){for(var e=b*b*b,l=0;l<d.length;l++){var g=d[l],c=g.speed*g.speed+g.angularSpeed*g.angularSpeed;0!==g.force.x||0!==g.force.y?a.set(g,!1):(g.motion=a._minBias*Math.min(g.motion,c)+(1-a._minBias)*Math.max(g.motion,c),0<g.sleepThreshold&&g.motion<a._motionSleepThreshold*e?(g.sleepCounter+=1,g.sleepCounter>=g.sleepThreshold&&a.set(g,!0)):0<g.sleepCounter&&--g.sleepCounter)}};a.afterCollisions=function(d,b){for(var e=b*b*b,l=0;l<d.length;l++){var g=d[l];if(g.isActive){var c=g.collision,g=c.bodyA.parent,m=c.bodyB.parent;g.isSleeping&&m.isSleeping||g.isStatic||m.isStatic||!g.isSleeping&&!m.isSleeping||(c=g.isSleeping&&!g.isStatic?g:m,g=c===g?m:g,!c.isStatic&&g.motion>a._motionWakeThreshold*e&&a.set(c,!1))}}};a.set=function(a,b){var d=a.isSleeping;b?(a.isSleeping=!0,a.sleepCounter=a.sleepThreshold,a.positionImpulse.x=0,a.positionImpulse.y=0,a.positionPrev.x=a.position.x,a.positionPrev.y=a.position.y,a.anglePrev=a.angle,a.speed=0,a.angularSpeed=0,a.motion=0,d||e.trigger(a,"sleepStart")):(a.isSleeping=!1,a.sleepCounter=0,d&&e.trigger(a,"sleepEnd"))}})()},{"./Events":16}],23:[function(n,q,w){(function(a){var e={};q.exports=e;var d=n("../geometry/Vertices"),b=n("../core/Common"),h=n("../body/Body"),l=n("../geometry/Bounds"),g=n("../geometry/Vector"),c="undefined"!==typeof window?window.decomp:"undefined"!==typeof a?a.decomp:null;(function(){e.rectangle=function(c,a,f,e,g){g=g||{};c={label:"Rectangle Body",position:{x:c,y:a},vertices:d.fromPath("L 0 0 L "+f+" 0 L "+f+" "+e+" L 0 "+e)};g.chamfer&&(a=g.chamfer,c.vertices=d.chamfer(c.vertices,a.radius,a.quality,a.qualityMin,a.qualityMax),delete g.chamfer);return h.create(b.extend({},c,g))};e.trapezoid=function(c,a,f,e,g,p){p=p||{};g*=.5;var r=f*g;f=r+(1-2*g)*f;var k=f+r;c={label:"Trapezoid Body",position:{x:c,y:a},vertices:d.fromPath(.5>g?"L 0 0 L "+r+" "+-e+" L "+f+" "+-e+" L "+k+" 0":"L 0 0 L "+f+" "+-e+" L "+k+" 0")};p.chamfer&&(a=p.chamfer,c.vertices=d.chamfer(c.vertices,a.radius,a.quality,a.qualityMin,a.qualityMax),delete p.chamfer);return h.create(b.extend({},c,p))};e.circle=function(c,a,d,g,h){g=g||{};var f={label:"Circle Body",circleRadius:d};h=Math.ceil(Math.max(10,Math.min(h||25,d)));1===h%2&&(h+=1);return e.polygon(c,a,h,d,b.extend({},f,g))};e.polygon=function(c,a,f,g,u){u=u||{};if(3>f)return e.circle(c,a,g,u);for(var p=2*Math.PI/f,r="",k=.5*p,m=0;m<f;m+=1)var l=k+m*p,n=Math.sin(l)*g,r=r+("L "+(Math.cos(l)*g).toFixed(3)+" "+n.toFixed(3)+" ");c={label:"Polygon Body",position:{x:c,y:a},vertices:d.fromPath(r)};u.chamfer&&(a=u.chamfer,c.vertices=d.chamfer(c.vertices,a.radius,a.quality,a.qualityMin,a.qualityMax),delete u.chamfer);return h.create(b.extend({},c,u))};e.fromVertices=function(a,e,f,r,u,p,t){var k,m,x,n;r=r||{};k=[];u="undefined"!==typeof u?u:!1;p="undefined"!==typeof p?p:.01;t="undefined"!==typeof t?t:10;c||b.warn("Bodies.fromVertices: poly-decomp.js required. Could not decompose vertices. Fallback to convex hull.");b.isArray(f[0])||(f=[f]);for(n=0;n<f.length;n+=1)if(x=f[n],(m=d.isConvex(x))||!c)x=m?d.clockwiseSort(x):d.hull(x),k.push({position:{x:a,y:e},vertices:x});else for(m=x.map(function(c){return[c.x,c.y]}),c.makeCCW(m),!1!==p&&c.removeCollinearPoints(m,p),x=c.quickDecomp(m),m=0;m<x.length;m++){var q=x[m].map(function(c){return{x:c[0],y:c[1]}});0<t&&d.area(q)<t||k.push({position:d.centre(q),vertices:q})}for(m=0;m<k.length;m++)k[m]=h.create(b.extend(k[m],r));if(u)for(m=0;m<k.length;m++)for(t=k[m],f=m+1;f<k.length;f++)if(n=k[f],l.overlaps(t.bounds,n.bounds))for(x=t.vertices,q=n.vertices,u=0;u<t.vertices.length;u++)for(p=0;p<n.vertices.length;p++){var y=g.magnitudeSquared(g.sub(x[(u+1)%x.length],q[p])),J=g.magnitudeSquared(g.sub(x[u],q[(p+1)%q.length]));5>y&&5>J&&(x[u].isInternal=!0,q[p].isInternal=!0)}return 1<k.length?(r=h.create(b.extend({parts:k.slice(0)},r)),h.setPosition(r,{x:a,y:e}),r):k[0]}})()}).call(this,"undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"../body/Body":1,"../core/Common":14,"../geometry/Bounds":26,"../geometry/Vector":28,"../geometry/Vertices":29}],24:[function(n,q,w){var a={};q.exports=a;var e=n("../body/Composite"),d=n("../constraint/Constraint"),b=n("../core/Common"),h=n("../body/Body"),l=n("./Bodies");(function(){a.stack=function(a,c,b,d,f,r,u){for(var g=e.create({label:"Stack"}),k=a,m,l=0,x=0;x<d;x++){for(var n=0,q=0;q<b;q++){var y=u(k,c,q,x,m,l);y?(k=y.bounds.max.y-y.bounds.min.y,m=y.bounds.max.x-y.bounds.min.x,k>n&&(n=k),h.translate(y,{x:.5*m,y:.5*k}),k=y.bounds.max.x+f,e.addBody(g,y),m=y,l+=1):k+=f}c+=n+r;k=a}return g};a.chain=function(a,c,h,k,f,r){for(var g=a.bodies,p=1;p<g.length;p++){var m=g[p-1],l=g[p],m=b.extend({bodyA:m,pointA:{x:(m.bounds.max.x-m.bounds.min.x)*c,y:(m.bounds.max.y-m.bounds.min.y)*h},bodyB:l,pointB:{x:(l.bounds.max.x-l.bounds.min.x)*k,y:(l.bounds.max.y-l.bounds.min.y)*f}},r);e.addConstraint(a,d.create(m))}a.label+=" Chain";return a};a.mesh=function(a,c,h,k,f){var g=a.bodies,m,p,l,z;for(m=0;m<h;m++){for(p=1;p<c;p++)l=g[p-1+m*c],z=g[p+m*c],e.addConstraint(a,d.create(b.extend({bodyA:l,bodyB:z},f)));if(0<m)for(p=0;p<c;p++)l=g[p+(m-1)*c],z=g[p+m*c],e.addConstraint(a,d.create(b.extend({bodyA:l,bodyB:z},f))),k&&0<p&&(l=g[p-1+(m-1)*c],e.addConstraint(a,d.create(b.extend({bodyA:l,bodyB:z},f)))),k&&p<c-1&&(l=g[p+1+(m-1)*c],e.addConstraint(a,d.create(b.extend({bodyA:l,bodyB:z},f))))}a.label+=" Mesh";return a};a.pyramid=function(b,c,d,e,f,r,u){return a.stack(b,c,d,e,f,r,function(c,a,g,r,k,m){var p=Math.min(e,Math.ceil(d/2));c=k?k.bounds.max.x-k.bounds.min.x:0;if(!(r>p||(r=p-r,p=d-1-r,g<r||g>p)))return 1===m&&h.translate(k,{x:(g+(1===d%2?1:-1))*c,y:0}),u(b+(k?g*c:0)+g*f,a,g,r,k,m)})};a.newtonsCradle=function(a,c,b,h,f){for(var g=e.create({label:"Newtons Cradle"}),k=0;k<b;k++){var p=l.circle(a+1.9*k*h,c+f,h,{inertia:Infinity,restitution:1,friction:0,frictionAir:1E-4,slop:1}),m=d.create({pointA:{x:a+1.9*k*h,y:c},bodyB:p});e.addBody(g,p);e.addConstraint(g,m)}return g};a.car=function(a,c,b,k,f){var g=h.nextGroup(!0),m=.5*-b+20,p=.5*b-20,t=e.create({label:"Car"});b=l.rectangle(a,c,b,k,{collisionFilter:{group:g},chamfer:{radius:.5*k},density:2E-4});k=l.circle(a+m,c+0,f,{collisionFilter:{group:g},friction:.8});a=l.circle(a+p,c+0,f,{collisionFilter:{group:g},friction:.8});m=d.create({bodyB:b,pointB:{x:m,y:0},bodyA:k,stiffness:1,length:0});p=d.create({bodyB:b,pointB:{x:p,y:0},bodyA:a,stiffness:1,length:0});e.addBody(t,b);e.addBody(t,k);e.addBody(t,a);e.addConstraint(t,m);e.addConstraint(t,p);return t};a.softBody=function(d,c,e,h,f,r,u,p,t,z){t=b.extend({inertia:Infinity},t);z=b.extend({stiffness:.2,render:{type:"line",anchors:!1}},z);d=a.stack(d,c,e,h,f,r,function(a,c){return l.circle(a,c,p,t)});a.mesh(d,e,h,u,z);d.label="Soft Body";return d}})()},{"../body/Body":1,"../body/Composite":2,"../constraint/Constraint":12,"../core/Common":14,"./Bodies":23}],25:[function(n,q,w){var a={};q.exports=a;var e=n("../geometry/Vector"),d=n("../core/Common");(function(){a.fromVertices=function(a){for(var b={},l=0;l<a.length;l++){var g=(l+1)%a.length,g=e.normalise({x:a[g].y-a[l].y,y:a[l].x-a[g].x}),c=0===g.y?Infinity:g.x/g.y,c=c.toFixed(3).toString();b[c]=g}return d.values(b)};a.rotate=function(a,d){if(0!==d)for(var b=Math.cos(d),e=Math.sin(d),c=0;c<a.length;c++){var h=a[c],k;k=h.x*b-h.y*e;h.y=h.x*e+h.y*b;h.x=k}}})()},{"../core/Common":14,"../geometry/Vector":28}],26:[function(n,q,w){var a={};q.exports=a;(function(){a.create=function(e){var d={min:{x:0,y:0},max:{x:0,y:0}};e&&a.update(d,e);return d};a.update=function(a,d,b){a.min.x=Infinity;a.max.x=-Infinity;a.min.y=Infinity;a.max.y=-Infinity;for(var e=0;e<d.length;e++){var l=d[e];l.x>a.max.x&&(a.max.x=l.x);l.x<a.min.x&&(a.min.x=l.x);l.y>a.max.y&&(a.max.y=l.y);l.y<a.min.y&&(a.min.y=l.y)}b&&(0<b.x?a.max.x+=b.x:a.min.x+=b.x,0<b.y?a.max.y+=b.y:a.min.y+=b.y)};a.contains=function(a,d){return d.x>=a.min.x&&d.x<=a.max.x&&d.y>=a.min.y&&d.y<=a.max.y};a.overlaps=function(a,d){return a.min.x<=d.max.x&&a.max.x>=d.min.x&&a.max.y>=d.min.y&&a.min.y<=d.max.y};a.translate=function(a,d){a.min.x+=d.x;a.max.x+=d.x;a.min.y+=d.y;a.max.y+=d.y};a.shift=function(a,d){var b=a.max.x-a.min.x,e=a.max.y-a.min.y;a.min.x=d.x;a.max.x=d.x+b;a.min.y=d.y;a.max.y=d.y+e}})()},{}],27:[function(n,q,w){var a={};q.exports=a;n("../geometry/Bounds");(function(){a.pathToVertices=function(e,d){var b,h,l,g,c,m,k=[],f,r,u=0,p=0,t=0;d=d||15;var z=function(a,c,b){b=1===b%2&&1<b;if(!m||a!=m.x||c!=m.y){m&&b?(f=m.x,r=m.y):r=f=0;var d={x:f+a,y:r+c};if(b||!m)m=d;k.push(d);p=f+a;t=r+c}},B=function(a){var c=a.pathSegTypeAsLetter.toUpperCase();if("Z"!==c){switch(c){case "M":case "L":case "T":case "C":case "S":case "Q":p=a.x;t=a.y;break;case "H":p=a.x;break;case "V":t=a.y}z(p,t,a.pathSegType)}};a._svgPathToAbsolute(e);h=e.getTotalLength();l=[];for(b=0;b<e.pathSegList.numberOfItems;b+=1)l.push(e.pathSegList.getItem(b));for(g=l.concat();u<h;){b=e.getPathSegAtLength(u);b=l[b];if(b!=c){for(;g.length&&g[0]!=b;)B(g.shift());c=b}switch(b.pathSegTypeAsLetter.toUpperCase()){case "C":case "T":case "S":case "Q":case "A":b=e.getPointAtLength(u),z(b.x,b.y,0)}u+=d}b=0;for(h=g.length;b<h;++b)B(g[b]);return k};a._svgPathToAbsolute=function(a){for(var d,b,e,l,g,c,m=a.pathSegList,k=0,f=0,r=m.numberOfItems,u=0;u<r;++u){var p=m.getItem(u),t=p.pathSegTypeAsLetter;if(/[MLHVCSQTA]/.test(t))"x"in p&&(k=p.x),"y"in p&&(f=p.y);else switch("x1"in p&&(e=k+p.x1),"x2"in p&&(g=k+p.x2),"y1"in p&&(l=f+p.y1),"y2"in p&&(c=f+p.y2),"x"in p&&(k+=p.x),"y"in p&&(f+=p.y),t){case "m":m.replaceItem(a.createSVGPathSegMovetoAbs(k,f),u);break;case "l":m.replaceItem(a.createSVGPathSegLinetoAbs(k,f),u);break;case "h":m.replaceItem(a.createSVGPathSegLinetoHorizontalAbs(k),u);break;case "v":m.replaceItem(a.createSVGPathSegLinetoVerticalAbs(f),u);break;case "c":m.replaceItem(a.createSVGPathSegCurvetoCubicAbs(k,f,e,l,g,c),u);break;case "s":m.replaceItem(a.createSVGPathSegCurvetoCubicSmoothAbs(k,f,g,c),u);break;case "q":m.replaceItem(a.createSVGPathSegCurvetoQuadraticAbs(k,f,e,l),u);break;case "t":m.replaceItem(a.createSVGPathSegCurvetoQuadraticSmoothAbs(k,f),u);break;case "a":m.replaceItem(a.createSVGPathSegArcAbs(k,f,p.r1,p.r2,p.angle,p.largeArcFlag,p.sweepFlag),u);break;case "z":case "Z":k=d,f=b}if("M"==t||"m"==t)d=k,b=f}}})()},{"../geometry/Bounds":26}],28:[function(n,q,w){var a={};q.exports=a;(function(){a.create=function(a,d){return{x:a||0,y:d||0}};a.clone=function(a){return{x:a.x,y:a.y}};a.magnitude=function(a){return Math.sqrt(a.x*a.x+a.y*a.y)};a.magnitudeSquared=function(a){return a.x*a.x+a.y*a.y};a.rotate=function(a,d,b){var e=Math.cos(d);d=Math.sin(d);b||(b={});var l=a.x*e-a.y*d;b.y=a.x*d+a.y*e;b.x=l;return b};a.rotateAbout=function(a,d,b,h){var e=Math.cos(d);d=Math.sin(d);h||(h={});var g=b.x+((a.x-b.x)*e-(a.y-b.y)*d);h.y=b.y+((a.x-b.x)*d+(a.y-b.y)*e);h.x=g;return h};a.normalise=function(e){var d=a.magnitude(e);return 0===d?{x:0,y:0}:{x:e.x/d,y:e.y/d}};a.dot=function(a,d){return a.x*d.x+a.y*d.y};a.cross=function(a,d){return a.x*d.y-a.y*d.x};a.cross3=function(a,d,b){return(d.x-a.x)*(b.y-a.y)-(d.y-a.y)*(b.x-a.x)};a.add=function(a,d,b){b||(b={});b.x=a.x+d.x;b.y=a.y+d.y;return b};a.sub=function(a,d,b){b||(b={});b.x=a.x-d.x;b.y=a.y-d.y;return b};a.mult=function(a,d){return{x:a.x*d,y:a.y*d}};a.div=function(a,d){return{x:a.x/d,y:a.y/d}};a.perp=function(a,d){d=!0===d?-1:1;return{x:d*-a.y,y:d*a.x}};a.neg=function(a){return{x:-a.x,y:-a.y}};a.angle=function(a,d){return Math.atan2(d.y-a.y,d.x-a.x)};a._temp=[a.create(),a.create(),a.create(),a.create(),a.create(),a.create()]})()},{}],29:[function(n,q,w){var a={};q.exports=a;var e=n("../geometry/Vector"),d=n("../core/Common");(function(){a.create=function(a,d){for(var b=[],e=0;e<a.length;e++){var c=a[e];b.push({x:c.x,y:c.y,index:e,body:d,isInternal:!1})}return b};a.fromPath=function(b,d){var e=[];b.replace(/L?\s*([\-\d\.e]+)[\s,]*([\-\d\.e]+)*/ig,function(a,c,b){e.push({x:parseFloat(c),y:parseFloat(b)})});return a.create(e,d)};a.centre=function(b){for(var d=a.area(b,!0),l={x:0,y:0},g,c,m=0;m<b.length;m++)c=(m+1)%b.length,g=e.cross(b[m],b[c]),g=e.mult(e.add(b[m],b[c]),g),l=e.add(l,g);return e.div(l,6*d)};a.mean=function(a){for(var b={x:0,y:0},d=0;d<a.length;d++)b.x+=a[d].x,b.y+=a[d].y;return e.div(b,a.length)};a.area=function(a,d){for(var b=0,e=a.length-1,c=0;c<a.length;c++)b+=(a[e].x-a[c].x)*(a[e].y+a[c].y),e=c;return d?b/2:Math.abs(b)/2};a.inertia=function(a,d){for(var b=0,g=0,c,h,k=0;k<a.length;k++)h=(k+1)%a.length,c=Math.abs(e.cross(a[h],a[k])),b+=c*(e.dot(a[h],a[h])+e.dot(a[h],a[k])+e.dot(a[k],a[k])),g+=c;return d/6*(b/g)};a.translate=function(a,d,e){var b;if(e)for(b=0;b<a.length;b++)a[b].x+=d.x*e,a[b].y+=d.y*e;else for(b=0;b<a.length;b++)a[b].x+=d.x,a[b].y+=d.y;return a};a.rotate=function(a,d,e){if(0!==d){var b=Math.cos(d);d=Math.sin(d);for(var c=0;c<a.length;c++){var h=a[c],k=h.x-e.x,f=h.y-e.y;h.x=e.x+(k*b-f*d);h.y=e.y+(k*d+f*b)}return a}};a.contains=function(a,d){for(var b=0;b<a.length;b++){var e=a[b],c=a[(b+1)%a.length];if(0<(d.x-e.x)*(c.y-e.y)+(d.y-e.y)*(e.x-c.x))return!1}return!0};a.scale=function(b,d,l,g){if(1===d&&1===l)return b;g=g||a.centre(b);for(var c,h=0;h<b.length;h++)c=b[h],c=e.sub(c,g),b[h].x=g.x+c.x*d,b[h].y=g.y+c.y*l;return b};a.chamfer=function(a,h,l,g,c){h="number"===typeof h?[h]:h||[8];l="undefined"!==typeof l?l:-1;g=g||2;c=c||14;for(var b=[],k=0;k<a.length;k++){var f=a[0<=k-1?k-1:a.length-1],r=a[k],u=a[(k+1)%a.length],p=h[k<h.length?k:h.length-1];if(0===p)b.push(r);else{var f=e.normalise({x:r.y-f.y,y:f.x-r.x}),t=e.normalise({x:u.y-r.y,y:r.x-u.x}),z=Math.sqrt(2*Math.pow(p,2)),u=e.mult(d.clone(f),p),B=e.normalise(e.mult(e.add(f,t),.5)),r=e.sub(r,e.mult(B,z)),z=l;-1===l&&(z=1.75*Math.pow(p,.32));z=d.clamp(z,g,c);1===z%2&&(z+=1);p=Math.acos(e.dot(f,t))/z;for(f=0;f<z;f++)b.push(e.add(e.rotate(u,p*f),r))}}return b};a.clockwiseSort=function(b){var d=a.mean(b);b.sort(function(a,b){return e.angle(d,a)-e.angle(d,b)});return b};a.isConvex=function(a){var b=0,d=a.length,e,c,m,k;if(3>d)return null;for(e=0;e<d;e++)if(c=(e+1)%d,m=(e+2)%d,k=(a[c].x-a[e].x)*(a[m].y-a[c].y),k-=(a[c].y-a[e].y)*(a[m].x-a[c].x),0>k?b|=1:0<k&&(b|=2),3===b)return!1;return 0!==b?!0:null};a.hull=function(a){var b=[],d=[],g,c;a=a.slice(0);a.sort(function(a,c){var b=a.x-c.x;return 0!==b?b:a.y-c.y});for(c=0;c<a.length;c+=1){for(g=a[c];2<=d.length&&0>=e.cross3(d[d.length-2],d[d.length-1],g);)d.pop();d.push(g)}for(c=a.length-1;0<=c;--c){for(g=a[c];2<=b.length&&0>=e.cross3(b[b.length-2],b[b.length-1],g);)b.pop();b.push(g)}b.pop();d.pop();return b.concat(d)}})()},{"../core/Common":14,"../geometry/Vector":28}],30:[function(n,q,w){q=q.exports=n("../core/Matter");q.Body=n("../body/Body");q.Composite=n("../body/Composite");q.World=n("../body/World");q.Contact=n("../collision/Contact");q.Detector=n("../collision/Detector");q.Grid=n("../collision/Grid");q.Pairs=n("../collision/Pairs");q.Pair=n("../collision/Pair");q.Query=n("../collision/Query");q.Resolver=n("../collision/Resolver");q.SAT=n("../collision/SAT");q.Constraint=n("../constraint/Constraint");q.MouseConstraint=n("../constraint/MouseConstraint");q.Common=n("../core/Common");q.Engine=n("../core/Engine");q.Events=n("../core/Events");q.Mouse=n("../core/Mouse");q.Runner=n("../core/Runner");q.Sleeping=n("../core/Sleeping");q.Plugin=n("../core/Plugin");q.Bodies=n("../factory/Bodies");q.Composites=n("../factory/Composites");q.Axes=n("../geometry/Axes");q.Bounds=n("../geometry/Bounds");q.Svg=n("../geometry/Svg");q.Vector=n("../geometry/Vector");q.Vertices=n("../geometry/Vertices");q.Render=n("../render/Render");q.RenderPixi=n("../render/RenderPixi");q.World.add=q.Composite.add;q.World.remove=q.Composite.remove;q.World.addComposite=q.Composite.addComposite;q.World.addBody=q.Composite.addBody;q.World.addConstraint=q.Composite.addConstraint;q.World.clear=q.Composite.clear;q.Engine.run=q.Runner.run},{"../body/Body":1,"../body/Composite":2,"../body/World":3,"../collision/Contact":4,"../collision/Detector":5,"../collision/Grid":6,"../collision/Pair":7,"../collision/Pairs":8,"../collision/Query":9,"../collision/Resolver":10,"../collision/SAT":11,"../constraint/Constraint":12,"../constraint/MouseConstraint":13,"../core/Common":14,"../core/Engine":15,"../core/Events":16,"../core/Matter":17,"../core/Metrics":18,"../core/Mouse":19,"../core/Plugin":20,"../core/Runner":21,"../core/Sleeping":22,"../factory/Bodies":23,"../factory/Composites":24,"../geometry/Axes":25,"../geometry/Bounds":26,"../geometry/Svg":27,"../geometry/Vector":28,"../geometry/Vertices":29,"../render/Render":31,"../render/RenderPixi":32}],31:[function(n,q,w){var a={};q.exports=a;var e=n("../core/Common"),d=n("../body/Composite"),b=n("../geometry/Bounds"),h=n("../core/Events"),l=n("../collision/Grid"),g=n("../geometry/Vector"),c=n("../core/Mouse");(function(){var m,k;"undefined"!==typeof window&&(m=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(function(){a(e.now())},1E3/60)},k=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame);a.create=function(c){var b=e.extend({controller:a,engine:null,element:null,canvas:null,mouse:null,frameRequestId:null,options:{width:800,height:600,pixelRatio:1,background:"#18181d",wireframeBackground:"#0f0f13",hasBounds:!!c.bounds,enabled:!0,wireframes:!0,showSleeping:!0,showDebug:!1,showBroadphase:!1,showBounds:!1,showVelocity:!1,showCollisions:!1,showSeparations:!1,showAxes:!1,showPositions:!1,showAngleIndicator:!1,showIds:!1,showShadows:!1,showVertexNumbers:!1,showConvexHulls:!1,showInternalEdges:!1,showMousePosition:!1}},c);b.canvas&&(b.canvas.width=b.options.width||b.canvas.width,b.canvas.height=b.options.height||b.canvas.height);b.mouse=c.mouse;b.engine=c.engine;b.canvas=b.canvas||f(b.options.width,b.options.height);b.context=b.canvas.getContext("2d");b.textures={};b.bounds=b.bounds||{min:{x:0,y:0},max:{x:b.canvas.width,y:b.canvas.height}};1!==b.options.pixelRatio&&a.setPixelRatio(b,b.options.pixelRatio);e.isElement(b.element)?b.element.appendChild(b.canvas):b.canvas.parentNode||e.log("Render.create: options.element was undefined, render.canvas was created but not appended","warn");return b};a.run=function(c){(function p(b){c.frameRequestId=m(p);a.world(c)})()};a.stop=function(a){k(a.frameRequestId)};a.setPixelRatio=function(a,c){var b=a.options,d=a.canvas;if("auto"===c){var f=d.getContext("2d");c=(window.devicePixelRatio||1)/(f.webkitBackingStorePixelRatio||f.mozBackingStorePixelRatio||f.msBackingStorePixelRatio||f.oBackingStorePixelRatio||f.backingStorePixelRatio||1)}b.pixelRatio=c;d.setAttribute("data-pixel-ratio",c);d.width=b.width*c;d.height=b.height*c;d.style.width=b.width+"px";d.style.height=b.height+"px";a.context.scale(c,c)};a.lookAt=function(a,b,d,f){f="undefined"!==typeof f?f:!0;b=e.isArray(b)?b:[b];d=d||{x:0,y:0};for(var p=Infinity,g=Infinity,h=-Infinity,k=-Infinity,r=0;r<b.length;r+=1){var m=b[r],u=m.bounds?m.bounds.min:m.min||m.position||m,m=m.bounds?m.bounds.max:m.max||m.position||m;u&&m&&(u.x<p&&(p=u.x),m.x>h&&(h=m.x),u.y<g&&(g=u.y),m.y>k&&(k=m.y))}b=h-p+2*d.x;k=k-g+2*d.y;h=a.canvas.width/a.canvas.height;r=b/k;m=u=1;r>h?m=r/h:u=h/r;a.options.hasBounds=!0;a.bounds.min.x=p;a.bounds.max.x=p+b*u;a.bounds.min.y=g;a.bounds.max.y=g+k*m;f&&(a.bounds.min.x+=.5*b-b*u*.5,a.bounds.max.x+=.5*b-b*u*.5,a.bounds.min.y+=.5*k-k*m*.5,a.bounds.max.y+=.5*k-k*m*.5);a.bounds.min.x-=d.x;a.bounds.max.x-=d.x;a.bounds.min.y-=d.y;a.bounds.max.y-=d.y;a.mouse&&(c.setScale(a.mouse,{x:(a.bounds.max.x-a.bounds.min.x)/a.canvas.width,y:(a.bounds.max.y-a.bounds.min.y)/a.canvas.height}),c.setOffset(a.mouse,a.bounds.min))};a.startViewTransform=function(a){a.context.scale(1/((a.bounds.max.x-a.bounds.min.x)/a.options.width),1/((a.bounds.max.y-a.bounds.min.y)/a.options.height));a.context.translate(-a.bounds.min.x,-a.bounds.min.y)};a.endViewTransform=function(a){a.context.setTransform(a.options.pixelRatio,0,0,a.options.pixelRatio,0,0)};a.world=function(f){var e=f.engine,p=e.world,k=f.canvas,m=f.context,r=f.options,x=d.allBodies(p),p=d.allConstraints(p),n=r.wireframes?r.wireframeBackground:r.background,q=[],y=[],J={timestamp:e.timing.timestamp};h.trigger(f,"beforeRender",J);if(f.currentBackground!==n){var w=n;/(jpg|gif|png)$/.test(n)&&(w="url("+n+")");f.canvas.style.background=w;f.canvas.style.backgroundSize="contain";f.currentBackground=n}m.globalCompositeOperation="source-in";m.fillStyle="transparent";m.fillRect(0,0,k.width,k.height);m.globalCompositeOperation="source-over";if(r.hasBounds){for(k=0;k<x.length;k++)n=x[k],b.overlaps(n.bounds,f.bounds)&&q.push(n);for(k=0;k<p.length;k++){var x=p[k],n=x.bodyA,w=x.bodyB,D=x.pointA,E=x.pointB;n&&(D=g.add(n.position,x.pointA));w&&(E=g.add(w.position,x.pointB));D&&E&&(b.contains(f.bounds,D)||b.contains(f.bounds,E))&&y.push(x)}a.startViewTransform(f);f.mouse&&(c.setScale(f.mouse,{x:(f.bounds.max.x-f.bounds.min.x)/f.canvas.width,y:(f.bounds.max.y-f.bounds.min.y)/f.canvas.height}),c.setOffset(f.mouse,f.bounds.min))}else y=p,q=x;!r.wireframes||e.enableSleeping&&r.showSleeping?a.bodies(f,q,m):(r.showConvexHulls&&a.bodyConvexHulls(f,q,m),a.bodyWireframes(f,q,m));r.showBounds&&a.bodyBounds(f,q,m);(r.showAxes||r.showAngleIndicator)&&a.bodyAxes(f,q,m);r.showPositions&&a.bodyPositions(f,q,m);r.showVelocity&&a.bodyVelocity(f,q,m);r.showIds&&a.bodyIds(f,q,m);r.showSeparations&&a.separations(f,e.pairs.list,m);r.showCollisions&&a.collisions(f,e.pairs.list,m);r.showVertexNumbers&&a.vertexNumbers(f,q,m);r.showMousePosition&&a.mousePosition(f,f.mouse,m);a.constraints(y,m);r.showBroadphase&&e.broadphase.controller===l&&a.grid(f,e.broadphase,m);r.showDebug&&a.debug(f,m);r.hasBounds&&a.endViewTransform(f);h.trigger(f,"afterRender",J)};a.debug=function(a,c){var b=a.engine,f=b.metrics,e=a.options;d.allBodies(b.world);if(500<=b.timing.timestamp-(a.debugTimestamp||0)){var g="";f.timing&&(g+="fps: "+Math.round(f.timing.fps)+"    ");a.debugString=g;a.debugTimestamp=b.timing.timestamp}if(a.debugString)for(c.font="12px Arial",c.fillStyle=e.wireframes?"rgba(255,255,255,0.5)":"rgba(0,0,0,0.5)",b=a.debugString.split("\n"),f=0;f<b.length;f++)c.fillText(b[f],50,50+18*f)};a.constraints=function(a,c){for(var b=0;b<a.length;b++){var d=a[b];if(d.render.visible&&d.pointA&&d.pointB){var f=d.bodyA,k=d.bodyB,h,f=f?g.add(f.position,d.pointA):d.pointA;if("pin"===d.render.type)c.beginPath(),c.arc(f.x,f.y,3,0,2*Math.PI),c.closePath();else{h=k?g.add(k.position,d.pointB):d.pointB;c.beginPath();c.moveTo(f.x,f.y);if("spring"===d.render.type)for(var k=g.sub(h,f),m=g.perp(g.normalise(k)),r=Math.ceil(e.clamp(d.length/5,12,20)),u,l=1;l<r;l+=1)u=0===l%2?1:-1,c.lineTo(f.x+l/r*k.x+m.x*u*4,f.y+l/r*k.y+m.y*u*4);c.lineTo(h.x,h.y)}d.render.lineWidth&&(c.lineWidth=d.render.lineWidth,c.strokeStyle=d.render.strokeStyle,c.stroke());d.render.anchors&&(c.fillStyle=d.render.strokeStyle,c.beginPath(),c.arc(f.x,f.y,3,0,2*Math.PI),c.arc(h.x,h.y,3,0,2*Math.PI),c.closePath(),c.fill())}}};a.bodyShadows=function(a,c,b){for(var d=0;d<c.length;d++){var f=c[d];if(f.render.visible){if(f.circleRadius)b.beginPath(),b.arc(f.position.x,f.position.y,f.circleRadius,0,2*Math.PI);else{b.beginPath();b.moveTo(f.vertices[0].x,f.vertices[0].y);for(var e=1;e<f.vertices.length;e++)b.lineTo(f.vertices[e].x,f.vertices[e].y)}b.closePath();var e=f.position.x-.5*a.options.width,f=f.position.y-.2*a.options.height,g=Math.abs(e)+Math.abs(f);b.shadowColor="rgba(0,0,0,0.15)";b.shadowOffsetX=.05*e;b.shadowOffsetY=.05*f;b.shadowBlur=1+12*Math.min(1,g/1E3);b.fill();b.shadowColor=null;b.shadowOffsetX=null;b.shadowOffsetY=null;b.shadowBlur=null}}};a.bodies=function(a,c,b){var d=a.options,f=d.showInternalEdges||!d.wireframes,e,g,k,h;for(k=0;k<c.length;k++)if(e=c[k],e.render.visible)for(h=1<e.parts.length?1:0;h<e.parts.length;h++)if(g=e.parts[h],g.render.visible){d.showSleeping&&e.isSleeping?b.globalAlpha=.5*g.render.opacity:1!==g.render.opacity&&(b.globalAlpha=g.render.opacity);if(g.render.sprite&&g.render.sprite.texture&&!d.wireframes){var m=g.render.sprite,p;p=m.texture;var r=a.textures[p];r||(r=a.textures[p]=new Image,r.src=p);p=r;b.translate(g.position.x,g.position.y);b.rotate(g.angle);b.drawImage(p,p.width*-m.xOffset*m.xScale,p.height*-m.yOffset*m.yScale,p.width*m.xScale,p.height*m.yScale);b.rotate(-g.angle);b.translate(-g.position.x,-g.position.y)}else{if(g.circleRadius)b.beginPath(),b.arc(g.position.x,g.position.y,g.circleRadius,0,2*Math.PI);else{b.beginPath();b.moveTo(g.vertices[0].x,g.vertices[0].y);for(m=1;m<g.vertices.length;m++)!g.vertices[m-1].isInternal||f?b.lineTo(g.vertices[m].x,g.vertices[m].y):b.moveTo(g.vertices[m].x,g.vertices[m].y),g.vertices[m].isInternal&&!f&&b.moveTo(g.vertices[(m+1)%g.vertices.length].x,g.vertices[(m+1)%g.vertices.length].y);b.lineTo(g.vertices[0].x,g.vertices[0].y);b.closePath()}d.wireframes?(b.lineWidth=1,b.strokeStyle="#bbb",b.stroke()):(b.fillStyle=g.render.fillStyle,g.render.lineWidth&&(b.lineWidth=g.render.lineWidth,b.strokeStyle=g.render.strokeStyle,b.stroke()),b.fill())}b.globalAlpha=1}};a.bodyWireframes=function(a,c,b){a=a.options.showInternalEdges;var d,f,e,g,k;b.beginPath();for(e=0;e<c.length;e++)if(d=c[e],d.render.visible)for(k=1<d.parts.length?1:0;k<d.parts.length;k++){f=d.parts[k];b.moveTo(f.vertices[0].x,f.vertices[0].y);for(g=1;g<f.vertices.length;g++)!f.vertices[g-1].isInternal||a?b.lineTo(f.vertices[g].x,f.vertices[g].y):b.moveTo(f.vertices[g].x,f.vertices[g].y),f.vertices[g].isInternal&&!a&&b.moveTo(f.vertices[(g+1)%f.vertices.length].x,f.vertices[(g+1)%f.vertices.length].y);b.lineTo(f.vertices[0].x,f.vertices[0].y)}b.lineWidth=1;b.strokeStyle="#bbb";b.stroke()};a.bodyConvexHulls=function(a,c,b){var d,f;b.beginPath();for(d=0;d<c.length;d++)if(a=c[d],a.render.visible&&1!==a.parts.length){b.moveTo(a.vertices[0].x,a.vertices[0].y);for(f=1;f<a.vertices.length;f++)b.lineTo(a.vertices[f].x,a.vertices[f].y);b.lineTo(a.vertices[0].x,a.vertices[0].y)}b.lineWidth=1;b.strokeStyle="rgba(255,255,255,0.2)";b.stroke()};a.vertexNumbers=function(a,c,b){var d,f;for(a=0;a<c.length;a++){var e=c[a].parts;for(f=1<e.length?1:0;f<e.length;f++){var g=e[f];for(d=0;d<g.vertices.length;d++)b.fillStyle="rgba(255,255,255,0.2)",b.fillText(a+"_"+d,g.position.x+.8*(g.vertices[d].x-g.position.x),g.position.y+.8*(g.vertices[d].y-g.position.y))}}};a.mousePosition=function(a,c,b){b.fillStyle="rgba(255,255,255,0.8)";b.fillText(c.position.x+"  "+c.position.y,c.position.x+5,c.position.y-5)};a.bodyBounds=function(a,c,b){a=a.options;b.beginPath();for(var d=0;d<c.length;d++)if(c[d].render.visible)for(var f=c[d].parts,e=1<f.length?1:0;e<f.length;e++){var g=f[e];b.rect(g.bounds.min.x,g.bounds.min.y,g.bounds.max.x-g.bounds.min.x,g.bounds.max.y-g.bounds.min.y)}b.strokeStyle=a.wireframes?"rgba(255,255,255,0.08)":"rgba(0,0,0,0.1)";b.lineWidth=1;b.stroke()};a.bodyAxes=function(a,c,b){a=a.options;var d,f,e,g;b.beginPath();for(f=0;f<c.length;f++){d=c[f];var k=d.parts;if(d.render.visible)if(a.showAxes)for(e=1<k.length?1:0;e<k.length;e++)for(d=k[e],g=0;g<d.axes.length;g++){var h=d.axes[g];b.moveTo(d.position.x,d.position.y);b.lineTo(d.position.x+20*h.x,d.position.y+20*h.y)}else for(e=1<k.length?1:0;e<k.length;e++)for(d=k[e],g=0;g<d.axes.length;g++)b.moveTo(d.position.x,d.position.y),b.lineTo((d.vertices[0].x+d.vertices[d.vertices.length-1].x)/2,(d.vertices[0].y+d.vertices[d.vertices.length-1].y)/2)}a.wireframes?(b.strokeStyle="indianred",b.lineWidth=1):(b.strokeStyle="rgba(255, 255, 255, 0.4)",b.globalCompositeOperation="overlay",b.lineWidth=2);b.stroke();b.globalCompositeOperation="source-over"};a.bodyPositions=function(a,c,b){a=a.options;var d,f,e,g;b.beginPath();for(e=0;e<c.length;e++)if(d=c[e],d.render.visible)for(g=0;g<d.parts.length;g++)f=d.parts[g],b.arc(f.position.x,f.position.y,3,0,2*Math.PI,!1),b.closePath();b.fillStyle=a.wireframes?"indianred":"rgba(0,0,0,0.5)";b.fill();b.beginPath();for(e=0;e<c.length;e++)d=c[e],d.render.visible&&(b.arc(d.positionPrev.x,d.positionPrev.y,2,0,2*Math.PI,!1),b.closePath());b.fillStyle="rgba(255,165,0,0.8)";b.fill()};a.bodyVelocity=function(a,c,b){b.beginPath();for(a=0;a<c.length;a++){var d=c[a];d.render.visible&&(b.moveTo(d.position.x,d.position.y),b.lineTo(d.position.x+2*(d.position.x-d.positionPrev.x),d.position.y+2*(d.position.y-d.positionPrev.y)))}b.lineWidth=3;b.strokeStyle="cornflowerblue";b.stroke()};a.bodyIds=function(a,c,b){var d;for(a=0;a<c.length;a++)if(c[a].render.visible){var f=c[a].parts;for(d=1<f.length?1:0;d<f.length;d++){var e=f[d];b.font="12px Arial";b.fillStyle="rgba(255,255,255,0.5)";b.fillText(e.id,e.position.x+10,e.position.y-10)}}};a.collisions=function(a,c,b){a=a.options;var d,f,e;b.beginPath();for(e=0;e<c.length;e++)if(d=c[e],d.isActive)for(f=0;f<d.activeContacts.length;f++){var g=d.activeContacts[f].vertex;b.rect(g.x-1.5,g.y-1.5,3.5,3.5)}b.fillStyle=a.wireframes?"rgba(255,255,255,0.7)":"orange";b.fill();b.beginPath();for(e=0;e<c.length;e++)if(d=c[e],d.isActive&&(f=d.collision,0<d.activeContacts.length)){var g=d.activeContacts[0].vertex.x,k=d.activeContacts[0].vertex.y;2===d.activeContacts.length&&(g=(d.activeContacts[0].vertex.x+d.activeContacts[1].vertex.x)/2,k=(d.activeContacts[0].vertex.y+d.activeContacts[1].vertex.y)/2);f.bodyB===f.supports[0].body||!0===f.bodyA.isStatic?b.moveTo(g-8*f.normal.x,k-8*f.normal.y):b.moveTo(g+8*f.normal.x,k+8*f.normal.y);b.lineTo(g,k)}b.strokeStyle=a.wireframes?"rgba(255,165,0,0.7)":"orange";b.lineWidth=1;b.stroke()};a.separations=function(a,c,b){a=a.options;var d,f,e,g;b.beginPath();for(g=0;g<c.length;g++)if(d=c[g],d.isActive){d=d.collision;f=d.bodyA;e=d.bodyB;var k=1;e.isStatic||f.isStatic||(k=.5);e.isStatic&&(k=0);b.moveTo(e.position.x,e.position.y);b.lineTo(e.position.x-d.penetration.x*k,e.position.y-d.penetration.y*k);k=1;e.isStatic||f.isStatic||(k=.5);f.isStatic&&(k=0);b.moveTo(f.position.x,f.position.y);b.lineTo(f.position.x+d.penetration.x*k,f.position.y+d.penetration.y*k)}b.strokeStyle=a.wireframes?"rgba(255,165,0,0.5)":"orange";b.stroke()};a.grid=function(a,c,b){b.strokeStyle=a.options.wireframes?"rgba(255,180,0,0.1)":"rgba(255,180,0,0.5)";b.beginPath();a=e.keys(c.buckets);for(var d=0;d<a.length;d++){var f=a[d];2>c.buckets[f].length||(f=f.split(/C|R/),b.rect(.5+parseInt(f[1],10)*c.bucketWidth,.5+parseInt(f[2],10)*c.bucketHeight,c.bucketWidth,c.bucketHeight))}b.lineWidth=1;b.stroke()};a.inspector=function(a,c){var b=a.selected,d=a.render,f=d.options,e;f.hasBounds&&(c.scale(1/((d.bounds.max.x-d.bounds.min.x)/d.options.width),1/((d.bounds.max.y-d.bounds.min.y)/d.options.height)),c.translate(-d.bounds.min.x,-d.bounds.min.y));for(d=0;d<b.length;d++){e=b[d].data;c.translate(.5,.5);c.lineWidth=1;c.strokeStyle="rgba(255,165,0,0.9)";c.setLineDash([1,2]);switch(e.type){case "body":e=e.bounds;c.beginPath();c.rect(Math.floor(e.min.x-3),Math.floor(e.min.y-3),Math.floor(e.max.x-e.min.x+6),Math.floor(e.max.y-e.min.y+6));c.closePath();c.stroke();break;case "constraint":var g=e.pointA;e.bodyA&&(g=e.pointB);c.beginPath();c.arc(g.x,g.y,10,0,2*Math.PI);c.closePath();c.stroke()}c.setLineDash([]);c.translate(-.5,-.5)}null!==a.selectStart&&(c.translate(.5,.5),c.lineWidth=1,c.strokeStyle="rgba(255,165,0,0.6)",c.fillStyle="rgba(255,165,0,0.1)",e=a.selectBounds,c.beginPath(),c.rect(Math.floor(e.min.x),Math.floor(e.min.y),Math.floor(e.max.x-e.min.x),Math.floor(e.max.y-e.min.y)),c.closePath(),c.stroke(),c.fill(),c.translate(-.5,-.5));f.hasBounds&&c.setTransform(1,0,0,1,0,0)};var f=function(a,c){var b=document.createElement("canvas");b.width=a;b.height=c;b.oncontextmenu=function(){return!1};b.onselectstart=function(){return!1};return b}})()},{"../body/Composite":2,"../collision/Grid":6,"../core/Common":14,"../core/Events":16,"../core/Mouse":19,"../geometry/Bounds":26,"../geometry/Vector":28}],32:[function(n,q,w){var a={};q.exports=a;var e=n("../geometry/Bounds"),d=n("../body/Composite"),b=n("../core/Common"),h=n("../core/Events"),l=n("../geometry/Vector");(function(){var g,c;"undefined"!==typeof window&&(g=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(function(){a(b.now())},1E3/60)},c=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame);a.create=function(c){b.warn("RenderPixi.create: Matter.RenderPixi is deprecated (see docs)");var d=b.extend({controller:a,engine:null,element:null,frameRequestId:null,canvas:null,renderer:null,container:null,spriteContainer:null,pixiOptions:null,options:{width:800,height:600,background:"#fafafa",wireframeBackground:"#222",hasBounds:!1,enabled:!0,wireframes:!0,showSleeping:!0,showDebug:!1,showBroadphase:!1,showBounds:!1,showVelocity:!1,showCollisions:!1,showAxes:!1,showPositions:!1,showAngleIndicator:!1,showIds:!1,showShadows:!1}},c),e=!d.options.wireframes&&"transparent"===d.options.background;d.pixiOptions=d.pixiOptions||{view:d.canvas,transparent:e,antialias:!0,backgroundColor:c.background};d.mouse=c.mouse;d.engine=c.engine;d.renderer=d.renderer||new PIXI.WebGLRenderer(d.options.width,d.options.height,d.pixiOptions);d.container=d.container||new PIXI.Container;d.spriteContainer=d.spriteContainer||new PIXI.Container;d.canvas=d.canvas||d.renderer.view;d.bounds=d.bounds||{min:{x:0,y:0},max:{x:d.options.width,y:d.options.height}};h.on(d.engine,"beforeUpdate",function(){a.clear(d)});d.textures={};d.sprites={};d.primitives={};d.container.addChild(d.spriteContainer);b.isElement(d.element)?d.element.appendChild(d.canvas):b.warn('No "render.element" passed, "render.canvas" was not inserted into document.');d.canvas.oncontextmenu=function(){return!1};d.canvas.onselectstart=function(){return!1};return d};a.run=function(c){(function r(b){c.frameRequestId=g(r);a.world(c)})()};a.stop=function(a){c(a.frameRequestId)};a.clear=function(a){for(var c=a.container,b=a.spriteContainer;c.children[0];)c.removeChild(c.children[0]);for(;b.children[0];)b.removeChild(b.children[0]);b=a.sprites["bg-0"];a.textures={};a.sprites={};a.primitives={};(a.sprites["bg-0"]=b)&&c.addChildAt(b,0);a.container.addChild(a.spriteContainer);a.currentBackground=null;c.scale.set(1,1);c.position.set(0,0)};a.setBackground=function(a,c){if(a.currentBackground!==c){var d=c.indexOf&&-1!==c.indexOf("#"),f=a.sprites["bg-0"];d?(d=b.colorToNumber(c),a.renderer.backgroundColor=d,f&&a.container.removeChild(f)):f||(f=m(a,c),f=a.sprites["bg-0"]=new PIXI.Sprite(f),f.position.x=0,f.position.y=0,a.container.addChildAt(f,0));a.currentBackground=c}};a.world=function(c){var b=c.engine.world,g=c.renderer,h=c.container,m=c.options,k=d.allBodies(b),b=d.allConstraints(b),z=[];m.wireframes?a.setBackground(c,m.wireframeBackground):a.setBackground(c,m.background);var n=(c.bounds.max.x-c.bounds.min.x)/c.options.width,q=(c.bounds.max.y-c.bounds.min.y)/c.options.height;if(m.hasBounds){for(m=0;m<k.length;m++){var v=k[m];v.render.sprite.visible=e.overlaps(v.bounds,c.bounds)}for(m=0;m<b.length;m++){var v=b[m],A=v.bodyA,y=v.bodyB,w=v.pointA,C=v.pointB;A&&(w=l.add(A.position,v.pointA));y&&(C=l.add(y.position,v.pointB));w&&C&&(e.contains(c.bounds,w)||e.contains(c.bounds,C))&&z.push(v)}h.scale.set(1/n,1/q);h.position.set(1/n*-c.bounds.min.x,1/q*-c.bounds.min.y)}else z=b;for(m=0;m<k.length;m++)a.body(c,k[m]);for(m=0;m<z.length;m++)a.constraint(c,z[m]);g.render(h)};a.constraint=function(a,c){var d=c.bodyA,f=c.bodyB,e=c.pointA,g=c.pointB,m=a.container,h=c.render,k="c-"+c.id,l=a.primitives[k];l||(l=a.primitives[k]=new PIXI.Graphics);h.visible&&c.pointA&&c.pointB?(-1===b.indexOf(m.children,l)&&m.addChild(l),l.clear(),l.beginFill(0,0),l.lineStyle(h.lineWidth,b.colorToNumber(h.strokeStyle),1),d?l.moveTo(d.position.x+e.x,d.position.y+e.y):l.moveTo(e.x,e.y),f?l.lineTo(f.position.x+g.x,f.position.y+g.y):l.lineTo(g.x,g.y),l.endFill()):l.clear()};a.body=function(a,c){var d=c.render;if(d.visible)if(d.sprite&&d.sprite.texture){var f="b-"+c.id,e=a.sprites[f],g=a.spriteContainer;if(!e){var e=a.sprites,h=m(a,c.render.sprite.texture),h=new PIXI.Sprite(h);h.anchor.x=c.render.sprite.xOffset;h.anchor.y=c.render.sprite.yOffset;e=e[f]=h}-1===b.indexOf(g.children,e)&&g.addChild(e);e.position.x=c.position.x;e.position.y=c.position.y;e.rotation=c.angle;e.scale.x=d.sprite.xScale||1;e.scale.y=d.sprite.yScale||1}else{d="b-"+c.id;g=a.primitives[d];f=a.container;if(!g){var g=a.primitives,e=c.render,h=a.options,k=new PIXI.Graphics,l=b.colorToNumber(e.fillStyle),n=b.colorToNumber(e.strokeStyle),q=b.colorToNumber(e.strokeStyle),y=b.colorToNumber("#bbb"),w=b.colorToNumber("#CD5C5C"),C;k.clear();for(var D=1<c.parts.length?1:0;D<c.parts.length;D++){C=c.parts[D];h.wireframes?(k.beginFill(0,0),k.lineStyle(1,y,1)):(k.beginFill(l,1),k.lineStyle(e.lineWidth,n,1));k.moveTo(C.vertices[0].x-c.position.x,C.vertices[0].y-c.position.y);for(var E=1;E<C.vertices.length;E++)k.lineTo(C.vertices[E].x-c.position.x,C.vertices[E].y-c.position.y);k.lineTo(C.vertices[0].x-c.position.x,C.vertices[0].y-c.position.y);k.endFill();if(h.showAngleIndicator||h.showAxes)k.beginFill(0,0),h.wireframes?k.lineStyle(1,w,1):k.lineStyle(1,q),k.moveTo(C.position.x-c.position.x,C.position.y-c.position.y),k.lineTo((C.vertices[0].x+C.vertices[C.vertices.length-1].x)/2-c.position.x,(C.vertices[0].y+C.vertices[C.vertices.length-1].y)/2-c.position.y),k.endFill()}g=g[d]=k;g.initialAngle=c.angle}-1===b.indexOf(f.children,g)&&f.addChild(g);g.position.x=c.position.x;g.position.y=c.position.y;g.rotation=c.angle-g.initialAngle}};var m=function(a,c){var b=a.textures[c];b||(b=a.textures[c]=PIXI.Texture.fromImage(c));return b}})()},{"../body/Composite":2,"../core/Common":14,"../core/Events":16,"../geometry/Bounds":26,"../geometry/Vector":28}]},{},[30])(30)});!function(N){"object"==typeof exports&&"undefined"!=typeof module?module.exports=N():"function"==typeof define&&define.amd?define([],N):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Matter=N()}(function(){return function n(q,w,a){function e(b,l){if(!w[b]){if(!q[b]){var g="function"==typeof require&&require;if(!l&&g)return g(b,!0);if(d)return d(b,!0);g=Error("Cannot find module '"+b+"'");throw g.code="MODULE_NOT_FOUND",g;}g=w[b]={exports:{}};q[b][0].call(g.exports,function(a){var c=q[b][1][a];return e(c?c:a)},g,g.exports,n,q,w,a)}return w[b].exports}for(var d="function"==typeof require&&require,b=0;b<a.length;b++)e(a[b]);return e}({1:[function(n,q,w){var a={};q.exports=a;var e=n("../geometry/Vertices"),d=n("../geometry/Vector"),b=n("../core/Sleeping"),h=(n("../render/Render"),n("../core/Common")),l=n("../geometry/Bounds"),g=n("../geometry/Axes");!function(){a._inertiaScale=4;a._nextCollidingGroupId=1;a._nextNonCollidingGroupId=-1;a._nextCategory=1;a.create=function(c){var b={id:h.nextId(),type:"body",label:"Body",parts:[],plugin:{},angle:0,vertices:e.fromPath("L 0 0 L 40 0 L 40 40 L 0 40"),position:{x:0,y:0},force:{x:0,y:0},torque:0,positionImpulse:{x:0,y:0},constraintImpulse:{x:0,y:0,angle:0},totalContacts:0,speed:0,angularSpeed:0,velocity:{x:0,y:0},angularVelocity:0,isSensor:!1,isStatic:!1,isSleeping:!1,motion:0,sleepThreshold:60,density:.001,restitution:0,friction:.1,frictionStatic:.5,frictionAir:.01,collisionFilter:{category:1,mask:4294967295,group:0},slop:.05,timeScale:1,render:{visible:!0,opacity:1,sprite:{xScale:1,yScale:1,xOffset:0,yOffset:0},lineWidth:0}},b=h.extend(b,c);c=c||{};a.set(b,{bounds:b.bounds||l.create(b.vertices),positionPrev:b.positionPrev||d.clone(b.position),anglePrev:b.anglePrev||b.angle,vertices:b.vertices,parts:b.parts||[b],isStatic:b.isStatic,isSleeping:b.isSleeping,parent:b.parent||b});e.rotate(b.vertices,b.angle,b.position);g.rotate(b.axes,b.angle);l.update(b.bounds,b.vertices,b.velocity);a.set(b,{axes:c.axes||b.axes,area:c.area||b.area,mass:c.mass||b.mass,inertia:c.inertia||b.inertia});c=b.isStatic?"#2e2b44":h.choose(["#006BA6","#0496FF","#FFBC42","#D81159","#8F2D56"]);b.render.fillStyle=b.render.fillStyle||c;b.render.strokeStyle=b.render.strokeStyle||"#000";b.render.sprite.xOffset+=-(b.bounds.min.x-b.position.x)/(b.bounds.max.x-b.bounds.min.x);b.render.sprite.yOffset+=-(b.bounds.min.y-b.position.y)/(b.bounds.max.y-b.bounds.min.y);return b};a.nextGroup=function(c){return c?a._nextNonCollidingGroupId--:a._nextCollidingGroupId++};a.nextCategory=function(){return a._nextCategory<<=1,a._nextCategory};a.set=function(c,d,e){var f;"string"==typeof d&&(f=d,d={},d[f]=e);for(f in d)if(e=d[f],d.hasOwnProperty(f))switch(f){case "isStatic":a.setStatic(c,e);break;case "isSleeping":b.set(c,e);break;case "mass":a.setMass(c,e);break;case "density":a.setDensity(c,e);break;case "inertia":a.setInertia(c,e);break;case "vertices":a.setVertices(c,e);break;case "position":a.setPosition(c,e);break;case "angle":a.setAngle(c,e);break;case "velocity":a.setVelocity(c,e);break;case "angularVelocity":a.setAngularVelocity(c,e);break;case "parts":a.setParts(c,e);break;default:c[f]=e}};a.setStatic=function(a,b){for(var c=0;c<a.parts.length;c++){var d=a.parts[c];(d.isStatic=b)?(d._original={restitution:d.restitution,friction:d.friction,mass:d.mass,inertia:d.inertia,density:d.density,inverseMass:d.inverseMass,inverseInertia:d.inverseInertia},d.restitution=0,d.friction=1,d.mass=d.inertia=d.density=1/0,d.inverseMass=d.inverseInertia=0,d.positionPrev.x=d.position.x,d.positionPrev.y=d.position.y,d.anglePrev=d.angle,d.angularVelocity=0,d.speed=0,d.angularSpeed=0,d.motion=0):d._original&&(d.restitution=d._original.restitution,d.friction=d._original.friction,d.mass=d._original.mass,d.inertia=d._original.inertia,d.density=d._original.density,d.inverseMass=d._original.inverseMass,d.inverseInertia=d._original.inverseInertia,delete d._original)}};a.setMass=function(a,b){a.inertia=a.inertia/(a.mass/6)*(b/6);a.inverseInertia=1/a.inertia;a.mass=b;a.inverseMass=1/a.mass;a.density=a.mass/a.area};a.setDensity=function(c,b){a.setMass(c,b*c.area);c.density=b};a.setInertia=function(a,b){a.inertia=b;a.inverseInertia=1/a.inertia};a.setVertices=function(c,b){b[0].body===c?c.vertices=b:c.vertices=e.create(b,c);c.axes=g.fromVertices(c.vertices);c.area=e.area(c.vertices);a.setMass(c,c.density*c.area);var d=e.centre(c.vertices);e.translate(c.vertices,d,-1);a.setInertia(c,a._inertiaScale*e.inertia(c.vertices,c.mass));e.translate(c.vertices,c.position);l.update(c.bounds,c.vertices,c.velocity)};a.setParts=function(c,b,d){var f;b=b.slice(0);c.parts.length=0;c.parts.push(c);c.parent=c;for(f=0;f<b.length;f++){var g=b[f];g!==c&&(g.parent=c,c.parts.push(g))}if(1!==c.parts.length){if("undefined"==typeof d||d){d=[];for(f=0;f<b.length;f++)d=d.concat(b[f].vertices);e.clockwiseSort(d);b=e.hull(d);f=e.centre(b);a.setVertices(c,b);e.translate(c.vertices,f)}b=a._totalProperties(c);c.area=b.area;c.parent=c;c.position.x=b.centre.x;c.position.y=b.centre.y;c.positionPrev.x=b.centre.x;c.positionPrev.y=b.centre.y;a.setMass(c,b.mass);a.setInertia(c,b.inertia);a.setPosition(c,b.centre)}};a.setPosition=function(a,b){var c=d.sub(b,a.position);a.positionPrev.x+=c.x;a.positionPrev.y+=c.y;for(var f=0;f<a.parts.length;f++){var g=a.parts[f];g.position.x+=c.x;g.position.y+=c.y;e.translate(g.vertices,c);l.update(g.bounds,g.vertices,a.velocity)}};a.setAngle=function(a,b){var c=b-a.angle;a.anglePrev+=c;for(var f=0;f<a.parts.length;f++){var h=a.parts[f];h.angle+=c;e.rotate(h.vertices,c,a.position);g.rotate(h.axes,c);l.update(h.bounds,h.vertices,a.velocity);0<f&&d.rotateAbout(h.position,c,a.position,h.position)}};a.setVelocity=function(a,b){a.positionPrev.x=a.position.x-b.x;a.positionPrev.y=a.position.y-b.y;a.velocity.x=b.x;a.velocity.y=b.y;a.speed=d.magnitude(a.velocity)};a.setAngularVelocity=function(a,b){a.anglePrev=a.angle-b;a.angularVelocity=b;a.angularSpeed=Math.abs(a.angularVelocity)};a.translate=function(b,e){a.setPosition(b,d.add(b.position,e))};a.rotate=function(b,d,e){if(e){var c=Math.cos(d),g=Math.sin(d),h=b.position.x-e.x,k=b.position.y-e.y;a.setPosition(b,{x:e.x+(h*c-k*g),y:e.y+(h*g+k*c)})}a.setAngle(b,b.angle+d)};a.scale=function(b,d,h,f){var c=0,k=0;f=f||b.position;for(var m=0;m<b.parts.length;m++){var t=b.parts[m];e.scale(t.vertices,d,h,f);t.axes=g.fromVertices(t.vertices);t.area=e.area(t.vertices);a.setMass(t,b.density*t.area);e.translate(t.vertices,{x:-t.position.x,y:-t.position.y});a.setInertia(t,a._inertiaScale*e.inertia(t.vertices,t.mass));e.translate(t.vertices,{x:t.position.x,y:t.position.y});0<m&&(c+=t.area,k+=t.inertia);t.position.x=f.x+(t.position.x-f.x)*d;t.position.y=f.y+(t.position.y-f.y)*h;l.update(t.bounds,t.vertices,b.velocity)}1<b.parts.length&&(b.area=c,b.isStatic||(a.setMass(b,b.density*c),a.setInertia(b,k)));b.circleRadius&&(d===h?b.circleRadius*=d:b.circleRadius=null)};a.update=function(a,b,h,f){b=Math.pow(b*h*a.timeScale,2);h=1-a.frictionAir*h*a.timeScale;var c=a.position.y-a.positionPrev.y;a.velocity.x=(a.position.x-a.positionPrev.x)*h*f+a.force.x/a.mass*b;a.velocity.y=c*h*f+a.force.y/a.mass*b;a.positionPrev.x=a.position.x;a.positionPrev.y=a.position.y;a.position.x+=a.velocity.x;a.position.y+=a.velocity.y;a.angularVelocity=(a.angle-a.anglePrev)*h*f+a.torque/a.inertia*b;a.anglePrev=a.angle;a.angle+=a.angularVelocity;a.speed=d.magnitude(a.velocity);a.angularSpeed=Math.abs(a.angularVelocity);for(f=0;f<a.parts.length;f++)b=a.parts[f],e.translate(b.vertices,a.velocity),0<f&&(b.position.x+=a.velocity.x,b.position.y+=a.velocity.y),0!==a.angularVelocity&&(e.rotate(b.vertices,a.angularVelocity,a.position),g.rotate(b.axes,a.angularVelocity),0<f&&d.rotateAbout(b.position,a.angularVelocity,a.position,b.position)),l.update(b.bounds,b.vertices,a.velocity)};a.applyForce=function(a,b,d){a.force.x+=d.x;a.force.y+=d.y;a.torque+=(b.x-a.position.x)*d.y-(b.y-a.position.y)*d.x};a._totalProperties=function(a){for(var b={mass:0,area:0,inertia:0,centre:{x:0,y:0}},c=1===a.parts.length?0:1;c<a.parts.length;c++){var f=a.parts[c],e=f.mass!==1/0?f.mass:1;b.mass+=e;b.area+=f.area;b.inertia+=f.inertia;b.centre=d.add(b.centre,d.mult(f.position,e))}return b.centre=d.div(b.centre,b.mass),b}}()},{"../core/Common":14,"../core/Sleeping":22,"../geometry/Axes":25,"../geometry/Bounds":26,"../geometry/Vector":28,"../geometry/Vertices":29,"../render/Render":31}],2:[function(n,q,w){var a={};q.exports=a;var e=n("../core/Events"),d=n("../core/Common"),b=n("./Body");!function(){a.create=function(a){return d.extend({id:d.nextId(),type:"composite",parent:null,isModified:!1,bodies:[],constraints:[],composites:[],label:"Composite",plugin:{}},a)};a.setModified=function(b,d,e,c){if(b.isModified=d,e&&b.parent&&a.setModified(b.parent,d,e,c),c)for(var g=0;g<b.composites.length;g++)a.setModified(b.composites[g],d,e,c)};a.add=function(b,l){var g=[].concat(l);e.trigger(b,"beforeAdd",{object:l});for(var c=0;c<g.length;c++){var h=g[c];switch(h.type){case "body":if(h.parent!==h){d.warn("Composite.add: skipped adding a compound body part (you must add its parent instead)");break}a.addBody(b,h);break;case "constraint":a.addConstraint(b,h);break;case "composite":a.addComposite(b,h);break;case "mouseConstraint":a.addConstraint(b,h.constraint)}}return e.trigger(b,"afterAdd",{object:l}),b};a.remove=function(b,d,g){var c=[].concat(d);e.trigger(b,"beforeRemove",{object:d});for(var h=0;h<c.length;h++){var k=c[h];switch(k.type){case "body":a.removeBody(b,k,g);break;case "constraint":a.removeConstraint(b,k,g);break;case "composite":a.removeComposite(b,k,g);break;case "mouseConstraint":a.removeConstraint(b,k.constraint)}}return e.trigger(b,"afterRemove",{object:d}),b};a.addComposite=function(b,d){return b.composites.push(d),d.parent=b,a.setModified(b,!0,!0,!1),b};a.removeComposite=function(b,e,g){var c=d.indexOf(b.composites,e);if(-1!==c&&(a.removeCompositeAt(b,c),a.setModified(b,!0,!0,!1)),g)for(g=0;g<b.composites.length;g++)a.removeComposite(b.composites[g],e,!0);return b};a.removeCompositeAt=function(b,d){return b.composites.splice(d,1),a.setModified(b,!0,!0,!1),b};a.addBody=function(b,d){return b.bodies.push(d),a.setModified(b,!0,!0,!1),b};a.removeBody=function(b,e,g){var c=d.indexOf(b.bodies,e);if(-1!==c&&(a.removeBodyAt(b,c),a.setModified(b,!0,!0,!1)),g)for(g=0;g<b.composites.length;g++)a.removeBody(b.composites[g],e,!0);return b};a.removeBodyAt=function(b,d){return b.bodies.splice(d,1),a.setModified(b,!0,!0,!1),b};a.addConstraint=function(b,d){return b.constraints.push(d),a.setModified(b,!0,!0,!1),b};a.removeConstraint=function(b,e,g){var c=d.indexOf(b.constraints,e);if(-1!==c&&a.removeConstraintAt(b,c),g)for(g=0;g<b.composites.length;g++)a.removeConstraint(b.composites[g],e,!0);return b};a.removeConstraintAt=function(b,d){return b.constraints.splice(d,1),a.setModified(b,!0,!0,!1),b};a.clear=function(b,d,e){if(e)for(e=0;e<b.composites.length;e++)a.clear(b.composites[e],d,!0);return d?b.bodies=b.bodies.filter(function(a){return a.isStatic}):b.bodies.length=0,b.constraints.length=0,b.composites.length=0,a.setModified(b,!0,!0,!1),b};a.allBodies=function(b){for(var d=[].concat(b.bodies),e=0;e<b.composites.length;e++)d=d.concat(a.allBodies(b.composites[e]));return d};a.allConstraints=function(b){for(var d=[].concat(b.constraints),e=0;e<b.composites.length;e++)d=d.concat(a.allConstraints(b.composites[e]));return d};a.allComposites=function(b){for(var d=[].concat(b.composites),e=0;e<b.composites.length;e++)d=d.concat(a.allComposites(b.composites[e]));return d};a.get=function(b,d,e){var c,g;switch(e){case "body":c=a.allBodies(b);break;case "constraint":c=a.allConstraints(b);break;case "composite":c=a.allComposites(b).concat(b)}return c?(g=c.filter(function(a){return a.id.toString()===d.toString()}),0===g.length?null:g[0]):null};a.move=function(b,d,e){return a.remove(b,d),a.add(e,d),b};a.rebase=function(b){for(var e=a.allBodies(b).concat(a.allConstraints(b)).concat(a.allComposites(b)),g=0;g<e.length;g++)e[g].id=d.nextId();return a.setModified(b,!0,!0,!1),b};a.translate=function(d,e,g){g=g?a.allBodies(d):d.bodies;for(var c=0;c<g.length;c++)b.translate(g[c],e);return a.setModified(d,!0,!0,!1),d};a.rotate=function(d,e,g,c){var h=Math.cos(e),k=Math.sin(e);c=c?a.allBodies(d):d.bodies;for(var f=0;f<c.length;f++){var r=c[f],l=r.position.x-g.x,p=r.position.y-g.y;b.setPosition(r,{x:g.x+(l*h-p*k),y:g.y+(l*k+p*h)});b.rotate(r,e)}return a.setModified(d,!0,!0,!1),d};a.scale=function(d,e,g,c,m){m=m?a.allBodies(d):d.bodies;for(var k=0;k<m.length;k++){var f=m[k];b.setPosition(f,{x:c.x+(f.position.x-c.x)*e,y:c.y+(f.position.y-c.y)*g});b.scale(f,e,g)}return a.setModified(d,!0,!0,!1),d};a.bounds=function(a){a=Matter.Composite.allBodies(a);for(var b=[],d=0;d<a.length;d+=1){var c=a[d];b.push(c.bounds.min,c.bounds.max)}return Matter.Bounds.create(b)}}()},{"../core/Common":14,"../core/Events":16,"./Body":1}],3:[function(n,q,w){var a={};q.exports=a;var e=n("./Composite"),d=(n("../constraint/Constraint"),n("../core/Common"));!function(){a.create=function(a){var b=e.create();return d.extend(b,{label:"World",gravity:{x:0,y:1,scale:.001},bounds:{min:{x:-(1/0),y:-(1/0)},max:{x:1/0,y:1/0}}},a)}}()},{"../constraint/Constraint":12,"../core/Common":14,"./Composite":2}],4:[function(n,q,w){var a={};q.exports=a;(function(){a.create=function(e){return{id:a.id(e),vertex:e,normalImpulse:0,tangentImpulse:0}};a.id=function(a){return a.body.id+"_"+a.index}})()},{}],5:[function(n,q,w){var a={};q.exports=a;var e=n("./SAT"),d=n("./Pair"),b=n("../geometry/Bounds");!function(){a.collisions=function(h,l){for(var g=[],c=l.pairs.table,m=0;m<h.length;m++){var k=h[m][0],f=h[m][1];if((!k.isStatic&&!k.isSleeping||!f.isStatic&&!f.isSleeping)&&a.canCollide(k.collisionFilter,f.collisionFilter)&&b.overlaps(k.bounds,f.bounds))for(var r=1<k.parts.length?1:0;r<k.parts.length;r++)for(var u=k.parts[r],p=1<f.parts.length?1:0;p<f.parts.length;p++){var t=f.parts[p];if(u===k&&t===f||b.overlaps(u.bounds,t.bounds)){var z=d.id(u,t),z=c[z],t=e.collides(u,t,z&&z.isActive?z.collision:null);t.collided&&g.push(t)}}}return g};a.canCollide=function(a,b){return a.group===b.group&&0!==a.group?0<a.group:0!==(a.mask&b.category)&&0!==(b.mask&a.category)}}()},{"../geometry/Bounds":26,"./Pair":7,"./SAT":11}],6:[function(n,q,w){var a={};q.exports=a;var e=n("./Pair"),d=n("./Detector"),b=n("../core/Common");!function(){a.create=function(e){return b.extend({controller:a,detector:d.collisions,buckets:{},pairs:{},pairsList:[],bucketWidth:48,bucketHeight:48},e)};a.update=function(b,d,e,c){var g,k,f,h,l=e.world,p=b.buckets;g=!1;for(e=0;e<d.length;e++){var t=d[e];if(!(t.isSleeping&&!c||t.bounds.max.x<l.bounds.min.x||t.bounds.min.x>l.bounds.max.x||t.bounds.max.y<l.bounds.min.y||t.bounds.min.y>l.bounds.max.y)){var z=a._getRegion(b,t);if(!t.region||z.id!==t.region.id||c){t.region&&!c||(t.region=z);var n=a._regionUnion(z,t.region);for(g=n.startCol;g<=n.endCol;g++)for(k=n.startRow;k<=n.endRow;k++){h=a._getBucketId(g,k);f=p[h];var q=g>=z.startCol&&g<=z.endCol&&k>=z.startRow&&k<=z.endRow,v=g>=t.region.startCol&&g<=t.region.endCol&&k>=t.region.startRow&&k<=t.region.endRow;!q&&v&&v&&f&&a._bucketRemoveBody(b,f,t);(t.region===z||q&&!v||c)&&(f||(f=a._createBucket(p,h)),a._bucketAddBody(b,f,t))}t.region=z;g=!0}}}g&&(b.pairsList=a._createActivePairsList(b))};a.clear=function(a){a.buckets={};a.pairs={};a.pairsList=[]};a._regionUnion=function(b,d){return a._createRegion(Math.min(b.startCol,d.startCol),Math.max(b.endCol,d.endCol),Math.min(b.startRow,d.startRow),Math.max(b.endRow,d.endRow))};a._getRegion=function(b,d){var e=d.bounds;return a._createRegion(Math.floor(e.min.x/b.bucketWidth),Math.floor(e.max.x/b.bucketWidth),Math.floor(e.min.y/b.bucketHeight),Math.floor(e.max.y/b.bucketHeight))};a._createRegion=function(a,b,d,c){return{id:a+","+b+","+d+","+c,startCol:a,endCol:b,startRow:d,endRow:c}};a._getBucketId=function(a,b){return"C"+a+"R"+b};a._createBucket=function(a,b){return a[b]=[]};a._bucketAddBody=function(a,b,d){for(var c=0;c<b.length;c++){var g=b[c];if(!(d.id===g.id||d.isStatic&&g.isStatic)){var k=e.id(d,g),f=a.pairs[k];f?f[2]+=1:a.pairs[k]=[d,g,1]}}b.push(d)};a._bucketRemoveBody=function(a,d,g){d.splice(b.indexOf(d,g),1);for(var c=0;c<d.length;c++){var h=e.id(g,d[c]);(h=a.pairs[h])&&--h[2]}};a._createActivePairsList=function(a){var d,e,c=[];d=b.keys(a.pairs);for(var h=0;h<d.length;h++)e=a.pairs[d[h]],0<e[2]?c.push(e):delete a.pairs[d[h]];return c}}()},{"../core/Common":14,"./Detector":5,"./Pair":7}],7:[function(n,q,w){var a={};q.exports=a;var e=n("./Contact");!function(){a.create=function(d,b){var e=d.bodyA,l=d.bodyB,g=d.parentA,c=d.parentB,e={id:a.id(e,l),bodyA:e,bodyB:l,contacts:{},activeContacts:[],separation:0,isActive:!0,isSensor:e.isSensor||l.isSensor,timeCreated:b,timeUpdated:b,inverseMass:g.inverseMass+c.inverseMass,friction:Math.min(g.friction,c.friction),frictionStatic:Math.max(g.frictionStatic,c.frictionStatic),restitution:Math.max(g.restitution,c.restitution),slop:Math.max(g.slop,c.slop)};return a.update(e,d,b),e};a.update=function(d,b,h){var l=d.contacts,g=b.supports,c=d.activeContacts,m=b.parentA,k=b.parentB;if(d.collision=b,d.inverseMass=m.inverseMass+k.inverseMass,d.friction=Math.min(m.friction,k.friction),d.frictionStatic=Math.max(m.frictionStatic,k.frictionStatic),d.restitution=Math.max(m.restitution,k.restitution),d.slop=Math.max(m.slop,k.slop),c.length=0,b.collided){for(m=0;m<g.length;m++){var k=g[m],f=e.id(k),r=l[f];r?c.push(r):c.push(l[f]=e.create(k))}d.separation=b.depth;a.setActive(d,!0,h)}else!0===d.isActive&&a.setActive(d,!1,h)};a.setActive=function(a,b,e){b?(a.isActive=!0,a.timeUpdated=e):(a.isActive=!1,a.activeContacts.length=0)};a.id=function(a,b){return a.id<b.id?"A"+a.id+"B"+b.id:"A"+b.id+"B"+a.id}}()},{"./Contact":4}],8:[function(n,q,w){var a={};q.exports=a;var e=n("./Pair"),d=n("../core/Common");!function(){a._pairMaxIdleLife=1E3;a.create=function(a){return d.extend({table:{},list:[],collisionStart:[],collisionActive:[],collisionEnd:[]},a)};a.update=function(a,h,l){var b,c,m,k=a.list,f=a.table,r=a.collisionStart,u=a.collisionEnd,p=a.collisionActive,t=[];r.length=0;u.length=0;for(m=p.length=0;m<h.length;m++)a=h[m],a.collided&&(b=e.id(a.bodyA,a.bodyB),t.push(b),c=f[b],c?(c.isActive?p.push(c):r.push(c),e.update(c,a,l)):(c=e.create(a,l),f[b]=c,r.push(c),k.push(c)));for(m=0;m<k.length;m++)c=k[m],c.isActive&&-1===d.indexOf(t,c.id)&&(e.setActive(c,!1,l),u.push(c))};a.removeOld=function(b,d){var e,g,c,h=b.list,k=b.table,f=[];for(c=0;c<h.length;c++)e=h[c],g=e.collision,g.bodyA.isSleeping||g.bodyB.isSleeping?e.timeUpdated=d:d-e.timeUpdated>a._pairMaxIdleLife&&f.push(c);for(c=0;c<f.length;c++)g=f[c]-c,e=h[g],delete k[e.id],h.splice(g,1)};a.clear=function(a){return a.table={},a.list.length=0,a.collisionStart.length=0,a.collisionActive.length=0,a.collisionEnd.length=0,a}}()},{"../core/Common":14,"./Pair":7}],9:[function(n,q,w){var a={};q.exports=a;var e=n("../geometry/Vector"),d=n("./SAT"),b=n("../geometry/Bounds"),h=n("../factory/Bodies"),l=n("../geometry/Vertices");!function(){a.collides=function(a,c){for(var e=[],g=0;g<c.length;g++){var f=c[g];if(b.overlaps(f.bounds,a.bounds))for(var h=1===f.parts.length?0:1;h<f.parts.length;h++){var l=f.parts[h];if(b.overlaps(l.bounds,a.bounds)&&(l=d.collides(l,a),l.collided)){e.push(l);break}}}return e};a.ray=function(b,c,d,k){k=k||1E-100;var f=e.angle(c,d),g=e.magnitude(e.sub(c,d));c=h.rectangle(.5*(d.x+c.x),.5*(d.y+c.y),g,k,{angle:f});b=a.collides(c,b);for(c=0;c<b.length;c+=1)d=b[c],d.body=d.bodyB=d.bodyA;return b};a.region=function(a,c,d){for(var e=[],f=0;f<a.length;f++){var g=a[f],h=b.overlaps(g.bounds,c);(h&&!d||!h&&d)&&e.push(g)}return e};a.point=function(a,c){for(var d=[],e=0;e<a.length;e++){var f=a[e];if(b.contains(f.bounds,c))for(var g=1===f.parts.length?0:1;g<f.parts.length;g++){var h=f.parts[g];if(b.contains(h.bounds,c)&&l.contains(h.vertices,c)){d.push(f);break}}}return d}}()},{"../factory/Bodies":23,"../geometry/Bounds":26,"../geometry/Vector":28,"../geometry/Vertices":29,"./SAT":11}],10:[function(n,q,w){var a={};q.exports=a;var e=n("../geometry/Vertices"),d=n("../geometry/Vector"),b=n("../core/Common"),h=n("../geometry/Bounds");!function(){a._restingThresh=4;a._restingThreshTangent=6;a._positionDampen=.9;a._positionWarming=.8;a._frictionNormalMultiplier=5;a.preSolvePosition=function(a){var b,c,d;for(b=0;b<a.length;b++)c=a[b],c.isActive&&(d=c.activeContacts.length,c.collision.parentA.totalContacts+=d,c.collision.parentB.totalContacts+=d)};a.solvePosition=function(b,e){var c,g,k,f,h,l,p,t,n,q=d._temp[0],x=d._temp[1],v=d._temp[2],A=d._temp[3];for(c=0;c<b.length;c++)g=b[c],g.isActive&&!g.isSensor&&(k=g.collision,f=k.parentA,h=k.parentB,l=k.normal,p=d.sub(d.add(h.positionImpulse,h.position,q),d.add(f.positionImpulse,d.sub(h.position,k.penetration,x),v),A),g.separation=d.dot(l,p));for(c=0;c<b.length;c++)g=b[c],g.isActive&&!g.isSensor&&(k=g.collision,f=k.parentA,h=k.parentB,l=k.normal,n=(g.separation-g.slop)*e,(f.isStatic||h.isStatic)&&(n*=2),f.isStatic||f.isSleeping||(t=a._positionDampen/f.totalContacts,f.positionImpulse.x+=l.x*n*t,f.positionImpulse.y+=l.y*n*t),h.isStatic||h.isSleeping||(t=a._positionDampen/h.totalContacts,h.positionImpulse.x-=l.x*n*t,h.positionImpulse.y-=l.y*n*t))};a.postSolvePosition=function(b){for(var g=0;g<b.length;g++){var c=b[g];if(c.totalContacts=0,0!==c.positionImpulse.x||0!==c.positionImpulse.y){for(var m=0;m<c.parts.length;m++){var k=c.parts[m];e.translate(k.vertices,c.positionImpulse);h.update(k.bounds,k.vertices,c.velocity);k.position.x+=c.positionImpulse.x;k.position.y+=c.positionImpulse.y}c.positionPrev.x+=c.positionImpulse.x;c.positionPrev.y+=c.positionImpulse.y;0>d.dot(c.positionImpulse,c.velocity)?(c.positionImpulse.x=0,c.positionImpulse.y=0):(c.positionImpulse.x*=a._positionWarming,c.positionImpulse.y*=a._positionWarming)}}};a.preSolveVelocity=function(a){var b,c,e,k,f,h,l,p,t,n,q,x,v=d._temp[0],A=d._temp[1];for(b=0;b<a.length;b++)if(e=a[b],e.isActive&&!e.isSensor)for(k=e.activeContacts,c=e.collision,f=c.parentA,h=c.parentB,l=c.normal,p=c.tangent,c=0;c<k.length;c++)t=k[c],n=t.vertex,q=t.normalImpulse,t=t.tangentImpulse,0===q&&0===t||(v.x=l.x*q+p.x*t,v.y=l.y*q+p.y*t,f.isStatic||f.isSleeping||(x=d.sub(n,f.position,A),f.positionPrev.x+=v.x*f.inverseMass,f.positionPrev.y+=v.y*f.inverseMass,f.anglePrev+=d.cross(x,v)*f.inverseInertia),h.isStatic||h.isSleeping||(x=d.sub(n,h.position,A),h.positionPrev.x-=v.x*h.inverseMass,h.positionPrev.y-=v.y*h.inverseMass,h.anglePrev-=d.cross(x,v)*h.inverseInertia))};a.solveVelocity=function(e,g){for(var c=g*g,h=d._temp[0],k=d._temp[1],f=d._temp[2],r=d._temp[3],l=d._temp[4],p=d._temp[5],t=0;t<e.length;t++){var n=e[t];if(n.isActive&&!n.isSensor){var q=n.collision,x=q.parentA,v=q.parentB,A=q.normal,q=q.tangent,y=n.activeContacts,w=1/y.length;x.velocity.x=x.position.x-x.positionPrev.x;x.velocity.y=x.position.y-x.positionPrev.y;v.velocity.x=v.position.x-v.positionPrev.x;v.velocity.y=v.position.y-v.positionPrev.y;x.angularVelocity=x.angle-x.anglePrev;v.angularVelocity=v.angle-v.anglePrev;for(var C=0;C<y.length;C++){var D=y[C],E=D.vertex,O=d.sub(E,x.position,k),E=d.sub(E,v.position,f),F=d.add(x.velocity,d.mult(d.perp(O),x.angularVelocity),r),H=d.add(v.velocity,d.mult(d.perp(E),v.angularVelocity),l),F=d.sub(F,H,p),G=d.dot(A,F),K=d.dot(q,F),I=Math.abs(K),M=b.sign(K),F=(1+n.restitution)*G,P=b.clamp(n.separation+G,0,1)*a._frictionNormalMultiplier,H=K,L=1/0;I>n.friction*n.frictionStatic*P*c&&(L=I,H=b.clamp(n.friction*M*c,-L,L));I=d.cross(O,A);M=d.cross(E,A);I=w/(x.inverseMass+v.inverseMass+x.inverseInertia*I*I+v.inverseInertia*M*M);(F*=I,H*=I,0>G&&G*G>a._restingThresh*c)?D.normalImpulse=0:(G=D.normalImpulse,D.normalImpulse=Math.min(D.normalImpulse+F,0),F=D.normalImpulse-G);K*K>a._restingThreshTangent*c?D.tangentImpulse=0:(G=D.tangentImpulse,D.tangentImpulse=b.clamp(D.tangentImpulse+H,-L,L),H=D.tangentImpulse-G);h.x=A.x*F+q.x*H;h.y=A.y*F+q.y*H;x.isStatic||x.isSleeping||(x.positionPrev.x+=h.x*x.inverseMass,x.positionPrev.y+=h.y*x.inverseMass,x.anglePrev+=d.cross(O,h)*x.inverseInertia);v.isStatic||v.isSleeping||(v.positionPrev.x-=h.x*v.inverseMass,v.positionPrev.y-=h.y*v.inverseMass,v.anglePrev-=d.cross(E,h)*v.inverseInertia)}}}}}()},{"../core/Common":14,"../geometry/Bounds":26,"../geometry/Vector":28,"../geometry/Vertices":29}],11:[function(n,q,w){var a={};q.exports=a;var e=n("../geometry/Vertices"),d=n("../geometry/Vector");!function(){a.collides=function(b,h,l){var g,c,m,k,f=!1;l?(k=b.parent,f=h.parent,k=k.speed*k.speed+k.angularSpeed*k.angularSpeed+f.speed*f.speed+f.angularSpeed*f.angularSpeed,f=l&&l.collided&&.2>k,k=l):k={collided:!1,bodyA:b,bodyB:h};if(l&&f){if(g=k.axisBody,m=a._overlapAxes(g.vertices,(g===b?h:b).vertices,[g.axes[l.axisNumber]]),k.reused=!0,0>=m.overlap)return k.collided=!1,k}else{if((g=a._overlapAxes(b.vertices,h.vertices,b.axes),0>=g.overlap)||(c=a._overlapAxes(h.vertices,b.vertices,h.axes),0>=c.overlap))return k.collided=!1,k;g.overlap<c.overlap?(m=g,k.axisBody=b):(m=c,k.axisBody=h);k.axisNumber=m.axisNumber}k.bodyA=b.id<h.id?b:h;k.bodyB=b.id<h.id?h:b;k.collided=!0;k.depth=m.overlap;k.parentA=k.bodyA.parent;k.parentB=k.bodyB.parent;b=k.bodyA;h=k.bodyB;0>d.dot(m.axis,d.sub(h.position,b.position))?k.normal={x:m.axis.x,y:m.axis.y}:k.normal={x:-m.axis.x,y:-m.axis.y};k.tangent=d.perp(k.normal);k.penetration=k.penetration||{};k.penetration.x=k.normal.x*k.depth;k.penetration.y=k.normal.y*k.depth;l=a._findSupports(b,h,k.normal);m=[];if(e.contains(b.vertices,l[0])&&m.push(l[0]),e.contains(b.vertices,l[1])&&m.push(l[1]),2>m.length)b=a._findSupports(h,b,d.neg(k.normal)),e.contains(h.vertices,b[0])&&m.push(b[0]),2>m.length&&e.contains(h.vertices,b[1])&&m.push(b[1]);return 1>m.length&&(m=[l[0]]),k.supports=m,k};a._overlapAxes=function(b,e,l){for(var g,c,h=d._temp[0],k=d._temp[1],f={overlap:Number.MAX_VALUE},r=0;r<l.length;r++){if(c=l[r],a._projectToAxis(h,b,c),a._projectToAxis(k,e,c),g=Math.min(h.max-k.min,k.max-h.min),0>=g)return f.overlap=g,f;g<f.overlap&&(f.overlap=g,f.axis=c,f.axisNumber=r)}return f};a._projectToAxis=function(a,e,l){for(var b=d.dot(e[0],l),c=b,h=1;h<e.length;h+=1){var k=d.dot(e[h],l);k>c?c=k:k<b&&(b=k)}a.min=b;a.max=c};a._findSupports=function(a,e,l){var b,c,h,k=Number.MAX_VALUE,f=d._temp[0];e=e.vertices;var r=a.position;for(h=0;h<e.length;h++)a=e[h],f.x=a.x-r.x,f.y=a.y-r.y,b=-d.dot(l,f),b<k&&(k=b,c=a);a=e[0<=c.index-1?c.index-1:e.length-1];f.x=a.x-r.x;f.y=a.y-r.y;k=-d.dot(l,f);h=a;return a=e[(c.index+1)%e.length],f.x=a.x-r.x,f.y=a.y-r.y,b=-d.dot(l,f),b<k&&(h=a),[c,h]}}()},{"../geometry/Vector":28,"../geometry/Vertices":29}],12:[function(n,q,w){var a={};q.exports=a;var e=n("../geometry/Vertices"),d=n("../geometry/Vector"),b=n("../core/Sleeping"),h=n("../geometry/Bounds"),l=n("../geometry/Axes"),g=n("../core/Common");!function(){a._warming=.4;a._torqueDampen=1;a._minLength=1E-6;a.create=function(a){a.bodyA&&!a.pointA&&(a.pointA={x:0,y:0});a.bodyB&&!a.pointB&&(a.pointB={x:0,y:0});var b=a.bodyA?d.add(a.bodyA.position,a.pointA):a.pointA,c=a.bodyB?d.add(a.bodyB.position,a.pointB):a.pointB,b=d.magnitude(d.sub(b,c));a.length="undefined"!=typeof a.length?a.length:b;a.id=a.id||g.nextId();a.label=a.label||"Constraint";a.type="constraint";a.stiffness=a.stiffness||(0<a.length?1:.7);a.damping=a.damping||0;a.angularStiffness=a.angularStiffness||0;a.angleA=a.bodyA?a.bodyA.angle:a.angleA;a.angleB=a.bodyB?a.bodyB.angle:a.angleB;a.plugin={};b={visible:!0,lineWidth:2,strokeStyle:"#ffffff",type:"line",anchors:!0};return 0===a.length&&.1<a.stiffness?(b.type="pin",b.anchors=!1):.9>a.stiffness&&(b.type="spring"),a.render=g.extend(b,a.render),a};a.preSolveAll=function(a){for(var b=0;b<a.length;b+=1){var c=a[b],d=c.constraintImpulse;c.isStatic||0===d.x&&0===d.y&&0===d.angle||(c.position.x+=d.x,c.position.y+=d.y,c.angle+=d.angle)}};a.solveAll=function(b,d){for(var c=0;c<b.length;c+=1){var e=b[c],g=!e.bodyA||e.bodyA&&e.bodyA.isStatic,e=!e.bodyB||e.bodyB&&e.bodyB.isStatic;(g||e)&&a.solve(b[c],d)}for(c=0;c<b.length;c+=1)e=b[c],g=!e.bodyA||e.bodyA&&e.bodyA.isStatic,e=!e.bodyB||e.bodyB&&e.bodyB.isStatic,g||e||a.solve(b[c],d)};a.solve=function(b,e){var c=b.bodyA,f=b.bodyB,g=b.pointA,h=b.pointB;if(c||f){c&&!c.isStatic&&(d.rotate(g,c.angle-b.angleA,g),b.angleA=c.angle);f&&!f.isStatic&&(d.rotate(h,f.angle-b.angleB,h),b.angleB=f.angle);var p=g,m=h;if(c&&(p=d.add(c.position,g)),f&&(m=d.add(f.position,h)),p&&m){var l=d.sub(p,m),n=d.magnitude(l);n<a._minLength&&(n=a._minLength);var q,v,A,y,p=d.mult(l,(n-b.length)/n*(1>b.stiffness?b.stiffness*e:b.stiffness)),m=(c?c.inverseMass:0)+(f?f.inverseMass:0),w=m+((c?c.inverseInertia:0)+(f?f.inverseInertia:0));b.damping&&(y=d.create(),A=d.div(l,n),y=d.sub(f&&d.sub(f.position,f.positionPrev)||y,c&&d.sub(c.position,c.positionPrev)||y),y=d.dot(A,y));c&&!c.isStatic&&(v=c.inverseMass/m,c.constraintImpulse.x-=p.x*v,c.constraintImpulse.y-=p.y*v,c.position.x-=p.x*v,c.position.y-=p.y*v,b.damping&&(c.positionPrev.x-=b.damping*A.x*y*v,c.positionPrev.y-=b.damping*A.y*y*v),q=d.cross(g,p)/w*a._torqueDampen*c.inverseInertia*(1-b.angularStiffness),c.constraintImpulse.angle-=q,c.angle-=q);f&&!f.isStatic&&(v=f.inverseMass/m,f.constraintImpulse.x+=p.x*v,f.constraintImpulse.y+=p.y*v,f.position.x+=p.x*v,f.position.y+=p.y*v,b.damping&&(f.positionPrev.x+=b.damping*A.x*y*v,f.positionPrev.y+=b.damping*A.y*y*v),q=d.cross(h,p)/w*a._torqueDampen*f.inverseInertia*(1-b.angularStiffness),f.constraintImpulse.angle+=q,f.angle+=q)}}};a.postSolveAll=function(c){for(var g=0;g<c.length;g++){var k=c[g],f=k.constraintImpulse;if(!(k.isStatic||0===f.x&&0===f.y&&0===f.angle)){b.set(k,!1);for(var r=0;r<k.parts.length;r++){var u=k.parts[r];e.translate(u.vertices,f);0<r&&(u.position.x+=f.x,u.position.y+=f.y);0!==f.angle&&(e.rotate(u.vertices,f.angle,k.position),l.rotate(u.axes,f.angle),0<r&&d.rotateAbout(u.position,f.angle,k.position,u.position));h.update(u.bounds,u.vertices,k.velocity)}f.angle*=a._warming;f.x*=a._warming;f.y*=a._warming}}}}()},{"../core/Common":14,"../core/Sleeping":22,"../geometry/Axes":25,"../geometry/Bounds":26,"../geometry/Vector":28,"../geometry/Vertices":29}],13:[function(n,q,w){var a={};q.exports=a;var e=n("../geometry/Vertices"),d=n("../core/Sleeping"),b=n("../core/Mouse"),h=n("../core/Events"),l=n("../collision/Detector"),g=n("./Constraint"),c=n("../body/Composite"),m=n("../core/Common"),k=n("../geometry/Bounds");!function(){a.create=function(d,e){var f=(d?d.mouse:null)||(e?e.mouse:null);f||(d&&d.render&&d.render.canvas?f=b.create(d.render.canvas):e&&e.element?f=b.create(e.element):(f=b.create(),m.warn("MouseConstraint.create: options.mouse was undefined, options.element was undefined, may not function as expected")));var k=g.create({label:"Mouse Constraint",pointA:f.position,pointB:{x:0,y:0},length:.01,stiffness:.1,angularStiffness:1,render:{strokeStyle:"#90EE90",lineWidth:3}}),l=m.extend({type:"mouseConstraint",mouse:f,element:null,body:null,constraint:k,collisionFilter:{category:1,mask:4294967295,group:0}},e);return h.on(d,"beforeUpdate",function(){var b=c.allBodies(d.world);a.update(l,b);a._triggerEvents(l)}),l};a.update=function(a,b){var c=a.mouse,f=a.constraint,g=a.body;if(0===c.button)if(f.bodyB)d.set(f.bodyB,!1),f.pointA=c.position;else for(var m=0;m<b.length;m++){if(g=b[m],k.contains(g.bounds,c.position)&&l.canCollide(g.collisionFilter,a.collisionFilter))for(var r=1<g.parts.length?1:0;r<g.parts.length;r++)if(e.contains(g.parts[r].vertices,c.position)){f.pointA=c.position;f.bodyB=a.body=g;f.pointB={x:c.position.x-g.position.x,y:c.position.y-g.position.y};f.angleB=g.angle;d.set(g,!1);h.trigger(a,"startdrag",{mouse:c,body:g});break}}else f.bodyB=a.body=null,f.pointB=null,g&&h.trigger(a,"enddrag",{mouse:c,body:g})};a._triggerEvents=function(a){var c=a.mouse,d=c.sourceEvents;d.mousemove&&h.trigger(a,"mousemove",{mouse:c});d.mousedown&&h.trigger(a,"mousedown",{mouse:c});d.mouseup&&h.trigger(a,"mouseup",{mouse:c});b.clearSourceEvents(c)}}()},{"../body/Composite":2,"../collision/Detector":5,"../core/Common":14,"../core/Events":16,"../core/Mouse":19,"../core/Sleeping":22,"../geometry/Bounds":26,"../geometry/Vertices":29,"./Constraint":12}],14:[function(n,q,w){var a={};q.exports=a;(function(){a._nextId=0;a._seed=0;a._nowStartTime=+new Date;a.extend=function(e,d){var b,h;for("boolean"==typeof d?(b=2,h=d):(b=1,h=!0);b<arguments.length;b++){var l=arguments[b];if(l)for(var g in l)h&&l[g]&&l[g].constructor===Object?e[g]&&e[g].constructor!==Object?e[g]=l[g]:(e[g]=e[g]||{},a.extend(e[g],h,l[g])):e[g]=l[g]}return e};a.clone=function(e,d){return a.extend({},d,e)};a.keys=function(a){if(Object.keys)return Object.keys(a);var d=[],b;for(b in a)d.push(b);return d};a.values=function(a){var d=[];if(Object.keys){for(var b=Object.keys(a),e=0;e<b.length;e++)d.push(a[b[e]]);return d}for(b in a)d.push(a[b]);return d};a.get=function(a,d,b,h){d=d.split(".").slice(b,h);for(b=0;b<d.length;b+=1)a=a[d[b]];return a};a.set=function(e,d,b,h,l){h=d.split(".").slice(h,l);return a.get(e,d,0,-1)[h[h.length-1]]=b,b};a.shuffle=function(e){for(var d=e.length-1;0<d;d--){var b=Math.floor(a.random()*(d+1)),h=e[d];e[d]=e[b];e[b]=h}return e};a.choose=function(e){return e[Math.floor(a.random()*e.length)]};a.isElement=function(a){return"undefined"!=typeof HTMLElement?a instanceof HTMLElement:!!(a&&a.nodeType&&a.nodeName)};a.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)};a.isFunction=function(a){return"function"==typeof a};a.isPlainObject=function(a){return"object"==typeof a&&a.constructor===Object};a.isString=function(a){return"[object String]"===toString.call(a)};a.clamp=function(a,d,b){return a<d?d:a>b?b:a};a.sign=function(a){return 0>a?-1:1};a.now=function(){if(window.performance){if(window.performance.now)return window.performance.now();if(window.performance.webkitNow)return window.performance.webkitNow()}return new Date-a._nowStartTime};a.random=function(e,d){return e="undefined"!=typeof e?e:0,d="undefined"!=typeof d?d:1,e+(a._seed=(9301*a._seed+49297)%233280,a._seed/233280)*(d-e)};a.colorToNumber=function(a){return a=a.replace("#",""),3==a.length&&(a=a.charAt(0)+a.charAt(0)+a.charAt(1)+a.charAt(1)+a.charAt(2)+a.charAt(2)),parseInt(a,16)};a.logLevel=1;a.log=function(){console&&0<a.logLevel&&3>=a.logLevel&&console.log.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))};a.info=function(){console&&0<a.logLevel&&2>=a.logLevel&&console.info.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))};a.warn=function(){console&&0<a.logLevel&&3>=a.logLevel&&console.warn.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))};a.nextId=function(){return a._nextId++};a.indexOf=function(a,d){if(a.indexOf)return a.indexOf(d);for(var b=0;b<a.length;b++)if(a[b]===d)return b;return-1};a.map=function(a,d){if(a.map)return a.map(d);for(var b=[],e=0;e<a.length;e+=1)b.push(d(a[e]));return b};a.topologicalSort=function(e){var d=[],b=[],h=[],l;for(l in e)b[l]||h[l]||a._topologicalSort(l,b,h,e,d);return d};a._topologicalSort=function(e,d,b,h,l){var g=h[e]||[];b[e]=!0;for(var c=0;c<g.length;c+=1){var m=g[c];b[m]||d[m]||a._topologicalSort(m,d,b,h,l)}b[e]=!1;d[e]=!0;l.push(e)};a.chain=function(){for(var a=[],d=0;d<arguments.length;d+=1){var b=arguments[d];b._chained?a.push.apply(a,b._chained):a.push(b)}d=function(){for(var b,d=Array(arguments.length),e=0,c=arguments.length;e<c;e++)d[e]=arguments[e];for(e=0;e<a.length;e+=1)c=a[e].apply(b,d),"undefined"!=typeof c&&(b=c);return b};return d._chained=a,d};a.chainPathBefore=function(e,d,b){return a.set(e,d,a.chain(b,a.get(e,d)))};a.chainPathAfter=function(e,d,b){return a.set(e,d,a.chain(a.get(e,d),b))}})()},{}],15:[function(n,q,w){var a={};q.exports=a;var e=n("../body/World"),d=n("./Sleeping"),b=n("../collision/Resolver"),h=n("../render/Render"),l=n("../collision/Pairs"),g=(n("./Metrics"),n("../collision/Grid")),c=n("./Events"),m=n("../body/Composite"),k=n("../constraint/Constraint"),f=n("./Common"),r=n("../body/Body");!function(){a.create=function(a,b){b=f.isElement(a)?b:a;a=f.isElement(a)?a:null;b=b||{};(a||b.render)&&f.warn("Engine.create: engine.render is deprecated (see docs)");var c=f.extend({positionIterations:6,velocityIterations:4,constraintIterations:2,enableSleeping:!1,events:[],plugin:{},timing:{timestamp:0,timeScale:1},broadphase:{controller:g}},b);if(a||c.render)c.render=f.extend({element:a,controller:h},c.render);return c.render&&c.render.controller&&(c.render=c.render.controller.create(c.render)),c.render&&(c.render.engine=c),c.world=b.world||e.create(c.world),c.pairs=l.create(),c.broadphase=c.broadphase.controller.create(c.broadphase),c.metrics=c.metrics||{extended:!1},c};a.update=function(e,f,g){f=f||1E3/60;g=g||1;var h=e.world,p=e.timing,r=e.broadphase,u=[];p.timestamp+=f*p.timeScale;var t={timestamp:p.timestamp};c.trigger(e,"beforeUpdate",t);var n=m.allBodies(h),q=m.allConstraints(h);e.enableSleeping&&d.update(n,p.timeScale);a._bodiesApplyGravity(n,h.gravity);a._bodiesUpdate(n,f,p.timeScale,g,h.bounds);k.preSolveAll(n);for(f=0;f<e.constraintIterations;f++)k.solveAll(q,p.timeScale);k.postSolveAll(n);r.controller?(h.isModified&&r.controller.clear(r),r.controller.update(r,n,e,h.isModified),u=r.pairsList):u=n;h.isModified&&m.setModified(h,!1,!1,!0);r=r.detector(u,e);h=e.pairs;u=p.timestamp;l.update(h,r,u);l.removeOld(h,u);e.enableSleeping&&d.afterCollisions(h.list,p.timeScale);0<h.collisionStart.length&&c.trigger(e,"collisionStart",{pairs:h.collisionStart});b.preSolvePosition(h.list);for(f=0;f<e.positionIterations;f++)b.solvePosition(h.list,p.timeScale);b.postSolvePosition(n);k.preSolveAll(n);for(f=0;f<e.constraintIterations;f++)k.solveAll(q,p.timeScale);k.postSolveAll(n);b.preSolveVelocity(h.list);for(f=0;f<e.velocityIterations;f++)b.solveVelocity(h.list,p.timeScale);return 0<h.collisionActive.length&&c.trigger(e,"collisionActive",{pairs:h.collisionActive}),0<h.collisionEnd.length&&c.trigger(e,"collisionEnd",{pairs:h.collisionEnd}),a._bodiesClearForces(n),c.trigger(e,"afterUpdate",t),e};a.merge=function(b,c){if(f.extend(b,c),c.world){b.world=c.world;a.clear(b);for(var e=m.allBodies(b.world),g=0;g<e.length;g++){var h=e[g];d.set(h,!1);h.id=f.nextId()}}};a.clear=function(a){var b=a.world;l.clear(a.pairs);var c=a.broadphase;c.controller&&(b=m.allBodies(b),c.controller.clear(c),c.controller.update(c,b,a,!0))};a._bodiesClearForces=function(a){for(var b=0;b<a.length;b++){var c=a[b];c.force.x=0;c.force.y=0;c.torque=0}};a._bodiesApplyGravity=function(a,b){var c="undefined"!=typeof b.scale?b.scale:.001;if((0!==b.x||0!==b.y)&&0!==c)for(var d=0;d<a.length;d++){var e=a[d];e.isStatic||e.isSleeping||(e.force.y+=e.mass*b.y*c,e.force.x+=e.mass*b.x*c)}};a._bodiesUpdate=function(a,b,c,d,e){for(e=0;e<a.length;e++){var f=a[e];f.isStatic||f.isSleeping||r.update(f,b,c,d)}}}()},{"../body/Body":1,"../body/Composite":2,"../body/World":3,"../collision/Grid":6,"../collision/Pairs":8,"../collision/Resolver":10,"../constraint/Constraint":12,"../render/Render":31,"./Common":14,"./Events":16,"./Metrics":18,"./Sleeping":22}],16:[function(n,q,w){var a={};q.exports=a;var e=n("./Common");!function(){a.on=function(a,b,e){for(var d=b.split(" "),g=0;g<d.length;g++)b=d[g],a.events=a.events||{},a.events[b]=a.events[b]||[],a.events[b].push(e);return e};a.off=function(a,b,h){if(!b)return void(a.events={});"function"==typeof b&&(h=b,b=e.keys(a.events).join(" "));b=b.split(" ");for(var d=0;d<b.length;d++){var g=a.events[b[d]],c=[];if(h&&g)for(var m=0;m<g.length;m++)g[m]!==h&&c.push(g[m]);a.events[b[d]]=c}};a.trigger=function(a,b,h){var d,g,c;if(a.events){h||(h={});b=b.split(" ");for(var m=0;m<b.length;m++)if(d=b[m],g=a.events[d]){c=e.clone(h,!1);c.name=d;c.source=a;for(var k=0;k<g.length;k++)g[k].apply(a,[c])}}}}()},{"./Common":14}],17:[function(n,q,w){var a={};q.exports=a;var e=n("./Plugin"),d=n("./Common");!function(){a.name="matter-js";a.version="0.14.1";a.uses=[];a.used=[];a.use=function(){e.use(a,Array.prototype.slice.call(arguments))};a.before=function(b,e){return b=b.replace(/^Matter./,""),d.chainPathBefore(a,b,e)};a.after=function(b,e){return b=b.replace(/^Matter./,""),d.chainPathAfter(a,b,e)}}()},{"./Common":14,"./Plugin":20}],18:[function(n,q,w){},{"../body/Composite":2,"./Common":14}],19:[function(n,q,w){var a={};q.exports=a;var e=n("../core/Common");!function(){a.create=function(d){var b={};return d||e.log("Mouse.create: element was undefined, defaulting to document.body","warn"),b.element=d||document.body,b.absolute={x:0,y:0},b.position={x:0,y:0},b.mousedownPosition={x:0,y:0},b.mouseupPosition={x:0,y:0},b.offset={x:0,y:0},b.scale={x:1,y:1},b.wheelDelta=0,b.button=-1,b.pixelRatio=b.element.getAttribute("data-pixel-ratio")||1,b.sourceEvents={mousemove:null,mousedown:null,mouseup:null,mousewheel:null},b.mousemove=function(d){var e=a._getRelativeMousePosition(d,b.element,b.pixelRatio);d.changedTouches&&(b.button=0,d.preventDefault());b.absolute.x=e.x;b.absolute.y=e.y;b.position.x=b.absolute.x*b.scale.x+b.offset.x;b.position.y=b.absolute.y*b.scale.y+b.offset.y;b.sourceEvents.mousemove=d},b.mousedown=function(d){var e=a._getRelativeMousePosition(d,b.element,b.pixelRatio);d.changedTouches?(b.button=0,d.preventDefault()):b.button=d.button;b.absolute.x=e.x;b.absolute.y=e.y;b.position.x=b.absolute.x*b.scale.x+b.offset.x;b.position.y=b.absolute.y*b.scale.y+b.offset.y;b.mousedownPosition.x=b.position.x;b.mousedownPosition.y=b.position.y;b.sourceEvents.mousedown=d},b.mouseup=function(d){var e=a._getRelativeMousePosition(d,b.element,b.pixelRatio);d.changedTouches&&d.preventDefault();b.button=-1;b.absolute.x=e.x;b.absolute.y=e.y;b.position.x=b.absolute.x*b.scale.x+b.offset.x;b.position.y=b.absolute.y*b.scale.y+b.offset.y;b.mouseupPosition.x=b.position.x;b.mouseupPosition.y=b.position.y;b.sourceEvents.mouseup=d},b.mousewheel=function(a){b.wheelDelta=Math.max(-1,Math.min(1,a.wheelDelta||-a.detail));a.preventDefault()},a.setElement(b,b.element),b};a.setElement=function(a,b){a.element=b;b.addEventListener("mousemove",a.mousemove);b.addEventListener("mousedown",a.mousedown);b.addEventListener("mouseup",a.mouseup);b.addEventListener("mousewheel",a.mousewheel);b.addEventListener("DOMMouseScroll",a.mousewheel);b.addEventListener("touchmove",a.mousemove);b.addEventListener("touchstart",a.mousedown);b.addEventListener("touchend",a.mouseup)};a.clearSourceEvents=function(a){a.sourceEvents.mousemove=null;a.sourceEvents.mousedown=null;a.sourceEvents.mouseup=null;a.sourceEvents.mousewheel=null;a.wheelDelta=0};a.setOffset=function(a,b){a.offset.x=b.x;a.offset.y=b.y;a.position.x=a.absolute.x*a.scale.x+a.offset.x;a.position.y=a.absolute.y*a.scale.y+a.offset.y};a.setScale=function(a,b){a.scale.x=b.x;a.scale.y=b.y;a.position.x=a.absolute.x*a.scale.x+a.offset.x;a.position.y=a.absolute.y*a.scale.y+a.offset.y};a._getRelativeMousePosition=function(a,b,e){var d,g,c=b.getBoundingClientRect(),h=document.documentElement||document.body.parentNode||document.body,k=void 0!==window.pageXOffset?window.pageXOffset:h.scrollLeft,h=void 0!==window.pageYOffset?window.pageYOffset:h.scrollTop,f=a.changedTouches;return f?(d=f[0].pageX-c.left-k,g=f[0].pageY-c.top-h):(d=a.pageX-c.left-k,g=a.pageY-c.top-h),{x:d/(b.clientWidth/(b.width||b.clientWidth)*e),y:g/(b.clientHeight/(b.height||b.clientHeight)*e)}}}()},{"../core/Common":14}],20:[function(n,q,w){var a={};q.exports=a;var e=n("./Common");!function(){a._registry={};a.register=function(d){if(a.isPlugin(d)||e.warn("Plugin.register:",a.toString(d),"does not implement all required fields."),d.name in a._registry){var b=a._registry[d.name],h=a.versionParse(d.version).number,l=a.versionParse(b.version).number;h>l?(e.warn("Plugin.register:",a.toString(b),"was upgraded to",a.toString(d)),a._registry[d.name]=d):h<l?e.warn("Plugin.register:",a.toString(b),"can not be downgraded to",a.toString(d)):d!==b&&e.warn("Plugin.register:",a.toString(d),"is already registered to different plugin object")}else a._registry[d.name]=d;return d};a.resolve=function(d){return a._registry[a.dependencyParse(d).name]};a.toString=function(a){return"string"==typeof a?a:(a.name||"anonymous")+"@"+(a.version||a.range||"0.0.0")};a.isPlugin=function(a){return a&&a.name&&a.version&&a.install};a.isUsed=function(a,b){return-1<a.used.indexOf(b)};a.isFor=function(d,b){var e=d["for"]&&a.dependencyParse(d["for"]);return!d["for"]||b.name===e.name&&a.versionSatisfies(b.version,e.range)};a.use=function(d,b){if(d.uses=(d.uses||[]).concat(b||[]),0===d.uses.length)return void e.warn("Plugin.use:",a.toString(d),"does not specify any dependencies to install.");for(var h=a.dependencies(d),h=e.topologicalSort(h),l=[],g=0;g<h.length;g+=1)if(h[g]!==d.name){var c=a.resolve(h[g]);c?a.isUsed(d,c.name)||(a.isFor(c,d)||(e.warn("Plugin.use:",a.toString(c),"is for",c["for"],"but installed on",a.toString(d)+"."),c._warned=!0),c.install?c.install(d):(e.warn("Plugin.use:",a.toString(c),"does not specify an install function."),c._warned=!0),c._warned?(l.push("\ud83d\udd36 "+a.toString(c)),delete c._warned):l.push("\u2705 "+a.toString(c)),d.used.push(c.name)):l.push("\u274c "+h[g])}0<l.length&&e.info(l.join("  "))};a.dependencies=function(d,b){var h=a.dependencyParse(d),l=h.name;if(b=b||{},!(l in b)){d=a.resolve(d)||d;b[l]=e.map(d.uses||[],function(b){a.isPlugin(b)&&a.register(b);var c=a.dependencyParse(b),g=a.resolve(b);return g&&!a.versionSatisfies(g.version,c.range)?(e.warn("Plugin.dependencies:",a.toString(g),"does not satisfy",a.toString(c),"used by",a.toString(h)+"."),g._warned=!0,d._warned=!0):g||(e.warn("Plugin.dependencies:",a.toString(b),"used by",a.toString(h),"could not be resolved."),d._warned=!0),c.name});for(var g=0;g<b[l].length;g+=1)a.dependencies(b[l][g],b);return b}};a.dependencyParse=function(a){return e.isString(a)?(/^[\w-]+(@(\*|[\^~]?\d+\.\d+\.\d+(-[0-9A-Za-z-]+)?))?$/.test(a)||e.warn("Plugin.dependencyParse:",a,"is not a valid dependency string."),{name:a.split("@")[0],range:a.split("@")[1]||"*"}):{name:a.name,range:a.range||a.version}};a.versionParse=function(a){/^\*|[\^~]?\d+\.\d+\.\d+(-[0-9A-Za-z-]+)?$/.test(a)||e.warn("Plugin.versionParse:",a,"is not a valid version or range.");var b=a.split("-");a=b[0];var d=isNaN(Number(a[0])),l=d?a.substr(1):a,g=e.map(l.split("."),function(a){return Number(a)});return{isRange:d,version:l,range:a,operator:d?a[0]:"",parts:g,prerelease:b[1],number:1E8*g[0]+1E4*g[1]+g[2]}};a.versionSatisfies=function(d,b){b=b||"*";var e=a.versionParse(b),l=e.parts,g=a.versionParse(d),c=g.parts;if(e.isRange){if("*"===e.operator||"*"===d)return!0;if("~"===e.operator)return c[0]===l[0]&&c[1]===l[1]&&c[2]>=l[2];if("^"===e.operator)return 0<l[0]?c[0]===l[0]&&g.number>=e.number:0<l[1]?c[1]===l[1]&&c[2]>=l[2]:c[2]===l[2]}return d===b||"*"===d}}()},{"./Common":14}],21:[function(n,q,w){var a={};q.exports=a;var e=n("./Events"),d=n("./Engine"),b=n("./Common");!function(){var h,l;if("undefined"!=typeof window&&(h=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame,l=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),!h){var g;h=function(a){g=setTimeout(function(){a(b.now())},1E3/60)};l=function(){clearTimeout(g)}}a.create=function(a){a=b.extend({fps:60,correction:1,deltaSampleSize:60,counterTimestamp:0,frameCounter:0,deltaHistory:[],timePrev:null,timeScalePrev:1,frameRequestId:null,isFixed:!1,enabled:!0},a);return a.delta=a.delta||1E3/a.fps,a.deltaMin=a.deltaMin||1E3/a.fps,a.deltaMax=a.deltaMax||1E3/(.5*a.fps),a.fps=1E3/a.delta,a};a.run=function(b,d){return"undefined"!=typeof b.positionIterations&&(d=b,b=a.create()),function f(c){b.frameRequestId=h(f);c&&b.enabled&&a.tick(b,d,c)}(),b};a.tick=function(a,b,g){var c,h=b.timing,k=1,p={timestamp:h.timestamp};e.trigger(a,"beforeTick",p);e.trigger(b,"beforeTick",p);a.isFixed?c=a.delta:(c=g-a.timePrev||a.delta,a.timePrev=g,a.deltaHistory.push(c),a.deltaHistory=a.deltaHistory.slice(-a.deltaSampleSize),c=Math.min.apply(null,a.deltaHistory),c=c<a.deltaMin?a.deltaMin:c,c=c>a.deltaMax?a.deltaMax:c,k=c/a.delta,a.delta=c);0!==a.timeScalePrev&&(k*=h.timeScale/a.timeScalePrev);0===h.timeScale&&(k=0);a.timeScalePrev=h.timeScale;a.correction=k;a.frameCounter+=1;1E3<=g-a.counterTimestamp&&(a.fps=(g-a.counterTimestamp)/1E3*a.frameCounter,a.counterTimestamp=g,a.frameCounter=0);e.trigger(a,"tick",p);e.trigger(b,"tick",p);b.world.isModified&&b.render&&b.render.controller&&b.render.controller.clear&&b.render.controller.clear(b.render);e.trigger(a,"beforeUpdate",p);d.update(b,c,k);e.trigger(a,"afterUpdate",p);b.render&&b.render.controller&&(e.trigger(a,"beforeRender",p),e.trigger(b,"beforeRender",p),b.render.controller.world(b.render),e.trigger(a,"afterRender",p),e.trigger(b,"afterRender",p));e.trigger(a,"afterTick",p);e.trigger(b,"afterTick",p)};a.stop=function(a){l(a.frameRequestId)};a.start=function(b,d){a.run(b,d)}}()},{"./Common":14,"./Engine":15,"./Events":16}],22:[function(n,q,w){var a={};q.exports=a;var e=n("./Events");!function(){a._motionWakeThreshold=.18;a._motionSleepThreshold=.08;a._minBias=.9;a.update=function(d,b){for(var e=b*b*b,l=0;l<d.length;l++){var g=d[l],c=g.speed*g.speed+g.angularSpeed*g.angularSpeed;0===g.force.x&&0===g.force.y?(g.motion=a._minBias*Math.min(g.motion,c)+(1-a._minBias)*Math.max(g.motion,c),0<g.sleepThreshold&&g.motion<a._motionSleepThreshold*e?(g.sleepCounter+=1,g.sleepCounter>=g.sleepThreshold&&a.set(g,!0)):0<g.sleepCounter&&--g.sleepCounter):a.set(g,!1)}};a.afterCollisions=function(d,b){for(var e=b*b*b,l=0;l<d.length;l++){var g=d[l];if(g.isActive){var c=g.collision,g=c.bodyA.parent,m=c.bodyB.parent;g.isSleeping&&m.isSleeping||g.isStatic||m.isStatic||!g.isSleeping&&!m.isSleeping||(c=g.isSleeping&&!g.isStatic?g:m,g=c===g?m:g,!c.isStatic&&g.motion>a._motionWakeThreshold*e&&a.set(c,!1))}}};a.set=function(a,b){var d=a.isSleeping;b?(a.isSleeping=!0,a.sleepCounter=a.sleepThreshold,a.positionImpulse.x=0,a.positionImpulse.y=0,a.positionPrev.x=a.position.x,a.positionPrev.y=a.position.y,a.anglePrev=a.angle,a.speed=0,a.angularSpeed=0,a.motion=0,d||e.trigger(a,"sleepStart")):(a.isSleeping=!1,a.sleepCounter=0,d&&e.trigger(a,"sleepEnd"))}}()},{"./Events":16}],23:[function(n,q,w){(function(a){var e={};q.exports=e;var d=n("../geometry/Vertices"),b=n("../core/Common"),h=n("../body/Body"),l=n("../geometry/Bounds"),g=n("../geometry/Vector"),c="undefined"!=typeof window?window.decomp:"undefined"!=typeof a?a.decomp:null;!function(){e.rectangle=function(a,c,e,g,l){l=l||{};a={label:"Rectangle Body",position:{x:a,y:c},vertices:d.fromPath("L 0 0 L "+e+" 0 L "+e+" "+g+" L 0 "+g)};l.chamfer&&(c=l.chamfer,a.vertices=d.chamfer(a.vertices,c.radius,c.quality,c.qualityMin,c.qualityMax),delete l.chamfer);return h.create(b.extend({},a,l))};e.trapezoid=function(a,c,e,g,l,p){p=p||{};l*=.5;var f=e*l;e=f+(1-2*l)*e;var k=e+f;a={label:"Trapezoid Body",position:{x:a,y:c},vertices:d.fromPath(.5>l?"L 0 0 L "+f+" "+-g+" L "+e+" "+-g+" L "+k+" 0":"L 0 0 L "+e+" "+-g+" L "+k+" 0")};p.chamfer&&(c=p.chamfer,a.vertices=d.chamfer(a.vertices,c.radius,c.quality,c.qualityMin,c.qualityMax),delete p.chamfer);return h.create(b.extend({},a,p))};e.circle=function(a,c,d,g,h){g=g||{};var f={label:"Circle Body",circleRadius:d};h=Math.ceil(Math.max(10,Math.min(h||25,d)));return 1===h%2&&(h+=1),e.polygon(a,c,h,d,b.extend({},f,g))};e.polygon=function(a,c,f,g,l){if(l=l||{},3>f)return e.circle(a,c,g,l);for(var k=2*Math.PI/f,m="",r=.5*k,n=0;n<f;n+=1)var u=r+n*k,q=Math.sin(u)*g,m=m+("L "+(Math.cos(u)*g).toFixed(3)+" "+q.toFixed(3)+" ");a={label:"Polygon Body",position:{x:a,y:c},vertices:d.fromPath(m)};l.chamfer&&(c=l.chamfer,a.vertices=d.chamfer(a.vertices,c.radius,c.quality,c.qualityMin,c.qualityMax),delete l.chamfer);return h.create(b.extend({},a,l))};e.fromVertices=function(a,e,f,r,n,p,t){var k,m,u,q,A,y;r=r||{};m=[];n="undefined"!=typeof n&&n;p="undefined"!=typeof p?p:.01;t="undefined"!=typeof t?t:10;c||b.warn("Bodies.fromVertices: poly-decomp.js required. Could not decompose vertices. Fallback to convex hull.");b.isArray(f[0])||(f=[f]);for(y=0;y<f.length;y+=1)if(q=f[y],u=d.isConvex(q),u||!c)q=u?d.clockwiseSort(q):d.hull(q),m.push({position:{x:a,y:e},vertices:q});else{A=q.map(function(a){return[a.x,a.y]});c.makeCCW(A);!1!==p&&c.removeCollinearPoints(A,p);var w=c.quickDecomp(A);for(A=0;A<w.length;A++){var C=w[A].map(function(a){return{x:a[0],y:a[1]}});0<t&&d.area(C)<t||m.push({position:d.centre(C),vertices:C})}}for(A=0;A<m.length;A++)m[A]=h.create(b.extend(m[A],r));if(n)for(A=0;A<m.length;A++)for(t=m[A],f=A+1;f<m.length;f++)if(u=m[f],l.overlaps(t.bounds,u.bounds))for(q=t.vertices,y=u.vertices,n=0;n<t.vertices.length;n++)for(p=0;p<u.vertices.length;p++)w=g.magnitudeSquared(g.sub(q[(n+1)%q.length],y[p])),C=g.magnitudeSquared(g.sub(q[n],y[(p+1)%y.length])),5>w&&5>C&&(q[n].isInternal=!0,y[p].isInternal=!0);return 1<m.length?(k=h.create(b.extend({parts:m.slice(0)},r)),h.setPosition(k,{x:a,y:e}),k):m[0]}}()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../body/Body":1,"../core/Common":14,"../geometry/Bounds":26,"../geometry/Vector":28,"../geometry/Vertices":29}],24:[function(n,q,w){var a={};q.exports=a;var e=n("../body/Composite"),d=n("../constraint/Constraint"),b=n("../core/Common"),h=n("../body/Body"),l=n("./Bodies");!function(){a.stack=function(a,b,d,k,f,l,n){for(var c,g=e.create({label:"Stack"}),m=a,r=0,u=0;u<k;u++){for(var q=0,A=0;A<d;A++){var y=n(m,b,A,u,c,r);y?(c=y.bounds.max.y-y.bounds.min.y,m=y.bounds.max.x-y.bounds.min.x,c>q&&(q=c),h.translate(y,{x:.5*m,y:.5*c}),m=y.bounds.max.x+f,e.addBody(g,y),c=y,r+=1):m+=f}b+=q+l;m=a}return g};a.chain=function(a,c,h,k,f,l){for(var g=a.bodies,p=1;p<g.length;p++){var m=g[p-1],r=g[p],m=b.extend({bodyA:m,pointA:{x:(m.bounds.max.x-m.bounds.min.x)*c,y:(m.bounds.max.y-m.bounds.min.y)*h},bodyB:r,pointB:{x:(r.bounds.max.x-r.bounds.min.x)*k,y:(r.bounds.max.y-r.bounds.min.y)*f}},l);e.addConstraint(a,d.create(m))}return a.label+=" Chain",a};a.mesh=function(a,c,h,k,f){var g,l,p,m,n,q=a.bodies;for(g=0;g<h;g++){for(l=1;l<c;l++)p=q[l-1+g*c],m=q[l+g*c],e.addConstraint(a,d.create(b.extend({bodyA:p,bodyB:m},f)));if(0<g)for(l=0;l<c;l++)p=q[l+(g-1)*c],m=q[l+g*c],e.addConstraint(a,d.create(b.extend({bodyA:p,bodyB:m},f))),k&&0<l&&(n=q[l-1+(g-1)*c],e.addConstraint(a,d.create(b.extend({bodyA:n,bodyB:m},f)))),k&&l<c-1&&(n=q[l+1+(g-1)*c],e.addConstraint(a,d.create(b.extend({bodyA:n,bodyB:m},f))))}return a.label+=" Mesh",a};a.pyramid=function(b,c,d,e,f,l,n){return a.stack(b,c,d,e,f,l,function(a,c,g,k,l,m){var p=Math.min(e,Math.ceil(d/2));a=l?l.bounds.max.x-l.bounds.min.x:0;if(!(k>p||(k=p-k,p=d-1-k,g<k||g>p)))return 1===m&&h.translate(l,{x:(g+(1===d%2?1:-1))*a,y:0}),n(b+(l?g*a:0)+g*f,c,g,k,l,m)})};a.newtonsCradle=function(a,b,h,k,f){for(var c=e.create({label:"Newtons Cradle"}),g=0;g<h;g++){var p=l.circle(a+1.9*g*k,b+f,k,{inertia:1/0,restitution:1,friction:0,frictionAir:1E-4,slop:1}),m=d.create({pointA:{x:a+1.9*g*k,y:b},bodyB:p});e.addBody(c,p);e.addConstraint(c,m)}return c};a.car=function(a,b,m,k,f){var c=h.nextGroup(!0),g=.5*-m+20,p=.5*m-20,n=e.create({label:"Car"});m=l.rectangle(a,b,m,k,{collisionFilter:{group:c},chamfer:{radius:.5*k},density:2E-4});k=l.circle(a+g,b+0,f,{collisionFilter:{group:c},friction:.8});a=l.circle(a+p,b+0,f,{collisionFilter:{group:c},friction:.8});g=d.create({bodyB:m,pointB:{x:g,y:0},bodyA:k,stiffness:1,length:0});p=d.create({bodyB:m,pointB:{x:p,y:0},bodyA:a,stiffness:1,length:0});return e.addBody(n,m),e.addBody(n,k),e.addBody(n,a),e.addConstraint(n,g),e.addConstraint(n,p),n};a.softBody=function(d,c,e,h,f,r,n,p,t,q){t=b.extend({inertia:1/0},t);q=b.extend({stiffness:.2,render:{type:"line",anchors:!1}},q);d=a.stack(d,c,e,h,f,r,function(a,b){return l.circle(a,b,p,t)});return a.mesh(d,e,h,n,q),d.label="Soft Body",d}}()},{"../body/Body":1,"../body/Composite":2,"../constraint/Constraint":12,"../core/Common":14,"./Bodies":23}],25:[function(n,q,w){var a={};q.exports=a;var e=n("../geometry/Vector"),d=n("../core/Common");!function(){a.fromVertices=function(a){for(var b={},l=0;l<a.length;l++){var g=(l+1)%a.length,g=e.normalise({x:a[g].y-a[l].y,y:a[l].x-a[g].x}),c=0===g.y?1/0:g.x/g.y,c=c.toFixed(3).toString();b[c]=g}return d.values(b)};a.rotate=function(a,d){if(0!==d)for(var b=Math.cos(d),e=Math.sin(d),c=0;c<a.length;c++){var h,k=a[c];h=k.x*b-k.y*e;k.y=k.x*e+k.y*b;k.x=h}}}()},{"../core/Common":14,"../geometry/Vector":28}],26:[function(n,q,w){var a={};q.exports=a;(function(){a.create=function(e){var d={min:{x:0,y:0},max:{x:0,y:0}};return e&&a.update(d,e),d};a.update=function(a,d,b){a.min.x=1/0;a.max.x=-(1/0);a.min.y=1/0;a.max.y=-(1/0);for(var e=0;e<d.length;e++){var l=d[e];l.x>a.max.x&&(a.max.x=l.x);l.x<a.min.x&&(a.min.x=l.x);l.y>a.max.y&&(a.max.y=l.y);l.y<a.min.y&&(a.min.y=l.y)}b&&(0<b.x?a.max.x+=b.x:a.min.x+=b.x,0<b.y?a.max.y+=b.y:a.min.y+=b.y)};a.contains=function(a,d){return d.x>=a.min.x&&d.x<=a.max.x&&d.y>=a.min.y&&d.y<=a.max.y};a.overlaps=function(a,d){return a.min.x<=d.max.x&&a.max.x>=d.min.x&&a.max.y>=d.min.y&&a.min.y<=d.max.y};a.translate=function(a,d){a.min.x+=d.x;a.max.x+=d.x;a.min.y+=d.y;a.max.y+=d.y};a.shift=function(a,d){var b=a.max.x-a.min.x,e=a.max.y-a.min.y;a.min.x=d.x;a.max.x=d.x+b;a.min.y=d.y;a.max.y=d.y+e}})()},{}],27:[function(n,q,w){var a={};q.exports=a;n("../geometry/Bounds");!function(){a.pathToVertices=function(e,d){var b,h,l,g,c,m,k,f,r,n,p=[],t=0,q=0,B=0;d=d||15;var x=function(a,b,c){c=1===c%2&&1<c;if(!k||a!=k.x||b!=k.y){k&&c?(r=k.x,n=k.y):(r=0,n=0);var d={x:r+a,y:n+b};!c&&k||(k=d);p.push(d);q=r+a;B=n+b}},v=function(a){var b=a.pathSegTypeAsLetter.toUpperCase();if("Z"!==b){switch(b){case "M":case "L":case "T":case "C":case "S":case "Q":q=a.x;B=a.y;break;case "H":q=a.x;break;case "V":B=a.y}x(q,B,a.pathSegType)}};a._svgPathToAbsolute(e);h=e.getTotalLength();g=[];for(b=0;b<e.pathSegList.numberOfItems;b+=1)g.push(e.pathSegList.getItem(b));for(c=g.concat();t<h;){if(f=e.getPathSegAtLength(t),l=g[f],l!=m){for(;c.length&&c[0]!=l;)v(c.shift());m=l}switch(l.pathSegTypeAsLetter.toUpperCase()){case "C":case "T":case "S":case "Q":case "A":b=e.getPointAtLength(t),x(b.x,b.y,0)}t+=d}b=0;for(h=c.length;b<h;++b)v(c[b]);return p};a._svgPathToAbsolute=function(a){for(var d,b,e,l,g,c,m=a.pathSegList,k=0,f=0,r=m.numberOfItems,n=0;n<r;++n){var p=m.getItem(n),t=p.pathSegTypeAsLetter;if(/[MLHVCSQTA]/.test(t))"x"in p&&(k=p.x),"y"in p&&(f=p.y);else switch("x1"in p&&(e=k+p.x1),"x2"in p&&(g=k+p.x2),"y1"in p&&(l=f+p.y1),"y2"in p&&(c=f+p.y2),"x"in p&&(k+=p.x),"y"in p&&(f+=p.y),t){case "m":m.replaceItem(a.createSVGPathSegMovetoAbs(k,f),n);break;case "l":m.replaceItem(a.createSVGPathSegLinetoAbs(k,f),n);break;case "h":m.replaceItem(a.createSVGPathSegLinetoHorizontalAbs(k),n);break;case "v":m.replaceItem(a.createSVGPathSegLinetoVerticalAbs(f),n);break;case "c":m.replaceItem(a.createSVGPathSegCurvetoCubicAbs(k,f,e,l,g,c),n);break;case "s":m.replaceItem(a.createSVGPathSegCurvetoCubicSmoothAbs(k,f,g,c),n);break;case "q":m.replaceItem(a.createSVGPathSegCurvetoQuadraticAbs(k,f,e,l),n);break;case "t":m.replaceItem(a.createSVGPathSegCurvetoQuadraticSmoothAbs(k,f),n);break;case "a":m.replaceItem(a.createSVGPathSegArcAbs(k,f,p.r1,p.r2,p.angle,p.largeArcFlag,p.sweepFlag),n);break;case "z":case "Z":k=d,f=b}"M"!=t&&"m"!=t||(d=k,b=f)}}}()},{"../geometry/Bounds":26}],28:[function(n,q,w){var a={};q.exports=a;(function(){a.create=function(a,d){return{x:a||0,y:d||0}};a.clone=function(a){return{x:a.x,y:a.y}};a.magnitude=function(a){return Math.sqrt(a.x*a.x+a.y*a.y)};a.magnitudeSquared=function(a){return a.x*a.x+a.y*a.y};a.rotate=function(a,d,b){var e=Math.cos(d);d=Math.sin(d);b||(b={});var l=a.x*e-a.y*d;return b.y=a.x*d+a.y*e,b.x=l,b};a.rotateAbout=function(a,d,b,h){var e=Math.cos(d);d=Math.sin(d);h||(h={});var g=b.x+((a.x-b.x)*e-(a.y-b.y)*d);return h.y=b.y+((a.x-b.x)*d+(a.y-b.y)*e),h.x=g,h};a.normalise=function(e){var d=a.magnitude(e);return 0===d?{x:0,y:0}:{x:e.x/d,y:e.y/d}};a.dot=function(a,d){return a.x*d.x+a.y*d.y};a.cross=function(a,d){return a.x*d.y-a.y*d.x};a.cross3=function(a,d,b){return(d.x-a.x)*(b.y-a.y)-(d.y-a.y)*(b.x-a.x)};a.add=function(a,d,b){return b||(b={}),b.x=a.x+d.x,b.y=a.y+d.y,b};a.sub=function(a,d,b){return b||(b={}),b.x=a.x-d.x,b.y=a.y-d.y,b};a.mult=function(a,d){return{x:a.x*d,y:a.y*d}};a.div=function(a,d){return{x:a.x/d,y:a.y/d}};a.perp=function(a,d){return d=!0===d?-1:1,{x:d*-a.y,y:d*a.x}};a.neg=function(a){return{x:-a.x,y:-a.y}};a.angle=function(a,d){return Math.atan2(d.y-a.y,d.x-a.x)};a._temp=[a.create(),a.create(),a.create(),a.create(),a.create(),a.create()]})()},{}],29:[function(n,q,w){var a={};q.exports=a;var e=n("../geometry/Vector"),d=n("../core/Common");!function(){a.create=function(a,d){for(var b=[],e=0;e<a.length;e++){var c=a[e];b.push({x:c.x,y:c.y,index:e,body:d,isInternal:!1})}return b};a.fromPath=function(b,d){var e=[];return b.replace(/L?\s*([\-\d\.e]+)[\s,]*([\-\d\.e]+)*/gi,function(a,b,d){e.push({x:parseFloat(b),y:parseFloat(d)})}),a.create(e,d)};a.centre=function(b){for(var d,l,g=a.area(b,!0),c={x:0,y:0},m=0;m<b.length;m++)l=(m+1)%b.length,d=e.cross(b[m],b[l]),d=e.mult(e.add(b[m],b[l]),d),c=e.add(c,d);return e.div(c,6*g)};a.mean=function(a){for(var b={x:0,y:0},d=0;d<a.length;d++)b.x+=a[d].x,b.y+=a[d].y;return e.div(b,a.length)};a.area=function(a,d){for(var b=0,e=a.length-1,c=0;c<a.length;c++)b+=(a[e].x-a[c].x)*(a[e].y+a[c].y),e=c;return d?b/2:Math.abs(b)/2};a.inertia=function(a,d){for(var b,g,c=0,h=0,k=0;k<a.length;k++)g=(k+1)%a.length,b=Math.abs(e.cross(a[g],a[k])),c+=b*(e.dot(a[g],a[g])+e.dot(a[g],a[k])+e.dot(a[k],a[k])),h+=b;return d/6*(c/h)};a.translate=function(a,d,e){var b;if(e)for(b=0;b<a.length;b++)a[b].x+=d.x*e,a[b].y+=d.y*e;else for(b=0;b<a.length;b++)a[b].x+=d.x,a[b].y+=d.y;return a};a.rotate=function(a,d,e){if(0!==d){var b=Math.cos(d);d=Math.sin(d);for(var c=0;c<a.length;c++){var h=a[c],k=h.x-e.x,f=h.y-e.y;h.x=e.x+(k*b-f*d);h.y=e.y+(k*d+f*b)}return a}};a.contains=function(a,d){for(var b=0;b<a.length;b++){var e=a[b],c=a[(b+1)%a.length];if(0<(d.x-e.x)*(c.y-e.y)+(d.y-e.y)*(e.x-c.x))return!1}return!0};a.scale=function(b,d,l,g){if(1===d&&1===l)return b;g=g||a.centre(b);for(var c,h=0;h<b.length;h++)c=b[h],c=e.sub(c,g),b[h].x=g.x+c.x*d,b[h].y=g.y+c.y*l;return b};a.chamfer=function(a,h,l,g,c){h="number"==typeof h?[h]:h||[8];l="undefined"!=typeof l?l:-1;g=g||2;c=c||14;for(var b=[],k=0;k<a.length;k++){var f=a[0<=k-1?k-1:a.length-1],r=a[k],n=a[(k+1)%a.length],p=h[k<h.length?k:h.length-1];if(0!==p){var f=e.normalise({x:r.y-f.y,y:f.x-r.x}),t=e.normalise({x:n.y-r.y,y:r.x-n.x}),q=Math.sqrt(2*Math.pow(p,2)),n=e.mult(d.clone(f),p),B=e.normalise(e.mult(e.add(f,t),.5)),r=e.sub(r,e.mult(B,q)),q=l;-1===l&&(q=1.75*Math.pow(p,.32));q=d.clamp(q,g,c);1===q%2&&(q+=1);p=Math.acos(e.dot(f,t))/q;for(f=0;f<q;f++)b.push(e.add(e.rotate(n,p*f),r))}else b.push(r)}return b};a.clockwiseSort=function(b){var d=a.mean(b);return b.sort(function(a,b){return e.angle(d,a)-e.angle(d,b)}),b};a.isConvex=function(a){var b,d,e,c,m=0,k=a.length;if(3>k)return null;for(b=0;b<k;b++)if(d=(b+1)%k,e=(b+2)%k,c=(a[d].x-a[b].x)*(a[e].y-a[d].y),c-=(a[d].y-a[b].y)*(a[e].x-a[d].x),0>c?m|=1:0<c&&(m|=2),3===m)return!1;return 0!==m||null};a.hull=function(a){var b,d,g=[],c=[];a=a.slice(0);a.sort(function(a,b){var c=a.x-b.x;return 0!==c?c:a.y-b.y});for(d=0;d<a.length;d+=1){for(b=a[d];2<=c.length&&0>=e.cross3(c[c.length-2],c[c.length-1],b);)c.pop();c.push(b)}for(d=a.length-1;0<=d;--d){for(b=a[d];2<=g.length&&0>=e.cross3(g[g.length-2],g[g.length-1],b);)g.pop();g.push(b)}return g.pop(),c.pop(),g.concat(c)}}()},{"../core/Common":14,"../geometry/Vector":28}],30:[function(n,q,w){q=q.exports=n("../core/Matter");q.Body=n("../body/Body");q.Composite=n("../body/Composite");q.World=n("../body/World");q.Contact=n("../collision/Contact");q.Detector=n("../collision/Detector");q.Grid=n("../collision/Grid");q.Pairs=n("../collision/Pairs");q.Pair=n("../collision/Pair");q.Query=n("../collision/Query");q.Resolver=n("../collision/Resolver");q.SAT=n("../collision/SAT");q.Constraint=n("../constraint/Constraint");q.MouseConstraint=n("../constraint/MouseConstraint");q.Common=n("../core/Common");q.Engine=n("../core/Engine");q.Events=n("../core/Events");q.Mouse=n("../core/Mouse");q.Runner=n("../core/Runner");q.Sleeping=n("../core/Sleeping");q.Plugin=n("../core/Plugin");q.Bodies=n("../factory/Bodies");q.Composites=n("../factory/Composites");q.Axes=n("../geometry/Axes");q.Bounds=n("../geometry/Bounds");q.Svg=n("../geometry/Svg");q.Vector=n("../geometry/Vector");q.Vertices=n("../geometry/Vertices");q.Render=n("../render/Render");q.RenderPixi=n("../render/RenderPixi");q.World.add=q.Composite.add;q.World.remove=q.Composite.remove;q.World.addComposite=q.Composite.addComposite;q.World.addBody=q.Composite.addBody;q.World.addConstraint=q.Composite.addConstraint;q.World.clear=q.Composite.clear;q.Engine.run=q.Runner.run},{"../body/Body":1,"../body/Composite":2,"../body/World":3,"../collision/Contact":4,"../collision/Detector":5,"../collision/Grid":6,"../collision/Pair":7,"../collision/Pairs":8,"../collision/Query":9,"../collision/Resolver":10,"../collision/SAT":11,"../constraint/Constraint":12,"../constraint/MouseConstraint":13,"../core/Common":14,"../core/Engine":15,"../core/Events":16,"../core/Matter":17,"../core/Metrics":18,"../core/Mouse":19,"../core/Plugin":20,"../core/Runner":21,"../core/Sleeping":22,"../factory/Bodies":23,"../factory/Composites":24,"../geometry/Axes":25,"../geometry/Bounds":26,"../geometry/Svg":27,"../geometry/Vector":28,"../geometry/Vertices":29,"../render/Render":31,"../render/RenderPixi":32}],31:[function(n,q,w){var a={};q.exports=a;var e=n("../core/Common"),d=n("../body/Composite"),b=n("../geometry/Bounds"),h=n("../core/Events"),l=n("../collision/Grid"),g=n("../geometry/Vector"),c=n("../core/Mouse");!function(){var m,k;"undefined"!=typeof window&&(m=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(function(){a(e.now())},1E3/60)},k=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame);a.create=function(b){var c=e.extend({controller:a,engine:null,element:null,canvas:null,mouse:null,frameRequestId:null,options:{width:800,height:600,pixelRatio:1,background:"#18181d",wireframeBackground:"#0f0f13",hasBounds:!!b.bounds,enabled:!0,wireframes:!0,showSleeping:!0,showDebug:!1,showBroadphase:!1,showBounds:!1,showVelocity:!1,showCollisions:!1,showSeparations:!1,showAxes:!1,showPositions:!1,showAngleIndicator:!1,showIds:!1,showShadows:!1,showVertexNumbers:!1,showConvexHulls:!1,showInternalEdges:!1,showMousePosition:!1}},b);return c.canvas&&(c.canvas.width=c.options.width||c.canvas.width,c.canvas.height=c.options.height||c.canvas.height),c.mouse=b.mouse,c.engine=b.engine,c.canvas=c.canvas||f(c.options.width,c.options.height),c.context=c.canvas.getContext("2d"),c.textures={},c.bounds=c.bounds||{min:{x:0,y:0},max:{x:c.canvas.width,y:c.canvas.height}},1!==c.options.pixelRatio&&a.setPixelRatio(c,c.options.pixelRatio),e.isElement(c.element)?c.element.appendChild(c.canvas):c.canvas.parentNode||e.log("Render.create: options.element was undefined, render.canvas was created but not appended","warn"),c};a.run=function(b){!function p(c){b.frameRequestId=m(p);a.world(b)}()};a.stop=function(a){k(a.frameRequestId)};a.setPixelRatio=function(a,b){var c=a.options,d=a.canvas;if("auto"===b){var e=d.getContext("2d");b=(window.devicePixelRatio||1)/(e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1)}c.pixelRatio=b;d.setAttribute("data-pixel-ratio",b);d.width=c.width*b;d.height=c.height*b;d.style.width=c.width+"px";d.style.height=c.height+"px";a.context.scale(b,b)};a.lookAt=function(a,b,d,f){f="undefined"==typeof f||f;b=e.isArray(b)?b:[b];d=d||{x:0,y:0};for(var g=1/0,h=1/0,k=-(1/0),p=-(1/0),m=0;m<b.length;m+=1){var l=b[m],n=l.bounds?l.bounds.min:l.min||l.position||l,l=l.bounds?l.bounds.max:l.max||l.position||l;n&&l&&(n.x<g&&(g=n.x),l.x>k&&(k=l.x),n.y<h&&(h=n.y),l.y>p&&(p=l.y))}b=k-g+2*d.x;p=p-h+2*d.y;k=a.canvas.width/a.canvas.height;m=b/p;l=n=1;m>k?l=m/k:n=k/m;a.options.hasBounds=!0;a.bounds.min.x=g;a.bounds.max.x=g+b*n;a.bounds.min.y=h;a.bounds.max.y=h+p*l;f&&(a.bounds.min.x+=.5*b-b*n*.5,a.bounds.max.x+=.5*b-b*n*.5,a.bounds.min.y+=.5*p-p*l*.5,a.bounds.max.y+=.5*p-p*l*.5);a.bounds.min.x-=d.x;a.bounds.max.x-=d.x;a.bounds.min.y-=d.y;a.bounds.max.y-=d.y;a.mouse&&(c.setScale(a.mouse,{x:(a.bounds.max.x-a.bounds.min.x)/a.canvas.width,y:(a.bounds.max.y-a.bounds.min.y)/a.canvas.height}),c.setOffset(a.mouse,a.bounds.min))};a.startViewTransform=function(a){a.context.scale(1/((a.bounds.max.x-a.bounds.min.x)/a.options.width),1/((a.bounds.max.y-a.bounds.min.y)/a.options.height));a.context.translate(-a.bounds.min.x,-a.bounds.min.y)};a.endViewTransform=function(a){a.context.setTransform(a.options.pixelRatio,0,0,a.options.pixelRatio,0,0)};a.world=function(e){var f,k=e.engine,m=k.world;f=e.canvas;var n=e.context,r=e.options,q=d.allBodies(m),m=d.allConstraints(m),v=r.wireframes?r.wireframeBackground:r.background,w=[],y=[],J={timestamp:k.timing.timestamp};h.trigger(e,"beforeRender",J);if(e.currentBackground!==v){var C=v;/(jpg|gif|png)$/.test(v)&&(C="url("+v+")");e.canvas.style.background=C;e.canvas.style.backgroundSize="contain";e.currentBackground=v}if(n.globalCompositeOperation="source-in",n.fillStyle="transparent",n.fillRect(0,0,f.width,f.height),n.globalCompositeOperation="source-over",r.hasBounds){for(f=0;f<q.length;f++)v=q[f],b.overlaps(v.bounds,e.bounds)&&w.push(v);for(f=0;f<m.length;f++){var q=m[f],v=q.bodyA,C=q.bodyB,D=q.pointA,E=q.pointB;v&&(D=g.add(v.position,q.pointA));C&&(E=g.add(C.position,q.pointB));D&&E&&(b.contains(e.bounds,D)||b.contains(e.bounds,E))&&y.push(q)}a.startViewTransform(e);e.mouse&&(c.setScale(e.mouse,{x:(e.bounds.max.x-e.bounds.min.x)/e.canvas.width,y:(e.bounds.max.y-e.bounds.min.y)/e.canvas.height}),c.setOffset(e.mouse,e.bounds.min))}else y=m,w=q;!r.wireframes||k.enableSleeping&&r.showSleeping?a.bodies(e,w,n):(r.showConvexHulls&&a.bodyConvexHulls(e,w,n),a.bodyWireframes(e,w,n));r.showBounds&&a.bodyBounds(e,w,n);(r.showAxes||r.showAngleIndicator)&&a.bodyAxes(e,w,n);r.showPositions&&a.bodyPositions(e,w,n);r.showVelocity&&a.bodyVelocity(e,w,n);r.showIds&&a.bodyIds(e,w,n);r.showSeparations&&a.separations(e,k.pairs.list,n);r.showCollisions&&a.collisions(e,k.pairs.list,n);r.showVertexNumbers&&a.vertexNumbers(e,w,n);r.showMousePosition&&a.mousePosition(e,e.mouse,n);a.constraints(y,n);r.showBroadphase&&k.broadphase.controller===l&&a.grid(e,k.broadphase,n);r.showDebug&&a.debug(e,n);r.hasBounds&&a.endViewTransform(e);h.trigger(e,"afterRender",J)};a.debug=function(a,b){var c=a.engine,e=c.metrics,f=a.options,g=(d.allBodies(c.world),"    ");if(500<=c.timing.timestamp-(a.debugTimestamp||0)){var h="";e.timing&&(h+="fps: "+Math.round(e.timing.fps)+g);a.debugString=h;a.debugTimestamp=c.timing.timestamp}if(a.debugString)for(b.font="12px Arial",f.wireframes?b.fillStyle="rgba(255,255,255,0.5)":b.fillStyle="rgba(0,0,0,0.5)",c=a.debugString.split("\n"),e=0;e<c.length;e++)b.fillText(c[e],50,50+18*e)};a.constraints=function(a,b){for(var c=0;c<a.length;c++){var d=a[c];if(d.render.visible&&d.pointA&&d.pointB){var f,h;f=d.bodyA;var k=d.bodyB;if(f=f?g.add(f.position,d.pointA):d.pointA,"pin"===d.render.type)b.beginPath(),b.arc(f.x,f.y,3,0,2*Math.PI),b.closePath();else{if(h=k?g.add(k.position,d.pointB):d.pointB,b.beginPath(),b.moveTo(f.x,f.y),"spring"===d.render.type)for(var l=g.sub(h,f),m=g.perp(g.normalise(l)),n=Math.ceil(e.clamp(d.length/5,12,20)),r=1;r<n;r+=1)k=0===r%2?1:-1,b.lineTo(f.x+r/n*l.x+m.x*k*4,f.y+r/n*l.y+m.y*k*4);b.lineTo(h.x,h.y)}d.render.lineWidth&&(b.lineWidth=d.render.lineWidth,b.strokeStyle=d.render.strokeStyle,b.stroke());d.render.anchors&&(b.fillStyle=d.render.strokeStyle,b.beginPath(),b.arc(f.x,f.y,3,0,2*Math.PI),b.arc(h.x,h.y,3,0,2*Math.PI),b.closePath(),b.fill())}}};a.bodyShadows=function(a,b,c){for(var d=(a.engine,0);d<b.length;d++){var e=b[d];if(e.render.visible){if(e.circleRadius)c.beginPath(),c.arc(e.position.x,e.position.y,e.circleRadius,0,2*Math.PI);else{c.beginPath();c.moveTo(e.vertices[0].x,e.vertices[0].y);for(var f=1;f<e.vertices.length;f++)c.lineTo(e.vertices[f].x,e.vertices[f].y)}c.closePath();var f=e.position.x-.5*a.options.width,e=e.position.y-.2*a.options.height,g=Math.abs(f)+Math.abs(e);c.shadowColor="rgba(0,0,0,0.15)";c.shadowOffsetX=.05*f;c.shadowOffsetY=.05*e;c.shadowBlur=1+12*Math.min(1,g/1E3);c.fill();c.shadowColor=null;c.shadowOffsetX=null;c.shadowOffsetY=null;c.shadowBlur=null}}};a.bodies=function(a,b,c){var d,e,f,g,h=(a.engine,a.options),k=h.showInternalEdges||!h.wireframes;for(f=0;f<b.length;f++)if(d=b[f],d.render.visible)for(g=1<d.parts.length?1:0;g<d.parts.length;g++)if(e=d.parts[g],e.render.visible){if(h.showSleeping&&d.isSleeping?c.globalAlpha=.5*e.render.opacity:1!==e.render.opacity&&(c.globalAlpha=e.render.opacity),e.render.sprite&&e.render.sprite.texture&&!h.wireframes){var l=e.render.sprite,m;m=l.texture;var p=a.textures[m];m=p?p:(p=a.textures[m]=new Image,p.src=m,p);c.translate(e.position.x,e.position.y);c.rotate(e.angle);c.drawImage(m,m.width*-l.xOffset*l.xScale,m.height*-l.yOffset*l.yScale,m.width*l.xScale,m.height*l.yScale);c.rotate(-e.angle);c.translate(-e.position.x,-e.position.y)}else{if(e.circleRadius)c.beginPath(),c.arc(e.position.x,e.position.y,e.circleRadius,0,2*Math.PI);else{c.beginPath();c.moveTo(e.vertices[0].x,e.vertices[0].y);for(l=1;l<e.vertices.length;l++)!e.vertices[l-1].isInternal||k?c.lineTo(e.vertices[l].x,e.vertices[l].y):c.moveTo(e.vertices[l].x,e.vertices[l].y),e.vertices[l].isInternal&&!k&&c.moveTo(e.vertices[(l+1)%e.vertices.length].x,e.vertices[(l+1)%e.vertices.length].y);c.lineTo(e.vertices[0].x,e.vertices[0].y);c.closePath()}h.wireframes?(c.lineWidth=1,c.strokeStyle="#bbb",c.stroke()):(c.fillStyle=e.render.fillStyle,e.render.lineWidth&&(c.lineWidth=e.render.lineWidth,c.strokeStyle=e.render.strokeStyle,c.stroke()),c.fill())}c.globalAlpha=1}};a.bodyWireframes=function(a,b,c){var d,e,f,g,h=a.options.showInternalEdges;c.beginPath();for(e=0;e<b.length;e++)if(d=b[e],d.render.visible)for(g=1<d.parts.length?1:0;g<d.parts.length;g++){a=d.parts[g];c.moveTo(a.vertices[0].x,a.vertices[0].y);for(f=1;f<a.vertices.length;f++)!a.vertices[f-1].isInternal||h?c.lineTo(a.vertices[f].x,a.vertices[f].y):c.moveTo(a.vertices[f].x,a.vertices[f].y),a.vertices[f].isInternal&&!h&&c.moveTo(a.vertices[(f+1)%a.vertices.length].x,a.vertices[(f+1)%a.vertices.length].y);c.lineTo(a.vertices[0].x,a.vertices[0].y)}c.lineWidth=1;c.strokeStyle="#bbb";c.stroke()};a.bodyConvexHulls=function(a,b,c){var d,e;c.beginPath();for(a=0;a<b.length;a++)if(d=b[a],d.render.visible&&1!==d.parts.length){c.moveTo(d.vertices[0].x,d.vertices[0].y);for(e=1;e<d.vertices.length;e++)c.lineTo(d.vertices[e].x,d.vertices[e].y);c.lineTo(d.vertices[0].x,d.vertices[0].y)}c.lineWidth=1;c.strokeStyle="rgba(255,255,255,0.2)";c.stroke()};a.vertexNumbers=function(a,b,c){var d,e;for(a=0;a<b.length;a++){var f=b[a].parts;for(e=1<f.length?1:0;e<f.length;e++){var g=f[e];for(d=0;d<g.vertices.length;d++)c.fillStyle="rgba(255,255,255,0.2)",c.fillText(a+"_"+d,g.position.x+.8*(g.vertices[d].x-g.position.x),g.position.y+.8*(g.vertices[d].y-g.position.y))}}};a.mousePosition=function(a,b,c){c.fillStyle="rgba(255,255,255,0.8)";c.fillText(b.position.x+"  "+b.position.y,b.position.x+5,b.position.y-5)};a.bodyBounds=function(a,b,c){a=(a.engine,a.options);c.beginPath();for(var d=0;d<b.length;d++)if(b[d].render.visible)for(var e=b[d].parts,f=1<e.length?1:0;f<e.length;f++){var g=e[f];c.rect(g.bounds.min.x,g.bounds.min.y,g.bounds.max.x-g.bounds.min.x,g.bounds.max.y-g.bounds.min.y)}a.wireframes?c.strokeStyle="rgba(255,255,255,0.08)":c.strokeStyle="rgba(0,0,0,0.1)";c.lineWidth=1;c.stroke()};a.bodyAxes=function(a,b,c){var d,e,f,g=(a.engine,a.options);c.beginPath();for(a=0;a<b.length;a++){d=b[a];var h=d.parts;if(d.render.visible)if(g.showAxes)for(e=1<h.length?1:0;e<h.length;e++)for(d=h[e],f=0;f<d.axes.length;f++){var k=d.axes[f];c.moveTo(d.position.x,d.position.y);c.lineTo(d.position.x+20*k.x,d.position.y+20*k.y)}else for(e=1<h.length?1:0;e<h.length;e++)for(d=h[e],f=0;f<d.axes.length;f++)c.moveTo(d.position.x,d.position.y),c.lineTo((d.vertices[0].x+d.vertices[d.vertices.length-1].x)/2,(d.vertices[0].y+d.vertices[d.vertices.length-1].y)/2)}g.wireframes?(c.strokeStyle="indianred",c.lineWidth=1):(c.strokeStyle="rgba(255, 255, 255, 0.4)",c.globalCompositeOperation="overlay",c.lineWidth=2);c.stroke();c.globalCompositeOperation="source-over"};a.bodyPositions=function(a,b,c){var d,e,f,g=(a.engine,a.options);c.beginPath();for(e=0;e<b.length;e++)if(d=b[e],d.render.visible)for(f=0;f<d.parts.length;f++)a=d.parts[f],c.arc(a.position.x,a.position.y,3,0,2*Math.PI,!1),c.closePath();g.wireframes?c.fillStyle="indianred":c.fillStyle="rgba(0,0,0,0.5)";c.fill();c.beginPath();for(e=0;e<b.length;e++)d=b[e],d.render.visible&&(c.arc(d.positionPrev.x,d.positionPrev.y,2,0,2*Math.PI,!1),c.closePath());c.fillStyle="rgba(255,165,0,0.8)";c.fill()};a.bodyVelocity=function(a,b,c){c.beginPath();for(a=0;a<b.length;a++){var d=b[a];d.render.visible&&(c.moveTo(d.position.x,d.position.y),c.lineTo(d.position.x+2*(d.position.x-d.positionPrev.x),d.position.y+2*(d.position.y-d.positionPrev.y)))}c.lineWidth=3;c.strokeStyle="cornflowerblue";c.stroke()};a.bodyIds=function(a,b,c){var d;for(a=0;a<b.length;a++)if(b[a].render.visible){var e=b[a].parts;for(d=1<e.length?1:0;d<e.length;d++){var f=e[d];c.font="12px Arial";c.fillStyle="rgba(255,255,255,0.5)";c.fillText(f.id,f.position.x+10,f.position.y-10)}}};a.collisions=function(a,b,c){var d,e,f,g=a.options;c.beginPath();for(a=0;a<b.length;a++)if(d=b[a],d.isActive)for(e=d.collision,f=0;f<d.activeContacts.length;f++){var h=d.activeContacts[f].vertex;c.rect(h.x-1.5,h.y-1.5,3.5,3.5)}g.wireframes?c.fillStyle="rgba(255,255,255,0.7)":c.fillStyle="orange";c.fill();c.beginPath();for(a=0;a<b.length;a++)if(d=b[a],d.isActive&&(e=d.collision,0<d.activeContacts.length))f=d.activeContacts[0].vertex.x,h=d.activeContacts[0].vertex.y,2===d.activeContacts.length&&(f=(d.activeContacts[0].vertex.x+d.activeContacts[1].vertex.x)/2,h=(d.activeContacts[0].vertex.y+d.activeContacts[1].vertex.y)/2),e.bodyB===e.supports[0].body||!0===e.bodyA.isStatic?c.moveTo(f-8*e.normal.x,h-8*e.normal.y):c.moveTo(f+8*e.normal.x,h+8*e.normal.y),c.lineTo(f,h);g.wireframes?c.strokeStyle="rgba(255,165,0,0.7)":c.strokeStyle="orange";c.lineWidth=1;c.stroke()};a.separations=function(a,b,c){var d,e,f,g,h=a.options;c.beginPath();for(g=0;g<b.length;g++)if(d=b[g],d.isActive){a=d.collision;e=a.bodyA;f=a.bodyB;var k=1;f.isStatic||e.isStatic||(k=.5);f.isStatic&&(k=0);c.moveTo(f.position.x,f.position.y);c.lineTo(f.position.x-a.penetration.x*k,f.position.y-a.penetration.y*k);k=1;f.isStatic||e.isStatic||(k=.5);e.isStatic&&(k=0);c.moveTo(e.position.x,e.position.y);c.lineTo(e.position.x+a.penetration.x*k,e.position.y+a.penetration.y*k)}h.wireframes?c.strokeStyle="rgba(255,165,0,0.5)":c.strokeStyle="orange";c.stroke()};a.grid=function(a,b,c){a.options.wireframes?c.strokeStyle="rgba(255,180,0,0.1)":c.strokeStyle="rgba(255,180,0,0.5)";c.beginPath();a=e.keys(b.buckets);for(var d=0;d<a.length;d++){var f=a[d];2>b.buckets[f].length||(f=f.split(/C|R/),c.rect(.5+parseInt(f[1],10)*b.bucketWidth,.5+parseInt(f[2],10)*b.bucketHeight,b.bucketWidth,b.bucketHeight))}c.lineWidth=1;c.stroke()};a.inspector=function(a,b){var c,d=(a.engine,a.selected),e=a.render,f=e.options;f.hasBounds&&(b.scale(1/((e.bounds.max.x-e.bounds.min.x)/e.options.width),1/((e.bounds.max.y-e.bounds.min.y)/e.options.height)),b.translate(-e.bounds.min.x,-e.bounds.min.y));for(e=0;e<d.length;e++){var g=d[e].data;switch(b.translate(.5,.5),b.lineWidth=1,b.strokeStyle="rgba(255,165,0,0.9)",b.setLineDash([1,2]),g.type){case "body":c=g.bounds;b.beginPath();b.rect(Math.floor(c.min.x-3),Math.floor(c.min.y-3),Math.floor(c.max.x-c.min.x+6),Math.floor(c.max.y-c.min.y+6));b.closePath();b.stroke();break;case "constraint":var h=g.pointA;g.bodyA&&(h=g.pointB);b.beginPath();b.arc(h.x,h.y,10,0,2*Math.PI);b.closePath();b.stroke()}b.setLineDash([]);b.translate(-.5,-.5)}null!==a.selectStart&&(b.translate(.5,.5),b.lineWidth=1,b.strokeStyle="rgba(255,165,0,0.6)",b.fillStyle="rgba(255,165,0,0.1)",c=a.selectBounds,b.beginPath(),b.rect(Math.floor(c.min.x),Math.floor(c.min.y),Math.floor(c.max.x-c.min.x),Math.floor(c.max.y-c.min.y)),b.closePath(),b.stroke(),b.fill(),b.translate(-.5,-.5));f.hasBounds&&b.setTransform(1,0,0,1,0,0)};var f=function(a,b){var c=document.createElement("canvas");return c.width=a,c.height=b,c.oncontextmenu=function(){return!1},c.onselectstart=function(){return!1},c}}()},{"../body/Composite":2,"../collision/Grid":6,"../core/Common":14,"../core/Events":16,"../core/Mouse":19,"../geometry/Bounds":26,"../geometry/Vector":28}],32:[function(n,q,w){var a={};q.exports=a;var e=n("../geometry/Bounds"),d=n("../body/Composite"),b=n("../core/Common"),h=n("../core/Events"),l=n("../geometry/Vector");!function(){var g,c;"undefined"!=typeof window&&(g=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(function(){a(b.now())},1E3/60)},c=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame);a.create=function(c){b.warn("RenderPixi.create: Matter.RenderPixi is deprecated (see docs)");var d=b.extend({controller:a,engine:null,element:null,frameRequestId:null,canvas:null,renderer:null,container:null,spriteContainer:null,pixiOptions:null,options:{width:800,height:600,background:"#fafafa",wireframeBackground:"#222",hasBounds:!1,enabled:!0,wireframes:!0,showSleeping:!0,showDebug:!1,showBroadphase:!1,showBounds:!1,showVelocity:!1,showCollisions:!1,showAxes:!1,showPositions:!1,showAngleIndicator:!1,showIds:!1,showShadows:!1}},c),e=!d.options.wireframes&&"transparent"===d.options.background;return d.pixiOptions=d.pixiOptions||{view:d.canvas,transparent:e,antialias:!0,backgroundColor:c.background},d.mouse=c.mouse,d.engine=c.engine,d.renderer=d.renderer||new PIXI.WebGLRenderer(d.options.width,d.options.height,d.pixiOptions),d.container=d.container||new PIXI.Container,d.spriteContainer=d.spriteContainer||new PIXI.Container,d.canvas=d.canvas||d.renderer.view,d.bounds=d.bounds||{min:{x:0,y:0},max:{x:d.options.width,y:d.options.height}},h.on(d.engine,"beforeUpdate",function(){a.clear(d)}),d.textures={},d.sprites={},d.primitives={},d.container.addChild(d.spriteContainer),b.isElement(d.element)?d.element.appendChild(d.canvas):b.warn('No "render.element" passed, "render.canvas" was not inserted into document.'),d.canvas.oncontextmenu=function(){return!1},d.canvas.onselectstart=function(){return!1},d};a.run=function(b){!function r(c){b.frameRequestId=g(r);a.world(b)}()};a.stop=function(a){c(a.frameRequestId)};a.clear=function(a){for(var b=a.container,c=a.spriteContainer;b.children[0];)b.removeChild(b.children[0]);for(;c.children[0];)c.removeChild(c.children[0]);c=a.sprites["bg-0"];a.textures={};a.sprites={};a.primitives={};(a.sprites["bg-0"]=c)&&b.addChildAt(c,0);a.container.addChild(a.spriteContainer);a.currentBackground=null;b.scale.set(1,1);b.position.set(0,0)};a.setBackground=function(a,c){if(a.currentBackground!==c){var d=c.indexOf&&-1!==c.indexOf("#"),e=a.sprites["bg-0"];d?(d=b.colorToNumber(c),a.renderer.backgroundColor=d,e&&a.container.removeChild(e)):e||(e=m(a,c),e=a.sprites["bg-0"]=new PIXI.Sprite(e),e.position.x=0,e.position.y=0,a.container.addChildAt(e,0));a.currentBackground=c}};a.world=function(b){var c,g=b.engine.world,h=b.renderer,k=b.container;c=b.options;var m=d.allBodies(g),g=d.allConstraints(g),n=[];c.wireframes?a.setBackground(b,c.wireframeBackground):a.setBackground(b,c.background);var q=(b.bounds.max.x-b.bounds.min.x)/b.options.width,x=(b.bounds.max.y-b.bounds.min.y)/b.options.height;if(c.hasBounds){for(c=0;c<m.length;c++){var v=m[c];v.render.sprite.visible=e.overlaps(v.bounds,b.bounds)}for(c=0;c<g.length;c++){var v=g[c],w=v.bodyA,y=v.bodyB,J=v.pointA,C=v.pointB;w&&(J=l.add(w.position,v.pointA));y&&(C=l.add(y.position,v.pointB));J&&C&&(e.contains(b.bounds,J)||e.contains(b.bounds,C))&&n.push(v)}k.scale.set(1/q,1/x);k.position.set(1/q*-b.bounds.min.x,1/x*-b.bounds.min.y)}else n=g;for(c=0;c<m.length;c++)a.body(b,m[c]);for(c=0;c<n.length;c++)a.constraint(b,n[c]);h.render(k)};a.constraint=function(a,c){var d=(a.engine,c.bodyA),e=c.bodyB,f=c.pointA,g=c.pointB,h=a.container,k=c.render,l="c-"+c.id,m=a.primitives[l];return m||(m=a.primitives[l]=new PIXI.Graphics),k.visible&&c.pointA&&c.pointB?(-1===b.indexOf(h.children,m)&&h.addChild(m),m.clear(),m.beginFill(0,0),m.lineStyle(k.lineWidth,b.colorToNumber(k.strokeStyle),1),d?m.moveTo(d.position.x+f.x,d.position.y+f.y):m.moveTo(f.x,f.y),e?m.lineTo(e.position.x+g.x,e.position.y+g.y):m.lineTo(g.x,g.y),void m.endFill()):void m.clear()};a.body=function(a,c){var d=(a.engine,c.render);if(d.visible)if(d.sprite&&d.sprite.texture){var e="b-"+c.id,f=a.sprites[e],g=a.spriteContainer;if(!f){var f=a.sprites,h;h=m(a,c.render.sprite.texture);h=new PIXI.Sprite(h);h=(h.anchor.x=c.render.sprite.xOffset,h.anchor.y=c.render.sprite.yOffset,h);f=f[e]=h}-1===b.indexOf(g.children,f)&&g.addChild(f);f.position.x=c.position.x;f.position.y=c.position.y;f.rotation=c.angle;f.scale.x=d.sprite.xScale||1;f.scale.y=d.sprite.yScale||1}else{d="b-"+c.id;g=a.primitives[d];e=a.container;if(!g){g=a.primitives;h=c.render;var k=a.options,l=new PIXI.Graphics,n=b.colorToNumber(h.fillStyle),q=b.colorToNumber(h.strokeStyle),w=b.colorToNumber(h.strokeStyle),J=b.colorToNumber("#bbb"),C=b.colorToNumber("#CD5C5C");l.clear();for(var D=1<c.parts.length?1:0;D<c.parts.length;D++){f=c.parts[D];k.wireframes?(l.beginFill(0,0),l.lineStyle(1,J,1)):(l.beginFill(n,1),l.lineStyle(h.lineWidth,q,1));l.moveTo(f.vertices[0].x-c.position.x,f.vertices[0].y-c.position.y);for(var E=1;E<f.vertices.length;E++)l.lineTo(f.vertices[E].x-c.position.x,f.vertices[E].y-c.position.y);l.lineTo(f.vertices[0].x-c.position.x,f.vertices[0].y-c.position.y);l.endFill();(k.showAngleIndicator||k.showAxes)&&(l.beginFill(0,0),k.wireframes?l.lineStyle(1,C,1):l.lineStyle(1,w),l.moveTo(f.position.x-c.position.x,f.position.y-c.position.y),l.lineTo((f.vertices[0].x+f.vertices[f.vertices.length-1].x)/2-c.position.x,(f.vertices[0].y+f.vertices[f.vertices.length-1].y)/2-c.position.y),l.endFill())}g=g[d]=l;g.initialAngle=c.angle}-1===b.indexOf(e.children,g)&&e.addChild(g);g.position.x=c.position.x;g.position.y=c.position.y;g.rotation=c.angle-g.initialAngle}};var m=function(a,b){var c=a.textures[b];return c||(c=a.textures[b]=PIXI.Texture.fromImage(b)),c}}()},{"../body/Composite":2,"../core/Common":14,"../core/Events":16,"../geometry/Bounds":26,"../geometry/Vector":28}]},{},[30])(30)});